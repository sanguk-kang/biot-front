define("systemsettings/webportal/webportal",["systemsettings/core"],function(){var rt,dt=window.kendo,st=window.Util,ct=window.GlobalSettings,lt=window.I18N,ut={},pt={},e=$("<div/>");rt=e.kendoCommonDialog().data("kendoCommonDialog");var mt,gt,Et=$("<div/>"),St=window.CommonLoadingPanel,Tt=new St,_t=window.MAIN_WINDOW,t=[],ft=$("#setting-common-tab"),Nt=[{resource:"Dashboard",enabled:!0},{resource:"HMI",enabled:!0},{resource:"Device",enabled:!0},{resource:"Device-AirConditioner.Indoor",enabled:!0},{resource:"Device-AirConditionerOutdoor",enabled:!0},{resource:"Device-Sensor.Temperature_Humidity",enabled:!0},{resource:"Device-Light",enabled:!0},{resource:"Device-Sensor.Motion",enabled:!1},{resource:"Device-ControlPoint",enabled:!0},{resource:"Device-Meter",enabled:!0},{resource:"Device-Gateway",enabled:!1},{resource:"Device-Beacon",enabled:!1},{resource:"Device-CCTV",enabled:!1},{resource:"Device-SmartPlug",enabled:!1},{resource:"Device-Etc",enabled:!1},{resource:"Operation",enabled:!0},{resource:"Operation-Alarm",enabled:!0},{resource:"Operation-Schedule",enabled:!0},{resource:"Operation-Rule",enabled:!0},{resource:"Operation-Group",enabled:!0},{resource:"History",enabled:!0},{resource:"History-Report",enabled:!0},{resource:"History-TrendLog",enabled:!0},{resource:"History-SystemLog",enabled:!0},{resource:"Energy",enabled:!0},{resource:"Energy-Summary",enabled:!0},{resource:"Energy-ConsumptionAndTarget",enabled:!0},{resource:"Energy-SamsungSAC",enabled:!0},{resource:"Asset",enabled:!1},{resource:"ControlAreaSettings",enabled:!0},{resource:"AccountSettings",enabled:!0},{resource:"DeviceSettings",enabled:!0},{resource:"EnergySettings",enabled:!0},{resource:"SystemSettings",enabled:!0}];Tt.open(),t.push($.ajax({url:"/foundation/settings/common"}).done(function(e){gt=(ut=e).version}).fail(function(e){var t=st.parseFailResponse(e);rt.message(t),rt.open()})),t.push($.ajax({url:"/foundation/settings/display"}).done(function(e){pt=e}).fail(function(e){var t=st.parseFailResponse(e);rt.message(t),rt.open()})),$.when.apply(this,t).always(function(){if(Tt.close(),ft.kendoCommonTabStrip(),null!==localStorage.getItem("reloadFromMenuConfig")){var e=ft.find("[aria-controls=settings-common-menuconfig]"),t=ft.find(".k-item").index(e);ft.data("kendoCommonTabStrip").select(t),localStorage.removeItem("reloadFromMenuConfig")}else ft.data("kendoCommonTabStrip").select(0);function o(e){var t;t=e?($("#settings-common-temperature_unit-half").prop("disabled",!0),$("#settings-common-temperature_unit-half").prop("checked",!1),$("#settings-common-temperature_unit-one").prop("disabled",!0),$("#settings-common-temperature_unit-one").prop("checked",!0),M.temperature.Fahrenheit.symbol):($("#settings-common-temperature_unit-half").prop("disabled",!1),$("#settings-common-temperature_unit-one").prop("disabled",!1),M.temperature.Celsius.symbol),$("#settings-common-common").find(".settings-common-temperature_ctrl_unit").find(".symbol").text(t)}var l,n,a,i,r,u,h,G,M,p,d,s,y,D,A,U,R,m,c,g,E,S,T,_,f,N,I,b,C,k,v,O,w,F,P,B,L,x,V,H,Y,W,q,j,K,z,Q,Z,J,X,ee,te,ne,oe,ae,ie,re,de,se,ce,le,ue,pe,me,ge,Ee,Se,Te,_e,fe,Ne,Ie,be,Ce,ke,ve,Oe,he,Ge,Me,ye,De,Ae,Ue,Re,we,Fe,Pe,Be,Le,$e,xe,Ve,He,Ye,We,qe,je,Ke,ze,Qe,Ze,Je,Xe,et,tt,nt,ot,at,it;_t.disableFloorNav(!0),0<ft.find("[aria-controls=settings-common-common]").length&&(n=lt.prop("SETTINGS_CELSIUS"),a=lt.prop("SETTINGS_FAHRENHEIT"),i=lt.prop("SETTINGS_TIME_DISPLAY_TWENTY_FOUR_HOURS"),r=lt.prop("SETTINGS_TIME_DISPLAY_AM_PM"),u=lt.prop("COMMON_MESSAGE_NOTI_CHANGES_SAVED"),h={language:{dataTextField:"text",dataValueField:"value",dataSource:[{value:"en",text:lt.prop("SETTINGS_LANGUAGE_ENGLISH")},{value:"ko",text:lt.prop("SETTINGS_LANGUAGE_KOREAN")}]},timeZone:["Asia/Seoul","Pacific/Hawaii","America/Los Angeles","America/Arizona"],weather:{country:["KR","USA","Poland"],cityName:{KR:["Seoul"],USA:["San Francisco"],Poland:["Warsaw"]}},purposeFacility:["Complex Facility","Sales Facility","Educational Facility","Accommocation"]},G={temperature:{unit:["Celsius","Fahrenheit"],unitName:[n,a],increment:[.5,1]},timeNotation:["24Hour","12Hour"]},M={temperature:{Celsius:{idName:"celsiuls",symbol:"\xb0C",checked:""},Fahrenheit:{idName:"fahrenheit",symbol:"\u2109",checked:""}},temperature_unit:{.5:{idName:"half",checked:""},1:{idName:"one",checked:""}},timeNotation:{"24Hour":{idName:"24",checked:"",displayName:i},"12Hour":{idName:"ampm",checked:"",displayName:r}}},p=$("#settings-common-common"),d=$("#settings-save-btn"),s=$("#settings-undo-btn"),y=$("#settings-common-language-list"),D=$("#settings-common-timezone-list"),A=$("#settings-common-country-list"),U=$("#settings-common-city-list"),R=$("#settings-common-purpose-list"),m=!1,c=$("#popup-settings-common-save-message"),g=function(e){var t,n,o,a,i,r,d,s=[],c=[],l=[],u=ct.getLocale()?ct.getLocale():e.language;u=u||h.language.dataSource[0].value,y.data("kendoDropDownList").value(u),t=new dt.data.DataSource({data:h.timeZone}),D.data("kendoDropDownList").setDataSource(t);var p=e.timeZone?e.timeZone:ct.getTimezone();p=p||t.options.data[0],D.data("kendoDropDownList").value(p),n=new dt.data.DataSource({data:h.weather.country}),A.data("kendoDropDownList").setDataSource(n);var m,g=ct.getWeather();g&&(m=g.country);var E=e.weather&&e.weather.country?e.wheather.country:m;E=E||n.options.data[0],A.data("kendoDropDownList").value(E),o=new dt.data.DataSource({data:h.weather.cityName[E]}),U.data("kendoDropDownList").setDataSource(o),U.data("kendoDropDownList").value(o.options.data[0]),a=new dt.data.DataSource({data:h.purposeFacility}),R.data("kendoDropDownList").setDataSource(a);var S=e.purposeOfFacility?e.purposeOfFacility:ct.getPurposeOfFacility();S=S||a.options.data[0],R.data("kendoDropDownList").value(S),i=$(".settings-common-temperature_unit").find(".select-cell ul");var T,_,f,N,I,b,C=e.temperature&&e.temperature.unit?e.temperature.unit:G.temperature.unit[0];for(b=0;b<G.temperature.unit.length;b++)T=G.temperature.unit[b],_=G.temperature.unitName[b],N="",T==C&&(N="checked"),I="<li class='value'><input type='radio' name='temperature-unit' data-value='"+T+"' id='settings-common-temperature-"+(f=M.temperature[T].idName)+"' class='k-radio' "+N+"/><label class='k-radio-label' for='settings-common-temperature-"+f+"'>"+_+" ("+M.temperature[T].symbol+")</label></li>",s.push(T),i.append(I);var k=e.temperature&&e.temperature.increment?e.temperature.increment:G.temperature.increment[0];for(r=$(".settings-common-temperature_ctrl_unit").find(".select-cell ul"),b=0;b<G.temperature.increment.length;b++)N="",(T=G.temperature.increment[b])==k&&(N="checked"),I="<li class='value'><input type='radio' name='temperature-control-unit' data-value='"+T+"' id='settings-common-temperature_unit-"+(f=M.temperature_unit[T].idName)+"' class='k-radio' "+N+"/><label class='k-radio-label' for='settings-common-temperature_unit-"+f+"'>"+T+"(<span class='symbol'>"+M.temperature[C].symbol+"</span>)</label></li>",c.push(T),r.append(I);d=$(".settings-common-time_display").find(".select-cell ul");var v=e.timeNotation?e.timeNotation:ct.getTimeDisplay();for(b=0;b<G.timeNotation.length;b++){T=G.timeNotation[b],_=M.timeNotation[T].displayName,N="",T===v&&(N="checked");var O="HH";"24hours"==T?O="HH":"AM/PM"==T&&(O="hh"),I="<li class='value'><input type='radio' name='time_display' data-value='"+T+"' data-local-value='"+O+"' id='settings-common-time_notation-"+(f=M.timeNotation[T].idName)+"' class='k-radio' "+N+"/><label class='k-radio-label' for='settings-common-time_notation-"+f+"'>"+_+"</label></li>",l.push(T),d.append(I)}},function(){y.kendoDropDownList(h.language),D.kendoDropDownList(),A.kendoDropDownList(),U.kendoDropDownList(),R.kendoDropDownList(),mt=Et.kendoCommonDialog({type:"confirm"}).data("kendoCommonDialog"),(l=c.kendoCommonDialog().data("kendoCommonDialog")).setActions(0,{action:function(){m=!0,location.reload()}}),d.kendoButton().data("kendoButton").enable(!1),s.kendoButton().data("kendoButton").enable(!1)}(),g(ut),$("#settings-common-temperature-fahrenheit").is(":checked")?o(!0):$("#settings-common-temperature-celsius").is(":checked")&&o(!1),D.closest(".common-tab-table-content").hide(),A.closest(".common-tab-table-content").hide(),R.closest(".common-tab-table-content").hide(),function(){y.data("kendoDropDownList").bind("change",function(){d.data("kendoButton").enable(!0),s.data("kendoButton").enable(!0)}),D.data("kendoDropDownList").bind("change",function(){d.data("kendoButton").enable(!0),s.data("kendoButton").enable(!0)}),A.data("kendoDropDownList").bind("change",function(){var e=this.value(),t=new dt.data.DataSource({data:h.weather.cityName[e]});U.data("kendoDropDownList").setDataSource(t),U.data("kendoDropDownList").value(t.options.data[0]),d.data("kendoButton").enable(!0),s.data("kendoButton").enable(!0)}),U.data("kendoDropDownList").bind("change",function(){d.data("kendoButton").enable(!0),s.data("kendoButton").enable(!0)}),R.data("kendoDropDownList").bind("change",function(){d.data("kendoButton").enable(!0),s.data("kendoButton").enable(!0)});var n=p.find("input.k-radio:checked");p.find("input.k-radio").on("click",function(e){var t=$(e.target);"Fahrenheit"==t.attr("data-value")?o(!0):"Celsius"==t.attr("data-value")&&o(!1),!1===n.is(t)&&(d.data("kendoButton").enable(!0),s.data("kendoButton").enable(!0)),n=t}),d.on("click",function(e){var n,o,a,t=$(e.target),i=y.data("kendoDropDownList").value(),r=D.data("kendoDropDownList").value(),d=A.data("kendoDropDownList").value(),s=U.data("kendoDropDownList").value(),c=R.data("kendoDropDownList").value();p.find("input.k-radio:checked").each(function(){var e=$(this).attr("name"),t=$(this).data("value");"temperature-unit"==e?n=t:"temperature-control-unit"==e?o=t:"time_display"==e&&(a=t)}),Tt.open(),$.ajax({url:"/foundation/settings/common",method:"PATCH",data:{language:i,temperature:{unit:n,increment:o},timeNotation:a}}).done(function(){ct.setLocale(i),ct.setTimezone(r),ct.setTimeDisplay(a),ct.setPurposeOfFacility(c),ct.setWeather({country:d,city:s}),ct.setTemperature({unit:n,increment:o}),ct.apply(),l.message(u),l.open(),t.data("kendoButton").enable(!1),m||setTimeout(function(){location.reload()},5e3)}).fail(function(e){var t=st.parseFailResponse(e);rt.message(t),rt.open()}).always(function(){Tt.close()})}),s.on("click",function(){})}()),0<ft.find("[aria-controls=settings-common-display]").length&&(E=st.getInstalledTypeList(),S=E,T=lt.prop("SETTINGS_VIEW_GRID"),_=lt.prop("SETTINGS_VIEW_LIST"),f=lt.prop("SETTINGS_VIEW_MAP"),N=lt.prop("SETTINGS_VIEW_STATISTIC"),I=lt.prop("COMMON_MESSAGE_NOTI_CHANGES_SAVED"),b={defaultView:[{menu:"Facility.Device",supportedViews:["Statistic","Map","List","Grid"],supportedViewsName:[N,f,_,T],view:""},{menu:"Facility.Group",supportedViews:["Statistic","List"],view:""},{menu:"Facility.Schedule_and_Rule",supportedViews:["Calendar","List","Grid"],view:""},{name:"Space.CCTV",supportedViews:["Map","Grid"],view:""}],deviceTabSortOrder:["Gateway","Beacon","AirConditioner.Indoor","AirConditionerOutdoor","ControlPoint","Sensor.Temperature_Humidity","Light","Sensor.Motion","CCTV","Meter","Etc","SmartPlug"],numOfItemsPerPage:{list:[10,20,30,40,50],view:20}},C={Statistic:"ic-statistic",Map:"ic-location",List:"ic-view-list",Grid:"ic-view-2x2",Graph:"ic-view-graph"},k={start:st.addBuildDateQuery("../../src/main/resources/static-dev/images/icon/arrow-start.png"),left:st.addBuildDateQuery("../../src/main/resources/static-dev/images/icon/arrow-prev.png"),right:st.addBuildDateQuery("../../src/main/resources/static-dev/images/icon/arrow-next.png"),end:st.addBuildDateQuery("../../src/main/resources/static-dev/images/icon/arrow-end.png")},v={Gateway:lt.prop("FACILITY_DEVICE_TYPE_IOT_GATEWAY"),Beacon:lt.prop("FACILITY_DEVICE_TYPE_BLE_BEACON"),"AirConditioner.Indoor":lt.prop("FACILITY_DEVICE_TYPE_SAC_INDOOR"),AirConditionerOutdoor:lt.prop("FACILITY_DEVICE_TYPE_SAC_OUTDOOR"),Sensor:lt.prop("FACILITY_DEVICE_TYPE_SENSOR"),Light:lt.prop("FACILITY_DEVICE_TYPE_LIGHT"),SmartPlug:lt.prop("FACILITY_DEVICE_TYPE_SMART_PLUG"),"Sensor.Temperature_Humidity":lt.prop("FACILITY_DEVICE_TYPE_TEMP_AND_HUMIDITY_SENSOR"),"Sensor.Temperature":lt.prop("COMMON_TEMPERATURE"),"Sensor.Humidity":lt.prop("COMMON_HUMIDITY"),"Sensor.Motion":lt.prop("FACILITY_DEVICE_TYPE_MOTION_SENSOR"),ControlPoint:lt.prop("FACILITY_DEVICE_TYPE_POINT"),Printer:lt.prop("FACILITY_DEVICE_TYPE_PRINTER"),CCTV:lt.prop("FACILITY_DEVICE_TYPE_CCTV"),Meter:lt.prop("FACILITY_DEVICE_TYPE_ENERGY_METER"),Etc:lt.prop("FACILITY_DEVICE_TYPE_ETC")},w={"AirConditioner.Indoor":!(O={"AirConditioner.AHU":"AirConditioner.Indoor","AirConditioner.Chiller":"AirConditioner.Indoor","AirConditioner.DuctFresh":"AirConditioner.Indoor","AirConditioner.EHS":"AirConditioner.Indoor","AirConditioner.ERV":"AirConditioner.Indoor","AirConditioner.ERVPlus":"AirConditioner.Indoor","AirConditioner.FCU":"AirConditioner.Indoor","AirConditioner.SFCU":"AirConditioner.Indoor","AirConditioner.Indoor":"AirConditioner.Indoor",AirConditionerOutdoor:"AirConditionerOutdoor",Beacon:"Beacon",CCTV:"CCTV",ControlPoint:"ControlPoint","ControlPoint.AI":"ControlPoint","ControlPoint.AO":"ControlPoint","ControlPoint.AV":"ControlPoint","ControlPoint.DI":"ControlPoint","ControlPoint.DO":"ControlPoint","ControlPoint.DV":"ControlPoint",Gateway:"Gateway",Light:"Light",SmartPlug:"SmartPlug",Meter:"Meter","Meter.Calori":"Meter","Meter.Gas":"Meter","Meter.Water":"Meter","Meter.WattHour":"Meter",Printer:"Printer","Sensor.Humidity":"Sensor.Temperature_Humidity","Sensor.Temperature":"Sensor.Temperature_Humidity","Sensor.Temperature_Humidity":"Sensor.Temperature_Humidity","Sensor.Motion":"Sensor.Motion",Etc:"Etc"}),AirConditionerOutdoor:!1,Beacon:!1,CCTV:!1,ControlPoint:!1,Gateway:!1,Light:!1,SmartPlug:!1,Meter:!1,Printer:!1,"Sensor.Temperature_Humidity":!1,"Sensor.Humidity":!1,"Sensor.Temperature":!1,"Sensor.Motion":!1,Etc:!1},F=$("#settings-common-display"),P=$(".settings-display-content.view-type").find(".content-category.facility").find("ul.content-detail"),B=$(".settings-display-content.view-type").find(".content-category.energy").find("li.item.mode").find("ul.content-detail"),L=$(".settings-display-content.num-items-page").find(".content-list"),x=$(".settings-display-content.device-type-ordering").find("ul.content-list"),V=$("#settings-display-save-btn"),H=$(".settings-display-content.device-type-ordering").find(".content-ordering-btn").find("button.start"),Y=$(".settings-display-content.device-type-ordering").find(".content-ordering-btn").find("button.left"),W=$(".settings-display-content.device-type-ordering").find(".content-ordering-btn").find("button.right"),q=$(".settings-display-content.device-type-ordering").find(".content-ordering-btn").find("button.end"),j=function(e,t){var n,o,a,i,r,d,s,c,l=t,u=b.defaultView,p=u[0],m=e.defaultView||ct.getDefaultViewType();if(m)for(a=m.length,n=0;n<a;n++)"Facility.Device"==(i=m[n]).menu&&(p=i);for(n=0;n<p.supportedViews.length;n++){r=p.supportedViews[n];var g=u[0].supportedViewsName[n];s="",r===(d=p.view)&&(s="checked"),c="<li class='content-detail-item'><input type='radio' name='facility-device' data-value='"+r+"' class='k-radio' id='facility-device-"+r+"' "+s+"/><label class='k-radio-label' for='facility-device-"+r+"'><span class='ic "+C[r]+"'></span>"+g+"</label></li>",P.append(c)}var E=e.numOfItemsPerPage||ct.getPageSize(),S=b.numOfItemsPerPage;for(S.view=E||S.view,n=0;n<S.list.length;n++)s="",(r=S.list[n])===(d=S.view)&&(s="checked"),c="<li class='content-detail-item'><input type='radio' name='num_of_item_per_page' data-value='"+r+"' class='k-radio' id='num_of_item_per_page-"+r+"' "+s+"/><label class='k-radio-label' for='num_of_item_per_page-"+r+"'>"+r+"</label></li>",L.append(c);var T=[];for(n=0;n<l.length;n++){var _=l[n];for(o=0;o<e.deviceTabSortOrder.length;o++)O[_]==e.deviceTabSortOrder[o]&&0==w[O[e.deviceTabSortOrder[o]]]&&(T.push(O[e.deviceTabSortOrder[o]]),w[e.deviceTabSortOrder[o]]=!0)}var f=[];for(n=0;n<e.deviceTabSortOrder.length;n++)for(o=0;o<T.length;o++)e.deviceTabSortOrder[n]==T[o]&&f.push(e.deviceTabSortOrder[n]);var N=f||b.deviceTabSortOrder;for(n=0;n<N.length;n++)c="<li class='content-detail-item'><input type='checkbox' class='k-checkbox' name='device-type-order' data-value='"+(d=r=N[n])+"'id='device_Tab_Sort_Order-"+d+"'/><label class='k-checkbox-label' for='device_Tab_Sort_Order-"+d+"'>"+v[d]+"</label></li>",x.append(c)},V.kendoButton().data("kendoButton").enable(!1),H.kendoButton({enable:!1}),Y.kendoButton({enable:!1}),W.kendoButton({enable:!1}),q.kendoButton({enable:!1}),j(pt,S),B.closest(".content-category").hide(),L.closest(".settings-display-content").hide(),H.kendoButton({imageUrl:k.start}),Y.kendoButton({imageUrl:k.left}),W.kendoButton({imageUrl:k.right}),q.kendoButton({imageUrl:k.end}),function(){var n=F.find("input.k-radio:checked");F.find("input.k-radio").on("click",function(e){var t=$(e.target);!1===n.is(t)&&V.data("kendoButton").enable(!0),n=t}),F.find(".content-ordering-btn").find("button.k-button").on("click",function(){V.data("kendoButton").enable(!0)});var e=x.find("li.content-detail-item"),o=e.find("input.k-checkbox"),d=e.find("input.k-checkbox:checked").closest("li"),s=[];function c(){var e=$("#settings-common-display").find(".device-type-ordering").find("ul.content-list").find("li.content-detail-item"),t=e.find("input.k-checkbox"),n=t.closest("ul").find("input:checked"),o=n.eq(0),a=n.eq(n.length-1),i=t.index(o),r=t.index(a);0==n.length?(H.data("kendoButton").enable(!1),Y.data("kendoButton").enable(!1),W.data("kendoButton").enable(!1),q.data("kendoButton").enable(!1)):1==n.length?0==i?(H.data("kendoButton").enable(!1),Y.data("kendoButton").enable(!1),W.data("kendoButton").enable(!0),q.data("kendoButton").enable(!0)):i==e.length-1?(H.data("kendoButton").enable(!0),Y.data("kendoButton").enable(!0),W.data("kendoButton").enable(!1),q.data("kendoButton").enable(!1)):(H.data("kendoButton").enable(!0),Y.data("kendoButton").enable(!0),W.data("kendoButton").enable(!0),q.data("kendoButton").enable(!0)):1<n.length&&(n.length==e.length?(H.data("kendoButton").enable(!1),Y.data("kendoButton").enable(!1),W.data("kendoButton").enable(!1),q.data("kendoButton").enable(!1)):r==n.length-1?(H.data("kendoButton").enable(!1),Y.data("kendoButton").enable(!1),W.data("kendoButton").enable(!0),q.data("kendoButton").enable(!0)):i==e.length-n.length?(H.data("kendoButton").enable(!0),Y.data("kendoButton").enable(!0),W.data("kendoButton").enable(!1),q.data("kendoButton").enable(!1)):(H.data("kendoButton").enable(!0),Y.data("kendoButton").enable(!0),W.data("kendoButton").enable(!0),q.data("kendoButton").enable(!0)))}o.closest("ul").on("click",".k-checkbox",function(){var e=$(this),t=o.index(this);e.is(":checked")?s.push(t):s=$.grep(s,function(e){return e!=t}),s.sort(),c()}),H.on("click",function(){x=$(".settings-display-content.device-type-ordering").find("ul.content-list"),e=x.find("li.content-detail-item"),(d=e.find("input.k-checkbox:checked").closest("li")).prependTo(x),c()}),Y.on("click",function(){if(0<s.length){var e=[],t=$("#settings-common-display").find(".settings-display-content.device-type-ordering").find("ul.content-list"),n=t.find("li.content-detail-item");d=n.find("input.k-checkbox:checked").closest("li");var o,a=n.index(d.eq(0));if(0<d.length)for(var i=0;i<d.length;i++)o=d.eq(i).clone(),e.push(o),d.eq(i).remove(),0<a?$(e[i]).insertBefore(n.eq(a-1)):0==a&&d.prependTo(t)}c()}),W.on("click",function(){if(0<s.length){var e=[],t=$("#settings-common-display").find(".settings-display-content.device-type-ordering").find("ul.content-list"),n=t.find("li.content-detail-item");d=n.find("input.k-checkbox:checked").closest("li");for(var o=n.index(d.eq(0)),a=n.index(d.eq(d.length-1)),i=0;i<d.length;i++){var r=d.eq(i).clone();e.push(r),d.eq(i).remove(),0<d.length&&(1===d.length?o+d.length+1<n.length?$(e[i]).insertBefore(n.eq(o+d.length+1)):d.appendTo(t):1<d.length&&(o+d.length+2<=n.length?a+2<n.length?$(e[i]).insertBefore(n.eq(a+2)):$(e[i]).appendTo(t):d.appendTo(t)))}}c()}),q.on("click",function(){x=$(".settings-display-content.device-type-ordering").find("ul.content-list"),e=x.find("li.content-detail-item"),(d=e.find("input.k-checkbox:checked").closest("li")).appendTo(x),c()}),V.on("click",function(e){var n,t,o=$(e.target);F.find("input.k-radio:checked").each(function(){var e=$(this).attr("name"),t=$(this).data("value");"num_of_item_per_page"==e||"facility-device"==e&&(n=t)});var a=[],i=b.deviceTabSortOrder;for(F.find("input.k-checkbox").each(function(){a.push($(this).data("value"))}),t=0;t<i.length;t++){var r=i[t];-1==a.indexOf(r)&&a.push(r)}pt.deviceTabSortOrder=a,pt.hasOwnProperty("numOfItemsPerPage")&&delete pt.numOfItemsPerPage;var d=pt.defaultView,s=d.length;for(t=0;t<s;t++)"Facility.Device"==d[t].menu&&(d[t].view=n),delete d[t].supportedViews;for(t=0;t<pt.defaultView.length;t++){var c=pt.defaultView[t];"Energy.Mode"==c.menu?pt.defaultView.splice(t,1):"Energy.Consumption"==c.menu&&pt.defaultView.splice(t,1)}Tt.open(),$.ajax({url:"/foundation/settings/display",method:"PATCH",data:pt}).done(function(){ct.setPageSize(pt.numOfItemsPerPage),ct.setDefaultViewType(pt.defaultView),ct.setDeviceTypeOrdering(pt.deviceTabSortOrder),ct.apply(),rt.message(I),rt.open(),o.data("kendoButton").enable(!1)}).fail(function(e){var t=st.parseFailResponse(e);rt.message(t),rt.open()}).always(function(){Tt.close()})})}()),0<ft.find("[aria-controls=settings-common-data]").length&&(Z=lt.prop("SETTINGS_DATA_RESTORE"),J=lt.prop("SETTINGS_DATA_NAME"),X=lt.prop("SETTINGS_MESSAGE_INFO_BACK_UP_DATA"),ee=lt.prop("SETTINGS_MESSAGE_INFO_COMPLETE_DATA_RESTORATION"),te=lt.prop("SETTINGS_MESSAGE_INFO_RESTORE_NOT_COMPLETE"),ne=lt.prop("SETTINGS_MESSAGE_INFO_BACKING_UP_NOT_COMPLETE"),oe=lt.prop("SETTINGS_MESSAGE_NOTI_COMPLETE_BACK_UP"),ae=lt.prop("SETTINGS_MESSAGE_NOTI_RESTORING"),ie=lt.prop("SETTINGS_MESSAGE_NOTI_BACKING_UP"),re=lt.prop("SETTINGS_MESSAGE_CONFIRM_ALL_SETTINGS_RETURN_SELECTED_DATE"),de=lt.prop("SETTINGS_MESSAGE_BEING_RESTORE"),se=lt.prop("SETTINGS_TOTAL_DATA"),ce=ft.find(".common-data-backup-btn[data-event=backup]"),le=ft.find(".common-data-restore-btn[data-event=restore]"),ue=null,pe=$("#popup-settings-common-data-backup"),me=pe.find(".settings-common-data-backup-grid"),ge=pe.find(".settings-common-data-backup-count"),Ee=pe.find(".popup-footer").find("[data-event=select]"),Se=$("#popup-settings-common-data-restore-message"),Te=$("#popup-settings-common-data-backup-message"),_e=!1,fe=window.CommonWebSocket,Ne=null,Ie=!1,be=lt.prop("COMMON_FRONT_END_URL"),function(){Tt=new St,pe.kendoPopupSingleWindow({title:Z}),me.kendoGrid({dataSource:[],columns:[{field:"id",headerAttributes:{style:"display: none;"},template:"<input type='radio' class='k-radio backup-data-radio-btn' id='backup-data-radio-#: id #' name='backup-data' class='k-radio'/><label class='k-radio-label' for='backup-data-radio-#: id#'></label>",width:"100px"},{title:J,field:"name",template:"<div class='settings-common-data-backup-cell'>#: name #</div>",headerAttributes:{colspan:2}}],sortable:!0}),Se.kendoCommonDialog({timeout:!1}),z=Se.data("kendoCommonDialog"),Te.kendoCommonDialog({timeout:!1}),Q=Te.data("kendoCommonDialog"),fe.on("receive",function(e){Ie&&Ne(e)})}(),ce.on("click",function(){_e?(Q.message(X),Q.open()):(Ie=!0,Tt.open(),$.ajax({url:"/foundation/settings/backups",method:"POST",dataType:"text"}).done(function(){_e=!0,Tt.close(),Q.message(""+ie),Q.open(),Te.siblings(".k-dialog-buttongroup").find("button").hide(),Tt.open(Te),Ne=function(e){"CompleteBackup"==e.name&&(Tt.close(Te),Te.siblings(".k-dialog-buttongroup").find("button").show(),Q.close(),Q.message(oe),Q.open(),Ie=_e=!1)}}).fail(function(e){_e=!1,Tt.close(),Te.siblings(".k-dialog-buttongroup").find("button").show(),503==e.status?Q.message(X):Q.message(ne),Q.open()}).always(function(){}))}),le.on("click",function(){var t;pe.data("kendoPopupSingleWindow").openWindowPopup(),t=pe,ue=[],Tt.open(t),$.ajax({url:"/foundation/settings/backups"}).done(function(e){Tt.close(t),ue=e,me.data("kendoGrid").dataSource.data(ue),me.data("kendoGrid").dataSource.sort({field:"name",dir:"desc"}),ge.text(se+": "+ue.length)}).fail(function(e){Tt.close(t),Q.message(e.responseText),Q.open()}).always(function(){Tt.close(t),Ee.data("kendoButton").enable(!1)})}),Ee.on("click",function(){var n=$(this).closest(".popup-window");mt.message(re),mt.setConfirmActions({yes:function(){var t,e;Ie=!0,t=n,e={id:ue[K].id},Tt.open(t),$.ajax({url:"/foundation/settings/restore",method:"PUT",data:e}).done(function(){Tt.close(t),z.message(ae),z.open(),Se.siblings(".k-dialog-buttongroup").find("button").hide(),Tt.open(Se),Ne=function(e){"CompleteRestore"==e.name&&(Tt.close(Se),Se.siblings(".k-dialog-buttongroup").find("button").show(),z.close(),z.message(ee),z.open(),Ie=!1,setTimeout(function(){var e=window.location.protocol+"//"+window.location.host+be+"/signin";window.location.href=e},5e3))}}).fail(function(e){Tt.close(t),503==e.status?z.message(de):z.message(te),z.open()}).always(function(){})},no:function(){}}),mt.open()}),me.data("kendoGrid").dataSource.bind("change",function(){var e,t,n,o;t="name",n=(e=me).data("kendoGrid").dataSource,o=n.sort(),ue=((void 0===o||void 0===o&&void 0!==t)&&(o=[{compare:void 0,dir:"asc",field:t}]),n.view()),K="",e.find("input[type=radio]").prop("checked",!1),Ee.data("kendoButton").enable(!1),$(".backup-data-radio-btn").on("click",function(e){var t=$(e.target),n=me.find("tbody").find("tr").index(t.closest("tr"));K=n,Ee.data("kendoButton").enable(!0)})})),0<ft.find("[aria-controls=settings-common-menuconfig]").length&&(he=lt.prop("COMMON_MESSAGE_NOTI_CHANGES_SAVED"),Ge=lt.prop("SETTINGS_MESSAGE_CONFIRM_WITHOUT_SAVE"),Me=lt.prop("COMMON_MENU_DASHBOARD"),ye=lt.prop("COMMON_MENU_ENERGY"),De=lt.prop("COMMON_MENU_FACILITY"),Ae=lt.prop("COMMON_MENU_SPACE"),Ue=lt.prop("COMMON_MENU_MEMBERSHIP"),Re=lt.prop("COMMON_MENU_SETTINGS"),we={Dashboard:lt.prop("SETTINGS_MENUCONFIGURE_DASHBOARD"),Energy:lt.prop("SETTINGS_MENUCONFIGURE_ENERGY"),"Energy-Summary":lt.prop("SETTINGS_MENUCONFIGURE_SUMMARY"),"Energy-ConsumptionAndTarget":lt.prop("SETTINGS_MENUCONFIGURE_CONSUMPTION"),"Energy-SamsungSAC":lt.prop("SETTINGS_MENUCONFIGURE_SAC_MONITORING"),Target:lt.prop("SETTINGS_MENUCONFIGURE_TARGET"),SacEnergyMonitoring:lt.prop("SETTINGS_MENUCONFIGURE_SAC_ENERGY_MONITORING"),PowerDistribution:lt.prop("SETTINGS_MENUCONFIGURE_POWER_DISTRIBUTION"),Facility:"Facility","Operation-Group":lt.prop("SETTINGS_MENUCONFIGURE_GROUP"),"Operation-Schedule":lt.prop("SETTINGS_MENUCONFIGURE_SCHEDULE"),"Operation-Rule":lt.prop("SETTINGS_MENUCONFIGURE_RULE"),HMI:lt.prop("SETTINGS_MENUCONFIGURE_HMI"),"History-TrendLog":lt.prop("SETTINGS_MENUCONFIGURE_TREND_LOG"),Device:lt.prop("SETTINGS_MENUCONFIGURE_DEVICE"),"Device-All":lt.prop("SETTINGS_MENUCONFIGURE_DEVICE_ALL"),"Device-AirConditioner.Indoor":lt.prop("SETTINGS_MENUCONFIGURE_SAC_INDOOR"),"Device-AirConditionerOutdoor":lt.prop("SETTINGS_MENUCONFIGURE_SAC_OUTDOOR"),"Device-Sensor.Temperature_Humidity":lt.prop("SETTINGS_MENUCONFIGURE_TEMP_HUM"),"Device-Light":lt.prop("SETTINGS_MENUCONFIGURE_LIGHT"),"Device-SmartPlug":lt.prop("SETTINGS_MENUCONFIGURE_SMART_PLUG"),"Device-Sensor.Motion":lt.prop("SETTINGS_MENUCONFIGURE_MOTION"),"Device-ControlPoint":lt.prop("SETTINGS_MENUCONFIGURE_POINT"),"Device-Meter":lt.prop("SETTINGS_MENUCONFIGURE_METER"),"Device-Etc":lt.prop("SETTINGS_MENUCONFIGURE_ETC"),Space:"Space",Building:lt.prop("SETTINGS_MENUCONFIGURE_BUILDING"),Membershp:"Membership",Tenant:lt.prop("SETTINGS_MENUCONFIGURE_TENANT"),Manager:lt.prop("SETTINGS_MENUCONFIGURE_MANAGER"),Authority:lt.prop("SETTINGS_MENUCONFIGURE_AUTHORITY"),Notice:"Notice","Operation-Alarm":lt.prop("SETTINGS_MENUCONFIGURE_ALARM"),"History-SystemLog":lt.prop("SETTINGS_MENUCONFIGURE_SYSTEM_LOG"),Settings:"Settings",Common:lt.prop("SETTINGS_MENUCONFIGURE_COMMON"),Display:lt.prop("SETTINGS_MENUCONFIGURE_DISPLAY"),Data:lt.prop("SETTINGS_MENUCONFIGURE_DATA"),SAC:lt.prop("SETTINGS_MENUCONFIGURE_SAC"),BACnet:lt.prop("SETTINGS_MENUCONFIGURE_BAC_NET"),Diagnosis:lt.prop("SETTINGS_MENUCONFIGURE_DIAGNOSIS"),"Device-Gateway":lt.prop("SETTINGS_MENUCONFIGURE_GATEWAY"),"Device-Beacon":lt.prop("SETTINGS_MENUCONFIGURE_BEACON"),"Device-CCTV":lt.prop("SETTINGS_MENUCONFIGURE_CCTV"),Asset:lt.prop("SETTINGS_MENUCONFIGURE_ASSET"),OpenAPI:lt.prop("SETTINGS_MENUCONFIGURE_OPEN_API"),MenuConfigure:lt.prop("SETTINGS_MENUCONFIGURE_MENU_CONFIGURE"),Information:lt.prop("SETTINGS_MENUCONFIGURE_INFORMATION"),VirtaulPoint:lt.prop("SETTINGS_MENUCONFIGURE_VIRTUAL_POINT"),Algorithm:lt.prop("SETTINGS_MENUCONFIGURE_ALGORITHM"),HistoryOfOperation:lt.prop("SETTINGS_MENUCONFIGURE_HISTORY_OF_OPERATION"),DemandMonitoring:lt.prop("SETTINGS_MENUCONFIGURE_DEMAND_MONITORING"),EnergyLossDetection:lt.prop("SETTINGS_MENUCONFIGURE_ENERGY_LOSS_DETECTION"),Operation:lt.prop("SETTINGS_MENUCONFIGURE_OPERATION"),History:lt.prop("SETTINGS_MENUCONFIGURE_HISTORY"),ControlAreaSettings:lt.prop("SETTINGS_MENUCONFIGURE_CONTROLAREA_SETTINGS"),AccountSettings:lt.prop("SETTINGS_MENUCONFIGURE_ACCOUNT_SETTINGS"),DeviceSettings:lt.prop("SETTINGS_MENUCONFIGURE_DEVICE_SETTINGS"),EnergySettings:lt.prop("SETTINGS_MENUCONFIGURE_ENERGY_SETTINGS"),SystemSettings:lt.prop("SETTINGS_MENUCONFIGURE_SYSTEM_SETTINGS"),"History-Report":lt.prop("SETTINGS_MENUCONFIGURE_REPORT")},Fe={Dashboard:Me,Energy:ye,Facility:De,Space:Ae,Membership:Ue,Notice:lt.prop("COMMON_MENU_ALARM_AND_LOG"),Settings:Re,Service:lt.prop("SETTINGS_MENUCONFIGURE_SERVICE")},Pe=["ControlAreaSettings","AccountSettings","DeviceSettings","EnergySettings","SystemSettings"],Be=["ControlAreaSettings","AccountSettings","DeviceSettings","EnergySettings","SystemSettings"],Le=[{resource:"ControlAreaSettings",enabled:!0},{resource:"AccountSettings",enabled:!0},{resource:"DeviceSettings",enabled:!0},{resource:"EnergySettings",enabled:!0},{resource:"SystemSettings",enabled:!0}],$e=$("#setting-common-tab").find(".common-tab-scroll-wrapper > ul"),xe=$("#settings").find(".sac-menuconfig-container"),Ve=xe.find(".sac-menuconfig-contents"),He=xe.find(".k-button[data-event=menuconfigsave]").kendoButton({enable:!1}),Ye=$("#popup-settings-common-menuconfig-message"),We=$("#popup-settings-common-menuconfig-confirm"),qe=function(){Oe=[],Tt.open(),$.ajax({url:"/foundation/settings/menus"}).done(function(e){void 0===e[0].resource?Ke(Nt):Ke(e),je()}).fail(function(e){Ce.message(e.responseText),Ce.open()}).always(function(){Tt.close()})},je=function(){var e=$(".sac-menuconfig-container .sac-menuconfig-category[data-category=Device]"),t=$(".sac-menuconfig-container .sac-menuconfig-category[data-category=Device] .detail"),n=$(".sac-menuconfig-container .sac-menuconfig-category[data-category=Device] .detail").css("width"),o=$(".sac-menuconfig-container .sac-menuconfig-category[data-category=Device] .detail > div").length,a=$(".sac-menuconfig-container .sac-menuconfig-category[data-category=Device] .detail > div").css("width"),i=n.split("px")[0]/a.split("px")[0],r=50*Math.ceil(Number(o/i))+14;e.css("height",r),t.css("height",r)},Ke=function(e){var t,n,o,a,i,r,d=!0,s=!1,c=[];for(Oe=void 0===e?Nt:$.extend(!0,[],e),n=0;n<Oe.length;n++){s=!(d=!0);var l=Oe[n];for(o=0;o<Pe.length;o++)-1!==l.resource.indexOf(Pe[o])&&(d=!1),-1!==l.resource.indexOf(Be[o])&&(s=!0);if(!s&&!0===d&&-1===l.resource.indexOf("-")){l.displayName=void 0===we[l.resource]?"test":we[l.resource],l.subMenus=[];for(var u=0;u<Oe.length;u++)-1!==(i=Oe[u]).resource.indexOf(l.resource+"-")&&((a=l.subMenus).push({}),a[r=a.length-1].resource=i.resource,a[r].enabled=i.enabled,a[r].displayName=void 0===we[i.resource]?"test":we[i.resource]);l.subMenus.length<=0&&(l.subMenus=void 0),c.push(l)}}ve=dt.observable({menuConfigData:c,checkEnabled:function(e){var t,n,o,a,i,r=this.menuConfigData,d=e.data.enabled,s=e.data.resource;if(-1===s.indexOf("-")){for(n=0;n<r.length;n++)if(void 0!==(t=r[n].subMenus)&&-1!==r[n].resource.indexOf(s))for(o=0;o<t.length;o++)t[o].set("enabled",!d)}else for(a=s.split("-")[0],n=0;n<r.length;n++)if(void 0!==(t=r[n].subMenus)&&-1!==r[n].resource.indexOf(a)){for(r[n].set("enabled",!d),i=!d,o=0;o<t.length;o++)-1===t[o].resource.indexOf(s)&&(i=i||t[o].get("enabled"));r[n].set("enabled",i)}}}),dt.bind(Ve,ve);var p=Ve.find("[data-tabs=true]");for(t=0;t<p.length;t++){var m=p.eq(t),g=m.closest(".detail"),E=g.find("[data-tabs=false]"),S=g.find(".sub-detail");g.append(m),0<E.length?S.addClass("upper"):1<g.find(".sub-detail").length&&S.addClass("lower")}var T=Ve.find("[display]");for(t=0;t<T.length;t++){var _,f,N=T.eq(t);f=N.text(),N.hasClass("title")&&(_=Fe[f],N.text(_))}},ze=function(){Ve.on("click","input.k-checkbox",function(){$(this).closest(".sac-menuconfig-container").find(".k-button[data-event=menuconfigsave]").data("kendoButton").enable(!0)}),He.on("click",function(){var e=$(this),t=function(){var e,t,n,o,a=ve.menuConfigData,i=[];for(e=0;e<a.length;e++)if(n=!1,-1===a[e].resource.indexOf("admin-setting")&&(i.push({resource:a[e].resource,enabled:a[e].enabled}),o=i.length-1),void 0!==a[e].subMenus){for(t=0;t<a[e].subMenus.length;t++)i.push({resource:a[e].subMenus[t].resource,enabled:a[e].subMenus[t].enabled}),n=n||a[e].subMenus[t].enabled;i[o].enabled=!1!==n}return i=i.concat(Le)}();Tt.open(),$.ajax({url:"/foundation/settings/menus",method:"PUT",data:t}).done(function(){Ce.message(he),Ce.open(),e.data("kendoButton").enable(!1),localStorage.setItem("reloadFromMenuConfig",!0),setTimeout(function(){location.reload()},5e3)}).fail(function(e){Ce.message(e.responseText),Ce.open()}).always(function(){Tt.close()}),e.data("kendoButton").enable(!1)}),$e.on("click","li",function(){var e=$(this),t=$(".sac-menuconfig-container").find(".k-button[data-event=menuconfigsave]");t.data("kendoButton").options.enable&&(ke.message(Ge),ke.setConfirmActions({yes:function(){t.data("kendoButton").enable(!1)},no:function(){e.closest("ul").find("li").removeClass("k-state-active k-tab-on-top"),$(".sac-menuconfig-wrapper").siblings("div").not("div.common-tab-scroll-wrapper").removeClass("k-state-active").hide(),e.closest("ul").find("li[aria-controls=settings-common-menuconfig]").addClass("k-state-active"),$(".sac-menuconfig-wrapper").addClass("k-state-active k-tab-on-top").show()}}),ke.open())}),$e.find("li[aria-controls=settings-common-menuconfig]").on("click",function(){var e=$(".sac-menuconfig-container").find(".k-button[data-event=menuconfigsave]");qe(),e.data("kendoButton").enable(!1)})},Ce=Ye.kendoCommonDialog().data("kendoCommonDialog"),ke=We.kendoCommonDialog({type:"confirm"}).data("kendoCommonDialog"),qe(),ze()),0<ft.find("[aria-controls=settings-common-information]").length&&(Qe=gt,Ze=lt.prop("COMMON_BTN_DETAIL"),Je=$("#settings-common-information"),Xe=Je.find(".version"),et=Je.find("button[data-event=informationdetail]"),tt=$("#popup-settings-common-information-detail"),nt=Je.find("button[data-event=authenticationcertificatedownload]"),ot=$("#popup-settings-common-message"),at=function(){tt.kendoPopupSingleWindow({title:Ze,width:"570px",height:"580px"}),ot.kendoCommonDialog()},it=function(){et.on("click",function(){tt.kendoPopupSingleWindow("openWindowPopup")}),nt.on("click",function(){var a=$(this);Tt.open(),$.ajax({url:"/foundation/settings/certificate",dataType:"binary"}).done(function(e){if(e){var t=URL.createObjectURL(e),n=a.closest(".select-cell"),o=$("<a/>").hide().attr({href:t,download:"BIOT_CERT_INSTALLER.bat"}).appendTo(n);o.get(0).click(),o.remove()}}).fail(function(e){var t=st.parseFailResponse(e);rt.message(t),rt.open()}).always(function(){Tt.close()})})},Xe.text(Qe),at(),it())})});