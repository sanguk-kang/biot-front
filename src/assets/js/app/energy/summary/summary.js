define("energy/summary/config/summary-common",[],function(){"use strict";var e=window.I18N;return{MESSAGE:{ALLFLOORDATA:["Optimal Start","Comfort","PRC"]},TEXT:{COMMON_MENU_SPACE_BUILDING:e.prop("COMMON_MENU_SPACE_BUILDING"),SPACE_ZONE:e.prop("SPACE_ZONE"),ENERGY_PRC:e.prop("ENERGY_PRC"),ENERGY_COMFORT:e.prop("ENERGY_COMFORT"),ENERGY_TOTAL:e.prop("ENERGY_TOTAL"),ENERGY_OPTIMAL_START:e.prop("ENERGY_OPTIMAL_START"),ENERGY_LOCATION:e.prop("ENERGY_LOCATION"),ENERGY_ALGORITHM:e.prop("ENERGY_ALGORITHM"),ENERGY_TEMP_AND_HUM:e.prop("ENERGY_TEMP_AND_HUM"),SPACE_TEXT_COMFORT:e.prop("SPACE_TEXT_COMFORT"),COMMON_BTN_DETAIL:e.prop("COMMON_BTN_DETAIL"),COMMON_NAME:e.prop("COMMON_NAME"),ENERGY_TYPE:e.prop("ENERGY_TYPE"),COMMON_STATUS:e.prop("COMMON_STATUS"),ENERGY_MODE:e.prop("ENERGY_MODE"),ENERGY_INFORMATION:e.prop("ENERGY_INFORMATION"),ENERGY_ALL_ALGORITHM:e.prop("ENERGY_ALL_ALGORITHM"),ENERGY_NONE:e.prop("ENERGY_NONE"),SPACE_COMFORT_INDEX_UNCOMFORTABLE:e.prop("SPACE_COMFORT_INDEX_UNCOMFORTABLE"),SPACE_COMFORT_INDEX_COMFORTABLE:e.prop("SPACE_COMFORT_INDEX_COMFORTABLE"),ENERGY_NORMAL:e.prop("ENERGY_NORMAL")}}}),define("energy/summary/config/summary-widget",["energy/core","energy/summary/config/summary-common"],function(e,t){"use strict";var o,a,n=window.kendo,r=window.Util,l=window.GlobalSettings,m=window.I18N,d=t.TEXT;o=$("<div/>").kendoCommonDialog({type:"confirm"}).data("kendoCommonDialog"),a=$("<div/>").kendoCommonDialog().data("kendoCommonDialog");var i=new window.CommonLoadingPanel,s=n.data.Model.define({id:"id",fields:{id:{name:"id",type:"string",editType:null},location:{name:"Location",type:"string",editType:null},Algorithm:{name:"Algorithm",type:"string",editType:null},statistic:{name:"Statistic",type:"string",editType:null}}}),u={location:function(e){var t="-";return e.location&&(t=e.location),jQuery('<div class="parentDiv"><span class="location">'+t+"</span></div>").html()},modes:function(e){var t,o=e.algorithm,a="-";if(o){a="";for(var n=o.length,i=0;i<n;i++)"OptimalStart"==o[i]&&(t=d.ENERGY_OPTIMAL_START),"Comfort"==o[i]&&(t=d.ENERGY_COMFORT),"PRC"==o[i]&&(t=d.ENERGY_PRC),a+=t,i!=n-1&&(a+=", ")}return a},algorithm:function(e){var t,o,a="",n="";if(e.algorithm){t=0<e.algorithm.indexOf(",")?e.algorithm.split(", "):[e.algorithm],a="";for(var i=0;i<t.length;i++)0<i&&(n=", "),"OptimalStart"==t[i]?o=d.ENERGY_OPTIMAL_START:"Comfort"==t[i]?o=d.ENERGY_COMFORT:"PRC"==t[i]&&(o=d.ENERGY_PRC),a+=n+o;return a}return"-"},deviceType:function(e){var t=e.dms_device_type;return t=t?r.getDetailDisplayTypeDeviceI18N(t):void 0!==e.occupancy?r.getDetailDisplayTypeDeviceI18N("Sensor.Motion"):void 0!==e.temperature||void 0!==e.humidity?r.getDetailDisplayTypeDeviceI18N("Sensor.Temperature_Humidity"):"-"},temp:function(e){var t=l.getTemperature(),o=r.CHAR[t.unit];return(e.temperature?e.temperature:"--.-")+o+" / "+(e.humidity?e.humidity:"--")+"%"},information:function(e){var t,o,a=l.getTemperature(),n=r.CHAR[a.unit],i="-";return void 0!==e.currentTemperature||void 0!==e.setTemperature?i=(e.currentTemperature?e.currentTemperature:"--.-")+n+" / "+(e.setTemperature?e.setTemperature:"--.-")+n:void 0!==e.occupancy?i=null===e.occupancy?"-":e.occupancy?m.prop("FACILITY_DEVICE_MOTION_SENSOR_PRESENCE_PRESENCE"):m.prop("FACILITY_DEVICE_MOTION_SENSOR_PRESENCE_ABSENCE"):void 0===e.temperature&&void 0===e.humidity||(t=void 0===e.temperature?"--.-":e.temperature,o=void 0===e.humidity?"--.-":e.humidity,i=(t+=n)+" / "+(o+="%")),i},comfort:function(e){var t,o,a=$("<span/>"),n=e.comfort_index;return n?(o="Uncomfortable"==n?(t=d.SPACE_COMFORT_INDEX_UNCOMFORTABLE,"uncomfortable"):"Comfortable"==n?(t=d.SPACE_COMFORT_INDEX_COMFORTABLE,"comfortable"):"Normal"==n?(t=d.ENERGY_NORMAL,"normal"):(t="None"==n?d.ENERGY_NONE:"-","none"),$("<i/>").addClass("comfort-icon "+o).appendTo(a),$("<span/>").text(t).appendTo(a).addClass(o)):a.text("-"),a.html()},zoneDetail:function(){return"<button>\ud31d\uc5c5 \uc5f4\uae30</button>"},total:function(){},operationMode:function(e){var t;return e.operationMode?("None"==(t=r.getModeToI18N(e.operationMode))&&(t=d.ENERGY_NONE),t):"-"},status:function(e){var t=e.status,o=e.power;return t?'<span class="circle-icon '+("Normal"==t?o?"Normal-On":"Normal-Off":"Critical"==t?"Alarm-Critical":"Warning"==t?"Alarm-Warning":"Normal-On")+'"></span>':"-"},optimalStartCount:function(e){return 0==e.optimal_start_count||e.optimal_start_count?e.optimal_start_count:"-"},comfortCount:function(e){return 0==e.comfort_count||e.comfort_count?e.comfort_count:"-"},prcCount:function(e){return 0==e.prc_count||e.prc_count?e.prc_count:"-"}};return{totalSummaryFields:{foundation_space_buildings_name:{editable:!1},zone_count:{editable:!1},optimal_start_count:{editable:!1},comfort_count:{editable:!1},presence_count:{editable:!1},prc_count:{editable:!1}},totalSummaryColumns:function(e){return[{field:"foundation_space_building_name",title:d.COMMON_MENU_SPACE_BUILDING,footerTemplate:d.ENERGY_TOTAL,footerAttributes:{class:"table-footer-cell two"},attributes:{"data-name":"building"},width:120,format:"",sortable:!1},{field:"optimal_start_count",title:d.ENERGY_OPTIMAL_START,footerTemplate:String(e.optimalStartCount),footerAttributes:{class:"table-footer-cell two"},attributes:{"data-name":"optimal"},sortable:!1,width:180,format:"",template:u.optimalStartCount},{field:"comfort_count",title:d.ENERGY_COMFORT,footerTemplate:String(e.comfortCount),footerAttributes:{class:"table-footer-cell two"},attributes:{"data-name":"comfort"},sortable:!1,width:120,format:"",editable:!1,template:u.comfortCount},{field:"prc_count",title:d.ENERGY_PRC,footerTemplate:String(e.prcCount),footerAttributes:{class:"table-footer-cell two"},attributes:{"data-name":"prc"},sortable:!1,width:120,format:"",editable:!1,template:u.prcCount}]},allSummaryFloorFields:{zone_id:{editable:!1},location:{editable:!1},modes:{editable:!1},temperature:{editable:!1},humidity:{editable:!1},comfort_index:{editable:!1}},allSummaryFloorColumns:[{field:"location",title:d.ENERGY_LOCATION,attributes:{"data-name":"floor"},width:140,format:"",sortable:!0,template:u.location},{field:"algorithm",title:d.ENERGY_ALGORITHM,attributes:{"data-name":"algorithm"},sortable:!0,width:180,format:"",template:u.modes},{field:"humidity",title:d.ENERGY_TEMP_AND_HUM,attributes:{"data-name":"maxOccupancy"},sortable:!1,width:120,format:"",template:u.temp},{field:"comfort_index",title:d.SPACE_TEXT_COMFORT,attributes:{"data-name":"maxOccupancy"},sortable:!0,width:120,format:"",template:u.comfort},{field:"zone_id",title:d.COMMON_BTN_DETAIL,attributes:{"data-name":"#: zone_id #"},sortable:!1,width:120,format:"",template:'<span class="ic ic-info" data-event="devicedetail"></span>'}],popupGridFields:{dms_device_name:{editable:!1},dms_device_type:{editable:!1},status:{editable:!1},operationMode:{editable:!1},Information:{editable:!1},algorithm:{editable:!1}},popupGridColumns:[{field:"dms_device_name",title:d.COMMON_NAME,attributes:{"data-name":"device_name"},width:100,format:"",sortable:!1},{field:"dms_device_type",title:d.ENERGY_TYPE,attributes:{"data-name":"dms_device_type"},sortable:!1,width:90,format:"",template:u.deviceType},{field:"status",title:d.COMMON_STATUS,attributes:{"data-name":"status"},sortable:!1,width:70,format:"",template:u.status},{field:"operationMode",title:d.ENERGY_MODE,attributes:{"data-name":"operation-mode"},sortable:!1,width:70,format:"",template:u.operationMode},{field:"Information",title:d.ENERGY_INFORMATION,attributes:{"data-name":"temperature"},sortable:!1,width:100,format:"",template:u.information},{field:"algorithm",title:d.ENERGY_ALGORITHM,attributes:{"data-name":"modes"},sortable:!1,width:100,format:"",template:u.algorithm}],messagDialog:a,confirmDialog:o,Loading:i,Model:s}}),define("energy/summary/model/summary-model",[],function(){"use strict";return{Zone:window.kendo.data.Model.define({id:"id",fields:{id:{name:"id",type:"string",editType:null},name:{name:"name",type:"string",editType:"input"},foundation_space_floors_name:{name:"Location",type:"string",editType:null},foundation_space_floors_type:{name:"",type:"string",editType:null},densityLevel:{name:"Density",type:"string",editType:null},comfortLevel:{name:"Comfort Index",type:"string",editType:null},description:{name:"Description",type:"string",editType:"input"},"created.date":{name:"Date",type:"string",editType:null},"created.ums_users_name":{name:"Manager",type:"string",editType:null},"updated.date":{name:"Date",type:"string",editType:null},"updated.ums_users_name":{name:"Manager",type:"string",editType:null}}})}}),define("energy/summary/total-summary",["energy/core","energy/summary/config/summary-common","energy/summary/config/summary-widget"],function(e,t,l){"use strict";var m,d,o=window.Util,a=l.messagDialog,s=l.totalSummaryFields,n=function(e){for(var t=e.length,o=0,a=0,n=0,i=0,r=0;r<t;r++)e[r].zone_count&&(o+=Number(e[r].zone_count)),e[r].optimal_start_count&&(a+=Number(e[r].optimal_start_count)),e[r].comfort_count&&(n+=Number(e[r].comfort_count)),e[r].prc_count&&(i+=Number(e[r].prc_count));m=l.totalSummaryColumns({zoneCount:o,optimalStartCount:a||"-",comfortCount:n||"-",prcCount:n?i:"-"}),d.kendoGrid({dataSource:{data:e,schema:{model:{fields:s}}},height:"calc(100% + 36px)",scrollable:!0,sortable:!0,filterable:!1,columns:m,editable:"inline",remove:function(e){},save:function(e){}}).data("kendoGrid")};return{init:function(){d=$("#summaryTotalGrid"),$.ajax({url:"/energy/algorithm-summary"}).done(function(e){e||[],n(e)}).fail(function(e){var t=o.parseFailResponse(e);a.message(t),a.open()})}}}),define("energy/summary/all-floor",["energy/core","energy/summary/config/summary-common","energy/summary/config/summary-widget"],function(e,t,o){"use strict";function a(e,t){var o="?";return(e=e||u.getCurrentFloor()).building.id!=u.FLOOR_NAV_BUILDING_TOTAL_ID&&(o+="foundation_space_buildings_id="+e.building.id+"&"),e.floor.id!=u.FLOOR_NAV_FLOOR_ALL_ID&&(o+="foundation_space_floors_id="+e.floor.id),("?"!=o&&-1!=o.indexOf("foundation_space_floors_id")||!t)&&o}var n,i,r,l,m,d,s,u=window.MAIN_WINDOW,c=window.Util,p=window.I18N,_=t.TEXT,f=o.messagDialog,E=o.Loading,y=o.allSummaryFloorFields,g=o.allSummaryFloorColumns,T=o.popupGridFields,O=o.popupGridColumns,N=[{text:_.ENERGY_OPTIMAL_START,value:"OptimalStart"},{text:_.ENERGY_COMFORT,value:"Comfort"},{text:_.ENERGY_PRC,value:"PRC"}],R=function(e){var t,o,a;$.isArray(e)&&e[0]&&(e=e[0]),t=e.optimal_start_count?e.optimal_start_count:"-",o=e.comfort_count?e.comfort_count:"-",a=e.prc_count?e.prc_count:"-",i.find(".statistic-view").remove();var n='<div class="statistic-view"><ul><li><div class="cell"><span>'+_.ENERGY_OPTIMAL_START+"</span><span>"+t+'</span></div></li><li><div class="cell"><span>'+_.ENERGY_COMFORT+"</span><span>"+o+'</span></div></li><li><div class="cell"><span>'+_.ENERGY_PRC+"</span><span>"+a+"</span></div></li></ul></div>";i.prepend(n)},C=function(){$('<input class="areaSelect size-s dropDown"/>').appendTo(r),s=r.find(".areaSelect"),(d=s.kendoDropDownCheckBox({invisible:!1,disabled:!1,dataTextField:"text",dataValueField:"value",selectAllText:_.ENERGY_ALL_ALGORITHM,animation:!1,autoBind:!0,showSelectAll:!0,emptyText:p.prop("FACILITY_DEVICE_FILTER_SELECT_EMPTY"),dataSource:N}).data("kendoDropDownCheckBox"))._old="OptimalStart,Comfort,PRC",s.on("change",function(e){var t=d._old,o=a();o=o.replace("?","&"),$.ajax({url:"/energy/algorithm-summary/zone?algorithm="+t+o}).done(function(e){e||(l=[]),v(l=e)}).fail(function(e){var t=c.parseFailResponse(e);f.message(t),f.open()})}),d.bind("selectionChanged",function(e){}),d.selectAll()},v=function(e){n=i.kendoGrid({dataSource:{data:e,schema:{model:{fields:y}}},height:"calc(100% - 72px)",scrollable:!0,sortable:!0,filterable:!1,columns:g,remove:function(e){},save:function(e){}}).data("kendoGrid")},A=function(e){var t=e.closest("tr").attr("data-uid"),a=n.dataSource.getByUid(t);E.open(),$.ajax({url:"/energy/algorithm-summary/zone/"+a.zone_id}).done(function(e){var t,o;E.close(),e||(m=[]),m=e,a.location?m.location=a.location:m.location="-",m.modes=a.modes,b.kendoPopupSingleWindow("bindSummaryData",[m],0),b.kendoPopupSingleWindow("openWindowPopup"),m.tempHum&&(m.sacDevices=m.sacDevices.concat(m.tempHum)),m.occupancy&&(m.sacDevices=m.sacDevices.concat(m.occupancy)),t=m.sacDevices,o=t||[],$("#popupDetailTable").kendoGrid({dataSource:{data:o,schema:{model:{fields:T}}},height:"100%",scrollable:!0,sortable:!0,filterable:!1,columns:O,remove:function(e){},save:function(e){}}).data("kendoGrid"),$("#summaryPopup_wnd_title").html(_.COMMON_BTN_DETAIL)}).fail(function(e){var t=c.parseFailResponse(e);f.message(t),f.open()}).always(function(){E.close()})},b=$("#summaryPopup");if(!b.data("kendoPopupSingleWindow")){var M=$("#summary-building-message-dialog"),h=$("#summary-building-confirm-dialog");M.kendoCommonDialog(),h.kendoCommonDialog({type:"confirm",title:"Notification"}),b=$("#summaryPopup").kendoPopupSingleWindow({model:o.Model,width:"1030px",height:"790px"})}return{init:function(e){l=e.building,i=$("#summaryAllGrid"),(r=$("#summary-control")).empty(),C(N);var t=$("#summary-control input.dropDown").data("kendoDropDownCheckBox").value(),o=a(e);E.open(),$.ajax({url:"/energy/algorithm-summary"+o}).done(function(e){R(e)}).fail(function(e){R(l);var t=c.parseFailResponse(e);f.message(t),f.open()}).always(function(){o=o.replace("?","&"),$.ajax({url:"/energy/algorithm-summary/zone?algorithm="+t+o}).done(function(e){e||(l=[]),v(l=e)}).fail(function(e){var t=c.parseFailResponse(e);f.message(t),f.open()}).always(function(){E.close()})}),i.on("click",'tr [data-event="devicedetail"]',function(){var e=$(this);E.open(),A(e)})}}}),define("energy/summary/oneFloor",["energy/core","energy/summary/config/summary-common","energy/summary/config/summary-widget"],function(e,t,o){"use strict";function n(e){var t="?";return(e=e||a.getCurrentFloor()).building.id!=a.FLOOR_NAV_BUILDING_TOTAL_ID&&(t+="foundation_space_buildings_id="+e.building.id+"&"),e.floor.id!=a.FLOOR_NAV_FLOOR_ALL_ID&&(t+="foundation_space_floors_id="+e.floor.id),"?"!=t&&-1!=t.indexOf("foundation_space_floors_id")&&t}var i,r,l,m,d,s,u,a=window.MAIN_WINDOW,c=window.Util,p=window.I18N,_=t.TEXT,f=o.messagDialog,E=o.Loading,y=o.allSummaryFloorFields,g=o.allSummaryFloorColumns,T=o.popupGridFields,O=o.popupGridColumns,N=function(e){var t,o,a;$.isArray(e)&&e[0]&&(e=e[0]),t=e.optimal_start_count?e.optimal_start_count:"-",o=e.comfort_count?e.comfort_count:"-",a=e.prc_count?e.prc_count:"-",r.find(".statistic-view").remove();var n='<div class="statistic-view"><ul><li><div class="cell"><span>'+_.ENERGY_OPTIMAL_START+"</span><span>"+t+'</span></div></li><li><div class="cell"><span>'+_.ENERGY_COMFORT+"</span><span>"+o+'</span></div></li><li><div class="cell"><span>'+_.ENERGY_PRC+"</span><span>"+a+"</span></div></li></ul></div>";r.prepend(n)},R=function(e){var a=(u=$('<input class="areaSelect size-s dropDown"/>').appendTo(l)).kendoDropDownCheckBox({invisible:!1,disabled:!1,dataTextField:"text",dataValueField:"value",selectAllText:_.ENERGY_ALL_ALGORITHM,animation:!1,autoBind:!0,showSelectAll:!0,emptyText:p.prop("FACILITY_DEVICE_FILTER_SELECT_EMPTY"),dataSource:e}).data("kendoDropDownCheckBox");a._old="OptimalStart,Comfort,PRC",u.on("change",function(e){var t=a._old,o=n();o=o.replace("?","&"),$.ajax({url:"/energy/algorithm-summary/zone?algorithm="+t+o}).done(function(e){e||(m=[]),C(m=e)}).fail(function(e){var t=c.parseFailResponse(e);f.message(t),f.open()})}),a.selectAll()},C=function(e){i=r.kendoGrid({dataSource:{data:e,schema:{model:{fields:y}}},height:"calc(100% - 72px)",scrollable:!0,sortable:!0,filterable:!1,columns:g,remove:function(e){},save:function(e){}}).data("kendoGrid")},v=function(e){var t=e.closest("tr").attr("data-uid"),a=i.dataSource.getByUid(t);return E.open(),$.ajax({url:"/energy/algorithm-summary/zone/"+a.zone_id}).done(function(e){var t,o;E.close(),e||(d=[]),d=e,a.location?d.location=a.location:d.location="-",d.modes=a.modes,A.kendoPopupSingleWindow("openWindowPopup"),A.kendoPopupSingleWindow("bindSummaryData",[d],0),d.tempHum&&(d.sacDevices=d.sacDevices.concat(d.tempHum)),d.occupancy&&(d.sacDevices=d.sacDevices.concat(d.occupancy)),t=d.sacDevices,o=t||[],s.kendoGrid({dataSource:{data:o,schema:{model:{fields:T}}},height:"100%",scrollable:!0,sortable:!0,filterable:!1,columns:O,remove:function(e){},save:function(e){}}).data("kendoGrid"),$("#summaryPopup_wnd_title").html(_.COMMON_BTN_DETAIL)}).fail(function(e){var t=c.parseFailResponse(e);f.message(t),f.open()}).always(function(){E.close()}),[d]},A=$("#summaryPopup");if(!A.data("kendoPopupSingleWindow")){var b=$("#summary-building-message-dialog"),M=$("#summary-building-confirm-dialog");b.kendoCommonDialog(),M.kendoCommonDialog({type:"confirm",title:"Notification"}),A=$("#summaryPopup").kendoPopupSingleWindow({model:o.Model,width:"1030px",height:"790px"})}return{init:function(e){m=e.building;var t=n(e),o=[{text:_.ENERGY_OPTIMAL_START,value:"OptimalStart"},{text:_.ENERGY_COMFORT,value:"Comfort"},{text:_.ENERGY_PRC,value:"PRC"}];r=$("#summaryFloorGrid"),l=$("#summary-control"),s=$("#popupDetailTable"),R(o);var a=$("#summary-control input.dropDown").data("kendoDropDownCheckBox").value();E.open(),$.ajax({url:"/energy/algorithm-summary"+t}).done(function(e){N(e)}).fail(function(e){N(m);var t=c.parseFailResponse(e);f.message(t),f.open()}).always(function(){t=t.replace("?","&"),$.ajax({url:"/energy/algorithm-summary/zone?algorithm="+a+t}).done(function(e){e||(m=[]),C(m=e)}).fail(function(e){var t=c.parseFailResponse(e);f.message(t),f.open()}).always(function(){E.close()})}),r.on("click",'tr [data-event="devicedetail"]',function(){var e=$(this);E.open(),v(e)})}}}),define("energy/summary/summary",["energy/core","energy/summary/config/summary-common","energy/summary/config/summary-widget","energy/summary/total-summary","energy/summary/all-floor","energy/summary/oneFloor"],function(e,t,o,n,i,r){"use strict";var l=window.kendo,m=window.MAIN_WINDOW,d=$("#summary-content"),s=$("#summary-control"),u=$("#summaryTotalViewTemplate").html(),c=$("#summaryAllViewTemplate").html(),p=$("#summaryFloorViewTemplate").html(),a=$("#component-example-tab"),_=function(e){var t=e.building,o=e.floor,a={building:t,floor:o,btnMadeList:null};d.empty(),s.empty(),t.id==m.FLOOR_NAV_BUILDING_TOTAL_ID?(d.html(l.template(u)),n.init(a)):o.id==m.FLOOR_NAV_FLOOR_ALL_ID?(d.html(l.template(c)),i.init(a)):(d.html(l.template(p)),r.init(a))};a.kendoCommonTabStrip(),e.on("onfloorchange",_)});