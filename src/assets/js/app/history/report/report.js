define("history/report/model/report-model",function(){"use strict";for(var e,l,o,i=window.kendo,d=window.I18N,_=window.moment,n=window.Util,t=[{dms_devices_id:"00:FF:0C:00:00:01:SYDG0631-598Y-81",dms_devices_name:"[Indoor] A:15F:A#1:#1",dms_devices_type:"AirConditioner.Indoor",foundation_space_buildings_id:1,foundation_space_floors_id:17,properties:["indoor_power","indoor_mode","current_room_temp","indoor_set_temp","discharge_cool_set_temp","discharge_heat_set_temp","indoor_cool_low_limit","indoor_heat_high_limit","indoor_fan_speed","ventilator_fan_speed"]}],a=0;a<2600;a++)t.push({dms_devices_id:"00:FF:0C:00:00:01:SYDG0631-598Y-777"+a,dms_devices_name:"[Indoor] A:15F:777"+a,dms_devices_type:"AirConditioner.Indoor",foundation_space_buildings_id:1,foundation_space_floors_id:a%50,properties:["indoor_power","indoor_mode","current_room_temp","indoor_set_temp","discharge_cool_set_temp","discharge_heat_set_temp","indoor_cool_low_limit","indoor_heat_high_limit","indoor_fan_speed","ventilator_fan_speed"]});var T={},R={AirConditioner:["AirConditioner.Indoor","AirConditioner.AHU","AirConditioner.Chiller","AirConditioner.DuctFresh","AirConditioner.EHS","AirConditioner.ERV","AirConditioner.ERVPlus","AirConditioner.FCU","AirConditioner.SFCU"],AirConditionerOutdoor:["AirConditionerOutdoor"],ControlPoint:["ControlPoint"],Light:["Light"],Meter:["Meter.Calori","Meter.Gas","Meter.Water","Meter.WattHour"],Sensor:["Sensor.Humidity","Sensor.Temperature","Sensor.Motion","Sensor.Temperature_Humidity"]},r=!1,u={AirConditioner:[],AirConditionerOutdoor:[],ControlPoint:[],Light:[],Meter:[],Sensor:[]};!function(){l=window.MAIN_WINDOW.getCurrentBuildingList();$.ajax({url:"/foundation/space/floors"}).done(function(e){o=e}).fail(function(e){D(e)})}();function p(e){return"Day"===e?d.prop("REPORT_REPORT_DAY"):"Week"===e?d.prop("REPORT_REPORT_WEEK"):"Month"===e?d.prop("REPORT_REPORT_MONTH"):"Custom"===e?d.prop("REPORT_REPORT_CUSTOM"):"Hourly"===e?d.prop("REPORT_REPORT_HOURLY"):"Daily"===e?d.prop("REPORT_REPORT_DAILY"):"Monthly"===e?d.prop("REPORT_REPORT_MONTHLY"):void 0}function s(e,t){var a=window.GlobalSettings.getTimeDisplay();if("Daily"===e){if("12Hour"===a)return m(t);if("24Hour"===a)return d.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_INTERVAL_DAILY",t)}else{if("Weekly"===e)return d.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_INTERVAL_WEEKLY",d.prop("REPORT_REPORT_AUTOGENDERATE_DAILY_"+String(t)));if("Monthly"===e)return d.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_INTERVAL_MONTHLY",t)}}function c(e){if(void 0===e)return!1;e instanceof Array||(e=[e]);for(var t=$.extend(!0,[],e),a=0;a<t.length;a++)void 0!==t[a].type&&("General"===t[a].type?t[a].type=d.prop("REPORT_REPORT_DROPDOWNLIST_VALUE_NORMAL"):"Template"===t[a].type&&(t[a].type=d.prop("REPORT_REPORT_DROPDOWNLIST_VALUE_TEMPLATE"))),void 0!==t[a].dms_devices_type&&(t[a].dms_devices_type=n.getDetailDisplayTypeDeviceI18N(t[a].dms_devices_type)),void 0!==t[a].duration&&(t[a].duration=p(t[a].duration)),void 0!==t[a].interval&&(t[a].interval=p(t[a].interval),void 0!==t[a].startTime&&void 0!==t[a].endTime&&(t[a].startDate=new Date(t[a].startTime),t[a].startTime=new Date(t[a].startTime),t[a].endDate=new Date(t[a].endTime),t[a].endTime=new Date(t[a].endTime))),void 0!==t[a].autoGenerate&&(t[a].autoGenerate?(t[a].autoGenerateTime=s(t[a].autoGenerateInterval,t[a].autoGenerateTime),t[a].autoGenerateInterval=E(t[a].autoGenerateInterval),t[a].autoGeneration=t[a].autoGenerateInterval+" "+t[a].autoGenerateTime):(t[a].autoGenerateInterval=d.prop("REPORT_REPORT_POPUP_AUTO_CREATE_NOT_APP"),t[a].autoGenerateTime=d.prop("REPORT_REPORT_POPUP_AUTO_CREATE_NOT_APP")),t[a].autoGenerate=d.prop("REPORT_REPORT_POPUP_AUTO_CREATE_NAME")),void 0!==t[a].devices&&(t[a].devices=f(t[a].devices,!1));return t}function v(e){return e=_(e).minutes(0).seconds(0).format(),new Date(e)}var m=function(e){var t;return 12<e?t=d.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_INTERVAL_DAILY",e-12)+"PM":12===e?t=d.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_INTERVAL_DAILY",e)+"PM":e<12&&(t=0===e?d.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_INTERVAL_DAILY",12)+"AM":d.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_INTERVAL_DAILY",e)+"AM"),t},E=function(e){return"Daily"==e?d.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_DAILY"):"Weekly"==e?d.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_WEEKLY"):"Monthly"==e?d.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_MONTHLY"):void 0},f=function(e,t){if(t)for(var a=e.length,i=0;i<a;i++)void 0===e[i].assigned&&(e[i].assigned=t);return e},M=function(e){var t=e,a=$.extend(!0,[],u[t.dms_devices_type]),i=[];if(i[0]=$.extend(!0,[],t),void 0!==t.devices)for(var o=t.devices,n=0,r=o.length;n<r;n++)for(var p=0,d=a.length;p<d;p++)if(o[n].dms_devices_id===a[p].dms_devices_id)for(var s=o[n].dms_reports_view_properties,l=0;l<s.length;l++)s[l]===a[p].dms_reports_view_properties&&(a[p].assigned=!0);return i[0].devices=a,i},P=function(){var a=new $.Deferred;return $.ajax({url:"/dms/reports/view"}).done(function(t){t=O(t,!0),$.each(R,function(e){u[e]=function(e,t){var a=[],i=R[t];if(void 0!==e)for(var o=e,n=o.length,r=0;r<n;r++)for(var p=o[r].dms_devices_type,d=0,s=i.length;d<s;d++)if(p===i[d]){o[r].dms_reports_view_properties=o[r].properties;var l=o[r].dms_reports_view_properties;if(l instanceof Array)for(var u=l.length,c=0;c<u;c++)a.push($.extend(!0,{},o[r])),a[a.length-1].dms_reports_view_properties=l[c];else a.push(o[r])}for(var v=a.length,_=0;_<v;_++)T[a[_].dms_devices_id]=a[_].dms_devices_name,delete a[_].properties;return a}(t,e)}),r=!0,a.resolve()}).fail(function(e){D(e),a.reject()}),a.promise()},O=function(e,t){var a,i,o=e,n=!0===t?"id":"sortOrder",r=!0===t?"sortOrder":"id";for(a=0,i=o.length;a<i;a++)for(var p=0,d=l.length;p<d;p++){var s=o[a];if(s.foundation_space_buildings_id===l[p][n]){s.foundation_space_buildings_id=l[p][r];break}}return o},g=function(e){var t=e.getResponseHeader("Content-Disposition");return decodeURI(t.substr(t.indexOf("filename=")+9,t.length-1))},D=function(e){var t,a,i=e.status,o=$("#popup-error-message").data("kendoCommonDialog");if(400===i)o.message(d.prop("REPORT_REPORT_POPUP_INVALID_FORMAT_ERROR")),o.open();else if(403===i)o.message(d.prop("REPORT_REPORT_POPUP_PERMISSION_ERROR")),o.open();else if(500===i){if(e.responseJSON&&(t=e.responseJSON.code),41301===t){var n,r;n=(a=e.responseJSON.message).indexOf("g [")+3,r=a.indexOf("] c");var p=(a=a.slice(n,r)).split(", ");3<p.length&&(a=(p=p.slice(0,3)).join(", ")),o.message(d.prop("REPORT_REPORT_POPUP_CONTROLPOINT_NOT_MATCH_ERROR",a))}else o.message(d.prop("REPORT_REPORT_POPUP_DATABASE_NOT_RUN_ERROR"));o.open()}};e={originData:{type:"General",name:"",duration:"",dms_devices_type:"",interval:"",autoGenerate:!1,autoGenerateInterval:"",autoGenerateTime:""},processingData:[{type:"",name:"",duration:"",dms_devices_type:"",autoGenerate:!1,autoGenerateInterval:"",autoGenerateTime:"",startDate:v(new Date),startTime:v(new Date(_().subtract(1,"hour"))),endDate:v(new Date),endTime:v(new Date),devices:new i.data.DataSource({data:[],group:[{field:"foundation_space_buildings_id"},{field:"foundation_space_floors_id"},{field:"dms_devices_name"}]})}]};var b=function(e){if(e instanceof Array)for(var t=0,a=e.length;t<a;t++)void 0!==e[t].dms_devices_type&&(e[t].dms_devices_type=e[t].dms_devices_type.split(".")[0]);else e instanceof Object&&void 0!==e.dms_devices_type&&(e.dms_devices_type=e.dms_devices_type.split(".")[0]);return e};return{originData:void 0,popupResetData:e,gridDataProcessing:c,deleteReportAjaxData:function(e){for(var t="",a=0;a<e.length;a++)t+=e[a].id+",";t=t.slice(0,-1);var i=new $.Deferred;return $.ajax({url:"/dms/reports?ids="+t,method:"DELETE"}).done(function(e){i.resolve(e)}).fail(function(e){D(e),i.reject(e)}),i.promise()},reportGridAjaxData:function(e){var t="/dms/reports";"serach"==e&&(t="/dms/reports?contains="+String($("#search-input-text").val()));var a=new $.Deferred,i=!1;return $.ajax({url:t}).done(function(e){100<=(e=b(e)).length&&(i=!0),a.resolve(c(e),i)}).fail(function(e){D(e),a.reject(e)}),a.promise()},requestGridDownload:function(e){var i=new $.Deferred;return $.ajax({url:"/dms/reports/"+e+"/download",dataType:"binary"}).done(function(e,t,a){i.resolve(new Blob([e]),g(a))}).fail(function(e){D(e),i.reject(e)}),i.promise()},detailDataPopupAjaxData:function(e){var t=new $.Deferred;return $.ajax({url:"/dms/reports/"+e}).done(function(e){e=b(e),t.resolve({originData:e,processingData:c(M(e))})}).fail(function(e){D(e)}),t.promise()},generalIntervalDDLDataProcessing:function(e){var t=0,a=[];if("Daily"==e)a=function(){var e=0,t=[],a=window.GlobalSettings.getTimeDisplay();if("12Hour"===a){var i="";for(e=0;e<24;e++)i=m(e),t.push({value:e,text:i})}else if("24Hour"===a)for(e=0;e<24;e++)t.push({value:e,text:d.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_INTERVAL_DAILY",e)});return t}();else if("Weekly"==e)for(t=1;t<8;t++)a.push({value:t,text:d.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_INTERVAL_WEEKLY",d.prop("REPORT_REPORT_AUTOGENDERATE_DAILY_"+t))});else if("Monthly"==e)for(t=1;t<32;t++)a.push({value:t,text:d.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_INTERVAL_MONTHLY",t)});return a},timeDataProcessing:v,checkDateTimePicker:function(e,t){var a=_(e),i=_(t);return!i.isBefore(a)&&a.format("YYYYMMDDHHMM")!=i.format("YYYYMMDDHHMM")},dateDataOverCheck:function(e){var t=_(new Date),a=_(e);return!(_.duration(t.diff(a)).asDays()<=0)},dateDataOneYearOverCheck:function(e,t){var a=_(e),i=_(t);return!(_.duration(a.diff(i)).asDays()<-365)},durationSetDataProcessing:function(e){var t={startDate:void 0,endDate:void 0};return"Day"===e?(t.startDate=new Date(_().subtract(1,"days").startOf("hour").format()),t.endDate=new Date(_().startOf("hour").format())):"Week"===e?(t.startDate=new Date(_().subtract(1,"week").startOf("hour").format()),t.endDate=new Date(_().startOf("hour").format())):"Month"===e&&(t.startDate=new Date(_().subtract(1,"month").startOf("hour").format()),t.endDate=new Date(_().startOf("hour").format())),t},popupGroupGridDataProcessing:f,popupIntervalGridDataProcessing:function(e,t,a,i,o){var n,r,p=[],d=0,s=_(new Date(_(t).format("YYYY-MM-DD")+"T"+_(a).format("HH:mm"))),l=_(new Date(_(i).format("YYYY-MM-DD")+"T"+_(o).format("HH:mm"))),u=_.duration(s.diff(l)),c=_(t).format("YYYY-MM-DD")+"T"+_(a).format("HH:mm");if("Hourly"===e)r="hour",n=u.asHours();else if("Daily"===e)r="day",n=u.asDays();else{if("Monthly"!==e)return p;r="month",n=u.asMonths()}5<(d=Math.abs(n))&&(d=5);for(var v=0;v<d;v++)p[v]={text:_(c).add(v,r).startOf(r).format("YYYY-MM-DD HH:mm:ss")};return p},intervalSetDataProcessing:function(e,t){var a,i=[{value:"Hourly",text:d.prop("REPORT_REPORT_HOURLY")},{value:"Daily",text:d.prop("REPORT_REPORT_DAILY")},{value:"Monthly",text:d.prop("REPORT_REPORT_MONTHLY")}],o=[[i[0]],[i[0],i[1]],[i[0],i[1],i[2]]];if("Day"===e)a=o[0];else if("Week"===e)a=o[1];else if("Month"===e)a=o[2];else if("Custom"===e){if("undefined"!==t.startDate&&"undefined"!==t.endDate){var n=_(t.startDate),r=_(t.endDate),p=_.duration(n.diff(r)).asDays();-2<p?a=o[0]:p<=-2&&-30<p?a=o[1]:p<=-30&&(a=o[2])}}else a="";return a},getCurrentBuildingList:function(e){for(var t=l.length-1;0<=t;t--)if(l[t].sortOrder===e)return l[t].name;return e},getCurrentFloorList:function(e){for(var t=o.length-1;0<=t;t--)if(o[t].id===e){var a=void 0===o[t].name||""===o[t].name?"-":o[t].name,i=void 0===o[t].type||""===o[t].type?"-":o[t].type;return a+(i="None"===i?"":i)}return e},assignedDevicesPropertiesDivision:M,autoCreateReportListAjaxData:function(e){var a=new $.Deferred;return $.ajax({url:"/dms/reports/"+e+"/files"}).done(function(e){var t=new i.data.DataSource({data:e,sort:{field:"id",dir:"asc"}});a.resolve(t)}).fail(function(e){D(e),a.reject(e)}),a.promise()},deleteAutoCreateReportList:function(e,t){for(var a="",i=0;i<t.length;i++)a+=t[i].id+",";a=a.slice(0,-1);var o=new $.Deferred;return $.ajax({url:"/dms/reports/"+e+"/files?ids="+a,method:"DELETE"}).done(function(e){o.resolve(e)}).fail(function(e){D(e),o.reject(e)}),o.promise()},saveDataAjax:function(e,t){var a,i="";"General"===e.type?(a="/dms/reports/","create"===t?i="POST":"edit"===t&&(i="PATCH",a="/dms/reports/"+e.id)):"Template"===e.type&&(a="/dms/reports/","create"===t?i="POST":"edit"===t&&(i="PATCH",a="/dms/reports/"+e.id));var o=new $.Deferred;return $.ajax({url:a,method:i,data:e}).done(function(e){o.resolve(e)}).fail(function(e){D(e),o.reject(e)}),o.promise()},getAssignedItem:function(){for(var e=$("#report-group-list").data("kendoCommonGroupList"),t=$.extend(!0,[],e.getAssignedItems()),a=[],i=[],o=0,n=!1,r=0;r<t.length;r++){n=!1;for(var p=0;p<a.length;p++)t[r].dms_devices_id===a[p].dms_devices_id&&(o=p,n=!0);n?a[o].dms_reports_view_properties+=","+t[r].dms_reports_view_properties:a.push(t[r])}for(var d=0;d<a.length;d++)a[d].dms_reports_view_properties=a[d].dms_reports_view_properties.split(",");for(var s=0;s<a.length;s++)i[s]={dms_devices_id:"",dms_devices_name:"",dms_reports_view_properties:"",foundation_space_buildings_id:"",foundation_space_floors_id:""},i[s].dms_devices_id=a[s].dms_devices_id,i[s].dms_devices_name=a[s].dms_devices_name,i[s].dms_reports_view_properties=a[s].dms_reports_view_properties,i[s].foundation_space_buildings_id=a[s].foundation_space_buildings_id,i[s].foundation_space_floors_id=a[s].foundation_space_floors_id;return i=O(i,!1)},dmsTypeRefershData:function(e){var t=new $.Deferred;return r?void 0===e&&""===e||t.resolve(f(u[e],!1)):P.done(function(){void 0===e&&""===e||t.resolve(f(u[e],!1))}).fail(function(e){t.reject([]),D(e)}),t.promise()},fileAjax:function(e,t){var a,i,o="",n=new $.Deferred;if(void 0!==e&&"Template"===e.type)if(a="/dms/reports/",(i=e.file).append("data",JSON.stringify(e)),"create"===t)o="POST",$.ajax({url:a,method:o,data:i,isFileUpload:!0}).done(function(){n.resolve()}).fail(function(e){D(e),n.reject()}).always(function(){});else if("edit"===t){var r=$.ajax({url:"/dms/reports/"+e.id,method:"PATCH",data:e});null!==i.get("file")&&"undefined"!==i.get("file")?(a="/dms/reports/"+e.id+"/template",o="DELETE",$.ajax({url:a,method:o}).done(function(){$.ajax({url:a,method:"POST",data:i,isFileUpload:!0}).done(function(){}).fail(function(e){D(e)}).always(function(e){r.done(function(){n.resolve()}).fail(function(e){n.reject(e)})})}).fail(function(e){D(e)})):r.done(function(){n.resolve()}).fail(function(e){D(e),n.reject()}).always(function(){})}return n.promise()},getAssignedItemCheck:function(){return $("#report-group-list").data("kendoCommonGroupList").getAssignedItems().length},autoGeneratedReportDownload:function(e,t){var i=new $.Deferred;return t=t.trim(),$.ajax({url:"/dms/reports/"+e+"/files/"+t+"/download",dataType:"binary"}).done(function(e,t,a){i.resolve(new Blob([e]),g(a))}).fail(function(e){D(e),i.reject(e)}),i.promise()},fileGetAjax:function(e){var i=new $.Deferred;return $.ajax({url:"/dms/reports/"+e+"/template",method:"GET",dataType:"binary"}).done(function(e,t,a){i.resolve(new Blob([e]),g(a))}).fail(function(e){D(e),i.reject(e)}),i.promise()},errorCheck:D,mappingDevicesName:T,dmsTypeDataGet:P,formDataProcessingFunc:function(){var e,t=new FormData;return e=(e=$("#excel-file-input")).get(0).files[0],t.append("file",e),t}}}),define("history/report/viewmodel/report-vm",["history/report/model/report-model"],function(e){var t=window.kendo,v=window.I18N,a=window.Util,_=e,l=window.moment,r=new window.CommonLoadingPanel,p=t.observable({topSearch:[{type:"textinput",id:"search-input-text",class:"report-top-search",disabled:!1,isEnabled:!0,keyPressEnterEvt:function(){r.open(),_.reportGridAjaxData("serach").done(function(e,t){p.contentGrid[0].set("GriddataSource",e),t&&p.topMenu[2].set("isEnabled",!1)}).fail(function(){}).always(function(){r.close()})}}],topMenu:[{type:"dropdownlist",id:"top-menu-kind-dropdownlist",class:"report-top-menu",disabled:!1,isEnabled:!0,ddlDs:new t.data.DataSource({schema:{model:{fields:{Value:{type:"string"},Title:{type:"string"}}}},data:[{Value:v.prop("REPORT_REPORT_DROPDOWNLIST_VALUE_NORMAL"),Title:v.prop("REPORT_REPORT_DROPDOWNLIST_VALUE_NORMAL")},{Value:v.prop("REPORT_REPORT_DROPDOWNLIST_VALUE_TEMPLATE"),Title:v.prop("REPORT_REPORT_DROPDOWNLIST_VALUE_TEMPLATE")}]}),options:{dataTextField:"Title",dataValueField:"Value",optionLabel:v.prop("REPORT_REPORT_SELECTALL"),change:function(){var e=$("#top-menu-kind-dropdownlist").data("kendoDropDownList").value();$("#report-content-grid").data("kendoGrid").dataSource.filter({logic:"and",filters:[{logic:"or",filters:[{field:"type",operator:"contains",value:e}]}]})}}},{type:"button",id:"top-menu-delete-btn",class:"report-top-menu",width:"120px",text:v.prop("REPORT_REPORT_DELETE_BTN"),invisible:!1,isEnabled:!1,options:{click:function(){$("#popup-delete-confrim").data("kendoCommonDialog").open()}}},{type:"button",id:"top-menu-create-btn",class:"report-top-menu",width:"120px",text:v.prop("REPORT_REPORT_CREATE_BTN"),invisible:!1,isEnabled:!0,options:{click:function(){$("#report-main-popup").data("kendoDialog").open(),o("create"),i()}}}],contentGrid:[{type:"grid",id:"report-content-grid",class:"",height:$("#report-common-tab").height()-130,columns:"[{ 'hidden': true, 'field': 'Id'},{ 'sortable': true, 'field': 'type', 'title': '"+v.prop("REPORT_REPORT_GRID_COLUMNS_KIND")+"'},{ 'sortable': true, 'field': 'name', width: 550, 'title': '"+v.prop("REPORT_REPORT_GRID_COLUMNS_TITLE")+"'},{ 'sortable': true, 'field': 'duration', 'title': '"+v.prop("REPORT_REPORT_GRID_COLUMNS_TREM")+"'},{ 'sortable': false, 'field': 'interval', 'title': '"+v.prop("REPORT_REPORT_GRID_COLUMNS_INTERVAL")+"'},{ 'sortable': false, 'field': 'autoGeneration', width: 150, 'title': '"+v.prop("REPORT_REPORT_GRID_COLUMNS_AUTO_GENERATION")+"'},{ 'sortable': false, 'field': 'dms_devices_type', 'title': '"+v.prop("REPORT_REPORT_GRID_COLUMNS_DEVICE_TYPE")+"'},{ 'template': '<button class=k-button data-bind=events:{click:options.clickDownload}>"+v.prop("REPORT_REPORT_GRID_COLUMNS_DOWNLOAD")+"</button>', 'sortable': false, 'field': 'download', 'title': '"+v.prop("REPORT_REPORT_GRID_COLUMNS_DOWNLOAD")+"' },{ 'template': '<span class=grid-detail-btn data-bind=events:{click:options.clickDetail}></span>', 'sortable': false, 'field': 'detailInfo', 'title': '"+v.prop("REPORT_REPORT_POPUP_TITLE_INFO")+"' }]",GriddataSource:new t.data.DataSource({schema:{model:{fields:{type:{type:"string"},title:{type:"string"},duration:{type:"string"},interval:{type:"string"},autoGeneration:{type:"string"},dms_devices_type:{type:"string"}}}}}),disabled:!1,isEnabled:!0,scrollable:!0,groupable:!1,sortable:!0,filterable:!1,pageable:!1,hasCheckedModel:!0,setCheckedAttribute:!0,options:{clickDownload:function(e){r.open(),_.requestGridDownload(e.data.id).done(function(e,t){O(e,t)}).fail(function(){}).always(function(){r.close()})},clickDetail:function(e){var t;r.open(),_.detailDataPopupAjaxData(e.data.id).done(function(e){t=e}).fail(function(){}).always(function(){$("#report-main-popup").data("kendoDialog").open(),r.close(),r.open($("#report-main-popup")),o("view"),i(t),r.close()})}}}]}),T=t.observable({popupMainCotent:{id:"",Header:{class:"popup-reportkind-Element",oldValue:"",value:"",text:"",oldText:"",enabled:!1,isEnabled:!0,ddlDs:new t.data.DataSource({schema:{model:{fields:{value:{type:"string"},text:{type:"string"}}}},data:[{value:"General",text:v.prop("REPORT_REPORT_DROPDOWNLIST_VALUE_NORMAL")},{value:"Template",text:v.prop("REPORT_REPORT_DROPDOWNLIST_VALUE_TEMPLATE")}]})},Main:{name:{value:"",oldValue:"",change:function(e){M()}},file:{value:"",oldValue:""},duration:{oldValue:"",value:"",text:"",oldText:"",isEnabled:!0,ddlDs:new t.data.DataSource({schema:{model:{fields:{value:{type:"string"},text:{type:"string"}}}},data:[{value:"Day",text:v.prop("REPORT_REPORT_DAY")},{value:"Week",text:v.prop("REPORT_REPORT_WEEK")},{value:"Month",text:v.prop("REPORT_REPORT_MONTH")},{value:"Custom",text:v.prop("REPORT_REPORT_CUSTOM")}]}),change:function(e){var t=e.sender.value();if("Custom"===t)T.popupMain.set("dateCustomMode",!0),g(!0);else{g(!1),T.popupMain.set("dateCustomMode",!1);var a=_.durationSetDataProcessing(t),i=T.popupMainCotent.Main;i.startDate.set("value",a.startDate),i.startTime.set("value",a.startDate),i.endDate.set("value",a.endDate),i.endTime.set("value",a.endDate),u(t,{startDate:a.startDate,endDate:a.endDate})}M()}},dmsType:{prevValue:"",oldValue:"",value:"",text:"",oldText:"",isEnabled:!0,ddlDs:new t.data.DataSource({schema:{model:{fields:{value:{type:"string"},text:{type:"string"}}}},data:[{value:"AirConditioner",text:a.getDetailDisplayTypeDeviceI18N("AirConditioner.Indoor")},{value:"AirConditionerOutdoor",text:a.getDetailDisplayTypeDeviceI18N("AirConditionerOutdoor")},{value:"ControlPoint",text:a.getDetailDisplayTypeDeviceI18N("ControlPoint")},{value:"Light",text:a.getDetailDisplayTypeDeviceI18N("Light")},{value:"Meter",text:a.getDetailDisplayTypeDeviceI18N("Meter")},{value:"Sensor",text:a.getDetailDisplayTypeDeviceI18N("Sensor")}]}),change:function(e){""!==this.popupMainCotent.Main.dmsType.get("value")&&(this.popupMain.createMode?n():$("#popup-dmstype-confrim").data("kendoCommonDialog").open())}},dmsGrid:{id:"popup-main-grid",oldValue:"",type:"commongrouplist",gridDs:"",oldDs:"",selectedData:null,oldSelectedData:null,columns:[{title:"\ube4c\ub529 \uac74\ubb3c",field:"foundation_space_buildings_id"},{title:"\ube4c\ub529 \uce35",field:"foundation_space_floors_id"},{title:"\uae30\uae30 \uc774\ub984",field:"dms_devices_name"},{title:"\uae30\uae30 \uc18d\uc131\uac12",field:"dms_reports_view_properties"}]},startDate:{value:new Date,oldValue:new Date,prevValue:new Date,change:function(e){E("startDate",e.sender.value()),M()}},endDate:{value:new Date,oldValue:new Date,prevValue:new Date,change:function(e){E("endDate",e.sender.value()),M()}},startTime:{value:new Date,oldValue:new Date,prevValue:new Date,change:function(e){E("startTime",e.sender.value()),M()}},endTime:{value:new Date,oldValue:new Date,prevValue:new Date,change:function(e){E("endTime",e.sender.value()),M()}},interval:{value:"",oldValue:"",text:"",oldText:"",ddlDs:new t.data.DataSource({schema:{model:{fields:{value:{type:"string"},text:{type:"string"}}}},data:[{value:"Hourly",text:v.prop("REPORT_REPORT_HOURLY")},{value:"Daily",text:v.prop("REPORT_REPORT_DAILY")},{value:"Monthly",text:v.prop("REPORT_REPORT_MONTHLY")}]}),change:function(e){var t,a=T.popupMainCotent.Main;t=void 0!==e.sender?e.sender.value():e;var i=_.popupIntervalGridDataProcessing(t,a.startDate.get("value"),a.startTime.get("value"),a.endDate.get("value"),a.endTime.get("value"));a.intervalGrid.set("gridDs",i),M()}},intervalGrid:{value:"",oldDs:"",text:"",gridDs:new t.data.DataSource({schema:{model:{fields:{value:{type:"string"},text:{type:"string"}}}}}),changeTextAlian:function(){return T.popupMain.get("viewMode")?"left":"center"}}},Footer:{autoGenerate:{value:!1,oldValue:!1,text:"",oldText:"",change:function(e){M()}},autoGenerateInterval:{value:"",oldValue:"",text:"",oldText:"",isEnabled:!0,ddlDs:new t.data.DataSource({schema:{model:{fields:{value:{type:"string"},text:{type:"string"}}}},data:[{value:"Daily",text:v.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_DAILY")},{value:"Weekly",text:v.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_WEEKLY")},{value:"Monthly",text:v.prop("REPORT_REPORT_POPUP_AUTOGENDERATE_MONTHLY")}]}),change:R},autoGenerateTime:{value:"",oldValue:"",text:"",oldText:"",isEnabled:!0,ddlDs:new t.data.DataSource({schema:{model:{fields:{value:{type:"string"},text:{type:"string"}}}},data:void 0}),change:function(){M()}}}},popupMain:{type:"MainPopup",id:"report-main-popup",reportTypeGeneral:!0,oldReportTypeGeneral:!0,isVisible:!1,title:v.prop("REPORT_REPORT_POPUP_TITLE_DETAIL"),width:1260,height:800,editMode:!0,viewMode:!1,createMode:!1,saveVailator:!1,dateCustomMode:!1,reportListBtnMode:!0,autoCreateReportDisabled:!1,fileName:"",oldFileName:"",oldFile:"",stateMode:"",actionArr:["view","edit","create"],btnActionStatus:[!0,!0,!1,!1,!1],btnViewEditMode:function(e){e===this.actionArr[0]?(this.set("btnActionStatus[0]",!0),this.set("btnActionStatus[1]",!0),this.set("btnActionStatus[2]",!1),this.set("btnActionStatus[3]",!1),this.set("btnActionStatus[4]",!1)):e===this.actionArr[1]?this.reportTypeGeneral?(this.set("btnActionStatus[0]",!1),this.set("btnActionStatus[1]",!1),this.set("btnActionStatus[2]",!0),this.set("btnActionStatus[3]",!0),this.set("btnActionStatus[4]",!1)):(this.set("btnActionStatus[0]",!1),this.set("btnActionStatus[1]",!1),this.set("btnActionStatus[2]",!0),this.set("btnActionStatus[3]",!0),this.set("btnActionStatus[4]",!0)):e===this.actionArr[2]&&(this.reportTypeGeneral?(this.set("btnActionStatus[0]",!1),this.set("btnActionStatus[1]",!0),this.set("btnActionStatus[2]",!1),this.set("btnActionStatus[3]",!0),this.set("btnActionStatus[4]",!1)):(this.set("btnActionStatus[0]",!1),this.set("btnActionStatus[1]",!0),this.set("btnActionStatus[2]",!1),this.set("btnActionStatus[3]",!0),this.set("btnActionStatus[4]",!0)))},titleTextChange:function(){this.get("stateMode")===this.actionArr[0]?this.set("title",v.prop("REPORT_REPORT_POPUP_TITLE_DETAIL")):this.get("stateMode")===this.actionArr[1]?this.set("title",v.prop("REPORT_REPORT_POPUP_TITLE_EDIT")):this.get("stateMode")===this.actionArr[2]&&this.set("title",v.prop("REPORT_REPORT_POPUP_TITLE_CREATE"))},headerTemplateHeight:function(){return this.get("viewMode")?"61px":"Template"===T.popupMainCotent.Header.get("value")?"61px":"136px"},containTemplateHeight:function(){return this.get("viewMode"),"570px"},reportTypeChangeEvt:function(e){"General"===e.sender.value()?(this.popupMain.set("reportTypeGeneral",!0),this.popupMain.btnViewEditMode(this.popupMain.stateMode),g(!1)):"Template"===e.sender.value()&&(D(),this.popupMain.set("reportTypeGeneral",!1),this.popupMain.btnViewEditMode(this.popupMain.stateMode),g(!0))},content:"<div><div><div id='report-mainpopup-head'><span id='mainpopup-head-title' data-bind='text:popupMain.title'></span><span class='popup-close-btn' data-bind='events:{click:popupMain.closeEvt}'></span></div><div class='report-popup-line'></div></div><div id='type-general-report' data-bind='visible:popupMain.reportTypeGeneral'><div id='report-mainpopup-header'><div class='mainpopup-header-box'><div id='reporting-kind-content' class='align-middle'><div class='align-middle popupview-text-box' data-bind='visible:popupMain.viewMode, text:popupMainCotent.Header.text, value:popupMainCotent.Header.value'></div><input id='report-type-ddl' data-role='dropdownlist' style='width: 178px;' data-text-field='text' data-value-field='value'  data-bind='visible:popupMain.editMode, enabled:popupMainCotent.Header.enabled, source:popupMainCotent.Header.ddlDs, value:popupMainCotent.Header.value, events: {change: popupMain.reportTypeChangeEvt}'></input></div></div><div class='mainpopup-header-box'><div><div class='align-middle popup-name-text' data-bind='visible:popupMain.viewMode, text:popupMainCotent.Main.name.value'></div></div><div data-bind='visible:popupMain.editMode'><div class='align-middle' style='line-height: 0px;'><input id='popup-title-input' class='k-input' type='text' placeholder='"+v.prop("REPORT_REPORT_ENTER_REPORT_TITLE_PLACEHORDER")+"' data-bind='events: { change: popupMainCotent.Main.name.change }, visible:popupMain.editMode, readonly:popupMain.viewMode, value:popupMainCotent.Main.name.value'></input></div></div></div><div class='mainpopup-header-box'><div id='reporting-duration-content' class='align-middle'><div class='align-middle popupview-text-box' data-bind='visible:popupMain.viewMode, text:popupMainCotent.Main.duration.text, value:popupMainCotent.Main.duration.value'></div><input class='align-middle' id='duration-dropdownlist' data-role='dropdownlist' style='width: 178px;' data-text-field='text' data-value-field='value' data-bind='visible:popupMain.editMode, source:popupMainCotent.Main.duration.ddlDs, events: { change: popupMainCotent.Main.duration.change }, value: popupMainCotent.Main.duration.value'></input></div></div><div class='mainpopup-header-box'><div class='type-devices-content align-middle'><div class='align-middle popupview-text-box' id='dms-devices-type-button' data-bind='visible:popupMain.viewMode, text:popupMainCotent.Main.dmsType.text, value: popupMainCotent.Main.dmsType.value'></div><input id='dms-devices-type-dropdownlist' data-role='dropdownlist' style='width: 178px;' data-text-field='text' data-value-field='value' data-bind='visible:popupMain.editMode, source:popupMainCotent.Main.dmsType.ddlDs, value: popupMainCotent.Main.dmsType.value, events: { change: popupMainCotent.Main.dmsType.change}'></input></div><div class='type-date-content align-middle'><input class='popup-date-picker' data-role='commondatepicker' data-bind='enabled:popupMain.dateCustomMode, value: popupMainCotent.Main.startDate.value, events: { change: popupMainCotent.Main.startDate.change }'></input><input class='popup-time-picker' data-role='commontimepicker' data-bind='enabled:popupMain.dateCustomMode, value: popupMainCotent.Main.startTime.value, events: { change: popupMainCotent.Main.startTime.change }'></input><span style='margin: 0px 5px 0px 5px'> ~ </span><input class='popup-date-picker' data-role='commondatepicker' data-bind='enabled:popupMain.dateCustomMode, value: popupMainCotent.Main.endDate.value, events: { change: popupMainCotent.Main.endDate.change }'></input><input class='popup-time-picker' data-role='commontimepicker' data-bind='enabled:popupMain.dateCustomMode, value: popupMainCotent.Main.endTime.value, events: { change: popupMainCotent.Main.endTime.change }'></input></div></div></div><div id=report-mainpopup-contain><div id='report-mainpopup-gridcontent'><div class='contain-left-box' data-bind='visible:popupMain.viewMode'><div class='contain-align-middle'><div id='interval-type-text' data-bind='visible:popupMain.viewMode, text:popupMainCotent.Main.interval.text,  value: popupMainCotent.Main.interval.value'></div></div></div><div class='contain-right-box' data-bind='visible:popupMain.viewMode'><div class='contain-align-middle'><div id='group-list-title' >"+v.prop("REPORT_REPORT_POPUP_GROUPLIST_TITLE_ASSIGNED_ITEM")+"</div></div></div><div class='contain-left-box'><div class='contain-align-middle'><div><input id='report-interval-ddl' class='k-widget k-dropdown k-header' data-role='dropdownlist' style='width: 178px;' data-text-field='text' data-value-field='value'  data-bind='visible:popupMain.editMode, source:popupMainCotent.Main.interval.ddlDs, value: popupMainCotent.Main.interval.value, events:{change:popupMainCotent.Main.interval.change}'></input></div></div><div class='contain-align-middle'><div id='interval-listview' data-role='listview' data-template='listTemplate' data-bind='source:popupMainCotent.Main.intervalGrid.gridDs' style='height: 300px;'></div></div></div><div class='contain-right-box'><div class='contain-align-middle'><div id='report-group-list'></div></div></div></div></div><div id='report-mainpopup-footer'><div id='auto-report-content'><div class='autoGenerate-checkbox-box'><input id='autoGenerate-checkbox' class='k-checkbox' type='checkbox' data-bind='events: {change:popupMainCotent.Footer.autoGenerate.change}, disabled:autoCreateReportDisabled, visible:popupMain.editMode, checked: popupMainCotent.Footer.autoGenerate.value'></input> <label for='autoGenerate-checkbox' class='k-checkbox-label' data-bind='visible:popupMain.editMode, disabled:autoCreateReportDisabled '><span display=''></span></label> <span class='autoGenerate-checkbox-text' data-bind='visible:popupMain.editMode, disabled:autoCreateReportDisabled'>"+v.prop("REPORT_REPORT_POPUP_AUTO_CREATE_TITLE")+"</span><span class='autoGenerate-text-title' data-bind='visible:popupMain.viewMode, text:popupMainCotent.Footer.autoGenerate.text'></span></div><div class='schedule-view-box' data-bind='visible:popupMain.viewMode'><div class='schedule-interval'><div class='popupview-text-box' data-bind='visible:popupMain.viewMode, text:popupMainCotent.Footer.autoGenerateInterval.text', value: popupMainCotent.Footer.autoGenerateInterval.value></div></div><div class='schedule-time'><div class='popupview-text-box' data-bind='visible:popupMain.viewMode, text:popupMainCotent.Footer.autoGenerateTime.text, value: popupMainCotent.Footer.autoGenerateTime.value'></div></div><div><button class='report-list-btn popupview-text-box' data-role='button' data-bind='events:{click:popupMain.reportListEvt}, enabled: popupMain.reportListBtnMode' style='line-height:0px'>"+v.prop("REPORT_REPORT_LIST")+"</button></div></div><div class='schedule-edit-box' data-bind='visible:popupMain.editMode'><div class='schedule-interval'><input id='general-schedule-interval-dropdownlist' style='width: 178px;' data-role='dropdownlist' data-option-label='"+v.prop("REPORT_REPORT_GENERATION_INTERVAL")+"' data-text-field='text' data-value-field='value' data-bind='enabled: popupMainCotent.Footer.autoGenerate.value, visible:popupMain.editMode, source:popupMainCotent.Footer.autoGenerateInterval.ddlDs, events:{change:popupMainCotent.Footer.autoGenerateInterval.change}, value: popupMainCotent.Footer.autoGenerateInterval.value'></input></div><div class='schedule-time'><input id='general-schedule-time-dropdownlist' style='width: 178px;' data-role='dropdownlist' data-option-label='"+v.prop("REPORT_REPORT_GENERATION_POINT")+"' data-text-field='text' data-value-field='value' data-bind='events: {change:popupMainCotent.Footer.autoGenerateTime.change}, enabled: popupMainCotent.Footer.autoGenerate.value, visible:popupMain.editMode, source:popupMainCotent.Footer.autoGenerateTime.ddlDs, value: popupMainCotent.Footer.autoGenerateTime.value'></input></div><div><button class='report-list-btn' data-role='button' data-bind='events:{click:popupMain.reportListEvt}, enabled: popupMain.reportListBtnMode'>"+v.prop("REPORT_REPORT_LIST")+"</button></div></div></div><div id='action-button-cotent'><button data-role='button' class='action-button-edit' value='edit' data-bind='events:{click:popupMain.editViewChange}, visible:popupMain.btnActionStatus[0]'>"+v.prop("REPORT_REPORT_POPUP_EDIT")+"</button><button data-role='button' class='action-button-close' data-bind='events:{click:popupMain.closeEvt}, visible:popupMain.btnActionStatus[1]'>"+v.prop("REPORT_REPORT_POPUP_CLOSE")+"</button><button data-role='button' class='action-button-cancle' value='view' data-bind='events:{click:popupMain.editViewChange}, visible:popupMain.btnActionStatus[2]'>"+v.prop("REPORT_REPORT_POPUP_CANCLE")+"</button><button data-role='button' class='action-button-save' data-bind='enabled:popupMain.saveVailator, visible:popupMain.btnActionStatus[3], events:{click:popupMain.saveEvt}'>"+v.prop("COMMON_BTN_SAVE")+"</button></div></div></div><div id='type-template-report' data-bind='invisible:popupMain.reportTypeGeneral'><div id='report-mainpopup-header' class='template'><div class='mainpopup-header-box'><div><div class='header-left-box'><div class='align-middle' ><div class='popupview-text-box' style='width: 170px;' data-bind='visible:popupMain.viewMode, text:popupMainCotent.Header.text, value:popupMainCotent.Header.value'></div><input data-role='dropdownlist' style='width: 170px;' data-text-field='text' data-value-field='value' data-bind='visible:popupMain.editMode, enabled:popupMainCotent.Header.enabled, source:popupMainCotent.Header.ddlDs, value:popupMainCotent.Header.value, events: {change: popupMain.reportTypeChangeEvt}'></input></div></div><div class='header-right-box'><div class='align-middle'><div class='header-template-name' data-bind='value:popupMainCotent.Main.name.value, text:popupMainCotent.Main.name.value, events:{click:popupMain.templateNameClickEvt, change:popupMainCotent.Main.name.change}'></div></div><form id='excel-file-frm'><input name='file' type='file' id='excel-file-input' accept='.csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel' data-bind='events:{change:popupMain.fileChange}'/></form></div></div></div></div><div id=report-mainpopup-contain class='mainpopup-template-contain' data-bind='style: {height: popupMain.containTemplateHeight}'><p>&ensp;</p><p class='contain-text' style='font-size: 20px;'>"+v.prop("REPORT_REPORT_POPUP_TEMPLATE_CONTENT1")+"</p><p class='contain-text' style='font-size: 20px;'>"+v.prop("REPORT_REPORT_POPUP_TEMPLATE_CONTENT2")+"</p><p>&ensp;</p><ul class='cotain-ul-style'><li>"+v.prop("REPORT_REPORT_POPUP_TEMPLATE_CONTENT3")+"</li><li>"+v.prop("REPORT_REPORT_POPUP_TEMPLATE_CONTENT4")+"</li><li>"+v.prop("REPORT_REPORT_POPUP_TEMPLATE_CONTENT5")+"</li><li>"+v.prop("REPORT_REPORT_POPUP_TEMPLATE_CONTENT6")+"</li><li>"+v.prop("REPORT_REPORT_POPUP_TEMPLATE_CONTENT7")+"</li></ul><p>&ensp;</p><p class='contain-text notice-color'>"+v.prop("REPORT_REPORT_POPUP_TEMPLATE_CONTENT8")+"</p><p class='contain-text notice-color'>"+v.prop("REPORT_REPORT_POPUP_TEMPLATE_CONTENT9")+"</p></div><div id='report-mainpopup-footer'><div id='auto-report-content'><div class='autoGenerate-checkbox-box'><input id='autoGenerate-checkbox' class='k-checkbox' type='checkbox' data-bind='events: {change:popupMainCotent.Footer.autoGenerate.change}, disabled:autoCreateReportDisabled, visible:popupMain.editMode, checked: popupMainCotent.Footer.autoGenerate.value'></input> <label for='autoGenerate-checkbox' class='k-checkbox-label' data-bind='visible:popupMain.editMode, disabled:autoCreateReportDisabled'><span display=''></span></label> <span class='autoGenerate-checkbox-text' data-bind='visible:popupMain.editMode, disabled:autoCreateReportDisabled'>"+v.prop("REPORT_REPORT_POPUP_AUTO_CREATE_TITLE")+"</span><span class='autoGenerate-text-title' data-bind='visible:popupMain.viewMode, text:popupMainCotent.Footer.autoGenerate.text'></span></div><div class='schedule-view-box' data-bind='visible:popupMain.viewMode'><div class='schedule-interval'><div class='popupview-text-box' data-bind='visible:popupMain.viewMode, text:popupMainCotent.Footer.autoGenerateInterval.text', value: popupMainCotent.Footer.autoGenerateInterval.value></div></div><div class='schedule-time'><div class='popupview-text-box' data-bind='visible:popupMain.viewMode, text:popupMainCotent.Footer.autoGenerateTime.text, value: popupMainCotent.Footer.autoGenerateTime.value'></div></div><div><button class='report-list-btn popupview-text-box' data-role='button' data-bind='events:{click:popupMain.reportListEvt}, enabled: popupMain.reportListBtnMode' style='line-height:0px'>"+v.prop("REPORT_REPORT_LIST")+"</button></div></div><div class='schedule-edit-box' data-bind='visible:popupMain.editMode'><div class='schedule-interval'><input id='template-schedule-interval-dropdownlist' style='width: 178px;' data-role='dropdownlist' data-option-label='"+v.prop("REPORT_REPORT_GENERATION_INTERVAL")+"' data-text-field='text' data-value-field='value' data-bind='enabled: popupMainCotent.Footer.autoGenerate.value, visible:popupMain.editMode, source:popupMainCotent.Footer.autoGenerateInterval.ddlDs, events:{change:popupMainCotent.Footer.autoGenerateInterval.change}, value: popupMainCotent.Footer.autoGenerateInterval.value'></input></div><div class='schedule-time'><input id='template-schedule-time-dropdownlist' style='width: 178px;' data-role='dropdownlist' data-option-label='"+v.prop("REPORT_REPORT_GENERATION_POINT")+"' data-text-field='text' data-value-field='value' data-bind='events: {change:popupMainCotent.Footer.autoGenerateTime.change}, enabled: popupMainCotent.Footer.autoGenerate.value, visible:popupMain.editMode, source:popupMainCotent.Footer.autoGenerateTime.ddlDs, value: popupMainCotent.Footer.autoGenerateTime.value'></input></div><div><button class='report-list-btn' data-role='button' data-bind='events:{click:popupMain.reportListEvt}, enabled: popupMain.reportListBtnMode'>"+v.prop("REPORT_REPORT_LIST")+"</button></div></div></div><div id='action-button-cotent'><button data-role='button' class='action-button-edit' value='edit' data-bind='events:{click:popupMain.editViewChange}, visible:popupMain.btnActionStatus[0]'>"+v.prop("REPORT_REPORT_POPUP_EDIT")+"</button><button data-role='button' class='action-button-close' data-bind='events:{click:popupMain.closeEvt}, visible:popupMain.btnActionStatus[1]'>"+v.prop("REPORT_REPORT_POPUP_CLOSE")+"</button><button data-role='button' class='action-button-cancle' value='view' data-bind='events:{click:popupMain.editViewChange}, visible:popupMain.btnActionStatus[2]'>"+v.prop("REPORT_REPORT_POPUP_CANCLE")+"</button><button data-role='button' class='action-button-save' data-bind='enabled:popupMain.saveVailator, visible:popupMain.btnActionStatus[3], events:{click:popupMain.saveEvt}'>"+v.prop("COMMON_BTN_SAVE")+"</button><button data-role='button' class='action-button-fileadd' data-bind='visible:popupMain.btnActionStatus[4], events:{click:popupMain.fileClick}'>"+v.prop("REPORT_REPORT_POPUP_FILE_ADD_BTN")+"</button></div></div></div></div>",onOpen:function(){},onClose:function(){i(),f()},editViewChange:function(e){var t=e.sender.element.val();"view"===t?function(){var e=T.popupMainCotent;if(e.Header.get("value")!==e.Header.get("oldValue")||T.popupMain.get("reportTypeGeneral")!==T.popupMain.get("oldReportTypeGeneral")||e.Main.duration.get("value")!==e.Main.duration.get("oldValue")||e.Main.dmsType.get("value")!==e.Main.dmsType.get("oldValue")||JSON.stringify(e.Main.dmsGrid.get("selectedData"))!==JSON.stringify(e.Main.dmsGrid.get("oldSelectedData"))||e.Main.interval.get("value")!==e.Main.interval.get("oldValue")||e.Main.startDate.get("value")!==e.Main.startDate.get("oldValue")||e.Main.startTime.get("value")!==e.Main.startTime.get("oldValue")||e.Main.endDate.get("value")!==e.Main.endDate.get("oldValue")||e.Main.endTime.get("value")!==e.Main.endTime.get("oldValue")||e.Footer.autoGenerate.get("value")!==e.Footer.autoGenerate.get("oldValue")||e.Footer.autoGenerateInterval.get("value")!==e.Footer.autoGenerateInterval.get("oldValue")||e.Footer.autoGenerateTime.get("value")!==e.Footer.autoGenerateTime.get("oldValue")||e.Main.name.get("value")!==e.Main.name.get("oldValue")){$("#popup-cancle-confrim").data("kendoCommonDialog").open()}else o("view")}():o(t)},closeEvt:function(e){s()},saveEvt:function(e){!function(e){r.open($("#report-main-popup"));var t,a,i=$("#popup-validation-confrim").data("kendoCommonDialog"),o=T.popupMainCotent.Header.get("value");if("General"===o)a=P(!0),(t=d(a)).chkValidation?_.saveDataAjax(a,e).done(function(){}).fail(function(){}).always(function(){s(),_.reportGridAjaxData().done(function(e,t){p.contentGrid[0].set("GriddataSource",e),t&&p.topMenu[2].set("isEnabled",!1)}).fail(function(){}).always(function(){r.close()})}):(i.message(t.errorMsg),i.open(),r.close());else if("Template"===o)if(a=P(!0),(t=d(a)).chkValidation){var n=T.popupMain.stateMode;_.fileAjax(a,n).done(function(){}).fail(function(){}).always(function(){_.reportGridAjaxData().done(function(e,t){p.contentGrid[0].set("GriddataSource",e),t&&p.topMenu[2].set("isEnabled",!1)}).fail(function(){}).always(function(){r.close()}),s()})}else i.message(t.errorMsg),i.open(),r.close()}(this.popupMain.get("stateMode"))},fileAddEvt:function(e){"create"===this.popupMain.stateMode?$("#popup-excel-file").data("kendoDialog").open():"edit"===this.popupMain.stateMode&&$("#popup-file-change-confrim").data("kendoCommonDialog").open()},reportListEvt:function(e){c()},templateNameClickEvt:function(e){r.open($("#report-main-popup"));var t=this.popupMainCotent.id;_.fileGetAjax(t).done(function(e,t){O(e,t)}).fail(function(){}).always(function(){r.close()})},fileClick:function(e){"create"===this.popupMain.stateMode?$("#excel-file-input").click():"edit"===this.popupMain.stateMode&&$("#popup-file-change-confrim").data("kendoCommonDialog").open()},fileChange:function(){var e=$("#excel-file-input")[0].files[0],t=$("#popup-validation-confrim").data("kendoCommonDialog"),a=T.popupMainCotent;if(void 0!==e){var i=e.name;if(-1!=i.indexOf(".xlsx"))if(i.length<=30){this.popupMain.set("fileName",e.name);var o=_.formDataProcessingFunc(),n=this.popupMain.get("fileName");a.Main.name.set("value",n),a.Main.file.set("value",o),M()}else $("#excel-file-input").val(""),(t=$("#popup-validation-confrim").data("kendoCommonDialog")).message(v.prop("REPORT_REPORT_POPUP_FILE_EXCEL_VALIDATION_NAME_FALSE")),t.open();else(t=$("#popup-validation-confrim").data("kendoCommonDialog")).message(v.prop("REPORT_REPORT_POPUP_FILE_EXCEL_VALIDATION_FALSE")),t.open()}else f()}},popupReportList:{type:"reportListPopup",id:"report-list-popup",isVisible:!1,isDeleteVisible:!1,title:v.prop("REPORT_REPORT_POPUP_TITLE_DETAIL"),width:560,height:820,content:"<div><div class='auto-create-title'><span>"+v.prop("REPORT_REPORT_POPUP_AUTO_CREATE_LIST")+"</span><span class='popup-close-btn' style='margin-top: 6px;' data-bind='events:{click:popupReportList.closeEvt}'></span></div><div></div><div><div data-template='report-menu-template' data-bind='source:popupReportList.grid'></div></div><div class='report-list-button-box'><button data-role='button' class='report-list-button-delete' data-bind='enabled:popupReportList.isDeleteVisible, events:{click:popupReportList.deleteEvt}'>"+v.prop("REPORT_REPORT_DELETE_BTN")+"</button><button data-role='button' class='report-list-button-close' data-bind='events:{click:popupReportList.closeEvt}'>"+v.prop("REPORT_REPORT_POPUP_CLOSE")+"</button></div></div>",onOpen:function(){},onClose:function(){},deleteEvt:function(e){r.open($("#report-list-popup"));var t=$("#report-list-grid").data("kendoGrid").getCheckedData();_.deleteAutoCreateReportList(T.popupMainCotent.id,t).done(function(){c()}).fail(function(){}).always(function(){})},closeEvt:function(e){$("#report-list-popup").data("kendoDialog").close()},grid:{id:"report-list-grid",type:"reportListGrid",class:"",height:680,columns:"[{ 'hidden': true, 'field': 'hidden'},{ 'sortable': true, 'width': 350, 'field': 'id', 'title': '"+v.prop("REPORT_REPORT_POPUP_CREATION_TIME")+"'},{ 'template': '<button class=grid-download-btn data-bind=events:{click:options.clickAutoReportDownload}>"+v.prop("REPORT_REPORT_GRID_COLUMNS_DOWNLOAD")+"</button>', 'sortable': false, 'field': 'download', 'title': ' '}]",GriddataSource:new t.data.DataSource({schema:{model:{fields:{Id:{type:"string"},creationTime:{type:"string"}}}}}),disabled:!1,isEnabled:!0,scrollable:!0,groupable:!1,sortable:!0,filterable:!1,pageable:!1,hasCheckedModel:!0,setCheckedAttribute:!0,options:{clickAutoReportDownload:function(e){r.open($("#report-list-popup"));var t=T.popupMainCotent.get("id");_.autoGeneratedReportDownload(t,e.data.id).done(function(e,t){O(e,t)}).fail(function(){}).always(function(){r.close()})}}}},popupDeleteConfrim:{id:"popup-delete-confrim",type:"confirm",title:v.prop("REPORT_REPORT_POPUP_DELETE_CONFRIM_TITLE"),message:v.prop("REPORT_REPORT_POPUP_DELETE_CONFRIM_CONTENT"),width:560,height:250},popupDmsTypeConfrim:{id:"popup-dmstype-confrim",type:"confirm",title:v.prop("REPORT_REPORT_POPUP_DMSTYPE_CONFRIM_TITLE"),message:v.prop("REPORT_REPORT_POPUP_DMSTYPE_CONFRIM_CONTENT"),width:560,height:250},popupCancleConfrim:{id:"popup-cancle-confrim",type:"confirm",title:v.prop("REPORT_REPORT_POPUP_CANCLE_CONFRIM_TITLE"),message:v.prop("REPORT_REPORT_POPUP_CANCLE_CONFRIM_CONTENT"),width:560,height:250},popupValidationContrim:{id:"popup-validation-confrim",type:"message",title:v.prop("REPORT_REPORT_POPUP_VALIDATION_CONFRIM_TITLE"),message:"",width:560,height:250},popupErrorMessage:{id:"popup-error-message",type:"message",title:v.prop("REPORT_REPORT_POPUP_VALIDATION_CONFRIM_TITLE"),message:"",width:560,height:250},popupFileChangeConfrim:{id:"popup-file-change-confrim",type:"confirm",title:v.prop("REPORT_REPORT_POPUP_FILE_CHANGE_CONFRIM_TITLE"),message:v.prop("REPORT_REPORT_POPUP_FILE_CHANGE_CONFRIM_CONTENT"),width:560,height:250}});function R(e){var t=void 0===e.sender?e:e.sender.value();T.popupMainCotent.Footer.autoGenerateTime.set("ddlDs",_.generalIntervalDDLDataProcessing(t)),M()}function m(e){var t=$("#report-group-list").data("kendoCommonGroupList"),a=$("#report-group-list"),i=$(t.assignedGroupList.element),o=$(t.deAssignedGroupList.element);D(),e?(t.setOptions({height:335}),a.height(335),i.height(335),o.height(335),t.hideEditMode(!0),$("#report-group-list > div > div.contents.edit > div.content.btn-group > div > div > button.deassign").text("<"),$("#report-group-list > div > div.contents.edit > div.content.btn-group > div > div > button.assign").text(">")):(t.setOptions({height:387}),a.height(387),i.height(387),o.height(387),t.hideEditMode(!1))}function o(e){var t=T.popupMain,a=T.popupMainCotent;"view"===e?(t.set("stateMode","view"),t.set("viewMode",!0),t.set("editMode",!1),t.set("createMode",!1),t.set("saveVailator",!1),a.Footer.autoGenerate.get("value")?t.set("reportListBtnMode",!0):t.set("reportListBtnMode",!1),m(!0)):"edit"===e?(t.set("stateMode","edit"),t.set("viewMode",!1),t.set("editMode",!0),t.set("createMode",!1),t.set("reportListBtnMode",!1),m(!1),g(!1)):"create"===e&&(t.set("stateMode","create"),t.set("viewMode",!1),t.set("editMode",!0),t.set("createMode",!0),t.set("reportListBtnMode",!1),m(!1)),function(e){if("view"!==e){"Custom"===T.popupMainCotent.Main.duration.get("value")?T.popupMain.set("dateCustomMode",!0):T.popupMain.set("dateCustomMode",!1)}else T.popupMain.set("dateCustomMode",!1)}(e),function(){for(var e=$("#interval-listview div"),t=0;t<e.length;t++)$(e[t]).css("text-align",T.popupMainCotent.Main.intervalGrid.changeTextAlian())}(),t.titleTextChange(),t.btnViewEditMode(e)}function u(e,t){var a=_.intervalSetDataProcessing(e,{startDate:t.startDate,endDate:t.endDate});if(T.popupMainCotent.Main.interval.set("ddlDs",a),""!==a){var i=T.popupMainCotent.Main.interval.get("value");T.popupMainCotent.Main.interval.set("value",a[0].value);for(var o=0;o<a.length;o++)if(a[o].value===i){T.popupMainCotent.Main.interval.set("value",a[o].value);break}}T.popupMainCotent.Main.interval.change(T.popupMainCotent.Main.interval.get("value"))}function i(e){var t;t=void 0===e?_.popupResetData:e;var a=T.popupMainCotent,i=t.originData,o=t.processingData[0],n=T.popupMain,r=["value","oldValue"],p=["text","oldText"],d=["gridDs","oldDs"],s=["reportTypeGeneral","oldReportTypeGeneral"],l=r.length;D(),a.set("id",i.id);for(var u=0;u<l;u++)a.Header.set(r[u],i.type),a.Main.duration.set(r[u],i.duration),a.Main.dmsType.set(r[u],i.dms_devices_type),a.Main.interval.set(r[u],i.interval),a.Main.startDate.set(r[u],o.startDate),a.Main.startTime.set(r[u],o.startTime),a.Main.endDate.set(r[u],o.endDate),a.Main.endTime.set(r[u],o.endTime),a.Footer.autoGenerate.set(r[u],i.autoGenerate),a.Footer.autoGenerateInterval.set(r[u],i.autoGenerateInterval),a.Footer.autoGenerateTime.set(r[u],i.autoGenerateTime),a.Header.set(p[u],o.type),a.Main.duration.set(p[u],o.duration),a.Main.dmsType.set(p[u],o.dms_devices_type),a.Main.interval.set(p[u],o.interval),a.Main.intervalGrid.set(d[u],_.popupIntervalGridDataProcessing(i.interval,a.Main.startDate.get("value"),a.Main.startTime.get("value"),a.Main.endDate.get("value"),a.Main.endTime.get("value"))),a.Footer.autoGenerate.set(p[u],o.autoGenerate),a.Footer.autoGenerateInterval.set(p[u],o.autoGenerateInterval),a.Footer.autoGenerateTime.set(p[u],o.autoGenerateTime),a.Main.name.set(r[u],i.name),n.set(s[u],"General"===i.type);var c=$("div[data-role=commongrouplist]").data("kendoCommonGroupList");c.data(o.devices),m("view"===n.get("stateMode")),a.Main.dmsGrid.set("oldDs",o.devices),a.Main.dmsGrid.set("selectedData",c.getAssignedItems()),a.Main.dmsGrid.set("oldSelectedData",c.getAssignedItems()),void 0!==a.Footer.autoGenerateInterval.get("value")&&R(a.Footer.autoGenerateInterval.get("value")),"create"===n.get("stateMode")?a.Header.set("enabled",!0):a.Header.set("enabled",!1),"Template"===a.Header.get("value")?g(!0):g(!1),a.Footer.autoGenerate.get("value")?n.set("reportListBtnMode",!0):n.set("reportListBtnMode",!1),D(),$("#report-group-list .k-grid-content.k-auto-scrollable").scrollTop(0),function(){for(var e={id:["#duration-dropdownlist","#dms-devices-type-dropdownlist","#report-type-ddl","#report-interval-ddl"],text:["REPORT_REPORT_PLACEHOLDER_REPORT_DURATION","REPORT_REPORT_PLACEHOLDER_REPORT_DMS_TYPE","REPORT_REPORT_PLACEHOLDER_REPORT_DMS_TYPE","REPORT_REPORT_PLACEHOLDER_REPORT_INTERVAL"]},t=0;t<e.id.length;t++){var a=$(e.id[t]).data("kendoDropDownList");a.setOptions({optionLabel:v.prop(e.text[t])}),a.setOptions({optionLabel:""})}}(),n.set("saveVailator",!1)}function d(e){var t=!1,a="";if(void 0===e&&(e=P()),"General"===e.type)void 0===e.type||""===e.type?a=v.prop("REPORT_REPORT_POPUP_VALIDATION_TYPE_MESSAGE"):void 0===e.name||""===e.name?a=v.prop("REPORT_REPORT_POPUP_VALIDATION_TITLE_MESSAGE"):void 0===e.dms_devices_type||""===e.dms_devices_type?a=v.prop("REPORT_REPORT_POPUP_VALIDATION_DMSTYPE_MESSAGE"):void 0===e.duration||""===e.duration?a=v.prop("REPORT_REPORT_POPUP_VALIDATION_DURATION_MESSAGE"):void 0===e.interval||""===e.interval?a=v.prop("REPORT_REPORT_POPUP_VALIDATION_INTERVAL_MESSAGE"):e.devices<=0?a=v.prop("REPORT_REPORT_POPUP_VALIDATION_DEVICE_MESSAGE"):t=!0,"Custom"===e.duration&&(void 0===e.startTime||""===e.startTime?(a=v.prop("REPORT_REPORT_POPUP_VALIDATION_START_TIME_MESSAGE"),t=!1):void 0!==e.endTime&&""!==e.endTime||(a=v.prop("REPORT_REPORT_POPUP_VALIDATION_END_TIME_MESSAGE"),t=!1)),!0===e.autoGenerate&&(void 0===e.autoGenerateInterval||""===e.autoGenerateInterval?(a=v.prop("REPORT_REPORT_POPUP_VALIDATION_AUTO_GENERATE_IMTERVAL_MESSAGE"),t=!1):void 0!==e.autoGenerateTime&&""!==e.autoGenerateTime||(a=v.prop("REPORT_REPORT_POPUP_VALIDATION_AUTO_GENERATE_TIME_MESSAGE"),t=!1));else if("Template"===e.type){void 0===e.type||""===e.type?a=v.prop("REPORT_REPORT_POPUP_VALIDATION_TYPE_MESSAGE"):void 0===e.name||""===e.name?a=v.prop("REPORT_REPORT_POPUP_VALIDATION_TITLE_MESSAGE"):t=!0,!0===e.autoGenerate&&(void 0===e.autoGenerateInterval||""===e.autoGenerateInterval?(a=v.prop("REPORT_REPORT_POPUP_VALIDATION_AUTO_GENERATE_IMTERVAL_MESSAGE"),t=!1):void 0!==e.autoGenerateTime&&""!==e.autoGenerateTime||(a=v.prop("REPORT_REPORT_POPUP_VALIDATION_AUTO_GENERATE_TIME_MESSAGE"),t=!1)),"undefined"!==T.popupMain.get("fileName")&&""!==e.excelFileName||(t=!1)}return{chkValidation:t,errorMsg:a}}function n(e){r.open($("#report-main-popup"));var t=$("div[data-role=commongrouplist]").data("kendoCommonGroupList"),a=T.popupMainCotent.Main.dmsType,i=a.get("value");a.set("prevValue",i),_.dmsTypeRefershData(i).done(function(e){t.data(e),T.popupMainCotent.Main.dmsGrid.set("selectedData",t.getAssignedItems())}).fail(function(){}).always(function(){r.close(),M()})}function s(){$("#report-main-popup").data("kendoDialog").close()}function c(){r.open($("#report-main-popup")),_.autoCreateReportListAjaxData(T.popupMainCotent.id).done(function(e){T.popupReportList.grid.set("GriddataSource",e)}).fail(function(){}).always(function(){$("#report-list-popup").data("kendoDialog").open(),r.close()})}function E(e,t){var a,i=T.popupMainCotent.Main,o="startDate"!==e?i.startDate.get("value"):t,n="endDate"!==e?i.endDate.get("value"):t,r="startTime"!==e?i.startTime.get("value"):t,p="endTime"!==e?i.endTime.get("value"):t,d=new Date(l(o).format("YYYY-MM-DD")+"T"+l(r).format("HH:mm")),s=new Date(l(n).format("YYYY-MM-DD")+"T"+l(p).format("HH:mm"));!1===_.dateDataOverCheck(s)&&(t=s=new Date(l().format("YYYY-MM-DD")+"T"+l(_.timeDataProcessing(new Date)).format("HH:mm")),i.endTime.set("value",new Date(l(s).format("YYYY-MM-DDTHH:mm")))),_.checkDateTimePicker(d,s)?_.dateDataOneYearOverCheck(d,s)?(i[e].set("value",new Date(l(_.timeDataProcessing(t)).format())),i[e].set("oldValue",new Date(l(_.timeDataProcessing(t)).format()))):i.startDate.set("value",new Date(l(s).subtract(1,"year").format("YYYY-MM-DDTHH:mm"))):(a=i[e].get("oldValue"),i[e].set("value",a)),u("Custom",{startDate:o,endDate:n})}function f(){var e=$("#excel-file-input");e.replaceWith(e.val("").clone(!0)),$("#excel-file-label").text("")}function M(e){d().chkValidation?T.popupMain.set("saveVailator",!0):T.popupMain.set("saveVailator",!1)}function P(e){var t=T.popupMainCotent,a={};return a.type=t.Header.get("value"),"General"===a.type?(a.id=t.get("id"),a.name=t.Main.name.get("value"),a.dms_devices_type=t.Main.dmsType.get("value"),a.duration=t.Main.duration.get("value"),a.startTime=l(new Date(l(t.Main.startDate.get("value")).format("YYYY-MM-DD")+"T"+l(t.Main.startTime.get("value")).format("HH:mm:ss"))).format(),a.endTime=l(new Date(l(t.Main.endDate.get("value")).format("YYYY-MM-DD")+"T"+l(t.Main.endTime.get("value")).format("HH:mm:ss"))).format(),a.interval=t.Main.interval.get("value"),a.autoGenerate=t.Footer.autoGenerate.get("value"),a.autoGenerateInterval=t.Footer.autoGenerateInterval.get("value"),a.autoGenerateTime=t.Footer.autoGenerateTime.get("value"),a.devices=e?_.getAssignedItem():_.getAssignedItemCheck()):"Template"===a.type&&(a.id=t.get("id"),a.name=t.Main.name.get("value"),a.file=t.Main.file.get("value"),a.autoGenerate=t.Footer.autoGenerate.get("value"),a.autoGenerateInterval=t.Footer.autoGenerateInterval.get("value"),a.autoGenerateTime=t.Footer.autoGenerateTime.get("value")),$.each(a,function(e,t){void 0!==t&&""!==t||delete a[e]}),a}function O(e,t){t=void 0===t?"report.xlsx":t;var a=document.createElement("a");a.href=window.URL.createObjectURL(e),a.download=t,a.click()}function g(e){var t=T.popupMainCotent,a=T.popupMain;"Custom"===t.Main.duration.get("value")&&(e=!0),a.set("autoCreateReportDisabled",e),e&&t.Footer.autoGenerate.set("value",!1)}function D(){$("#report-group-list .contents.edit .k-grid-content.k-auto-scrollable").scrollTop(0)}return{MainViewModel:p,PopupViewModel:T,deleteReportData:function(){r.open();var e=$("#report-content-grid").data("kendoGrid").getCheckedData();_.deleteReportAjaxData(e).done(function(){r.open(),_.reportGridAjaxData().done(function(e,t){p.contentGrid[0].set("GriddataSource",e),t?p.topMenu[2].set("isEnabled",!1):p.topMenu[2].set("isEnabled",!0)}).fail(function(){}).always(function(){r.close()})}).fail(function(){}).always(function(){r.close()})},popupDmsTypeNo:function(e){var t=T.popupMainCotent.Main.dmsType;t.set("value",t.get("prevValue"))},popupDmsTypeYes:n,ModeChange:o,popupCancleYes:function(e){var t=T.popupMainCotent,a=T.popupMain;t.Header.set("value",t.Header.get("oldValue")),a.set("value",t.Header.get("oldValue")),a.set("reportTypeGeneral",a.get("oldReportTypeGeneral")),t.Main.duration.set("value",t.Main.duration.get("oldValue")),t.Main.dmsType.set("value",t.Main.dmsType.get("oldValue")),t.Main.interval.set("value",t.Main.interval.get("oldValue")),t.Main.startDate.set("value",t.Main.startDate.get("oldValue")),t.Main.startTime.set("value",t.Main.startTime.get("oldValue")),t.Main.endDate.set("value",t.Main.endDate.get("oldValue")),t.Main.endTime.set("value",t.Main.endTime.get("oldValue")),t.Footer.autoGenerate.set("value",t.Footer.autoGenerate.get("oldValue")),t.Footer.autoGenerateInterval.set("value",t.Footer.autoGenerateInterval.get("oldValue")),t.Footer.autoGenerateTime.set("value",t.Footer.autoGenerateTime.get("oldValue")),t.Header.set("text",t.Header.get("oldText")),t.Main.duration.set("text",t.Main.duration.get("oldText")),t.Main.dmsType.set("text",t.Main.dmsType.get("oldText")),t.Main.interval.set("text",t.Main.interval.get("oldText")),t.Main.intervalGrid.set("text",t.Main.intervalGrid.get("oldText")),t.Footer.autoGenerateInterval.set("text",t.Footer.autoGenerateInterval.get("oldText")),t.Footer.autoGenerateTime.set("text",t.Footer.autoGenerateTime.get("oldText")),t.Main.name.set("value",t.Main.name.get("oldValue")),t.Main.file.set("value",t.Main.file.get("oldValue")),$("#excel-file-input").val("");var i=$("div[data-role=commongrouplist]").data("kendoCommonGroupList");t.Main.dmsGrid.set("selectedData",t.Main.dmsGrid.get("oldSelectedData")),i.data(t.Main.dmsGrid.get("oldDs")),m(!0),o("view")},fileChangeConfrimYes:function(){$("#popup-file-change-confrim").data("kendoCommonDialog").close(),$("#excel-file-input").click()},saveConfrimValidator:M}}),define("history/report/report",["history/report/viewmodel/report-vm","history/report/model/report-model"],function(e,t){var o,n=window.I18N,a=window.kendo,i=new window.CommonLoadingPanel,p=e,d=t,s=p.MainViewModel,l=p.PopupViewModel,r=$("#report-common-tab"),u=function(){$("#popup-delete-confrim").data("kendoCommonDialog").setConfirmActions({yes:p.deleteReportData,no:function(){return!0}}),$("#popup-dmstype-confrim").data("kendoCommonDialog").setConfirmActions({yes:p.popupDmsTypeYes,no:p.popupDmsTypeNo}),$("#popup-cancle-confrim").data("kendoCommonDialog").setConfirmActions({yes:p.popupCancleYes,no:function(){return!0}});var e=$("#popup-file-change-confrim").data("kendoCommonDialog");$(e.buttons[0][0]).text(n.prop("REPORT_REPORT_POPUP_CANCLE")),$(e.buttons[1][0]).text(n.prop("REPORT_REPORT_POPUP_CONFIRM")),e.setConfirmActions({yes:p.fileChangeConfrimYes,no:function(){return!0}});var t=$("#popup-title-input");t.kendoCommonValidator({type:"name"}).data("kendoCommonValidator"),t.keyup(function(e){$(this).data("kendoCommonValidator").validate()||(e.target.value=e.target.value.substring(0,30))});var a=$("#report-content-grid").data("kendoGrid");a.bind("checked",function(e){a.getCheckedData().length<=0?s.topMenu[1].set("isEnabled",!1):s.topMenu[1].set("isEnabled",!0)});var i=$("#report-list-grid").data("kendoGrid");i.bind("checked",function(e){i.getCheckedData().length<=0?l.popupReportList.set("isDeleteVisible",!1):l.popupReportList.set("isDeleteVisible",!0)});var r=$("#report-group-list").kendoCommonGroupList({width:995,columns:[{title:"\uae30\uae30\uc18d\uc131\uac12",field:"dms_reports_view_properties",template:function(e){return"foundation_space_buildings_id"===(t=e).field?d.getCurrentBuildingList(t.value):"foundation_space_floors_id"===t.field?d.getCurrentFloorList(t.value):"dms_devices_id"===t.field?o[t.value]:void 0!==t.dms_reports_view_properties?n.prop("REPORT_REPORT_"+t.dms_reports_view_properties.toUpperCase()):"-";var t}}],showEditListHeader:!1,checkedLimit:200,onceExpandParentLevel:1,group:[{field:"foundation_space_buildings_id"},{field:"foundation_space_floors_id"},{field:"dms_devices_id"}],showNormalMode:!1,change:function(e){p.saveConfrimValidator()}}).data("kendoCommonGroupList");r.bind("change",function(e){l.popupMainCotent.Main.dmsGrid.set("selectedData",r.getAssignedItems()),200<=e.assignedItems.length&&r.setButtonState(!1,0)}),r.deAssignedGroupList.bind("checked",function(e){var t=r.deAssignedGroupList.getCheckedData(),a=t.length,i=r.getAssignedItems().length+t.length;if(200<i){var o=i-200;o=o>t.length?t.length:o;for(var n=1;n<=o;n++)r.deAssignedGroupList.checkById(t[a-n].id,!1)}}),$("#report-group-list .k-button.deassign").on("click",function(){p.saveConfrimValidator()}),$("#report-group-list .k-button.assign").on("click",function(){p.saveConfrimValidator()}),$($(".minute[data-role=dropdownlist]")[0]).data("kendoDropDownList").enable(!1),$($(".minute[data-role=dropdownlist]")[1]).data("kendoDropDownList").enable(!1)},c=function(){$("#search-input-text").on("keydown",function(e){13==e.keyCode&&s.topSearch[0].keyPressEnterEvt(e)})};window.MAIN_WINDOW.disableFloorNav(!0),a.bind(r,s),d.dmsTypeDataGet().done(function(){o=d.mappingDevicesName}),d.reportGridAjaxData().done(function(e,t){s.contentGrid[0].set("GriddataSource",e),t?s.topMenu[2].set("isEnabled",!1):s.topMenu[2].set("isEnabled",!0)}).fail(function(e){d.errorCheck(e)}).always(function(){i.close()}),a.bind($("#report-popup-box"),l),u(),c()});