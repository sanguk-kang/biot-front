window.GlobalSettings.loadSettings(!0).always(function(){$(document).ready(function(){"use strict";var i=$("#main"),r=window.I18N,d=window.Util,a=new window.CommonLoadingPanel;a.open(i);var l,e=$(".signup-contents-formfieldset"),t=e.find(".signup-form-block").find(".signup-field"),s=$("#signup-join"),c=$("#signup-cancel"),o=r.prop("COMMON_FRONT_END_URL"),p=$("<div/>"),u={},m={id:null,password:null,passwordRetype:null,name:null,mobilePhoneNumber:null,email:null},n=function(){var n,o;for(n in e.on("click",".signup-form-block .signup-input-remove",f),u)"text"!=(o=m[n].attr("type"))&&"password"!=o&&"tel"!=o&&"email"!=o||m[n].on("keyup",w);s.on("click",g),c.on("click",v)},f=function(){var n=$(this),o=n.data("target"),e=$("#"+o);return e.val(""),e.data("kendoCommonValidator").validate(),n.hide(),!1},w=function(){var n=$(this),o=n.siblings(".signup-input-remove");n.val()?o.is(":visible")||o.show():o.hide()},g=function(){var n,t,o=!0,s={};for(n in u){if(!u[n].validate()){o=!1;break}var e=u[n].element.val();"passwordRetype"!=n&&e&&(s[n]=e)}o&&(s.role="Manager",a.open(i),k(s).done(function(){l.message(r.prop("COMMON_SIGN_UP_RESULT")),l.open(),setTimeout(function(){O()},2e3)}).fail(function(n){var o=n.responseJSON,e=n.responseText;if(e&&-1!=e.indexOf("access_denied")&&-1!=e.indexOf("is currently locked out for"))return t=r.prop("COMMON_SIGNIN_LOCKED",s.id),l.message(t),void l.open(t);if(o){var i=o.code,a=o.message;400==i?-1!=a.indexOf("password")?u.password.validate("incorrect",!0):-1!=a.indexOf("id")||u.password.validate("incorrectBoth",!0):500==i?(l.message("[Error Code : "+i+"] "+a),l.open()):211301==i?u.id.validate("alreadyUse",!0):211303==i&&(t=r.prop("MEMBERSHIP_MAXIMUM_NUMBER"),l.message(t),l.open(),setTimeout(function(){O()},5e3))}else t=d.parseFailResponse(n),l.message(t),l.open()}).always(function(){a.close()}))},v=function(){O()},k=function(n){return $.ajax({url:"/ums/signup",method:"POST",data:n})},O=function(){var n=window.location.protocol+"//"+window.location.host+o+"/signin";window.location.href=n};(function(){var n,o,e,i;t.each(function(){n=$(this),o=n.data("key"),m[o]=n,"text"!=(e=n.attr("type"))&&"password"!=e&&"tel"!=e&&"email"!=e||("password"==((i={}).type=o)&&(i.mixedPasswordCheck=!0),u[o]=n.kendoCommonValidator(i).data("kendoCommonValidator"))}),p.kendoCommonDialog(),l=p.data("kendoCommonDialog")})(),n(),a.close()})});