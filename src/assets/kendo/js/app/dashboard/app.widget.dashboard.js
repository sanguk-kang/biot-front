!function(u,m){var o=u.moment,g=u.kendo,A=u.Util,h={network:{cards:[{width:2,height:2,refreshUrl:"/alarms?types=NetworkError",menuUrl:"/operation/alarm",template:"<div class='dashboard-body-content dashboard-network-error-2x2'><div class='dashboard-network-error-2x2-label'><p class='key' data-bind='text : key'></p></div><div class='dashboard-network-error-2x2-value'><p class='value' data-bind='text : value'></p></div></div>",viewModel:{key:"Network Error",value:0},parseData:function(e){this.viewModel.set("value",e.length)}},{width:4,height:6,refreshUrl:"/alarms?types=NetworkError&sort=-eventTime",menuUrl:"/operation/alarm",template:"<div class='dashboard-body-content dashboard-network-error-4x6'><ul data-template='dashboard-network-ul-template' data-bind='source: list' class='dashboard-list'></ul><script id='dashboard-network-ul-template' type='text/x-kendo-template'><li class='dashboard-list-item'><div class='img cell'><span class='detail-img gray  #=deviceType#'/></div><div class='desc cell'><p class='desc-text' data-bind='text: description'></p><p class='desc-date' data-bind='text: eventTime'></p></div><div class='location cell'><p class='location-floor'><span data-bind='text: building'></span>, <span data-bind='text: floor'></span></p><p class='location-zone'><span data-bind='text: zone'></span></p></div></li><\/script>",otherTemplates:[""],viewModel:{list:[]},parseData:function(e){var a,t,i,s,n=e.slice(0,5),d=n.length;for(a=0;a<d;a++)t=n[a].eventTime,n[a].eventTime=o(t).format("LLL").replace(/\./g,"/"),(i=n[a].location)&&(s=i.split(", "),n[a].building=s[0],n[a].floor=s[1],n[a].zone=s[2]),n[a].deviceType=A.getDisplayClassType(n[a].dms_devices_type);this.viewModel.set("list",n)}}]},facilityOperation:{cards:[{width:2,height:4,template:'<div class="dashboard-body-content dashboard-facility-operation-2x4"><div class="dashboard-facility-dropdownlist" data-bind="invisible : invisibleDropDown"><div class="dashboard-facility-dropdownlist-wrapper"><div class="dropdown-wrapper"><input data-role="dropdownlist" data-width="100%" data-animation="false" data-text-field="displayType" data-value-field="type" data-bind="source: dropDownDs, value : dropDownValue, events:{ select : dropDownSelect }, invisible: invisible, disabled : disabled"/></div><div class="button-wrapper"><button class="k-button" data-bind="disabled:btnDisabled, events:{click:btnClick}"><span data-bind="text: btnText">Apply</span></button></div></div></div><div class="dashboard-facility-operation-graph" data-bind="invisible: invisibleGraph"><div class="dashboard-facility-operation-info"><div class="wrapper"><div class="legend-wrapper" data-bind="visible:isHover"><span class="count" data-bind="text: hoverCount"></span><span class="percent">%<br></span><span class="category" data-bind="text: hoverCategory"></span></div><div class="icon-wrapper" data-bind="invisible:isHover"><span class="card-device-icon detail-img gray"></span></div></div></div><div class="dashboard-facility-operation-chart" data-role="chart" data-transitions="false" data-series-defaults="{type:\'donut\',holeSize:50}" data-chart-area="{ background : \'\\#f7f7f7\', }" data-series="[{field:\'value\',categoryField:\'type\',visibleInLegendField:\'visibleInLegend\',padding:0,overlay:{gradient:\'none\'}}]" data-bind="visible: isVisible, source: operationData, events:{ seriesHover: onSeriesHover }"></div><div class="dashboard-facility-operation-legend" data-bind="invisible:hideDefaultDevice"><span class="unit">(EA)</span><ul class="legends"><li class="legend"><span class="square on"></span><p class="key">#=on#</p><p class="value" data-bind="text: on"></p></li><li class="legend"><span class="square off"></span><p class="key">#=off#</p><p class="value" data-bind="text: off"></p></li><li class="legend"><span class="square critical"></span><p class="key">#=critical#</p><p class="value" data-bind="text: critical"></p></li><li class="legend"><span class="square warning"></span><p class="key">#=warning#</p><p class="value" data-bind="text: warning"></p></li></ul></div><div class="dashboard-facility-operation-legend" data-bind="invisible:hideBeacon"><span class="unit">(EA)</span><ul class="legends"><li class="legend"><span class="square on"></span><p class="key">#=normal#</p><p class="value" data-bind="text: normalBeacon"></p></li><li class="legend"><span class="square critical"></span><p class="key">#=disconnected#</p><p class="value" data-bind="text: disconnected"></p></li><li class="legend"><span class="square warning"></span><p class="key">#=lowBattery#</p><p class="value" data-bind="text: lowBattery"></p></li></ul></div><div class="dashboard-facility-operation-legend" data-bind="invisible:hideNw"><span class="unit">(EA)</span><ul class="legends"><li class="legend"><span class="square on"></span><p class="key">#=normal#</p><p class="value" data-bind="text: normal"></p></li><li class="legend"><span class="square critical"></span><p class="key">#=critical#</p><p class="value" data-bind="text: critical"></p></li><li class="legend"><span class="square warning"></span><p class="key">#=warning#</p><p class="value" data-bind="text: warning"></p></li></ul></div></div></div>',localeTemplateData:{critical:"FACILITY_DEVICE_STATUS_CRITICAL",warning:"FACILITY_DEVICE_STATUS_WARNING",off:"FACILITY_DEVICE_STATUS_OFF",on:"FACILITY_DEVICE_STATUS_ON",normal:"FACILITY_DEVICE_STATUS_NORMAL",disconnected:"FACILITY_DEVICE_STATUS_CRITICAL",lowBattery:"FACILITY_DEVICE_STATUS_WARNING",wrongLocation:"FACILITY_DEVICE_STATUS_WRONG_LOCATION"},init:function(){var n=this,e=u.I18N,a=[{displayType:e.prop("FACILITY_DEVICE_TYPE_SAC_INDOOR"),type:"AirConditioner"},{displayType:e.prop("FACILITY_DEVICE_TYPE_LIGHT"),type:"Light"},{displayType:e.prop("FACILITY_DEVICE_TYPE_TEMP_AND_HUMIDITY_SENSOR_SENSOR"),type:"Sensor.Temperature_Humidity"},{displayType:e.prop("FACILITY_DEVICE_TYPE_MOTION_SENSOR"),type:"Sensor.Motion"},{displayType:e.prop("FACILITY_DEVICE_TYPE_ENERGY_METER"),type:"Meter"},{displayType:e.prop("FACILITY_DEVICE_TYPE_IOT_GATEWAY"),type:"Gateway"},{displayType:e.prop("FACILITY_DEVICE_TYPE_BLE_BEACON"),type:"Beacon"},{displayType:e.prop("FACILITY_DEVICE_TYPE_CCTV"),type:"CCTV"},{displayType:e.prop("FACILITY_DEVICE_TYPE_SMART_PLUG"),type:"SmartPlug"}];this.viewModel.set("dropDownDs",a),this.viewModel.set("btnText",e.prop("COMMON_BTN_APPLY")),this.getInstalledType();var t=this.viewModel.get("dropDownDs");0<t.length&&this.viewModel.set("dropDownText",t[0].displayType);var d,o,r,i=this.widget.element.attr("data-message");if(i){var s,l=i.split("/");for(r=l.length,d=0;d<r;d++)"type"==l[d]&&(s=l[d+1],this.viewModel.set("dropDownValue",s));for(r=a.length,d=0;d<r;d++)a[d].type==s&&this.viewModel.set("dropDownText",a[d].displayType);this.viewModel.btnClick()}var c=A.getInstalledTypeList();(!c||c.length<1)&&(this.viewModel.set("disabled",!0),this.viewModel.set("btnDisabled",!0)),require(["dashboard/dashboard"],function(e){var a,t=e.getDisableTypeList(),i=n.viewModel.get("dropDownDs"),s=i.length;for(r=t.length,d=0;d<r;d++)for(-1!=(a=t[d]).indexOf("AirConditioner.")&&(a="AirConditioner"),s=i.length,o=s-1;0<=o;o--)i[o].type==a&&i.splice(o,1);0<i.length?(n.viewModel.set("dropDownDs",i),n.viewModel.set("dropDownValue",i[0].type)):(n.viewModel.set("disabled",!0),n.viewModel.set("btnDisabled",!0))})},getInstalledType:function(){var e,a,t=this.viewModel.dropDownDs;for(a=t.length-1;0<=a;a--)e=(e=t[a]).type,A.isInstalledType(e)||t.splice(a,1);this.viewModel.set("dropDownDs",t)},templateData:{seriesDefaults:'{type:"donut"}',series:""},viewModel:{isHover:!1,hoverCount:0,hoverCategory:"On",hideDefaultDevice:!1,hideNw:!0,hideBeacon:!0,dropDownDs:[],dropDownSelect:function(e){var a=e.dataItem.displayType;this.set("dropDownText",a)},disabled:!1,btnDisabled:!1,dropDownText:"SAC Indoor",dropDownValue:"AirConditioner",btnText:"Apply",btnClick:function(){var a=this.dropDownValue,e=this.dropDownText,t="/dms/devices/statisticView/"+a+"?foundation_space_buildings_id=0",i=this.thisOptions;i.setRefreshUrl(t),i.widget.titleElem.text(e);var s=this;this.set("invisibleDropDown",!0),this.set("invisibleGraph",!1);var n="/displayType/"+e+"/type/"+a+"/";i.widget.element.attr("data-message",n),i.widget.refresh().done(function(){if(s.get("on")||s.get("off")||s.get("critical")||s.get("warning")||s.get("normal")||s.get("normalBeacon")||s.get("disconnected")||s.get("lowBattery")||s.get("wrongLocation")){var e=A.getDisplayClassType(a);i.widget.element.find(".card-device-icon").addClass(e)}}),i.widget.trigger("onPin"),i.widget.element.on("mouseleave",".k-chart",function(){s.get("isHover")&&s.set("isHover",!1)})},invisibleDropDown:!1,invisibleGraph:!0,isVisible:!0,on:0,off:0,critical:0,warning:0,normal:0,normalBeacon:0,disconnected:0,wrongLocation:0,lowBattery:0,operationData:new g.data.DataSource({data:[]}),onSeriesHover:function(e){this.set("isHover",!0);var a=e.percentage;a=Math.round(100*a);var t=e.category;"DISCONNECTED"==(t=(t=t.toUpperCase()).replace(" ","_"))?t="CRITICAL":"LOW_BATTERY"==t&&(t="WARNING"),t=u.I18N.prop("FACILITY_DEVICE_STATUS_"+t),this.set("hoverCount",a),this.set("hoverCategory",t)}},setRefreshUrl:function(e){this.refreshUrl=e},setDataSource:function(e,a){var t=this.viewModel.get("on")+"";t=t.replace("+","");var i=this.viewModel.get("off")+"";i=i.replace("+","");var s=this.viewModel.get("critical")+"";s=s.replace("+","");var n=this.viewModel.get("warning")+"";n=n.replace("+","");var d,o=[{type:"on",value:t=Number(t),visibleInLegend:!1,color:"#1aa05a"},{type:"off",value:i=Number(i),visibleInLegend:!1,color:"#454545"},{type:"critical",value:s=Number(s),visibleInLegend:!1,color:"#ef2b2b"},{type:"warning",value:n=Number(n),visibleInLegend:!1,color:"#ffa41f"}];a=e=!1,-1!=this.refreshUrl.indexOf("Beacon")&&(e=!0,this.viewModel.set("hideDefaultDevice",!0),this.viewModel.set("hideNw",!0),this.viewModel.set("hideBeacon",!1)),-1==this.refreshUrl.indexOf("Gateway")&&-1==this.refreshUrl.indexOf("CCTV")&&-1==this.refreshUrl.indexOf("Meter")&&-1==this.refreshUrl.indexOf("Sensor")||(a=!0,this.viewModel.set("hideDefaultDevice",!0),this.viewModel.set("hideBeacon",!0),this.viewModel.set("hideNw",!1)),e?(o[0].type="normal",d=(d=this.viewModel.get("normalBeacon")+"").replace("+",""),o[0].value=Number(d),o[1].type="disconnected",d=(d=this.viewModel.get("disconnected")+"").replace("+",""),o[1].value=Number(d),o[1].color="#ef2b2b",o[3].type="low battery",d=(d=this.viewModel.get("lowBattery")+"").replace("+",""),o[3].value=Number(d),o[3].color="#ffa41f"):a&&(o[0].type="normal",d=(d=this.viewModel.get("normal")+"").replace("+",""),o[0].value=Number(d),o.splice(1,1)),o=new g.data.DataSource({data:o}),this.viewModel.set("operationData",o)},parseData:function(e){var a=void 0!==(e=e[0]).numberOfNormalDevices?e.numberOfNormalDevices:0;this.viewModel.set("normal",a);var t=void 0!==e.numberOfOnDevices?e.numberOfOnDevices:0;this.viewModel.set("on",t);var i=void 0!==e.numberOfOffDevices?e.numberOfOffDevices:0;this.viewModel.set("off",i);var s=void 0!==e.numberOfCriticalDevices?e.numberOfCriticalDevices:0;this.viewModel.set("critical",s);var n=void 0!==e.numberOfWarningDevices?e.numberOfWarningDevices:0;this.viewModel.set("warning",n);var d=(void 0!==e.numberOfFixedNormalDevices?e.numberOfFixedNormalDevices:0)+(void 0!==e.numberOfMovableNormalDevices?e.numberOfMovableNormalDevices:0);this.viewModel.set("normalBeacon",d);var o=(void 0!==e.numberOfFixedCriticalDevices?e.numberOfFixedCriticalDevices:0)+(void 0!==e.numberOfMovableCriticalDevices?e.numberOfMovableCriticalDevices:0);this.viewModel.set("disconnected",o);var r=(void 0!==e.numberOfFixedOutOfBoundsDevices?e.numberOfFixedOutOfBoundsDevices:0)+(void 0!==e.numberOfMovableOutOfBoundsDevices?e.numberOfMovableOutOfBoundsDevices:0);this.viewModel.set("wrongLocation",r);var l=(void 0!==e.numberOfFixedWarningDevices?e.numberOfFixedWarningDevices:0)+(void 0!==e.numberOfMovableWarningDevices?e.numberOfMovableWarningDevices:0);this.viewModel.set("lowBattery",l),this.setDataSource()}},{width:4,height:4,template:'<div class="dashboard-body-content dashboard-facility-operation-4x4"><div class="dashboard-facility-dropdownlist" data-bind="invisible : invisibleDropDown"><div class="dashboard-facility-dropdownlist-wrapper"><div class="dropdown-wrapper"><input data-role="dropdownlist" data-width="100%" data-animation="false" data-text-field="displayType" data-value-field="type" data-bind="source: dropDownDs, value : dropDownValue, events:{ select : dropDownSelect }, invisible: invisible, disabled : disabled"/></div><div class="button-wrapper"><button class="k-button" data-bind="disabled:disabled, events:{click:btnClick}"><span data-bind="text: btnText">Apply</span></button></div></div></div><div class="dashboard-facility-operation-graph" data-bind="invisible: invisibleGraph"><div class="dashboard-facility-operation-info"><div class="wrapper"><div class="legend-wrapper" data-bind="visible:isHover"><span class="count" data-bind="text: hoverCount"></span><span class="percent">%<br></span><span class="category" data-bind="text: hoverCategory"></span></div><div class="icon-wrapper" data-bind="invisible:isHover"><span class="card-device-icon detail-img gray"></span></div></div></div><div class="dashboard-facility-operation-chart" data-role="chart" data-transitions="false" data-series-defaults="{type:\'donut\',holeSize:78}" data-chart-area="{ background : \'\\#f7f7f7\', }" data-series="[{field:\'value\',categoryField:\'type\',visibleInLegendField:\'visibleInLegend\',padding:35,overlay:{gradient:\'none\'}}]" data-bind="visible: isVisible, source: operationData, events:{seriesHover : onSeriesHover}"></div><div class="dashboard-facility-operation-legend" data-bind="invisible:hideDefaultDevice"><span class="unit">(EA)</span><ul class="legends"><li class="legend"><span class="square on"></span><p class="key">#=on#</p><p class="value" data-bind="text: on"></p></li><li class="legend"><span class="square off"></span><p class="key">#=off#</p><p class="value" data-bind="text: off"></p></li><li class="legend"><span class="square critical"></span><p class="key">#=critical#</p><p class="value" data-bind="text: critical"></p></li><li class="legend"><span class="square warning"></span><p class="key">#=warning#</p><p class="value" data-bind="text: warning"></p></li></ul></div><div class="dashboard-facility-operation-legend" data-bind="invisible:hideBeacon"><span class="unit">(EA)</span><ul class="legends"><li class="legend"><span class="square on"></span><p class="key">#=normal#</p><p class="value" data-bind="text: normalBeacon"></p></li><li class="legend"><span class="square critical"></span><p class="key">#=disconnected#</p><p class="value" data-bind="text: disconnected"></p></li><li class="legend"><span class="square warning"></span><p class="key">#=lowBattery#</p><p class="value" data-bind="text: lowBattery"></p></li></ul></div><div class="dashboard-facility-operation-legend" data-bind="invisible:hideNw"><span class="unit">(EA)</span><ul class="legends"><li class="legend"><span class="square on"></span><p class="key">#=normal#</p><p class="value" data-bind="text: normal"></p></li><li class="legend"><span class="square critical"></span><p class="key">#=critical#</p><p class="value" data-bind="text: critical"></p></li><li class="legend"><span class="square warning"></span><p class="key">#=warning#</p><p class="value" data-bind="text: warning"></p></li></ul></div></div></div>',localeTemplateData:{critical:"FACILITY_DEVICE_STATUS_CRITICAL",warning:"FACILITY_DEVICE_STATUS_WARNING",off:"FACILITY_DEVICE_STATUS_OFF",on:"FACILITY_DEVICE_STATUS_ON",normal:"FACILITY_DEVICE_STATUS_NORMAL",disconnected:"FACILITY_DEVICE_STATUS_CRITICAL",lowBattery:"FACILITY_DEVICE_STATUS_WARNING",wrongLocation:"FACILITY_DEVICE_STATUS_WRONG_LOCATION"},init:function(){var n=this,e=u.I18N,a=[{displayType:e.prop("FACILITY_DEVICE_TYPE_SAC_INDOOR"),type:"AirConditioner"},{displayType:e.prop("FACILITY_DEVICE_TYPE_LIGHT"),type:"Light"},{displayType:e.prop("FACILITY_DEVICE_TYPE_TEMP_AND_HUMIDITY_SENSOR_SENSOR"),type:"Sensor.Temperature_Humidity"},{displayType:e.prop("FACILITY_DEVICE_TYPE_MOTION_SENSOR"),type:"Sensor.Motion"},{displayType:e.prop("FACILITY_DEVICE_TYPE_ENERGY_METER"),type:"Meter"},{displayType:e.prop("FACILITY_DEVICE_TYPE_IOT_GATEWAY"),type:"Gateway"},{displayType:e.prop("FACILITY_DEVICE_TYPE_BLE_BEACON"),type:"Beacon"},{displayType:e.prop("FACILITY_DEVICE_TYPE_CCTV"),type:"CCTV"},{displayType:e.prop("FACILITY_DEVICE_TYPE_SMART_PLUG"),type:"SmartPlug"}];this.viewModel.set("dropDownDs",a),this.viewModel.set("btnText",e.prop("COMMON_BTN_APPLY")),this.getInstalledType();var t=this.viewModel.get("dropDownDs");0<t.length&&this.viewModel.set("dropDownText",t[0].displayType);var d,o,r,i=this.widget.element.attr("data-message");if(i){var s,l=i.split("/");for(r=l.length,d=0;d<r;d++)"type"==l[d]&&(s=l[d+1],this.viewModel.set("dropDownValue",s));for(r=a.length,d=0;d<r;d++)a[d].type==s&&this.viewModel.set("dropDownText",a[d].displayType);this.viewModel.btnClick()}var c=A.getInstalledTypeList();(!c||c.length<1)&&(this.viewModel.set("disabled",!0),this.viewModel.set("btnDisabled",!0)),require(["dashboard/dashboard"],function(e){var a,t=e.getDisableTypeList(),i=n.viewModel.get("dropDownDs"),s=i.length;for(r=t.length,d=0;d<r;d++)for(-1!=(a=t[d]).indexOf("AirConditioner.")&&(a="AirConditioner"),s=i.length,o=s-1;0<=o;o--)i[o].type==a&&i.splice(o,1);0<i.length?(n.viewModel.set("dropDownDs",i),n.viewModel.set("dropDownValue",i[0].type)):(n.viewModel.set("disabled",!0),n.viewModel.set("btnDisabled",!0))})},getInstalledType:function(){var e,a,t=this.viewModel.dropDownDs;for(a=t.length-1;0<=a;a--)e=(e=t[a]).type,A.isInstalledType(e)||t.splice(a,1);this.viewModel.set("dropDownDs",t)},templateData:{seriesDefaults:'{type:"donut"}',series:""},viewModel:{isHover:!1,hoverCount:0,hoverCategory:"On",hideDefaultDevice:!1,hideNw:!0,hideBeacon:!0,dropDownDs:[{displayType:"SAC Indoor",type:"AirConditioner"},{displayType:"SAC Outdoor",type:"AirConditionerOutdoor"},{displayType:"Point",type:"ControlPoint"},{displayType:"Temp. & Humi. Sensor",type:"Sensor.Temperature_Humidity"},{displayType:"Motion Sensor",type:"Sensor.Motion"},{displayType:"Light",type:"Light"},{displayType:"Energy Meter",type:"Meter"}],dropDownSelect:function(e){var a=e.dataItem.displayType;this.set("dropDownText",a)},dropDownText:"SAC Indoor",dropDownValue:"AirConditioner",disabled:!1,btnDisabled:!1,btnText:"Apply",btnClick:function(){var a=this.dropDownValue,e=this.dropDownText,t="/dms/devices/statisticView/"+a+"?foundation_space_buildings_id=0",i=this.thisOptions;i.setRefreshUrl(t),i.widget.titleElem.text(e);var s=this;this.set("invisibleDropDown",!0),this.set("invisibleGraph",!1);var n="/displayType/"+e+"/type/"+a+"/";i.widget.element.attr("data-message",n),i.widget.refresh().done(function(){if(s.get("on")||s.get("off")||s.get("critical")||s.get("warning")||s.get("normal")||s.get("normalBeacon")||s.get("disconnected")||s.get("lowBattery")||s.get("wrongLocation")){var e=A.getDisplayClassType(a);i.widget.element.find(".card-device-icon").addClass(e)}}),i.widget.trigger("onPin"),i.widget.element.on("mouseleave",".k-chart",function(){s.get("isHover")&&s.set("isHover",!1)})},onSeriesHover:function(e){this.set("isHover",!0);var a=e.percentage;a=Math.round(100*a);var t=e.category;"DISCONNECTED"==(t=(t=t.toUpperCase()).replace(" ","_"))?t="CRITICAL":"LOW_BATTERY"==t&&(t="WARNING"),t=u.I18N.prop("FACILITY_DEVICE_STATUS_"+t),this.set("hoverCount",a),this.set("hoverCategory",t)},invisibleDropDown:!1,invisibleGraph:!0,isVisible:!0,on:0,off:0,critical:0,warning:0,normal:0,normalBeacon:0,disconnected:0,wrongLocation:0,lowBattery:0,operationData:new g.data.DataSource({data:[]})},setRefreshUrl:function(e){this.refreshUrl=e},setDataSource:function(e,a){var t=this.viewModel.get("on")+"";t=t.replace("+","");var i=this.viewModel.get("off")+"";i=i.replace("+","");var s=this.viewModel.get("critical")+"";s=s.replace("+","");var n=this.viewModel.get("warning")+"";n=n.replace("+","");var d,o=[{type:"on",value:t=Number(t),visibleInLegend:!1,color:"#1aa05a"},{type:"off",value:i=Number(i),visibleInLegend:!1,color:"#454545"},{type:"critical",value:s=Number(s),visibleInLegend:!1,color:"#ef2b2b"},{type:"warning",value:n=Number(n),visibleInLegend:!1,color:"#ffa41f"}];a=e=!1,-1!=this.refreshUrl.indexOf("Beacon")&&(e=!0,this.viewModel.set("hideDefaultDevice",!0),this.viewModel.set("hideNw",!0),this.viewModel.set("hideBeacon",!1)),-1==this.refreshUrl.indexOf("Gateway")&&-1==this.refreshUrl.indexOf("CCTV")&&-1==this.refreshUrl.indexOf("Meter")&&-1==this.refreshUrl.indexOf("Sensor")||(a=!0,this.viewModel.set("hideDefaultDevice",!0),this.viewModel.set("hideBeacon",!0),this.viewModel.set("hideNw",!1)),e?(o[0].type="normal",d=(d=this.viewModel.get("normalBeacon")+"").replace("+",""),o[0].value=Number(d),o[1].type="disconnected",d=(d=this.viewModel.get("disconnected")+"").replace("+",""),o[1].value=Number(d),o[1].color="#ef2b2b",o[3].type="low battery",d=(d=this.viewModel.get("lowBattery")+"").replace("+",""),o[3].value=Number(d),o[3].color="#ffa41f"):a&&(o[0].type="normal",d=(d=this.viewModel.get("normal")+"").replace("+",""),o[0].value=Number(d),o.splice(1,1)),o=new g.data.DataSource({data:o}),this.viewModel.set("operationData",o)},parseData:function(e){var a=void 0!==(e=e[0]).numberOfNormalDevices?e.numberOfNormalDevices:0;this.viewModel.set("normal",a);var t=void 0!==e.numberOfOnDevices?e.numberOfOnDevices:0;this.viewModel.set("on",t);var i=void 0!==e.numberOfOffDevices?e.numberOfOffDevices:0;this.viewModel.set("off",i);var s=void 0!==e.numberOfCriticalDevices?e.numberOfCriticalDevices:0;this.viewModel.set("critical",s);var n=void 0!==e.numberOfWarningDevices?e.numberOfWarningDevices:0;this.viewModel.set("warning",n);var d=(void 0!==e.numberOfFixedNormalDevices?e.numberOfFixedNormalDevices:0)+(void 0!==e.numberOfMovableNormalDevices?e.numberOfMovableNormalDevices:0);this.viewModel.set("normalBeacon",d);var o=(void 0!==e.numberOfFixedCriticalDevices?e.numberOfFixedCriticalDevices:0)+(void 0!==e.numberOfMovableCriticalDevices?e.numberOfMovableCriticalDevices:0);this.viewModel.set("disconnected",o);var r=(void 0!==e.numberOfFixedOutOfBoundsDevices?e.numberOfFixedOutOfBoundsDevices:0)+(void 0!==e.numberOfMovableOutOfBoundsDevices?e.numberOfMovableOutOfBoundsDevices:0);this.viewModel.set("wrongLocation",r);var l=(void 0!==e.numberOfFixedWarningDevices?e.numberOfFixedWarningDevices:0)+(void 0!==e.numberOfMovableWarningDevices?e.numberOfMovableWarningDevices:0);this.viewModel.set("lowBattery",l),this.setDataSource()}}],title:"DASHBOARD_FACILITY_OPERATION"},assetFacilityOperation:{cards:[{width:2,height:4,template:'<div class="dashboard-body-content dashboard-facility-operation-2x4"><div class="dashboard-facility-dropdownlist" data-bind="invisible : invisibleDropDown"><div class="dashboard-facility-dropdownlist-wrapper"><div class="dropdown-wrapper"><input data-role="dropdownlist" data-width="100%" data-animation="false" data-text-field="name" data-value-field="id" data-bind="source: dropDownDs, value : dropDownValue, events:{ select : dropDownSelect }, invisible: invisible, disabled : disabled"/></div><div class="button-wrapper"><button class="k-button" data-bind="disabled:btnDisabled, events:{click:btnClick}"><span data-bind="text: btnText">Apply</span></button></div></div></div><div class="dashboard-facility-operation-graph" data-bind="invisible: invisibleGraph"><div class="dashboard-facility-operation-info"><div class="wrapper"><div class="legend-wrapper" data-bind="visible:isHover"><span class="count" data-bind="text: hoverCount"></span><span class="percent">%<br></span><span class="category" data-bind="text: hoverCategory"></span></div><div class="icon-wrapper" data-bind="invisible:isHover"><span class="card-device-icon detail-img gray"></span></div></div></div><div class="dashboard-facility-operation-chart" data-role="chart" data-transitions="false" data-series-defaults="{type:\'donut\',holeSize:50}" data-chart-area="{ background : \'\\#f7f7f7\', }" data-series="[{field:\'value\',categoryField:\'type\',visibleInLegendField:\'visibleInLegend\',padding:0,overlay:{gradient:\'none\'}}]" data-bind="visible: isVisible, source: operationData, events:{ seriesHover: onSeriesHover }"></div><div class="dashboard-facility-operation-legend""><span class="unit">(EA)</span><ul class="legends"><li class="legend"><span class="square on"></span><p class="key">#=normal#</p><p class="value" data-bind="text: normal"></p></li><li class="legend"><span class="square critical"></span><p class="key">#=disconnected#</p><p class="value" data-bind="text: disconnected"></p></li><li class="legend"><span class="square warning"></span><p class="key">#=lowBattery#</p><p class="value" data-bind="text: lowBattery"></p></li></ul></div></div></div>',localeTemplateData:{critical:"FACILITY_DEVICE_STATUS_CRITICAL",warning:"FACILITY_DEVICE_STATUS_WARNING",off:"FACILITY_DEVICE_STATUS_OFF",on:"FACILITY_DEVICE_STATUS_ON",normal:"FACILITY_DEVICE_STATUS_NORMAL",disconnected:"FACILITY_DEVICE_STATUS_CRITICAL",lowBattery:"FACILITY_DEVICE_STATUS_WARNING",wrongLocation:"FACILITY_DEVICE_STATUS_WRONG_LOCATION"},init:function(){var o=this,e=u.I18N,s=this.widget,n=s.element.attr("data-message");s.loading.open(s.element),this.viewModel.set("btnText",e.prop("COMMON_BTN_APPLY"));var r=[];m.ajax({url:"/assets"}).done(function(e){var a,t,i,s,n=e.length;for(t=0;t<n;t++)if(a=e[t],(s={}).id=a.id,s.name=a.assets_types_name,a.subAssetType&&(s.name+=" / "+a.subAssetType),0<r.length){var d=!1;for(i=0;i<r.length;i++){if(r[i].name==s.name){d=!0;break}}0==d&&r.push(s)}else r.push(s);0<r.length&&(o.viewModel.set("dropDownDs",r),o.viewModel.set("dropDownValue",r[0].id),o.viewModel.set("dropDownText",r[0].name))}).fail(function(){}).always(function(){if(s.loading.close(),n){var e,a,t,i=n.split("/");for(a=i.length,e=0;e<a;e++)if("assetId"==i[e]){t=i[e+1],o.viewModel.set("dropDownValue",t);break}for(a=r.length,e=0;e<a;e++)if(r[e].id==t){o.viewModel.set("dropDownText",r[e].name);break}o.viewModel.btnClick()}(!r||r.length<1)&&(o.viewModel.set("disabled",!0),o.viewModel.set("btnDisabled",!0))})},templateData:{seriesDefaults:'{type:"donut"}',series:""},viewModel:{isHover:!1,hoverCount:0,hoverCategory:"On",dropDownDs:[],dropDownSelect:function(e){var a=e.dataItem.name;this.set("dropDownText",a)},disabled:!1,btnDisabled:!1,dropDownText:"",dropDownValue:"",btnText:"Apply",btnClick:function(){var e=this.dropDownValue,a=this.dropDownText,t=this.thisOptions;t.setRefreshUrl("/assets/statisticView?foundation_space_buildings_id=0");var i=u.I18N;t.widget.titleElem.text(i.prop("DASHBOARD_ASSETS")+" > "+a);var s=this;this.set("invisibleDropDown",!0),this.set("invisibleGraph",!1);var n="/assetId/"+e+"/assetText/"+a+"/";t.widget.element.attr("data-message",n),t.widget.refresh().done(function(){}),t.widget.trigger("onPin"),t.widget.element.on("mouseleave",".k-chart",function(){s.get("isHover")&&s.set("isHover",!1)})},invisibleDropDown:!1,invisibleGraph:!0,isVisible:!0,normal:0,disconnected:0,wrongLocation:0,lowBattery:0,operationData:new g.data.DataSource({data:[]}),onSeriesHover:function(e){this.set("isHover",!0);var a=e.percentage;a=Math.round(100*a);var t=e.category;"DISCONNECTED"==(t=(t=t.toUpperCase()).replace(" ","_"))?t="CRITICAL":"LOW_BATTERY"==t&&(t="WARNING"),t=u.I18N.prop("FACILITY_DEVICE_STATUS_"+t),this.set("hoverCount",a),this.set("hoverCategory",t)}},setRefreshUrl:function(e){this.refreshUrl=e},setDataSource:function(){var e=this.viewModel.get("normal")+"";e=e.replace("+",""),e=Number(e);var a=this.viewModel.get("disconnected")+"";a=a.replace("+",""),a=Number(a);var t=this.viewModel.get("lowBattery")+"";t=t.replace("+",""),t=Number(t);var i=this.viewModel.get("wrongLocation")+"";i=i.replace("+","");var s=[{type:"on",value:e,visibleInLegend:!1,color:"#1aa05a"},{type:"disconnected",value:a,visibleInLegend:!1,color:"#ef2b2b"},{type:"wrong location",value:i=Number(i),visibleInLegend:!1,color:"#ef2b2b"},{type:"low battery",value:t,visibleInLegend:!1,color:"#ffa41f"}];s=new g.data.DataSource({data:s}),this.viewModel.set("operationData",s)},parseData:function(e){e=e[0];var a=this.viewModel.get("dropDownText").split(" / "),t=a[0],i=a[1];i=i||void 0;var s=0,n=0,d=0;if(e){var o,r,l,c,v,p,u=e.assetTypes,m=u.length;for(c=0;c<m;c++)if((o=u[c]).assets_types_name==t)for(p=(l=o.subAssetTypes).length,v=0;v<p;v++)if((r=l[v]).assets_subAssetType==i){s=r.numberOfNormalDevices,n=r.numberOfCriticalDevices,d=r.numberOfWarningDevices;break}}this.viewModel.set("normal",s),this.viewModel.set("disconnected",n),this.viewModel.set("wrongLocation",0),this.viewModel.set("lowBattery",d),this.setDataSource()}},{width:4,height:4,template:'<div class="dashboard-body-content dashboard-facility-operation-4x4"><div class="dashboard-facility-dropdownlist" data-bind="invisible : invisibleDropDown"><div class="dashboard-facility-dropdownlist-wrapper"><div class="dropdown-wrapper"><input data-role="dropdownlist" data-width="100%" data-animation="false" data-text-field="name" data-value-field="id" data-bind="source: dropDownDs, value : dropDownValue, events:{ select : dropDownSelect }, invisible: invisible, disabled : disabled"/></div><div class="button-wrapper"><button class="k-button" data-bind="disabled:disabled, events:{click:btnClick}"><span data-bind="text: btnText">Apply</span></button></div></div></div><div class="dashboard-facility-operation-graph" data-bind="invisible: invisibleGraph"><div class="dashboard-facility-operation-info"><div class="wrapper"><div class="legend-wrapper" data-bind="visible:isHover"><span class="count" data-bind="text: hoverCount"></span><span class="percent">%<br></span><span class="category" data-bind="text: hoverCategory"></span></div><div class="icon-wrapper" data-bind="invisible:isHover"><span class="card-device-icon detail-img gray"></span></div></div></div><div class="dashboard-facility-operation-chart" data-role="chart" data-transitions="false" data-series-defaults="{type:\'donut\',holeSize:78}" data-chart-area="{ background : \'\\#f7f7f7\', }" data-series="[{field:\'value\',categoryField:\'type\',visibleInLegendField:\'visibleInLegend\',padding:35,overlay:{gradient:\'none\'}}]" data-bind="visible: isVisible, source: operationData, events:{seriesHover : onSeriesHover}"></div><div class="dashboard-facility-operation-legend"><span class="unit">(EA)</span><ul class="legends"><li class="legend"><span class="square on"></span><p class="key">#=normal#</p><p class="value" data-bind="text: normal"></p></li><li class="legend"><span class="square critical"></span><p class="key">#=disconnected#</p><p class="value" data-bind="text: disconnected"></p></li><li class="legend"><span class="square warning"></span><p class="key">#=lowBattery#</p><p class="value" data-bind="text: lowBattery"></p></li></ul></div></div></div>',localeTemplateData:{critical:"FACILITY_DEVICE_STATUS_CRITICAL",warning:"FACILITY_DEVICE_STATUS_WARNING",off:"FACILITY_DEVICE_STATUS_OFF",on:"FACILITY_DEVICE_STATUS_ON",normal:"FACILITY_DEVICE_STATUS_NORMAL",disconnected:"FACILITY_DEVICE_STATUS_CRITICAL",lowBattery:"FACILITY_DEVICE_STATUS_WARNING",wrongLocation:"FACILITY_DEVICE_STATUS_WRONG_LOCATION"},init:function(){var o=this,e=u.I18N,s=this.widget,n=s.element.attr("data-message");s.loading.open(s.element),this.viewModel.set("btnText",e.prop("COMMON_BTN_APPLY"));var r=[];m.ajax({url:"/assets"}).done(function(e){var a,t,i,s,n=e.length;for(t=0;t<n;t++)if(a=e[t],(s={}).id=a.id,s.name=a.assets_types_name,a.subAssetType&&(s.name+=" / "+a.subAssetType),0<r.length){var d=!1;for(i=0;i<r.length;i++){if(r[i].name==s.name){d=!0;break}}0==d&&r.push(s)}else r.push(s);0<r.length&&(o.viewModel.set("dropDownDs",r),o.viewModel.set("dropDownValue",r[0].id),o.viewModel.set("dropDownText",r[0].name))}).fail(function(){}).always(function(){if(s.loading.close(),n){var e,a,t,i=n.split("/");for(a=i.length,e=0;e<a;e++)if("assetId"==i[e]){t=i[e+1],o.viewModel.set("dropDownValue",t);break}for(a=r.length,e=0;e<a;e++)if(r[e].id==t){o.viewModel.set("dropDownText",r[e].name);break}o.viewModel.btnClick()}(!r||r.length<1)&&(o.viewModel.set("disabled",!0),o.viewModel.set("btnDisabled",!0))})},templateData:{seriesDefaults:'{type:"donut"}',series:""},viewModel:{isHover:!1,hoverCount:0,hoverCategory:"On",dropDownDs:[],dropDownSelect:function(e){var a=e.dataItem.name;this.set("dropDownText",a)},dropDownText:"SAC Indoor",dropDownValue:"AirConditioner",disabled:!1,btnDisabled:!1,btnText:"Apply",btnClick:function(){var e=this.dropDownValue,a=this.dropDownText,t=this.thisOptions;t.setRefreshUrl("/assets/statisticView?foundation_space_buildings_id=0");var i=u.I18N;t.widget.titleElem.text(i.prop("DASHBOARD_ASSETS")+" > "+a);var s=this;this.set("invisibleDropDown",!0),this.set("invisibleGraph",!1);var n="/assetId/"+e+"/assetText/"+a+"/";t.widget.element.attr("data-message",n),t.widget.refresh().done(function(){}),t.widget.trigger("onPin"),t.widget.element.on("mouseleave",".k-chart",function(){s.get("isHover")&&s.set("isHover",!1)})},onSeriesHover:function(e){this.set("isHover",!0);var a=e.percentage;a=Math.round(100*a);var t=e.category;"DISCONNECTED"==(t=(t=t.toUpperCase()).replace(" ","_"))?t="CRITICAL":"LOW_BATTERY"==t&&(t="WARNING"),t=u.I18N.prop("FACILITY_DEVICE_STATUS_"+t),this.set("hoverCount",a),this.set("hoverCategory",t)},invisibleDropDown:!1,invisibleGraph:!0,isVisible:!0,normal:0,disconnected:0,wrongLocation:0,lowBattery:0,operationData:new g.data.DataSource({data:[]})},setRefreshUrl:function(e){this.refreshUrl=e},setDataSource:function(){var e=this.viewModel.get("normal")+"";e=e.replace("+",""),e=Number(e);var a=this.viewModel.get("disconnected")+"";a=a.replace("+",""),a=Number(a);var t=this.viewModel.get("lowBattery")+"";t=t.replace("+",""),t=Number(t);var i=this.viewModel.get("wrongLocation")+"";i=i.replace("+","");var s=[{type:"on",value:e,visibleInLegend:!1,color:"#1aa05a"},{type:"disconnected",value:a,visibleInLegend:!1,color:"#ef2b2b"},{type:"wrong location",value:i=Number(i),visibleInLegend:!1,color:"#ef2b2b"},{type:"low battery",value:t,visibleInLegend:!1,color:"#ffa41f"}];s=new g.data.DataSource({data:s}),this.viewModel.set("operationData",s)},parseData:function(e){e=e[0];var a=this.viewModel.get("dropDownText").split(" / "),t=a[0],i=a[1];i=i||void 0;var s=0,n=0,d=0;if(e){var o,r,l,c,v,p,u=e.assetTypes,m=u.length;for(c=0;c<m;c++)if((o=u[c]).assets_types_name==t)for(p=(l=o.subAssetTypes).length,v=0;v<p;v++)if((r=l[v]).assets_subAssetType==i){s=r.numberOfNormalDevices,n=r.numberOfCriticalDevices,d=r.numberOfWarningDevices;break}}this.viewModel.set("normal",s),this.viewModel.set("disconnected",n),this.viewModel.set("wrongLocation",0),this.viewModel.set("lowBattery",d),this.setDataSource()}}],title:"DASHBOARD_ASSETS"},alarmLog:{cards:[{width:2,height:2,refreshUrl:"/alarms/statisticView",menuUrl:"/operation/alarm",template:"<div class='dashboard-body-content dashboard-alarm-log-2x2'><div class='row'><div class='dashboard-alarm-log-2x2-label'><p class='key'>#=critical#</p></div><div class='dashboard-alarm-log-2x2-value'><p class='value critical' data-bind='text : criticalValue'></p></div></div><div class='row'><div class='dashboard-alarm-log-2x2-label'><p class='key'>#=warning#</p></div><div class='dashboard-alarm-log-2x2-value'><p class='value warning' data-bind='text : warningValue'></p></div></div></div>",localeTemplateData:{critical:"FACILITY_DEVICE_STATUS_CRITICAL",warning:"FACILITY_DEVICE_STATUS_WARNING"},viewModel:{criticalValue:0,warningValue:0},parseData:function(e){var a=e.numberOfUnresolvedCriticalAlarms,t=e.numberOfUnresolvedWarningAlarms;this.viewModel.set("criticalValue",a),this.viewModel.set("warningValue",t)}},{width:4,height:6,refreshUrl:"/alarms/statisticView",menuUrl:"/operation/alarm",template:"<div class='dashboard-body-content dashboard-alarm-log-4x6'><div data-animation='false' data-role='tabstrip'><ul><li class='k-state-active'><span class='critical'>#=critical# <span class='ciritcal-count main-top-nav-alarm error' data-bind='text: criticalNum'></span></span><li><span class='warning'>#=warning# <span class='warning-count main-top-nav-alarm warning' data-bind='text: warningNum'></span></span></li></ul><div><ul data-template='dashboard-alarm-log-ul-template' data-bind='source: criticalList' class='dashboard-list'></ul></div><div><ul data-template='dashboard-alarm-log-ul-template' data-bind='source: warningList' class='dashboard-list'></ul></div>",localeTemplateData:{critical:"FACILITY_DEVICE_STATUS_CRITICAL",warning:"FACILITY_DEVICE_STATUS_WARNING"},viewModel:{criticalList:[],warningList:[]},parseData:function(e){var a=e.numberOfUnresolvedCriticalAlarms,t=e.numberOfUnresolvedWarningAlarms,i=e.unresolvedCriticalAlarms;this.viewModel.set("criticalNum",a),i=this.parseAlarmList(i),this.viewModel.set("criticalList",i);var s=e.unresolvedWarningAlarms;this.viewModel.set("warningNum",t),s=this.parseAlarmList(s),this.viewModel.set("warningList",s)},parseAlarmList:function(e){var a,t,i,s=e.slice(0,5),n=s.length;for(a=0;a<n;a++)A.setAlarmData(s[a]),(t=s[a].location)&&"-"!=t?(i=t.split(", "),s[a].building=i[0],i[1]&&(s[a].floor=", "+i[1]),s[a].zone=i[2]?i[2]:"-"):(s[a].building="-",s[a].zone="-"),s[a].deviceType=A.getDisplayClassType(s[a].dms_devices_type);return s}}],title:"DASHBOARD_CARD_CRITICAL_AND_WARINING"},deviceStatusOn:{cards:[{width:2,height:4,refreshUrl:"/dms/devices/statisticView/AirConditioner?foundation_space_buildings_id=0",menuUrl:"/device",template:"<div class='dashboard-body-content dashboard-device-status on'><div class='dashboard-device-status-circle-block'><span class='circle'>#=on#</span></div><div class='table-content'><div class='cell'><p class='key'>#=indoor#</p></div><div class='cell'><p class='value' data-bind='text: indoor'></p></div></div><div class='table-content'><div class='cell'><p class='key'>#=ventilator#</p></div><div class='cell'><p class='value' data-bind='text: ventilator'></p></div></div><div class='table-content'><div class='cell'><p class='key'>#=dhw#</p></div><div class='cell'><p class='value' data-bind='text: dhw'></p></div></div>",localeTemplateData:{on:"FACILITY_DEVICE_STATUS_ON",indoor:"FACILITY_INDOOR_INDOOR",ventilator:"FACILITY_DEVICE_TYPE_VENTILATOR",dhw:"FACILITY_DEVICE_TYPE_DHW"},viewModel:{indoor:0,ventilator:0,dhw:0},onMoveMenu:function(){u.localStorage.setItem("deviceTypeTab","AirConditioner.Indoor"),u.localStorage.setItem("deviceViewType","STATISTIC")},parseData:function(e){if(e&&e[0]){var a=(e=e[0]).numberOfOnIndoorDevices,t=e.numberOfOnVentilatorDevices,i=e.numberOfOnDHWDevices;this.viewModel.set("indoor",a),this.viewModel.set("ventilator",t),this.viewModel.set("dhw",i)}}}],title:"DASHBOARD_SAC_INDOOR_ON"},deviceStatusOff:{cards:[{width:2,height:4,refreshUrl:"/dms/devices/statisticView/AirConditioner?foundation_space_buildings_id=0",menuUrl:"/device",template:"<div class='dashboard-body-content dashboard-device-status off'><div class='dashboard-device-status-circle-block'><span class='circle'>#=off#</span></div><div class='table-content'><div class='cell'><p class='key'>#=indoor#</p></div><div class='cell'><p class='value' data-bind='text: indoor'></p></div></div><div class='table-content'><div class='cell'><p class='key'>#=ventilator#</p></div><div class='cell'><p class='value' data-bind='text: ventilator'></p></div></div><div class='table-content'><div class='cell'><p class='key'>#=dhw#</p></div><div class='cell'><p class='value' data-bind='text: dhw'></p></div></div>",localeTemplateData:{off:"FACILITY_DEVICE_STATUS_OFF",indoor:"FACILITY_INDOOR_INDOOR",ventilator:"FACILITY_DEVICE_TYPE_VENTILATOR",dhw:"FACILITY_DEVICE_TYPE_DHW"},viewModel:{indoor:0,ventilator:0,dhw:0},onMoveMenu:function(){u.localStorage.setItem("deviceTypeTab","AirConditioner.Indoor"),u.localStorage.setItem("deviceViewType","STATISTIC")},parseData:function(e){if(e&&e[0]){var a=(e=e[0]).numberOfOffIndoorDevices,t=e.numberOfOffVentilatorDevices,i=e.numberOfOffDHWDevices;this.viewModel.set("indoor",a),this.viewModel.set("ventilator",t),this.viewModel.set("dhw",i)}}}],title:"DASHBOARD_SAC_INDOOR_OFF"},energyLoss:{title:"DASHBOARD_ENERGY_LOSS",cards:[{refreshOption:{timeout:36e5},width:4,height:4,refreshUrl:"/energy/sac/energyLossDetection/today?attributes=energyLossDetails",menuUrl:"/energy/samsungsac",template:'<div class="dashboard-body-content dashboard-energy-loss-4x4"><div class="dashboard-facility-operation-graph"><div class="dashboard-energy-loss-info"><div class="wrapper"><div class="legend-wrapper" data-bind="visible:isHover"><span class="count" data-bind="text: hoverCount"></span><span class="percent">%<br></span><span class="category" data-bind="text: hoverCategory"></span></div></div></div><div class="dashboard-energy-loss-chart" data-role="chart" data-transitions="false" data-series-defaults="{type:\'donut\',holeSize:78}" data-chart-area="{ background : \'\\#f7f7f7\', }" data-series="[{field:\'value\',categoryField:\'type\',visibleInLegendField:\'visibleInLegend\',padding:35,overlay:{gradient:\'none\'}}]" data-bind="source: chartData, events:{seriesHover : onSeriesHover}"></div><span class="dashboard-energy-loss-based-time" data-bind="text:BasedTime"></span><div class="dashboard-energy-loss-legend"><span class="unit">(EA)</span><ul class="legends"><li class="legend"><span class="square insufficient-insulation"></span><p class="key">#=insufficient#</p><p class="value" data-bind="text: InsufficientInsulation"></p></li><li class="legend"><span class="square load-variation"></span><p class="key">#=load#</p><p class="value" data-bind="text: LoadVariation"></p></li><li class="legend"><span class="square abnormal-set-temperature"></span><p class="key">#=abnormalRoomTemp#</p><p class="value" data-bind="text: AbnormalRoomTemp"></p></li><li class="legend"><span class="square temp-setting-error"></span><p class="key">#=abnormalSetTemp#</p><p class="value" data-bind="text: AbnormalSetTemp"></p></li><li class="legend"><span class="square long-time-oper"></span><p class="key">#=longtime#</p><p class="value" data-bind="text: LongTimeOperation"></p></li><li class="legend"><span class="square repetitive-control"></span><p class="key">#=repetitive#</p><p class="value" data-bind="text: RepetitiveControl"></p></li><li class="legend"><span class="square over-time-operation"></span><p class="key">#=overtime#</p><p class="value" data-bind="text: OverTimeOperation"></p></li></ul></div></div></div>',localeTemplateData:{insufficient:"ENERGY_INSUFFICIENT_INSULATION",load:"ENERGY_LOAD_VARIATION",abnormalRoomTemp:"DASHBOARD_ABNORMAL_ROOM_TEMP",abnormalSetTemp:"ENERGY_ABNORMAL_SET_TEMP",longtime:"ENERGY_LONG_TIME_OPERATION",repetitive:"ENERGY_REPETITIVE_CONTROL",overtime:"ENERGY_OVER_TIME_OPERATION"},apiMockData:{energyLossDetails:[{name:"InsufficientInsulation",count:1},{name:"LoadVariation",count:2},{name:"AbnormalRoomTemp",count:3},{name:"AbnormalSetTemp",count:4},{name:"LongTimeOperation",count:5},{name:"RepetitiveControl",count:6},{name:"OverTimeOperation",count:4}]},templateData:{seriesDefaults:'{type:"donut"}',series:""},init:function(){var e=this.viewModel;this.widget.element.on("mouseleave",".k-chart",function(){e.get("isHover")&&e.set("isHover",!1)})},onMoveMenu:function(){u.localStorage.setItem("dashboardShortcut","energylossdetection")},viewModel:{isHover:!1,hoverCount:0,hoverCategory:"",BasedTime:"",InsufficientInsulation:"-",LoadVariation:"-",AbnormalRoomTemp:"-",AbnormalSetTemp:"-",LongTimeOperation:"-",RepetitiveControl:"-",OverTimeOperation:"-",chartData:new g.data.DataSource({data:[]}),onSeriesHover:function(e){this.set("isHover",!0);var a=e.percentage;a=Math.round(100*a);var t=e.category;this.set("hoverCount",a);var i=u.I18N;"InsufficientInsulation"==t?t=i.prop("ENERGY_INSUFFICIENT_INSULATION"):"LoadVariation"==t?t=i.prop("ENERGY_LOAD_VARIATION"):"AbnormalRoomTemp"==t?t=i.prop("DASHBOARD_ABNORMAL_ROOM_TEMP"):"AbnormalSetTemp"==t?t=i.prop("ENERGY_ABNORMAL_SET_TEMP"):"LongTimeOperation"==t?t=i.prop("ENERGY_LONG_TIME_OPERATION"):"RepetitiveControl"==t?t=i.prop("ENERGY_REPETITIVE_CONTROL"):"OverTimeOperation"==t&&(t=i.prop("ENERGY_OVER_TIME_OPERATION")),this.set("hoverCategory",t)}},setDataSource:function(){var e=this.viewModel.get("InsufficientInsulation");e="-"==e?0:e;var a=this.viewModel.get("LoadVariation");a="-"==a?0:a;var t=this.viewModel.get("AbnormalRoomTemp");t="-"==t?0:t;var i=this.viewModel.get("AbnormalSetTemp");i="-"==i?0:i;var s=this.viewModel.get("LongTimeOperation");s="-"==s?0:s;var n=this.viewModel.get("RepetitiveControl");n="-"==n?0:n;var d=this.viewModel.get("OverTimeOperation"),o=[{type:"InsufficientInsulation",value:e,visibleInLegend:!1,color:"#2c81db"},{type:"LoadVariation",value:a,visibleInLegend:!1,color:"#08b5d4"},{type:"AbnormalRoomTemp",value:t,visibleInLegend:!1,color:"#68BA10"},{type:"AbnormalSetTemp",value:i,visibleInLegend:!1,color:"#feac5a"},{type:"LongTimeOperation",value:s,visibleInLegend:!1,color:"#f0824f"},{type:"RepetitiveControl",value:n,visibleInLegend:!1,color:"#eb5b6c"},{type:"OverTimeOperation",value:d="-"==d?0:d,visibleInLegend:!1,color:"#7c62f0"}];(o=new g.data.DataSource({data:o})).read(),this.viewModel.set("chartData",o)},parseData:function(e){var a=u.I18N;void 0!==e.time?this.viewModel.set("BasedTime",e.time+" "+a.prop("DASHBOARD_BASED")):this.viewModel.set("BasedTime","");var t,i,s,n=(e=e.energyLossDetails&&e.energyLossDetails[0]?e.energyLossDetails:[]).length;for(t=0;t<n;t++)i=e[t].name,s=void 0!==e[t].count?e[t].count:"-",i&&this.viewModel.set(i,s);this.setDataSource()}},{refreshOption:{timeout:36e5},width:8,height:4,refreshUrl:"/energy/sac/energyLossDetection/today?attributes=hourlyLoss",menuUrl:"/energy/samsungsac",template:"<div class='dashboard-body-content dashboard-energy-list-4x4'><div class='top-five-bar-graph-wrapper'><div class='graph-y-unit left'>(EA)</div><div data-role='chart' class='top-five-bar-graph' style='height:#=height#;' data-series-defaults='#=seriesDefault#' data-series='#=series#' data-chart-area='#=chartArea#' data-value-axis='#=valueAxis#' data-category-axis='#=categoryAxis#' data-bind='source:list' data-legend='#=legend#'></div></div></div>",templateData:{height:"250px",legend:"{visible:false}",seriesDefault:'{type:"column", axis:"count", categoryAxis:"hour",color:"rgb(0, 129, 198)",overlay:{ gradient : "none"}, border:{width:0}, spacing:0.1,gap:2.5}',chartArea:'{background:"#f7f7f7"}',series:'[{field:"count", name:"count"}]',valueAxis:'[{ name : "count", min : 0, max : 12, line: {visible:false}}]',categoryAxis:'[{name :"hour", majorGridLines : {visible:false}, minorGridLines : {visible : false}, majorUnit:2}]'},listMockData:{hourlyLoss:[{hour:10,count:5},{hour:11,count:5},{hour:12,count:5},{hour:13,count:5},{hour:14,count:5},{hour:15,count:5},{hour:16,count:5},{hour:21,count:5},{hour:22,count:5},{hour:23,count:10},{hour:7,count:5},{hour:8,count:5},{hour:9,count:5}],min:5,max:10},viewModel:{list:[]},onMoveMenu:function(){u.localStorage.setItem("dashboardShortcut","energylossdetection")},parseData:function(e){var a,t;t=e.hourlyLosses||e.hourlyLoss?(a=e.hourlyLosses||e.hourlyLoss,e.max?e.max:10):(a=[],10),a.sort(function(e,a){return(e=Number(e.hour))-(a=Number(a.hour))});var i,s,n,d=[],o=a.length;for(n=0;n<o;n++)i=a[n].hour,s=a[n].count,void 0!==i&&(d[i]={count:s});var r=this.widget.element.find(".top-five-bar-graph").data("kendoChart"),l=_();r.setOptions({categoryAxis:[{name:"hour",minorGridLines:{visible:!1},majorGridLines:{visible:!1},majorUnit:2,categories:l}],valueAxis:[{name:"count",min:0,max:t,line:{visible:!1}}]}),this.viewModel.set("list",d)}}]},sacShortcut:{title:"DASHBOARD_SAC_SHORTCUT",cards:[{refreshOption:!1,width:2,height:2,template:'<div class="dashboard-body-content dashboard-shortcut-2x2"><div class="dashboard-shorcut-dropdownlist" data-bind="invisible : invisibleDropDown"><div class="dashboard-shorcut-dropdownlist-wrapper"><div class="input-wrapper"><input class="k-input shortcut-name" data-role="commonvalidator" data-type="name" data-bind="events:{change:changeName}" required/><button class="k-button" data-bind="disabled:btnDisabled, events:{click:btnClick}">#=save#</button></div><div class="dropdown-wrapper"><input class="building-dropdown" data-role="dropdownlist" data-width="100%" data-animation="false" data-text-field="name" data-value-field="id" data-bind="source: buildingList, value : buildingValue, events:{ change : changeBuilding, dataBound:dataBoundBuilding }"/><input class="floor-dropdown" data-role="dropdownlist" data-width="100%" data-animation="false" data-text-field="name" data-value-field="id" data-bind="source: floorList, disabled:floorDisabled, value : floorValue, events:{ change : changeFloor, dataBound:dataBoundFloor }"/><input class="zone-dropdown" data-role="dropdownlist" data-width="100%" data-animation="false" data-text-field="name" data-value-field="id" data-bind="source: zoneList, disabled:zoneDisabled, value : zoneValue, events:{ change : changeZone, dataBound : dataBoundZone }"/></div></div></div><div class="dashboard-shorcut-display" data-bind="invisible: invisibleDisplay"><p class="shorcut-title" data-bind="text: shortcutName"></p><p class="shorcut-location" data-bind="text:shortcutLocation"></p></div></div>',localeTemplateData:{save:"COMMON_BTN_SAVE"},init:function(){var a=this,e=a.widget,t=e.element.data("message");if(t){var i,s,n,d={},o={},r={},l=(t=t.split("/")).length;for(n=0;n<l;n++){var c=t[n+1];"location"==t[n]?s=c:"name"==t[n]?i=c:"buildingName"==t[n]?o.name=c:"buildingId"==t[n]?o.id=c:"floorName"==t[n]?d.name=c:"floorId"==t[n]?d.id=c:"floorType"==t[n]?d.type=c:"zoneName"==t[n]?r.name=c:"zoneId"==t[n]&&(r.id=c)}this.viewModel.set("shortcutName",i),this.viewModel.set("shortcutLocation",s),this.viewModel.set("buildingValue",o),this.viewModel.set("floorValue",d),this.viewModel.set("zoneValue",r),this.viewModel.set("invisibleDropDown",!0),this.viewModel.set("invisibleDisplay",!1),this.menuUrl="/device"}else e.loading.open(e.element),m.ajax({url:"/foundation/space/buildings"}).done(function(e){e.sort(function(e,a){return e.sortOrder-a.sortOrder}),a.viewModel.set("buildingList",e)}).fail(function(){}).always(function(){e.loading.close()})},onMoveMenu:function(){var e=u.MAIN_WINDOW,a=this.viewModel.get("floorValue"),t=this.viewModel.get("buildingValue"),i=a.type,s=a.name;s=s.replace(i,"");var n={floor:{id:a.id,value:s,type:i},building:{id:t.id,value:t.name}};e.setCurrentFloor(n),u.localStorage.setItem("deviceTypeTab","AirConditioner.Indoor"),u.localStorage.setItem("deviceViewType","MAP")},viewModel:{isHover:!1,disabled:!1,btnDisabled:!0,buildingList:[],buildingValue:null,floorList:[],floorValue:null,floorDisabled:!0,zoneList:[],zoneValue:null,zoneDisabled:!0,shortcutName:"",shortcutLocation:"",changeName:function(){this.checkBtnDisabled()},checkBtnDisabled:function(){var e=this.thisOptions.widget.element.find(".shortcut-name").val(),a=this.get("buildingValue"),t=this.get("floorValue");e&&a&&t?this.set("btnDisabled",!1):this.set("btnDisabled",!0)},changeBuilding:function(e){var a=e.sender.value();if(a instanceof g.data.ObservableObject&&(a=a.id),a){var t=this.thisOptions,i=this,s=t.widget,n=s.element;s.loading.open(n),m.ajax({url:"/foundation/space/floors?foundation_space_buildings_id="+a}).done(function(e){var a,t=e.length;for(e.sort(function(e,a){return e.sortOrder-a.sortOrder}),a=0;a<t;a++)e[a].name=A.getFloorName(e[a]);i.set("floorList",e),i.set("floorValue",null),e.length<1?i.set("floorDisabled",!0):i.set("floorDisabled",!1),i.set("zoneList",[]),i.set("zoneDisabled",!0),i.set("zoneValue",null)}).fail(function(){}).always(function(){i.checkBtnDisabled(),s.loading.close()})}},dataBoundBuilding:function(e){this.changeBuilding(e,!0)},changeFloor:function(e){var a=e.sender.value();if(a instanceof g.data.ObservableObject&&(a=a.id),a){var t=this.thisOptions,i=this,s=t.widget,n=s.element;s.loading.open(n),m.ajax({url:"/foundation/space/zones?foundation_space_floors_id="+a}).done(function(e){e.sort(function(e,a){return e.sortOrder-a.sortOrder}),i.set("zoneList",e),i.set("zoneValue",null),e.length<1?i.set("zoneDisabled",!0):i.set("zoneDisabled",!1)}).fail(function(){}).always(function(){i.checkBtnDisabled(),s.loading.close()})}},dataBoundFloor:function(e){this.changeFloor(e,!0)},changeZone:function(){},dataBoundZone:function(e){this.changeZone(e,!0)},btnClick:function(){var e=this.thisOptions,a=e.widget.element.find(".shortcut-name");if(a.data("kendoCommonValidator").validate()){var t=a.val(),i=this.get("buildingValue"),s=this.get("floorValue"),n=this.get("zoneValue"),d="",o="",r="",l="",c="",v="",p="",u="";i&&(d=i.id,u+=o=i.name),s&&(r=s.id,l=s.name,c=s.type,u+=", "+l),n&&(v=n.id,u+=", "+(p=n.name)),this.set("shortcutLocation",u),this.set("shortcutName",t),this.set("invisibleDropDown",!0),this.set("invisibleDisplay",!1);var m="/name/"+t+"/location/"+u+"/buildingName/"+o+"/buildingId/"+d+"/floorName/"+l+"/floorId/"+r+"/floorType/"+c+"//zoneName/"+p+"/zoneId/"+v;return e.widget.element.attr("data-message",m),e.widget.trigger("onPin"),!(e.menuUrl="/device")}},invisibleDropDown:!1,invisibleDisplay:!0},setRefreshUrl:function(e){this.refreshUrl=e},parseData:function(){}}]},buildingOperationStatus:{title:"DASHBOARD_BUILDING_OPERATION_STATUS",cards:[{width:2,height:2,template:'<div class="dashboard-body-content dashboard-building-operation-status-2x2"><div class="dashboard-building-dropdownlist" data-bind="invisible : invisibleDropDown"><div class="dashboard-building-dropdownlist-wrapper"><div class="dropdown-wrapper"><input data-role="dropdownlist" data-width="100%" data-animation="false" data-text-field="name" data-value-field="id" data-option-label="#=buildingOptionLabel#" data-bind="source: buildingList, value : buildingValue, events:{ select : dropDownSelect }, invisible: invisible, disabled : disabled"/></div><div class="button-wrapper"><button class="k-button" data-bind="disabled:btnDisabled, events:{click:handleClickApplyBtn}"><span>#=btnText#</span></button></div></div></div><div class="dashboard-building-operation-graph" data-bind="invisible: invisibleGraph"><div class="text-wrapper" data-bind="events: {click: handleClickSchedulesArea}"><div class="text-field">#=schedules#</div><p data-bind="text: numberOfSchedules"></p></div><div class="chart-wrapper" data-bind="events: {click: handleClickChartArea }"><div class="on-stack"></div><div class="off-stack"></div><div class="critical-stack"></div><div class="warning-stack"></div></div><div class="table-wrapper" data-bind="events: {click: handleClickTableDataArea }"><div class="table-content"><div class="table-row"><div class="cell">#=on#<p data-bind="text: tableData.numberOfOnIndoorDevices"></p></div><div class="cell">#=off#<p data-bind="text: tableData.numberOfOffIndoorDevices"></p></div><div class="cell">#=critical#<p data-bind="text: tableData.numberOfCriticalDevices"></p></div><div class="cell">#=warning#<p data-bind="text: tableData.numberOfWarningDevices"></p></div></div></div></div></div></div>',init:function(){var e,a=this,t=a.widget,i=t.element.data("message"),s=u.GlobalSettings,n=this.widget.bodyElem.find(".table-wrapper")[0],d=m(n).find(".cell");if(i?(a.viewModel.set("buildingValue",{id:i.split("/")[0],name:i.split("/")[1]}),a.viewModel.handleClickApplyBtn({isSavedCard:!0})):(this.viewModel.set("invisibleGraph",!0),t.loading.open(t.element),m.ajax({url:"/foundation/space/buildings"}).done(function(e){e.sort(function(e,a){return e.sortOrder-a.sortOrder}),a.viewModel.set("buildingList",e)}).fail(function(){}).always(function(){t.loading.close()})),"ko"==s.getLocale())for(e=0;e<d.length;e++)m(d[e]).addClass("cell-ko")},localeTemplateData:{buildingOptionLabel:"DASHBOARD_SELECT_BUILDING",btnText:"COMMON_BTN_APPLY",schedules:"DASHBOARD_BUILDING_OPERATION_STATUS_SCHEDULES",on:"DASHBOARD_BUILDING_OPERATION_STATUS_ON",off:"DASHBOARD_BUILDING_OPERATION_STATUS_OFF",critical:"DASHBOARD_BUILDING_OPERATION_STATUS_CRITICAL",warning:"DASHBOARD_BUILDING_OPERATION_STATUS_WARNING"},viewModel:{isHover:!1,disabled:!1,btnDisabled:!0,buildingList:[],buildingValue:null,dropDownSelect:function(e){""===e.dataItem.id?this.set("btnDisabled",!0):this.set("btnDisabled",!1)},handleClickSchedulesArea:function(e){var a=this.thisOptions.widget,t=a.options,i=this.get("buildingValue"),s=u.MAIN_WINDOW,n={floor:{id:s.FLOOR_NAV_FLOOR_ALL_ID,value:s.FLOOR_NAV_FLOOR_ALL,type:null},building:{id:i.id,value:i.name}};t.menuUrl="/operation/schedule",s.setCurrentFloor(n),a.moveMenu()},handleClickChartArea:function(e){this.gotoDeviceMenu()},handleClickTableDataArea:function(e){this.gotoDeviceMenu()},gotoDeviceMenu:function(){var e=this.thisOptions.widget,a=e.options,t=this.get("buildingValue"),i=u.MAIN_WINDOW,s={floor:{id:i.FLOOR_NAV_FLOOR_ALL_ID,value:i.FLOOR_NAV_FLOOR_ALL,type:null},building:{id:t.id,value:t.name}};a.menuUrl="/device",u.localStorage.setItem("deviceTypeTab","AirConditioner.Indoor"),u.localStorage.setItem("deviceViewType","STATISTIC"),i.setCurrentFloor(s),e.moveMenu()},handleClickApplyBtn:function(e){var a=this,t=this.get("buildingValue").id,i=this.get("buildingValue").name,s=this.thisOptions,n=s.widget,d="/dms/devices/statisticView/AirConditioner?foundation_space_buildings_id="+t+"&exposeFloors=false";s.setRefreshUrl(d),s.widget.element.attr("data-message",t+"/"+i),s.widget.trigger("onPin"),n.refresh().always(function(){a.set("invisibleDropDown",!0),a.set("invisibleGraph",!1)})},numberOfSchedules:"-",chartData:[],tableData:{numberOfOnIndoorDevices:"-",numberOfOffIndoorDevices:"-",numberOfCriticalDevices:"-",numberOfWarningDevices:"-"}},setRefreshUrl:function(e){this.refreshUrl=e},parseData:function(e){var a=this.viewModel,t=this.widget,i=a.buildingValue.name;t.titleElem.text(i),0!==e.length&&(a.set("numberOfSchedules",void 0===e[0].numberOfSchedules||null===e[0].numberOfSchedules?"-":e[0].numberOfSchedules),a.set("tableData.numberOfOnIndoorDevices",void 0===e[0].numberOfOnIndoorDevices||null===e[0].numberOfOnIndoorDevices?"-":e[0].numberOfOnIndoorDevices),a.set("tableData.numberOfOffIndoorDevices",void 0===e[0].numberOfOffIndoorDevices||null===e[0].numberOfOffIndoorDevices?"-":e[0].numberOfOffIndoorDevices),a.set("tableData.numberOfCriticalDevices",void 0===e[0].numberOfCriticalDevices||null===e[0].numberOfCriticalDevices?"-":e[0].numberOfCriticalDevices),a.set("tableData.numberOfWarningDevices",void 0===e[0].numberOfWarningDevices||null===e[0].numberOfWarningDevices?"-":e[0].numberOfWarningDevices),this.setChart())},setChart:function(){var e,a=this.widget.bodyElem.find(".chart-wrapper")[0],t=m(a).find(".on-stack")[0],i=m(a).find(".off-stack")[0],s=m(a).find(".critical-stack")[0],n=m(a).find(".warning-stack")[0],d=this.viewModel.tableData,o=0,r=[d.numberOfOnIndoorDevices,d.numberOfOffIndoorDevices,d.numberOfCriticalDevices,d.numberOfWarningDevices],l=[t,i,s,n],c=0;for(e=0;e<r.length;e++)o+="-"===r[e]?0:r[e];for(e=0;e<r.length;e++)c="-"===r[e]?0:r[e]/o*100,m(l[e]).css({width:c+"%"})}}]},memo:{title:"DASHBOARD_MEMO",cards:[{refreshOption:!1,width:2,height:6,template:'<div class="dashboard-body-content dashboard-memo-2x6"><div class="dashboard-memo-input" data-bind="invisible : invisibleMemo"><textarea id="memo-content" class="k-input" data-role="commonvalidator" data-type="description"></textarea></div><div class="dashboard-memo-display" data-bind="invisible: invisibleDisplay"><p data-bind="text: memoContents"></p></div></div>',init:function(){var t=this,e=t.widget,a=e.element;a.find("#memo-content").on("change",this.viewModel.changeContent.bind(this.viewModel));var i=e.element.data("message");a.find(".dashboard-body-content").off("click").on("click",function(){if(!t.viewModel.get("isEditable")){var e=m(this).find("#memo-content"),a=t.viewModel.get("memoContents");e.val(a),t.viewModel.set("invisibleMemo",!1),t.viewModel.set("invisibleDisplay",!0),t.viewModel.set("isEditable",!0)}}),i&&(this.viewModel.set("memoContents",i),this.viewModel.set("invisibleMemo",!0),this.viewModel.set("invisibleDisplay",!1),this.viewModel.set("isEditable",!1))},viewModel:{invisibleMemo:!1,invisibleDisplay:!0,memoContents:"",isEditable:!1,changeContent:function(){var e=this.thisOptions,a=e.widget.element.find("#memo-content").val();this.set("memoContents",a),this.set("invisibleMemo",!0),this.set("invisibleDisplay",!1),this.set("isEditable",!1),e.widget.element.attr("data-message",a),e.widget.trigger("onPin")}},parseData:function(){}}]},outdoorTemperature:{title:"DASHBOARD_OUTDOOR_TEMPERATURE",cards:[{width:2,height:2,refreshUrl:"/energy/temperature/average",menuUrl:"",template:"<div class='dashboard-body-content dashboard-outdoor-2x2'><div class='dashboard-outdoor-2x2-label'><p class='key'>#=sensor#</p></div><div class='dashboard-outdoor-2x2-value'><span class='unit temp' data-bind='text:unit'></span><p class='value' data-bind='text : value'></p></div></div>",localeTemplateData:{sensor:"DASHBOARD_TEMPERATURE_SENSOR"},mockDatas:{type:"outdoor temperature",degrees:27},viewModel:{value:0,unit:"\xb0C"},parseData:function(e){var a=u.GlobalSettings.getTemperature(),t=A.CHAR[a.unit];this.viewModel.set("unit",t);var i=e.degrees||e.temperature;void 0!==i&&""!=i&&null!==i||(i="-"),this.viewModel.set("value",i)}}]},outdoorHumidity:{title:"DASHBOARD_OUTDOOR_HUMIDITY",cards:[{width:2,height:2,refreshUrl:"/energy/humidity/average",menuUrl:"",template:"<div class='dashboard-body-content dashboard-outdoor-2x2'><div class='dashboard-outdoor-2x2-label'><p class='key'>#=sensor#</p></div><div class='dashboard-outdoor-2x2-value'><span class='unit humi' data-bind='text:unit'></span><p class='value' data-bind='text : value'></p></div></div>",localeTemplateData:{sensor:"DASHBOARD_HUMIDITY_SENSOR"},mockDatas:{humidity:10},viewModel:{value:0,unit:"%"},parseData:function(e){var a=e.humidity;void 0!==a&&""!=a&&null!==a||(a="-"),this.viewModel.set("value",a)}}]},outdoorTempHumidity:{title:"DASHBOARD_OUTDOOR_TEMPERATURE_AND_HUMIDITY",cards:[{width:2,height:2,refreshUrl:"",menuUrl:"",template:"<div class='dashboard-body-content dashboard-alarm-log-2x2 outdoor'><div class='row'><div class='dashboard-alarm-log-2x2-label'><p class='key'>#=tempSensor#</p></div><div class='dashboard-alarm-log-2x2-value'><span class='value unit temp' data-bind='text: tempUnit'></span><p class='value critical' data-bind='text : tempValue'></p></div></div><div class='row'><div class='dashboard-alarm-log-2x2-label'><p class='key'>#=humiSensor#</p></div><div class='dashboard-alarm-log-2x2-value'><span class='value unit humi' data-bind='text: humiUnit'></span><p class='value warning' data-bind='text : humiValue'></p></div></div></div>",localeTemplateData:{tempSensor:"DASHBOARD_TEMPERATURE_SENSOR",humiSensor:"DASHBOARD_HUMIDITY_SENSOR"},viewModel:{humiValue:0,humiUnit:"%",tempValue:0,tempUnit:"\xb0C"},tempMockData:{type:"outdoor temperature",degrees:27},humiMockData:{humidity:10},init:function(){this.widget.options.refreshFunc=this.refreshFunc.bind(this);var e=u.GlobalSettings.getTemperature(),a=A.CHAR[e.unit];this.viewModel.set("tempUnit",a)},refreshFunc:function(){var t=this.widget,i=this;t.loading.open(t.element);var e=[];return e.push(m.ajax({url:"/energy/temperature/average"}).done(function(e){t.bodyElem.find(".dashboard-error-panel").remove();var a=e.degrees||e.temperature;void 0!==a?(""!=a&&null!==a||(a="-"),i.viewModel.set("tempValue",a)):i.viewModel.set("tempValue","-")}).fail(function(e){t.responseFailCallback(e)})),e.push(m.ajax({url:"/energy/humidity/average"}).done(function(e){t.bodyElem.find(".dashboard-error-panel").remove(),void 0!==e.humidity?(""!=e.humidity&&null!==e.humidity||(e.humidity="-"),i.viewModel.set("humiValue",e.humidity)):i.viewModel.set("humiValue","-")}).fail(function(e){t.responseFailCallback(e)})),m.when.apply(this,e).always(function(){t.loading.close()})},parseData:function(){}}]},usedTimeTopFive:{title:"DASHBOARD_USED_TIME_TOP_5_OF_DAY",cards:[{refreshOption:{timeout:function(){var e=o();return 0===e.hours()&&0===e.minutes()}},width:4,height:4,refreshUrl:"/energy/sac/operatingHistory/operationTime/todayTop5",menuUrl:"/energy/samsungsac",template:"<div class='dashboard-body-content dashboard-energy-list-4x4'><ul class='dataList'><li class='head'><div class='tbc num'><span></span></div><div class='tbc dvc' style='width:24.4%'><span>#=deviceName#</span></div><div class='tbc loc'><span>#=location#</span></div><div class='tbc time'><span>#=usedTime#</span></div></li><div data-template='dashboard-energy-list-ul-template' data-bind='source: list' class='dashboard-energy-list'></div></ul><script id='dashboard-energy-list-ul-template' type='text/x-kendo-template'><li><div class='tbc num'><span data-bind='text: rank'></span></div><div class='tbc dvc' style='width:24.4%'><span data-bind='text: deviceName'></span></div><div class='tbc loc'><span data-bind='text:location'></span></div><div class='tbc time'><span data-bind='text:usedTime'></span></div></li><\/script>",localeTemplateData:{location:"FACILITY_HISTORY_LOCATION",usedTime:"DASHBOARD_USED_TIME",deviceName:"FACILITY_DEVICE_DEVICE_NAME"},listMockData:[{rank:"1",deviceName:"device1",location:"30F, A Zone",usedTime:"12:12"},{rank:"2",deviceName:"device2",location:"14F, B Zone",usedTime:"15:12"},{rank:"3",deviceName:"device2",location:"14F, B Zone",usedTime:"15:12"},{rank:"4",deviceName:"device2",location:"14F, B Zone",usedTime:"15:12"},{rank:"5",deviceName:"device2",location:"14F, B Zone",usedTime:"15:12"}],viewModel:{list:[]},parseData:function(e){e=e.top5UsedTime?e.top5UsedTime:[],this.viewModel.set("list",e)},onMoveMenu:function(){u.localStorage.setItem("dashboardEnergyCategory","operationTime")}},{refreshOption:{timeout:function(){var e=o();return 0===e.hours()&&0===e.minutes()}},width:4,height:6,refreshUrl:"/energy/sac/operatingHistory/operationTime/todayTop5",menuUrl:"/energy/samsungsac",template:"<div class='dashboard-body-content dashboard-energy-list-4x4'><div class='top-five-bar-graph-wrapper'><div class='graph-y-unit'>(#=hour#)</div><div data-role='chart' class='top-five-bar-graph' style='height:#=height#;' data-series-defaults='#=seriesDefault#' data-series='#=series#' data-chart-area='#=chartArea#' data-value-axis='#=valueAxis#' data-category-axis='#=categoryAxis#' data-bind='source:chartList' data-legend='#=legend#'></div></div><ul class='dataList'><li class='head'><div class='tbc num'><span></span></div><div class='tbc dvc' style='width:24.4%'><span>#=deviceName#</span></div><div class='tbc loc'><span>#=location#</span></div><div class='tbc time'><span>#=usedTime#</span></div></li><div data-template='dashboard-energy-list-ul-template' data-bind='source: list' class='dashboard-energy-list'></div></ul><script id='dashboard-energy-list-ul-template' type='text/x-kendo-template'><li><div class='tbc num'><span data-bind='text: rank'></span></div><div class='tbc dvc' style='width:24.4%'><span data-bind='text: deviceName'></span></div><div class='tbc loc'><span data-bind='text:location'></span></div><div class='tbc time'><span data-bind='text:usedTime'></span></div></li><\/script>",localeTemplateData:{location:"FACILITY_HISTORY_LOCATION",usedTime:"DASHBOARD_USED_TIME",deviceName:"FACILITY_DEVICE_DEVICE_NAME",hour:"DASHBOARD_HOUR"},templateData:{height:"158px",legend:"{visible:false}",seriesDefault:'{type:"column", axis:"usedTime", categoryAxis:"topFive",color:"rgb(0, 129, 198)",overlay:{ gradient : "none"}, border:{width:0}, spacing:0.1,gap:2.5}',chartArea:'{background:"#f7f7f7"}',series:'[{field:"usedTime", name:"Used Time"}]',valueAxis:'[{ name : "usedTime", min : 0, max : 25, line: {visible:false}}]',categoryAxis:'[{name :"topFive", majorGridLines : {visible:false}, minorGridLines : {visible : false}, line: {visible:false}, majorUnit:5}]'},listMockData:[{rank:"1",deviceName:"device1",location:"30F, A Zone",usedTime:"12:12"},{rank:"2",deviceName:"device2",location:"14F, B Zone",usedTime:"15:12"},{rank:"3",deviceName:"device2",location:"14F, B Zone",usedTime:"15:12"},{rank:"4",deviceName:"device2",location:"14F, B Zone",usedTime:"15:12"},{rank:"5",deviceName:"device2",location:"14F, B Zone",usedTime:"15:12"}],viewModel:{list:[],chartList:[]},parseData:function(e){e=e.top5UsedTime?e.top5UsedTime:[],this.viewModel.set("list",e);var a,t,i=e.length;for(a=0;a<i;a++)t=e[a].usedTime,e[a].usedTime=this.parseMinToHour(t);this.viewModel.set("chartList",e)},parseMinToHour:function(e){return e?e.split(":")[0]:0},onMoveMenu:function(){u.localStorage.setItem("dashboardEnergyCategory","operationTime")}},{refreshOption:{timeout:function(){var e=o();return 0===e.hours()&&0===e.minutes()}},width:2,height:6,refreshUrl:"/energy/sac/operatingHistory/operationTime/todayTop5",menuUrl:"/energy/samsungsac",template:"<div class='dashboard-body-content dashboard-energy-list-4x4'><div class='top-five-bar-graph-wrapper'><div class='graph-y-unit'>(#=hour#)</div><div data-role='chart' class='top-five-bar-graph' style='height:#=height#;' data-series-defaults='#=seriesDefault#' data-series='#=series#' data-chart-area='#=chartArea#' data-value-axis='#=valueAxis#' data-category-axis='#=categoryAxis#' data-bind='source:chartList' data-legend='#=legend#'></div></div><ul class='dataList'><li class='head'><div class='tbc dvc' style='width:24.4%'><span>#=deviceName#</span></div></li><div data-template='dashboard-energy-list-ul-min-time-template' data-bind='source: list' class='dashboard-energy-list'></div></ul><script id='dashboard-energy-list-ul-min-time-template' type='text/x-kendo-template'><li><div class='tbc num'><span data-bind='text: rank'></span></div><div class='tbc dvc' style='width:24.4%'><span data-bind='text: deviceName'></span></div></li><\/script>",localeTemplateData:{location:"FACILITY_HISTORY_LOCATION",usedTime:"DASHBOARD_USED_TIME",deviceName:"FACILITY_DEVICE_DEVICE_NAME",hour:"DASHBOARD_HOUR"},templateData:{height:"158px",legend:"{visible:false}",seriesDefault:'{type:"column", axis:"usedTime", categoryAxis:"topFive",color:"rgb(0, 129, 198)",overlay:{ gradient : "none"}, border:{width:0}, spacing:0.1,gap:2.5}',chartArea:'{background:"#f7f7f7"}',series:'[{field:"usedTime", name:"Used Time"}]',valueAxis:'[{ name : "usedTime", min : 0, max : 25, line: {visible:false}}]',categoryAxis:'[{name :"topFive", majorGridLines : {visible:false}, minorGridLines : {visible : false}, line: {visible:false}, majorUnit:5}]'},listMockData:[{rank:"1",deviceName:"device1",location:"30F, A Zone",usedTime:"12:12"},{rank:"2",deviceName:"device2",location:"14F, B Zone",usedTime:"15:12"},{rank:"3",deviceName:"device2",location:"14F, B Zone",usedTime:"15:12"},{rank:"4",deviceName:"device2",location:"14F, B Zone",usedTime:"15:12"},{rank:"5",deviceName:"device2",location:"14F, B Zone",usedTime:"15:12"}],viewModel:{list:[],chartList:[]},parseData:function(e){e=e.top5UsedTime?e.top5UsedTime:[],this.viewModel.set("list",e);var a,t,i=e.length;for(a=0;a<i;a++)t=e[a].usedTime,e[a].usedTime=this.parseMinToHour(t);this.viewModel.set("chartList",e)},parseMinToHour:function(e){return e?e.split(":")[0]:0},onMoveMenu:function(){u.localStorage.setItem("dashboardEnergyCategory","operationTime")}}]},amountTopFive:{title:"DASHBOARD_AMOUNT_TOP_5_OF_DAY",cards:[{refreshOption:{timeout:function(){var e=o();return 0===e.hours()&&0===e.minutes()}},width:4,height:4,refreshUrl:"/energy/sac/operatingHistory/powerGasUsage/todayTop5",menuUrl:"/energy/samsungsac",template:"<div class='dashboard-body-content dashboard-energy-list-4x4'><ul class='dataList'><li class='head'><div class='tbc num'><span></span></div><div class='tbc dvc' style='width:24.4%'><span>#=deviceName#</span></div><div class='tbc loc'><span>#=location#</span></div><div class='tbc amount'><span>#=amount# (kWh)</span></div></li><div data-template='dashboard-energy-list-ul-amount-template' data-bind='source: list' class='dashboard-energy-list'></div></ul><script id='dashboard-energy-list-ul-amount-template' type='text/x-kendo-template'><li><div class='tbc num'><span data-bind='text: rank'></span></div><div class='tbc dvc' style='width:24.4%'><span data-bind='text: deviceName'></span></div><div class='tbc loc'><span data-bind='text:location'></span></div><div class='tbc time'><span data-bind='text:amount'></span></div></li><\/script>",localeTemplateData:{location:"FACILITY_HISTORY_LOCATION",deviceName:"FACILITY_DEVICE_DEVICE_NAME",amount:"DASHBOARD_AMOUNT"},listMockData:[{rank:"1",deviceName:"device1",location:"30F, A Zone",amount:"354100"},{rank:"2",deviceName:"device2",location:"14F, B Zone",amount:"354100"},{rank:"3",deviceName:"device2",location:"14F, B Zone",amount:"354100"},{rank:"4",deviceName:"device2",location:"14F, B Zone",amount:"354100"},{rank:"5",deviceName:"device2",location:"14F, B Zone",amount:"354100"}],viewModel:{list:[]},parseData:function(e){e=e.top5PowerAmount?e.top5PowerAmount:[],this.setFormat(e),this.viewModel.set("list",e)},setFormat:function(e){var a,t,i=e.length;for(a=0;a<i;a++)t=e[a].amount,t=Number(t),e[a].amount=g.toString(t,"n0")},onMoveMenu:function(){u.localStorage.setItem("dashboardEnergyCategory","powerGasUsage")}},{refreshOption:{timeout:function(){var e=o();return 0===e.hours()&&0===e.minutes()}},width:4,height:6,refreshUrl:"/energy/sac/operatingHistory/powerGasUsage/todayTop5",menuUrl:"/energy/samsungsac",template:"<div class='dashboard-body-content dashboard-energy-list-4x4'><div class='top-five-bar-graph-wrapper'><div class='graph-y-unit' style='float: right;padding-right: 527px;'>(kWh)</div><div data-role='chart' class='top-five-bar-graph' style='height:#=height#; margin-bottom:12px;' data-series-defaults='#=seriesDefault#' data-series='#=series#' data-chart-area='#=chartArea#' data-value-axis='#=valueAxis#' data-category-axis='#=categoryAxis#' data-bind='source:list' data-legend='#=legend#'></div></div><ul class='dataList'><li class='head'><div class='tbc num'><span></span></div><div class='tbc dvc' style='width:24.4%'><span>#=deviceName#</span></div><div class='tbc loc'><span>#=location#</span></div><div class='tbc amount'><span>#=amount# (kWh)</span></div></li><div data-template='dashboard-energy-list-ul-amount-template' data-bind='source: list' class='dashboard-energy-list'></div></ul><script id='dashboard-energy-list-ul-amount-template' type='text/x-kendo-template'><li><div class='tbc num'><span data-bind='text: rank'></span></div><div class='tbc dvc' style='width:24.4%'><span data-bind='text: deviceName'></span></div><div class='tbc loc'><span data-bind='text:location'></span></div><div class='tbc time'><span data-bind='text:amount'></span></div></li><\/script>",localeTemplateData:{location:"FACILITY_HISTORY_LOCATION",deviceName:"FACILITY_DEVICE_DEVICE_NAME",amount:"DASHBOARD_AMOUNT"},templateData:{height:"158px",legend:"{visible:false}",seriesDefault:'{type:"column", axis:"amount", categoryAxis:"topFive",color:"rgb(0, 129, 198)",overlay:{ gradient : "none"}, border:{width:0}, spacing:0.1,gap:2.5}',chartArea:'{background:"#f7f7f7"}',series:'[{field:"amount", name:"Amount (kWh)"}]',valueAxis:'[{ name : "amount", min : 0, max : 50000, line: {visible:false}}]',categoryAxis:'[{name :"topFive", majorGridLines : {visible:false}, minorGridLines : {visible : false}, line: {visible:false}}]'},listMockData:[{rank:"1",deviceName:"device1",location:"30F, A Zone",amount:"500000"},{rank:"2",deviceName:"device2",location:"14F, B Zone",amount:"354100"},{rank:"3",deviceName:"device2",location:"14F, B Zone",amount:"354100"},{rank:"4",deviceName:"device2",location:"14F, B Zone",amount:"354100"},{rank:"5",deviceName:"device2",location:"14F, B Zone",amount:"354100"}],viewModel:{list:[]},parseData:function(e){var a,t,i=0,s=(e=e.top5PowerAmount?e.top5PowerAmount:[]).length;for(t=0;t<s;t++)a=e[t].amount,isNaN(a)||i<(a=Number(a))&&(i=a);0==(i*=1.2)&&(i=1);var n;n=A.getChartOptionsForFiveChartSection(i,0).newMajorUnit,i=A.getChartOptionsForFiveChartSection(i,0).newMax,this.widget.element.find(".top-five-bar-graph").data("kendoChart").setOptions({valueAxis:[{name:"amount",min:0,max:i,line:{visible:!1},minorGridLines:{visible:!1},majorUnit:n}]}),this.viewModel.set("list",e)},onMoveMenu:function(){u.localStorage.setItem("dashboardEnergyCategory","powerGasUsage")}},{refreshOption:{timeout:function(){var e=o();return 0===e.hours()&&0===e.minutes()}},width:2,height:6,refreshUrl:"/energy/sac/operatingHistory/powerGasUsage/todayTop5",menuUrl:"/energy/samsungsac",template:"<div class='dashboard-body-content dashboard-energy-list-4x4'><div class='top-five-bar-graph-wrapper'><div class='graph-y-unit' style='float: right;padding-right: 209px;'>(kWh)</div><div data-role='chart' class='top-five-bar-graph' style='height:#=height#; margin-bottom:12px;' data-series-defaults='#=seriesDefault#' data-series='#=series#' data-chart-area='#=chartArea#' data-value-axis='#=valueAxis#' data-category-axis='#=categoryAxis#' data-bind='source:list' data-legend='#=legend#'></div></div><ul class='dataList'><li class='head'><div class='tbc dvc' style='width:24.4%'><span>#=deviceName#</span></div></li><div data-template='dashboard-energy-list-ul-amount-min-template' data-bind='source: list' class='dashboard-energy-list'></div></ul><script id='dashboard-energy-list-ul-amount-min-template' type='text/x-kendo-template'><li><div class='tbc num'><span data-bind='text: rank'></span></div><div class='tbc dvc' style='width:24.4%'><span data-bind='text: deviceName'></span></div></li><\/script>",localeTemplateData:{location:"FACILITY_HISTORY_LOCATION",deviceName:"FACILITY_DEVICE_DEVICE_NAME",amount:"DASHBOARD_AMOUNT"},templateData:{height:"158px",legend:"{visible:false}",seriesDefault:'{type:"column", axis:"amount", categoryAxis:"topFive",color:"rgb(0, 129, 198)",overlay:{ gradient : "none"}, border:{width:0}, spacing:0.1,gap:2.5}',chartArea:'{background:"#f7f7f7"}',series:'[{field:"amount", name:"Amount (kWh)"}]',valueAxis:'[{ name : "amount", min : 0, max : 50000, line: {visible:false}}]',categoryAxis:'[{name :"topFive", majorGridLines : {visible:false}, minorGridLines : {visible : false}, line: {visible:false}}]'},listMockData:[{rank:"1",deviceName:"device1",location:"30F, A Zone",amount:"500000"},{rank:"2",deviceName:"device2",location:"14F, B Zone",amount:"354100"},{rank:"3",deviceName:"device2",location:"14F, B Zone",amount:"354100"},{rank:"4",deviceName:"device2",location:"14F, B Zone",amount:"354100"},{rank:"5",deviceName:"device2",location:"14F, B Zone",amount:"354100"}],viewModel:{list:[]},parseData:function(e){var a,t,i=0,s=(e=e.top5PowerAmount?e.top5PowerAmount:[]).length;for(t=0;t<s;t++)a=e[t].amount,isNaN(a)||i<(a=Number(a))&&(i=a);0==(i*=1.2)&&(i=1);var n;n=A.getChartOptionsForFiveChartSection(i,0).newMajorUnit,i=A.getChartOptionsForFiveChartSection(i,0).newMax,this.widget.element.find(".top-five-bar-graph").data("kendoChart").setOptions({valueAxis:[{name:"amount",min:0,max:i,line:{visible:!1},minorGridLines:{visible:!1},majorUnit:n}]}),this.viewModel.set("list",e)},onMoveMenu:function(){u.localStorage.setItem("dashboardEnergyCategory","powerGasUsage")}}]},energyLossTopFive:{title:"DASHBOARD_ENERGY_LOSS_TOP_5",cards:[{refreshOption:{timeout:36e5},width:4,height:4,refreshUrl:"/energy/sac/energyLossDetection/today?attributes=top5EnergyLoss",menuUrl:"/energy/samsungsac",template:"<div class='dashboard-body-content dashboard-energy-list-4x4'><ul class='dataList'><li class='head'><div class='tbc num'><span></span></div><div class='tbc energy' style='width:43.5%'><span>#=lossName#</span></div><div class='tbc dvc'><span>#=deviceName#</span></div><div class='tbc count'><span>#=count#</span></div></li><div data-template='dashboard-energy-list-ul-loss-template' data-bind='source: list' class='dashboard-energy-loss-list'></div></ul><script id='dashboard-energy-list-ul-loss-template' type='text/x-kendo-template'><li><div class='tbc num'><span data-bind='text: rank'></span></div><div class='tbc energy' style='width:43.5%'><span data-bind='text: name'></span></div><div class='tbc dvc'><span data-bind='text:deviceName'></span></div><div class='tbc count'><span data-bind='text:count'></span></div></li><\/script>",localeTemplateData:{lossName:"ENERGY_ENERGY_LOSS_NAME",count:"ENERGY_COUNT",location:"FACILITY_HISTORY_LOCATION",deviceName:"FACILITY_DEVICE_DEVICE_NAME"},listMockData:[{rank:1,name:"LongTimeOperation",deviceId:"11.01.00",deviceName:"device1",count:10},{rank:2,name:"RepetitiveControl",deviceId:"11.01.00",deviceName:"device2",count:9},{rank:3,name:"AbnormalSetTemp",deviceId:"11.01.00",deviceName:"device3",count:8},{rank:4,name:"AbnormalRoomTemp",deviceId:"11.01.00",deviceName:"device4",count:10},{rank:5,name:"LoadVariation",deviceId:"11.01.00",deviceName:"device1",count:10}],viewModel:{list:[]},onMoveMenu:function(){u.localStorage.setItem("dashboardShortcut","energylossdetection")},parseData:function(e){e=e.top5EnergyLosses?e.top5EnergyLosses:[],this.setFormat(e),this.viewModel.set("list",e)},setFormat:function(e){var a,t,i,s=u.I18N,n=e.length;for(e.sort(function(e,a){return e.rank-a.rank}),a=0;a<n;a++)i=e[a].count,i=Number(i),e[a].count=g.toString(i,"n0"),"InsufficientInsulation"==(t=e[a].name)?t=s.prop("ENERGY_INSUFFICIENT_INSULATION"):"LoadVariation"==t?t=s.prop("ENERGY_LOAD_VARIATION"):"AbnormalSetTemp"==t?t=s.prop("ENERGY_ABNORMAL_SET_TEMP"):"AbnormalRoomTemp"==t?t=s.prop("DASHBOARD_ABNORMAL_ROOM_TEMP"):"LongTimeOperation"==t?t=s.prop("ENERGY_LONG_TIME_OPERATION"):"RepetitiveControl"==t?t=s.prop("ENERGY_REPETITIVE_CONTROL"):"OverTimeOperation"==t&&(t=s.prop("ENERGY_OVER_TIME_OPERATION")),e[a].name=t}}]},averageUsedTime:{title:"DASHBOARD_AVERAGE_USED_TIME",cards:[{refreshOption:{timeout:function(){var e=o();return 0===e.hours()&&0===e.minutes()}},width:4,height:4,refreshUrl:"/energy/sac/operatingHistory/operationTime/average",menuUrl:"/energy/samsungsac",template:"<div class='dashboard-body-content dashboard-average-used usage'><div class='simpleDataBox'><div class='tbc labels'><p class='name'>#=time#</p><p class='subinfo'><span data-bind='text: time'>2016-08-25 07:00</span> #=based#</p></div><div class='tbc values'><span><span class='t-blue' data-bind='text: yesterdayAverage'>9</span><span class='unit lower'>#=hour#</span></span></div></div><div class='subDataList'><ul><li><p class='labels'>#=monthAverage#</p><p class='values'><strong data-bind='text:monthAverage'>8</strong><span>#=hour#<span></p></li><li><p class='labels'>#=estAverage#</p><p class='values'><strong data-bind='text:monthEstAverage'>10</strong><span>#=hour#</span></p></li></ul></div></div>",localeTemplateData:{based:"DASHBOARD_BASED",estAverage:"DASHBOARD_ESTIMATED_MONTHLY_AVERAGE_USED_TIME",monthAverage:"DASHBOARD_MONTHLY_AVERAGE_USED_TIME",time:"DASHBOARD_YESTERDAY",hour:"DASHBOARD_HOUR"},avgMockData:{responseTime:o().format("YYYY-MM-DD HH:mm").replace(/\./g,"-"),average:{yesterday:9,monthly:8,estMonthly:10}},viewModel:{time:o().format("YYYY-MM-DD HH:mm").replace(/\./g,"-"),yesterdayAverage:0,monthAverage:0,monthEstAverage:0,unit:"Hours"},parseData:function(e){var a,t,i,s,n;a=e.responseTime,this.viewModel.set("time",a),i=void 0!==(t=e.average?e.average:this.avgMockData.average).yesterday?t.yesterday:"-",s=void 0!==t.monthly?t.monthly:"-",n=void 0!==t.estMonthly?t.estMonthly:"-",this.viewModel.set("yesterdayAverage",i),this.viewModel.set("monthAverage",s),this.viewModel.set("monthEstAverage",n);var d=u.I18N;this.viewModel.set("unit",d.prop("COMMON_HOURS"))},onMoveMenu:function(){u.localStorage.setItem("dashboardEnergyCategory","operationTime")}}]},meterAverageUsage:{title:"DASHBOARD_AVERAGE_USAGE",cards:[{refreshOption:{timeout:36e5},width:4,height:4,template:"<div class='dashboard-body-content dashboard-average-used'><div class='average-dropdown' data-bind='invisible: invisibleDropdown'><div class='tbc'><div class='wrapper'><input data-role='dropdownlist' data-text-field='displayType' data-value-field='type' data-option-label='#=meterOptionLabel#' data-bind='source:meterTypeList, events:{change:changeType}, disabled:disabledMeter'/></div><div class='wrapper'><input class='group-check-dropdown' data-role='dropdowncheckbox' data-text-field='name' data-value-field='id' data-option-label='#=groupOptionLabel#' data-empty-text='#=noSelectText#' data-select-all-text='#=selectAllText#' data-bind='source:groupList, disabled:disabledGroup, events:{change:changeGroup, selectionChanged:selectedGroup}'/></div><div class='wrapper'><button class='k-button' data-bind='events:{click:clickApply}, disabled:disabledApply'>#=apply#</button></div></div></div><div class='average usage' data-bind='invisible: invisibleDisplay'><div class='simpleDataBox'><div class='tbc labels'><p class='name'>#=today#</p><p class='subinfo'><span data-bind='text: today'>2016-08-25 07:00</span> #=based#</p></div><div class='tbc values'><span class='t-blue'><span data-bind='text: todayAverage'>9</span><span class='unit lower' data-bind='text:unit'>#=hour#</span></span></div></div><div class='subDataList'><ul><li><p class='labels'>#=monthAverage#</p><p class='values'><strong data-bind='text:monthAverage'>8</strong><span data-bind='text:unit'>#=hour#<span></p></li><li><p class='labels'>#=estAverage#</p><p class='values'><strong data-bind='text:monthEstAverage'>10</strong><span data-bind='text:unit'>#=hour#</span></p></li></ul></div></div></div>",avgMockData:{"Meter.Gas":{time:o().format("YYYY-MM-DD HH:mm").replace(/\./g,"-"),summary:[{dms_meter_type:"Meter.Gas",today:6375,monthly:5412,estMonthly:6048,unit:"m3"}]},"Meter.Water":{time:o().format("YYYY-MM-DD HH:mm").replace(/\./g,"-"),summary:[{dms_meter_type:"Meter.Water",today:6375,monthly:5412,estMonthly:6048,unit:"L"}]},"Meter.WattHour":{time:o().format("YYYY-MM-DD HH:mm").replace(/\./g,"-"),summary:[{dms_meter_type:"Meter.WattHour",today:6375,monthly:5412,estMonthly:6048,unit:"kWh"}]}},localeTemplateData:{meterOptionLabel:"DASHBOARD_ALL_ENERGY_METER_TYPE",groupOptionLabel:"FACILITY_HISTORY_GROUP",noSelectText:"DASHBOARD_SELECT_GROUP",selectAllText:"DASHBOARD_ALL_GROUP",apply:"COMMON_BTN_APPLY",based:"DASHBOARD_BASED",estAverage:"DASHBOARD_ESTIMATED_MONTHLY_AVERAGE",monthAverage:"DASHBOARD_MONTHLY_AVERAGE",today:"DASHBOARD_TODAY",hour:"DASHBOARD_HOUR"},viewModel:{invisibleDropdown:!1,invisibleDisplay:!0,meterTypeList:[],meterType:null,disabledMeter:!1,groupList:[],disabledGroup:!0,disabledApply:!0,today:o().format("YYYY-MM-DD HH:mm").replace(/\./g,"-"),todayAverage:0,monthAverage:0,monthEstAverage:0,unit:"kWh",groupIds:"",groupNames:"",changeType:function(e){var a=this,t=a.thisOptions,i=t.widget.element.find(".group-check-dropdown").eq(1).data("kendoDropDownCheckBox"),s=e.sender.value();if(s){a.set("meterType",s);var n=t.widget.loading;n.open(),m.ajax({url:"/dms/groups?dms_devices_types="+s}).done(function(e){a.set("groupList",e),i.unselectAll(),a.set("disabledApply",!0),a.set("disabledGroup",0==e.length)}).fail(function(){a.set("disabledGroup",!0)}).always(function(){n.close()})}else a.set("disabledGroup",!0),a.set("disabledApply",!0)},changeGroup:function(){},selectedGroup:function(e){var a=e.newValue;if(!a||a.length<1)this.set("disabledApply",!0);else{var t,i,s,n=this.get("groupList"),d="",o=n.length,r=a.length;for(i=0;i<r;i++){for(t=a[i],s=0;s<o;s++)if(n[s].id==t){d+=n[s].name;break}i!=r-1&&""!=d&&(d+=", ")}this.set("groupIds",a.join(",")),this.set("groupNames",d),this.set("disabledApply",!1)}},clickApply:function(e){var a,t=this,i=t.thisOptions,s=i.widget,n=t.get("groupIds"),d=t.get("groupNames"),o=t.get("meterType"),r="/energy/consumption/summary?dms_meter_types="+o+"&dms_group_ids="+n;i.refreshUrl=r;var l=u.I18N;"Meter.WattHour"==o?a=l.prop("DASHBOARD_POWER_AVERAGE"):"Meter.Gas"==o?a=l.prop("DASHBOARD_GAS_AVERAGE"):"Meter.Water"==o&&(a=l.prop("DASHBOARD_WATER_AVERAGE"));var c=a+" > "+d;i.widget.titleElem.text(c);var v="/groupNames/"+d+"/groupIds/"+n+"/meterType/"+o+"/";e.isSavedCard||(i.widget.element.attr("data-message",v),i.widget.trigger("onPin")),s.refresh().always(function(){t.set("invisibleDropdown",!0),t.set("invisibleDisplay",!1),i.menuUrl="/energy/consumptionandtarget"})}},init:function(){var e=u.I18N,a=[{displayType:e.prop("FACILITY_DEVICE_ENERGY_METER_TYPE_WATTHOUR"),type:"Meter.WattHour"},{displayType:e.prop("FACILITY_DEVICE_ENERGY_METER_TYPE_GAS"),type:"Meter.Gas"},{displayType:e.prop("FACILITY_DEVICE_ENERGY_METER_TYPE_WATER"),type:"Meter.Water"}];this.viewModel.set("meterTypeList",a);var t,i,s=this.viewModel.meterTypeList,n=s.length;for(i=n-1;0<=i;i--)t=s[i],A.isInstalledType(t.type,!0)||s.splice(i,1);var d=this.widget.element.data("message");if(d){var o=d.split("/");for(n=o.length,i=0;i<n;i++)"groupNames"==o[i]?this.viewModel.set("groupNames",o[i+1]):"groupIds"==o[i]?this.viewModel.set("groupIds",o[i+1]):"meterType"==o[i]&&this.viewModel.set("meterType",o[i+1]);this.viewModel.clickApply({isSavedCard:!0})}},parseData:function(e){var a,t,i,s,n,d;this.viewModel.get("meterType");a=e.time?e.time:"-",i=void 0!==(t=0!==(t=e.summary?e.summary:"-").length?t[0]:"-").today?t.today:"-",s=void 0!==t.monthly?t.monthly:"-",n=void 0!==t.estMonthly?t.estMonthly:"-","m3"==(d=void 0!==t.unit?t.unit:"")?d="m\xb3":"l"==d&&(d="L"),this.viewModel.set("today",a),this.viewModel.set("todayAverage",i),this.viewModel.set("monthAverage",s),this.viewModel.set("monthEstAverage",n),this.viewModel.set("unit",d)}}]},energyPeak:{title:"DASHBOARD_ENERGY_PEAK",cards:[{width:2,height:4,template:"<div class='dashboard-body-content dashboard-energy-peak'><div class='average-dropdown' data-bind='invisible: invisibleDropdown'><div class='tbc'><div class='wrapper'><input data-role='dropdownlist' data-text-field='name' data-value-field='id' data-bind='source:deviceList, events:{change:changeDevice}, disabled:disabledDevice'/></div><div class='wrapper'><button class='k-button' data-bind='events:{click:clickApply}, disabled:disabledApply'>#=apply#</button></div></div></div><div class='radial-guage' data-bind='invisible:invisibleDisplay'><div class='gauge-num peak-1'>1</div><div class='gauge-num peak-2'>2</div><div class='gauge-num peak-3'>3</div><div data-role='radialgauge' data-scale='#=scale#' data-pointer='#=pointer#' data-bind='value:peakLevel'></div><div class='gaugeData min'><p class='nowData' data-bind='css:{red:isTargetOver}'><strong data-bind='text:currentDemand'>250,780</strong><span class='unit'>kW</span></p><p></p><p>/ <span><span data-bind='text:targetDemand'>175,780</span> kW</span></p><p></p></div></div>",MockData:{deviceName:"device 1",currentDemand:150780,targetDemand:175780,peakLevel:3},localeTemplateData:{apply:"COMMON_BTN_APPLY"},templateData:{scale:'{startAngle: 0,endAngle: 180,min: 0,max: 30, majorTicks:{visible : false}, minorTicks: {visible : false}, rangeSize : 18, rangeDistance:-33, ranges: [{from: 0,to: 10, color: "rgb(84, 183, 96)",}, {from: 10,to: 20,color: "rgb(255, 192, 22)"},{from: 20,to: 30, color: "rgb(255, 61, 51)"}],labels: {visible : false}}',pointer:'{value: 5,color: "#333",cap:{size:0}}'},viewModel:{invisibleDropdown:!1,invisibleDisplay:!0,deviceList:[],disabledDevice:!0,disabledApply:!0,peakLevel:3,currentDemand:0,targetDemand:0,isTargetOver:!1,deviceId:"",deviceName:"",changeDevice:function(e){var a=e.sender.value(),t=e.sender.text();this.set("deviceId",a),this.set("deviceName",t)},clickApply:function(e){var a=this,t=a.thisOptions,i=t.widget,s=a.get("deviceId"),n=a.get("deviceName"),d="/energy/sac/demandMonitoring/runtime/latest?dms_device_id="+s;t.refreshUrl=d;var o=u.I18N.prop("DASHBOARD_ENERGY_PEAK")+" > "+n;t.widget.titleElem.text(o);var r="/deviceName/"+n+"/deviceId/"+s+"/";e.isSavedCard||(t.widget.element.attr("data-message",r),t.widget.trigger("onPin")),i.refresh().always(function(){a.set("invisibleDropdown",!0),a.set("invisibleDisplay",!1),t.menuUrl="/energy/samsungsac"})}},init:function(){var a=this,e=a.widget.element.data("message"),t=u.I18N;if(e){var i,s=e.split("/"),n=s.length;for(i=0;i<n;i++)"deviceId"==s[i]?a.viewModel.set("deviceId",s[i+1]):"deviceName"==s[i]&&a.viewModel.set("deviceName",s[i+1]);a.viewModel.clickApply({isSavedCard:!0})}else{var d=a.widget.loading;d.open(),m.ajax({url:"/dms/devices?types=AirConditionerController.DMS,AirConditionerController.WirelessDDC&registrationStatuses=Registered"}).done(function(e){e.length<1?(a.viewModel.set("disabledDevice",!0),a.viewModel.set("disabledApply",!0),a.widget.bodyElem.find("input").eq(0).data("kendoDropDownList").setOptions({optionLabel:t.prop("DASHBOARD_NO_INSTALLED_DEVICE")})):(a.viewModel.set("deviceList",e),a.viewModel.set("deviceId",e[0].id),a.viewModel.set("deviceName",e[0].name),a.viewModel.set("disabledDevice",!1),a.viewModel.set("disabledApply",!1),a.widget.bodyElem.find("input").eq(0).data("kendoDropDownList").setOptions({optionLabel:!1}))}).fail(function(){}).always(function(){d.close()})}},parseData:function(e){var a,t,i;a=void 0!==e.currentDemand?e.currentDemand:0,t=void 0!==e.targetDemand?e.targetDemand:0;i=[5,15,25][(i=void 0!==e.peakLevel?e.peakLevel:0)-1],this.viewModel.set("currentDemand",g.toString(a,"n0")),this.viewModel.set("targetDemand",g.toString(t,"n0")),this.viewModel.set("peakLevel",i),t<a&&this.viewModel.set("isTargetOver",!0)},onMoveMenu:function(){u.localStorage.setItem("dashboardShortcut","demandmonitoring"),u.localStorage.setItem("dashboardDemandBtn","runtime")}},{width:4,height:4,template:"<div class='dashboard-body-content dashboard-energy-peak-4x4'><div class='average-dropdown' data-bind='invisible: invisibleDropdown'><div class='tbc'><div class='wrapper'><input data-role='dropdownlist' data-text-field='name' data-value-field='id' data-bind='source:deviceList, events:{change:changeDevice}, disabled:disabledDevice'/></div><div class='wrapper'><button class='k-button' data-bind='events:{click:clickApply}, disabled:disabledApply'>#=apply#</button></div></div></div><div class='radial-guage' data-bind='invisible:invisibleDisplay'><div class='tbc'><div class='gauge-num peak-1'>1</div><div class='gauge-num peak-2'>2</div><div class='gauge-num peak-3'>3</div><div data-role='radialgauge' data-gauge-area='#=gaugeArea#' data-scale='#=scale#' data-pointer='#=pointer#' data-bind='value:peakLevel'></div></div><div class='tbc' style='width:262px;'><div class='gaugeData'><p class='nowData' data-bind='css:{red:isTargetOver}'><strong data-bind='text:currentDemand'>250,780</strong><span class='unit'>kW</span></p><p></p><p>/ <span><span data-bind='text:targetDemand'>175,780</span> kW</span></p><p></p></div></div></div>",MockData:{deviceName:"device 1",currentDemand:150780,targetDemand:175780,peakLevel:3},localeTemplateData:{apply:"COMMON_BTN_APPLY"},templateData:{gaugeArea:"{margin :{top:-20}}",scale:'{startAngle: 0,endAngle: 180,min: 0,max: 30, majorTicks:{visible : false}, minorTicks: {visible : false}, rangeSize : 18, rangeDistance:-33, ranges: [{from: 0,to: 10, color: "rgb(84, 183, 96)",}, {from: 10,to: 20,color: "rgb(255, 192, 22)"},{from: 20,to: 30, color: "rgb(255, 61, 51)"}],labels: {visible : false}}',pointer:'{value: 5,color: "#333",cap:{size:0}}'},viewModel:{invisibleDropdown:!1,invisibleDisplay:!0,deviceList:[],disabledDevice:!0,disabledApply:!0,peakLevel:3,currentDemand:0,targetDemand:0,isTargetOver:!1,deviceId:"",deviceName:"",changeDevice:function(e){var a=e.sender.value(),t=e.sender.text();this.set("deviceId",a),this.set("deviceName",t)},clickApply:function(e){var a=this,t=a.thisOptions,i=t.widget,s=a.get("deviceId"),n=a.get("deviceName"),d="/energy/sac/demandMonitoring/runtime/latest?dms_device_id="+s;t.refreshUrl=d;var o=u.I18N.prop("DASHBOARD_ENERGY_PEAK")+" > "+n;t.widget.titleElem.text(o);var r="/deviceName/"+n+"/deviceId/"+s+"/";e.isSavedCard||(t.widget.element.attr("data-message",r),t.widget.trigger("onPin")),i.refresh().always(function(){a.set("invisibleDropdown",!0),a.set("invisibleDisplay",!1),t.menuUrl="/energy/samsungsac"})}},init:function(){var a=this,e=a.widget.element.data("message"),t=u.I18N;if(e){var i,s=e.split("/"),n=s.length;for(i=0;i<n;i++)"deviceId"==s[i]?a.viewModel.set("deviceId",s[i+1]):"deviceName"==s[i]&&a.viewModel.set("deviceName",s[i+1]);a.viewModel.clickApply({isSavedCard:!0})}else{var d=a.widget.loading;d.open(),m.ajax({url:"/dms/devices?types=AirConditionerController.DMS,AirConditionerController.WirelessDDC&registrationStatuses=Registered"}).done(function(e){e.length<1?(a.viewModel.set("disabledDevice",!0),a.viewModel.set("disabledApply",!0),a.widget.bodyElem.find("input").eq(0).data("kendoDropDownList").setOptions({optionLabel:t.prop("DASHBOARD_NO_INSTALLED_DEVICE")})):(a.viewModel.set("deviceList",e),a.viewModel.set("deviceId",e[0].id),a.viewModel.set("deviceName",e[0].name),a.viewModel.set("disabledDevice",!1),a.viewModel.set("disabledApply",!1),a.widget.bodyElem.find("input").eq(0).data("kendoDropDownList").setOptions({optionLabel:!1}))}).fail(function(){}).always(function(){d.close()})}},parseData:function(e){var a,t,i;a=void 0!==e.currentDemand?e.currentDemand:0,t=void 0!==e.targetDemand?e.targetDemand:0;i=[5,15,25][(i=void 0!==e.peakLevel?e.peakLevel:0)-1],this.viewModel.set("currentDemand",g.toString(a,"n0")),this.viewModel.set("targetDemand",g.toString(t,"n0")),this.viewModel.set("peakLevel",i),t<a&&this.viewModel.set("isTargetOver",!0)},onMoveMenu:function(){u.localStorage.setItem("dashboardShortcut","demandmonitoring"),u.localStorage.setItem("dashboardDemandBtn","runtime")}},{width:6,height:4,template:"<div class='dashboard-body-content dashboard-energy-peak-6x4'><div class='average-dropdown' data-bind='invisible: invisibleDropdown'><div class='tbc'><div class='wrapper'><input data-role='dropdownlist' data-text-field='name' data-value-field='id' data-bind='source:deviceList, events:{change:changeDevice}, disabled:disabledDevice'/></div><div class='wrapper'><button class='k-button' data-bind='events:{click:clickApply}, disabled:disabledApply'>#=apply#</button></div></div></div><div data-bind='invisible:invisibleDisplay'><div class='energy-peak-bar-graph-wrapper'><div class='chart-legend'><div class='graph-y-unit' style='float: left;padding-left: 5px;'>(kW)</div><span class='legend peak-0'></span><span class='legend peak-1'></span><span class='legend peak-2'></span><span class='legend peak-3'></span>#=peakLevel# + #=currentDemand#<span class='legend target'><span class='two-line'></span></span>#=estimatedLine#<span class='legend target'><span class='line'></span></span>#=targetDemand#</div><div data-role='chart' class='peak-bar-graph' style='height:#=height#; width:#=width#' data-series-defaults='#=seriesDefault#' data-series='#=series#' data-chart-area='#=chartArea#' data-value-axis='#=valueAxis#' data-category-axis='#=categoryAxis#' data-bind='source:list' data-legend='#=legend#'></div></div></div></div>",localeTemplateData:{apply:"COMMON_BTN_APPLY",peakLevel:"ENERGY_PEAK_LEVEL",currentDemand:"ENERGY_CURRENT_DEMAND",targetDemand:"ENERGY_TARGET_DEMAND",estimatedLine:"ENERGY_ESTIMATE_LINE"},MockData:{runtime:[{syncTime:"12:00",currentDemand:32500,estimateDemand:1e4,targetDemand:27e3,peakLevel:2},{syncTime:"13:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{syncTime:"14:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{syncTime:"15:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:1},{syncTime:"1:00",currentDemand:32500,estimateDemand:32e3,targetDemand:27e3,peakLevel:2},{syncTime:"2:00",currentDemand:32500,estimateDemand:31e3,targetDemand:27e3,peakLevel:0},{syncTime:"3:00",currentDemand:32500,estimateDemand:25e3,targetDemand:27e3,peakLevel:3},{syncTime:"4:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{syncTime:"5:00",currentDemand:32500,estimateDemand:33e3,targetDemand:27e3,peakLevel:1},{syncTime:"6:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:2},{syncTime:"7:00",currentDemand:32500,estimateDemand:12e3,targetDemand:27e3,peakLevel:1},{syncTime:"8:00",currentDemand:32500,estimateDemand:33e3,targetDemand:27e3,peakLevel:3},{syncTime:"9:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:1},{syncTime:"10:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:0},{syncTime:"11:00",currentDemand:32500,targetDemand:27e3,peakLevel:1}],min:{currentDemand:3250,estimateDemand:3100,targetDemand:2300},max:{currentDemand:3290,estimateDemand:3500,targetDemand:2700}},templateData:{height:"240px",width:"875px",legend:"{visible:false}",seriesDefault:'{overlay:{ gradient : "none"}, border:{width:0}, spacing:1,gap:3, missingValues: "gap" }',chartArea:'{background:"#f7f7f7"}',series:'[{type:"column", field:"currentDemand", name:"currentDemandPeak1", categoryAxis:"syncTime", color:"#afaeae"},{type:"line", field:"targetDemand", name:"targetDemand", color:"#2c81db", markers:{size:0}, width:1}, {type:"line", field:"estimateDemand", name:"estimateDemand", categoryAxis:"syncTime", color:"#333333", markers:{size:0},width:1}]',valueAxis:'[{ name : "currentDemand", min : 0, max : 60000, line: {visible:false}, majorUnit:10000}]',categoryAxis:'[{name :"syncTime", field:"syncTime", majorGridLines:{visible:false},minorGridLines : {visible : false}, majorTicks:{visible : false}}]'},viewModel:{invisibleDropdown:!1,invisibleDisplay:!0,deviceList:[],disabledDevice:!0,disabledApply:!0,peakLevel:5,deviceId:"",deviceName:"",changeDevice:function(e){var a=e.sender.value(),t=e.sender.text();this.set("deviceId",a),this.set("deviceName",t)},clickApply:function(e){var a=this,t=a.thisOptions,i=t.widget,s=a.get("deviceId"),n=a.get("deviceName"),d="/energy/sac/demandMonitoring/runtime?dms_device_id="+s;t.refreshUrl=d;var o=u.I18N,r=o.prop("DASHBOARD_ENERGY_PEAK_TREND")+"("+o.prop("DASHBOARD_ENERGY_EOI_TIME")+") > "+n;t.widget.titleElem.text(r);var l="/deviceName/"+n+"/deviceId/"+s+"/";e.isSavedCard?(t.menuUrl="/energy/samsungsac",a.set("invisibleDropdown",!0),a.set("invisibleDisplay",!1)):(t.widget.element.attr("data-message",l),t.widget.trigger("onPin"),i.refresh().always(function(){t.menuUrl="/energy/samsungsac",a.set("invisibleDropdown",!0),a.set("invisibleDisplay",!1)}))}},init:function(){var a=this,e=a.widget.element.data("message"),t=u.I18N;if(e){var i,s=e.split("/"),n=s.length;for(i=0;i<n;i++)"deviceId"==s[i]?a.viewModel.set("deviceId",s[i+1]):"deviceName"==s[i]&&a.viewModel.set("deviceName",s[i+1]);a.viewModel.clickApply({isSavedCard:!0})}else{var d=a.widget.loading;d.open(),m.ajax({url:"/dms/devices?types=AirConditionerController.DMS,AirConditionerController.WirelessDDC&registrationStatuses=Registered"}).done(function(e){e.length<1?(a.viewModel.set("disabledDevice",!0),a.viewModel.set("disabledApply",!0),a.widget.bodyElem.find("input").eq(0).data("kendoDropDownList").setOptions({optionLabel:t.prop("DASHBOARD_NO_INSTALLED_DEVICE")})):(a.viewModel.set("deviceList",e),a.viewModel.set("deviceId",e[0].id),a.viewModel.set("deviceName",e[0].name),a.viewModel.set("disabledDevice",!1),a.viewModel.set("disabledApply",!1),a.widget.bodyElem.find("input").eq(0).data("kendoDropDownList").setOptions({optionLabel:!1}))}).fail(function(){}).always(function(){d.close()})}},peakLevelColors:["#afaeae","#1aa05a","#ffa41f","#ef2b2b"],parseData:function(e){var a;(e=e.runtime?(a=e.max,e.runtime):[]).sort(function(e,a){return e=e.syncTime?e.syncTime:"00:00",a=a.syncTime?a.syncTime:"00:00",e=e.split(":"),a=a.split(":"),(e=60*Number(e[e.length-2])+Number(e[e.length-1]))-(a=60*Number(a[a.length-2])+Number(a[a.length-1]))});var t,i=this.widget,s=this,n=[{type:"column",field:"currentDemand",name:"currentDemandPeak1",categoryAxis:"syncTime",color:function(e){var a=e.dataItem.peakLevel;return a=a||0,s.peakLevelColors[a]}},{type:"line",field:"targetDemand",name:"targetDemand",color:"#2c81db",markers:{size:0},width:1},{type:"line",field:"estimateDemand",name:"estimateDemand",categoryAxis:"syncTime",color:"#333333",markers:{size:0},width:1}],d=[{name:"currentDemand",min:0,max:1,line:{visible:!1},majorUnit:.2}],o=0;if(a)for(t in a)o<a[t]&&(o=a[t]);0!==o&&(o*=1.2,d[0].max=A.getChartOptionsForFiveChartSection(o,0).newMax,d[0].majorUnit=A.getChartOptionsForFiveChartSection(o,0).newMajorUnit),i.element.find(".peak-bar-graph").data("kendoChart").setOptions({series:n,valueAxis:d}),this.viewModel.set("list",e)},onMoveMenu:function(){u.localStorage.setItem("dashboardShortcut","demandmonitoring"),u.localStorage.setItem("dashboardDemandBtn","runtime")}},{refreshOption:{timeout:function(){var e=o();return 0===e.hours()&&0===e.minutes()}},width:8,height:4,template:"<div class='dashboard-body-content dashboard-energy-peak-8x4'><div class='average-dropdown' data-bind='invisible: invisibleDropdown'><div class='tbc'><div class='wrapper'><input data-role='dropdownlist' data-text-field='name' data-value-field='id' data-bind='source:deviceList, events:{change:changeDevice}, disabled:disabledDevice'/></div><div class='wrapper'><button class='k-button' data-bind='events:{click:clickApply}, disabled:disabledApply'>#=apply#</button></div></div></div><div data-bind='invisible:invisibleDisplay'><div class='energy-peak-bar-graph-wrapper'><div class='chart-legend'><div class='graph-y-unit' style='float: left;padding-left: 5px;'>(kW)</div><span class='legend peak-0'></span><span class='legend peak-1'></span><span class='legend peak-2'></span><span class='legend peak-3'></span>#=peakLevel# + #=currentDemand#<span class='legend target'><span class='line'></span></span>#=targetDemand#</div><div data-role='chart' class='top-five-bar-graph peak-bar-graph' style='height:#=height#; width:#=width#' data-series-defaults='#=seriesDefault#' data-series='#=series#' data-chart-area='#=chartArea#' data-value-axis='#=valueAxis#' data-category-axis='#=categoryAxis#' data-legend='#=legend#'></div></div></div></div>",localeTemplateData:{apply:"COMMON_BTN_APPLY",peakLevel:"ENERGY_PEAK_LEVEL",currentDemand:"ENERGY_CURRENT_DEMAND",targetDemand:"ENERGY_TARGET_DEMAND",estimatedLine:"ENERGY_ESTIMATE_LINE"},MockData:{hourly:[{time:"00:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"01:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"02:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"03:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"04:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"05:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"06:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"07:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"09:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"09:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"10:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"11:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"12:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"13:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"14:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"15:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"16:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"17:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"18:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"19:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"20:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"21:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"22:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3},{time:"23:00",currentDemand:32500,estimateDemand:35e3,targetDemand:27e3,peakLevel:3}]},templateData:{selectAllText:"All Group",height:"240px",width:"1190px",legend:"{visible:false}",seriesDefault:'{overlay:{ gradient : "none"}, border:{width:0}, spacing:0.1,missingValues: "gap"}',chartArea:'{background:"#f7f7f7"}',series:'[{type:"column", field:"currentDemand", name:"currentDemandPeak", categoryAxis:"hour", color:"#afaeae"},{type:"line", field:"targetDemand", name:"targetDemand", color:"#2c81db", markers:{size:0},width:1}]',valueAxis:'[{ name : "currentDemand", min : 0, max : 60000, line: {visible:false}, majorUnit:10000, majorGridLines:{visible:false}}]',categoryAxis:'[{name :"hour", field:"time", minorGridLines : {visible : false}, majorTicks:{visible : false}}]'},viewModel:{invisibleDropdown:!1,invisibleDisplay:!0,deviceList:[],disabledDevice:!0,disabledApply:!0,peakLevel:5,deviceId:"",deviceName:"",changeDevice:function(e){var a=e.sender.value(),t=e.sender.text();this.set("deviceId",a),this.set("deviceName",t)},clickApply:function(e){var a=this,t=a.thisOptions,i=t.widget,s=a.get("deviceId"),n=a.get("deviceName"),d=new Date,o=d.getFullYear(),r=d.getMonth()+1,l=d.getDate()-1,c="/energy/sac/demandMonitoring?dms_device_id="+s+"&year="+o+"&month="+(r=g.toString(r,"00"))+"&day="+(l=g.toString(l,"00"));t.refreshUrl=c;var v=u.I18N.prop("DASHBOARD_ENERGY_PEAK_TREND")+" > "+n;t.widget.titleElem.text(v);var p="/deviceName/"+n+"/deviceId/"+s+"/";e.isSavedCard?(t.menuUrl="/energy/samsungsac",a.set("invisibleDropdown",!0),a.set("invisibleDisplay",!1)):(t.widget.element.attr("data-message",p),t.widget.trigger("onPin"),i.refresh().always(function(){t.menuUrl="/energy/samsungsac",a.set("invisibleDropdown",!0),a.set("invisibleDisplay",!1)}))}},init:function(){var a=this,e=a.widget.element.data("message"),t=u.I18N;if(e){var i,s=e.split("/"),n=s.length;for(i=0;i<n;i++)"deviceId"==s[i]?a.viewModel.set("deviceId",s[i+1]):"deviceName"==s[i]&&a.viewModel.set("deviceName",s[i+1]);a.viewModel.clickApply({isSavedCard:!0})}else{var d=a.widget.loading;d.open(),m.ajax({url:"/dms/devices?types=AirConditionerController.DMS,AirConditionerController.WirelessDDC&registrationStatuses=Registered"}).done(function(e){e.length<1?(a.viewModel.set("disabledDevice",!0),a.viewModel.set("disabledApply",!0),a.widget.bodyElem.find("input").eq(0).data("kendoDropDownList").setOptions({optionLabel:t.prop("DASHBOARD_NO_INSTALLED_DEVICE")})):(a.viewModel.set("deviceList",e),a.viewModel.set("deviceId",e[0].id),a.viewModel.set("deviceName",e[0].name),a.viewModel.set("disabledDevice",!1),a.viewModel.set("disabledApply",!1),a.widget.bodyElem.find("input").eq(0).data("kendoDropDownList").setOptions({optionLabel:!1}))}).fail(function(){}).always(function(){d.close()})}},parseData:function(e){var a;e=e.hourly?(a=e.max,e.hourly):[];var t,i,s,n,d,o,r,l=_(),c=e.length,v=this.widget,p=["#afaeae","#1aa05a","#ffa41f","#ef2b2b"],u=[{name:"currentDemand",min:0,max:1,line:{visible:!1},majorUnit:.2,majorGridLines:{visible:!1}}],m=[{type:"column",name:"currentDemandPeak0",field:"currentDemand",categoryAxis:"hour",color:function(e){var a=0;return e.dataItem&&(a=e.dataItem.peakLevel),p[a]}},{type:"column",name:"currentDemandPeak1",field:"currentDemand",categoryAxis:"hour",color:function(e){var a=0;return e.dataItem&&(a=e.dataItem.peakLevel),p[a]}},{type:"column",name:"currentDemandPeak2",field:"currentDemand",categoryAxis:"hour",color:function(e){var a=0;return e.dataItem&&(a=e.dataItem.peakLevel),p[a]}},{type:"column",name:"currentDemandPeak3",field:"currentDemand",categoryAxis:"hour",color:function(e){var a=0;return e.dataItem&&(a=e.dataItem.peakLevel),p[a]}},{type:"line",field:"targetDemand",name:"targetDemand",color:"#3a89dd",markers:{size:0},width:1}],g=[{name:"hour",minorGridLines:{visible:!1},majorTicks:{visible:!1},categories:l}],h=[],b=[],f=[],D=[],y=[];for(t=0;t<c;t++)(d=e[t].time)&&(i=d.split(":"),s=Number(i[i.length-3]),n=Number(i[i.length-2]),o={currentDemand:e[t].currentDemand,peakLevel:e[t].peakLevel},0==n?h[s]=o:15==n?b[s]=o:30==n?f[s]=o:45==n&&(D[s]=o),(r=e[t].targetDemand)&&(y[s]={targetDemand:r}));for(c=h.length,t=0;t<c;t++)void 0===h[t]&&(h[t]=null);for(c=b.length,t=0;t<c;t++)void 0===b[t]&&(b[t]=null);for(c=f.length,t=0;t<c;t++)void 0===f[t]&&(f[t]=null);for(c=D.length,t=0;t<c;t++)void 0===D[t]&&(D[t]=null);for(c=y.length,t=0;t<c;t++)void 0===y[t]&&(y[t]=null);m[0].data=h,m[1].data=b,m[2].data=f,m[3].data=D,m[4].data=y;var w,T=0;if(a)for(w in a)T<a[w]&&(T=a[w]);0!==T&&(T*=1.2,u[0].max=A.getChartOptionsForFiveChartSection(T,0).newMax,u[0].majorUnit=A.getChartOptionsForFiveChartSection(T,0).newMajorUnit),v.element.find(".peak-bar-graph").data("kendoChart").setOptions({valueAxis:u,series:m,categoryAxis:g})},onMoveMenu:function(){u.localStorage.setItem("dashboardShortcut","demandmonitoring"),u.localStorage.setItem("dashboardDemandBtn","day")}}]},todayEnergyUsage:{title:"DASHBOARD_TODAY_ENERGY_USAGE",cards:[{refreshOption:{timeout:36e5},width:2,height:4,menuUrl:"/energy/consumptionandtarget",template:'<div class="dashboard-body-content dashboard-today-usage-2x4"><div class="dashboard-facility-operation-graph"><div class="dashboard-facility-operation-info"><div class="wrapper"><div class="legend-wrapper"><span class="count" data-bind="text: hoverCount"></span><span class="percent" data-bind="text:unit">%<br></span></div></div></div><div class="dashboard-facility-operation-chart" data-role="chart" data-transitions="false" data-series-defaults="{type:\'donut\',holeSize:80}" data-chart-area="{ background : \'\\#f7f7f7\', }" data-series="[{field:\'value\',categoryField:\'type\',visibleInLegendField:\'visibleInLegend\',padding:0,overlay:{gradient:\'none\'}}]" data-bind="source: operationData, events:{ seriesHover: onSeriesHover }"></div><div class="dashboard-today-usage-legend"><ul class="legends"><li class="legend" style="width:62px;"><span class="square critical"></span><p class="key">#=sac#</p></li><li class="legend" style="width:122px;text-align:center;"><span class="square warning"></span><p class="key">#=light#</p></li><li class="legend" style="width:62px;text-align:right;"><span class="square on"></span><p class="key">#=etc#</p></li></ul></div></div></div>',mockDatas:{usage:32e3,unit:"kWh",current:[{energy_category:"AirConditionerAll",usage:1e3},{energy_category:"Light",usage:0},{energy_category:"Others",usage:0}]},localeTemplateData:{sac:"DASHBOARD_SAC",light:"DASHBOARD_LIGHT",etc:"DASHBOARD_OTHERS"},init:function(){var a=this;a.widget.element.on("mouseleave",".k-chart",function(){if(a.viewModel.get("isHover")){a.viewModel.set("isHover",!1);var e=a.viewModel.get("total");a.viewModel.set("hoverCount",g.toString(e,"n0")),a.viewModel.set("unit","kWh")}});var e="/energy/consumption/today?year="+o().format("Y")+"&month="+o().format("M")+"&day="+o().format("D")+"&dms_meter_type=Meter.WattHour";a.refreshUrl=e,a.widget.refresh()},templateData:{seriesDefaults:'{type:"donut"}',series:""},viewModel:{unit:"kWh",isHover:!1,hoverCount:0,hoverCategory:"sac",sac:0,light:0,etc:0,total:0,operationData:new g.data.DataSource({data:[]}),onSeriesHover:function(e){this.set("isHover",!0);var a=e.percentage;a=Math.round(100*a);var t=e.category;t=t.toUpperCase(),t=u.I18N.prop("DASHBOARD_"+t),this.set("hoverCount",a),this.set("hoverCategory",t),this.set("unit","%")}},setDataSource:function(){var e=[{type:"sac",value:this.viewModel.get("sac"),visibleInLegend:!1,color:"#ef2b2b"},{type:"light",value:this.viewModel.get("light"),visibleInLegend:!1,color:"#ffa41f"},{type:"etc",value:this.viewModel.get("etc"),visibleInLegend:!1,color:"#1aa05a"}];e=new g.data.DataSource({data:e}),this.viewModel.set("operationData",e)},parseData:function(e){var a=void 0!==e.usage?e.usage:0;this.viewModel.set("total",a),0==a?this.viewModel.set("hoverCount","-"):this.viewModel.set("hoverCount",g.toString(a,"n0"));var t=e.unit?e.unit:"kWh";this.viewModel.set("unit",t);var i,s,n,d=e.energy?e.energy:[],o=d.length;for(i=0;i<o;i++)n=d[i].category,s=d[i].usage,"AirConditioner"==n?this.viewModel.set("sac",s):"Light"==n?this.viewModel.set("light",s):this.viewModel.set("etc",s);this.setDataSource()}}]},monthlyEnergyPower:{title:"DASHBOARD_MONTHLY_POWER_PLAN",cards:[{refreshOption:{timeout:function(){var e=o();return 0===e.hours()&&0===e.minutes()}},width:2,height:4,template:"<div class='dashboard-body-content dashboard-energy-peak'><div class='radial-guage'><div data-role='radialgauge' data-scale='#=scale#' data-pointer='#=pointer#' data-bind='value:percent'></div><div class='gaugeData min'><p class='nowData'><strong data-bind='text:usage, css:{red:isTargetOver}'>250,780</strong><span class='unit' data-bind='text:unit'>kWh</span></p><p></p><p>/ <span><span data-bind='text:target'>175,780</span> <span data-bind='text:unit'>kWh</span></span></p><p></p></div></div>",MockData:{usage:2000.21,target:8000.21,unit:"kWh"},templateData:{scale:'{startAngle: 0,endAngle: 180,min: 0,max: 100, majorTicks:{visible : false}, minorTicks: {visible : false}, rangeSize : 18, rangeDistance:-33, ranges: [{from: 0,to: 20, color: "#1aa05a",}, {from: 20,to: 40,color: "#c6e6a2"},{from: 40,to: 60, color: "#ffa41f"},{from: 60,to: 80, color: "#ff7631"},{from: 80,to: 100, color: "#ee392f"}],labels: {visible : false}}',pointer:'{value: 5,color: "#333",cap:{size:0}}'},viewModel:{usage:0,target:0,unit:0,percent:0,percentReady:0,isTargetOver:!1},init:function(){var e=this,a=e.widget,t=new Date,i=t.getFullYear(),s=t.getMonth()+1;e.refreshUrl="/energy/consumption/plan?year="+i+"&month="+s+"&dms_meter_type=Meter.WattHour",a.refresh().always(function(){e.menuUrl="/energy/consumptionandtarget"})},parseData:function(e){var a,t=this.MockData,i=void 0!==e.usage?e.usage:0,s=void 0!==e.target?e.target:0;void 0!==e.unit?e.unit:t.unit;i=Number(i),s=Number(s),i=Math.round(i),"-"!=(s=Math.round(s))&&"-"!=i?(a=Math.round(i/s*100),isNaN(a)&&(a=0),s<i&&this.viewModel.set("isTargetOver",!0)):a=0,s=0===s?"-":g.toString(s,"n0"),i=0===i?"-":g.toString(i,"n0"),this.viewModel.set("usage",i),this.viewModel.set("target",s),this.viewModel.set("unit","kWh"),this.viewModel.set("percent",a)},onMoveMenu:function(){u.localStorage.setItem("dashboardShortcut","target")}}]},monthlyEnergyGas:{title:"DASHBOARD_MONTHLY_GAS_PLAN",cards:[{refreshOption:{timeout:function(){var e=o();return 0===e.hours()&&0===e.minutes()}},width:2,height:4,template:"<div class='dashboard-body-content dashboard-energy-peak'><div class='radial-guage'><div data-role='radialgauge' data-scale='#=scale#' data-pointer='#=pointer#' data-bind='value:percent'></div><div class='gaugeData min'><p class='nowData'><strong data-bind='text:usage, css:{red:isTargetOver}'>250,780</strong><span class='unit' data-bind='text:unit'>kWh</span></p><p></p><p>/ <span><span data-bind='text:target'>175,780</span> <span data-bind='text:unit'>kWh</span></span></p><p></p></div></div>",MockData:{usage:2000.21,target:8000.21,unit:"m3"},templateData:{scale:'{startAngle: 0,endAngle: 180,min: 0,max: 100, majorTicks:{visible : false}, minorTicks: {visible : false}, rangeSize : 18, rangeDistance:-33, ranges: [{from: 0,to: 20, color: "#1aa05a",}, {from: 20,to: 40,color: "#c6e6a2"},{from: 40,to: 60, color: "#ffa41f"},{from: 60,to: 80, color: "#ff7631"},{from: 80,to: 100, color: "#ee392f"}],labels: {visible : false}}',pointer:'{value: 5,color: "#333",cap:{size:0}}'},viewModel:{percentReady:0,usage:0,target:0,unit:0,percent:0,isTargetOver:!1},init:function(){var e=this,a=e.widget,t=new Date,i=t.getFullYear(),s=t.getMonth()+1;e.refreshUrl="/energy/consumption/plan?year="+i+"&month="+s+"&dms_meter_type=Meter.Gas",a.refresh().always(function(){e.menuUrl="/energy/consumptionandtarget"})},parseData:function(e){var a,t=this.MockData,i=void 0!==e.usage?e.usage:0,s=void 0!==e.target?e.target:0;void 0!==e.unit?e.unit:t.unit;i=Number(i),s=Number(s),i=Math.round(i),"-"!=(s=Math.round(s))&&"-"!=i?(a=Math.round(i/s*100),isNaN(a)&&(a=0),s<i&&this.viewModel.set("isTargetOver",!0)):a=0,s=0===s?"-":g.toString(s,"n0"),i=0===i?"-":g.toString(i,"n0"),this.viewModel.set("usage",i),this.viewModel.set("target",s),this.viewModel.set("unit","m\xb3"),this.viewModel.set("percent",a)},onMoveMenu:function(){u.localStorage.setItem("dashboardShortcut","target")}}]},monthlyEnergyWater:{title:"DASHBOARD_MONTHLY_WATER_PLAN",cards:[{refreshOption:{timeout:function(){var e=o();return 0===e.hours()&&0===e.minutes()}},width:2,height:4,template:"<div class='dashboard-body-content dashboard-energy-peak'><div class='radial-guage'><div data-role='radialgauge' data-scale='#=scale#' data-pointer='#=pointer#' data-bind='value:percent'></div><div class='gaugeData min'><p class='nowData'><strong data-bind='text:usage, css:{red:isTargetOver}'>250,780</strong><span class='unit' data-bind='text:unit'>kWh</span></p><p></p><p>/ <span><span data-bind='text:target'>175,780</span> <span data-bind='text:unit'>L</span></span></p><p></p></div></div>",MockData:{usage:2000.21,target:8000.21,unit:"L"},templateData:{scale:'{startAngle: 0,endAngle: 180,min: 0,max: 100, majorTicks:{visible : false}, minorTicks: {visible : false}, rangeSize : 18, rangeDistance:-33, ranges: [{from: 0,to: 20, color: "#1aa05a",}, {from: 20,to: 40,color: "#c6e6a2"},{from: 40,to: 60, color: "#ffa41f"},{from: 60,to: 80, color: "#ff7631"},{from: 80,to: 100, color: "#ee392f"}],labels: {visible : false}}',pointer:'{value: 5,color: "#333",cap:{size:0}}'},viewModel:{percentReady:0,usage:0,target:0,unit:0,percent:0,isTargetOver:!1},init:function(){var e=this,a=e.widget,t=new Date,i=t.getFullYear(),s=t.getMonth()+1;e.refreshUrl="/energy/consumption/plan?year="+i+"&month="+s+"&dms_meter_type=Meter.Water",a.refresh().always(function(){e.menuUrl="/energy/consumptionandtarget"})},parseData:function(e){var a,t=this.MockData,i=void 0!==e.usage?e.usage:0,s=void 0!==e.target?e.target:0;void 0!==e.unit?e.unit:t.unit;i=Number(i),s=Number(s),i=Math.round(i),"-"!=(s=Math.round(s))&&"-"!=i?(a=Math.round(i/s*100),isNaN(a)&&(a=0),s<i&&this.viewModel.set("isTargetOver",!0)):a=0,s=0===s?"-":g.toString(s,"n0"),i=0===i?"-":g.toString(i,"n0"),this.viewModel.set("usage",i),this.viewModel.set("target",s),this.viewModel.set("unit","L"),this.viewModel.set("percent",a)},onMoveMenu:function(){u.localStorage.setItem("dashboardShortcut","target")}}]}},b=u.CommonLoadingPanel,f=g.ui.Widget,d=g.template("<div class='dashboard-error-panel'><div class='wrapper'><div class='text'>#=title#<br>#=message#</div></div></div>"),_=function(){var e,a=u.I18N,t=[];if("24Hour"===u.GlobalSettings.getTimeDisplay())for(e=0;e<24;e++)t[e]=a.prop("ENERGY_CHART_TIME_HOUR",e);else t=["12 AM","1 AM","2 AM","3 AM","4 AM","5 AM","6 AM","7 AM","8 AM","9 AM","10 AM","11 AM","12 PM","1 PM","2 PM","3 PM","4 PM","5 PM","6 PM","7 PM","8 PM","9 PM","10 PM","11 PM"];return t},e=f.extend({options:{name:"Card",type:null,drawerElement:null,refreshFunc:null,cardDraggableOptions:null,events:["onClose","onClosed","onPin","onPinned","onChange"]},init:function(e,a){var t=this;a=a||{};var i=m(e),s=i.data("gs-width"),n=i.data("gs-height"),d=a.type?a.type:i.data("type");if(d){var o=h[d];if(o){var r=o.cards;if(r){var l,c=r.length,v={};for(l=0;l<c;l++)if(r[l].width==s&&r[l].height==n){m.extend(v,a,r[l]);break}var p=u.I18N;v.title=p.prop(o.title),v.title=v.title.replace("&#039;","'"),f.fn.init.call(t,e,v),t.gridStack=i.closest(".grid-stack").data("gridstack"),t.headerElem=i.find(".dashboard-card-header"),t.titleElem=i.find(".dashboard-card-title"),t.closeBtn=i.find(".dashboard-card-icons .ic-close"),t.pinBtn=i.find(".dashboard-card-icons .ic-pin"),t.refreshBtn=i.find(".dashboard-card-icons .ic-refresh"),t.bodyElem=i.find(".dashboard-card-body"),t.loading=new b(t.element.find(".dashboard-card-wrapper")),t._renderTemplate(),t._attachEvent(),t._refresh(),i.data("pinned")&&t.pinBtn.trigger("click"),t._attachRefreshEvt()}else console.error("there is no card options for "+d)}else console.error("there is no options for "+d)}else console.error("there is no widget type.")},_attachRefreshEvt:function(){var e,a=this.options.refreshOption,t=this;if(a&&a.timeout)if(m.isFunction(a.timeout))e=function(){a.timeout({sender:t})&&t._refresh()},this.refreshInterval=setInterval(e,6e4);else{var i=a.timeout;if(!i)return;e=function(){t._refresh()},this.refreshInterval=setInterval(e,i)}},_attachEvent:function(){var e=this;e.pinBtn.on("click",e._pinBtnEvt),e.refreshBtn.on("click",e._refreshBtnEvt),e.closeBtn.on("click",e._closeBtnEvt),e.bodyElem.on("click",e._moveLinkEvt)},_moveLinkEvt:function(e){var a=m(this).closest(".dashboard-card-item").data("kendoCard");a.options.menuUrl&&(a._exceptionMoveLink(e.target)||(a.options.onMoveMenu&&m.isFunction(a.options.onMoveMenu)&&a.options.onMoveMenu(),a.moveMenu()))},_exceptionMoveLink:function(e){return 0<(e=m(e)).closest(".k-tabstrip-items").length},_pinBtnEvt:function(){var e=m(this),a=e.closest(".dashboard-card-item"),t=a.data("kendoCard"),i=e.siblings(".ic-close");a.hasClass("dashboard-card-lock")?(t._pin(!1),t.element.attr("data-pinned",!1),i.removeClass("disabled"),a.removeClass("dashboard-card-lock"),t.trigger("onPin",{pinned:!1})):(t._pin(!0),t.element.attr("data-pinned",!0),i.addClass("disabled"),a.addClass("dashboard-card-lock"),t.trigger("onPin",{pinned:!0}))},_closeBtnEvt:function(){var e=m(this);e.hasClass("disabled")||e.closest(".dashboard-card-item").data("kendoCard")._close()},_refreshBtnEvt:function(){m(this).closest(".dashboard-card-item").data("kendoCard")._refresh()},_close:function(){var e=this;if(e.trigger("onClose"),e.destroy(),e.gridStack.removeWidget(e.element),e.options.drawerElement){var a=e.element.data("category"),t=e.options.drawerElement.find(".dashboard-drawer-category-"+a),i=e.element.data("type"),s=e.element.data("width"),n=e.element.data("height"),d=t.find(".dashboard-card-item[data-type='"+i+"'][data-width='"+s+"'][data-height='"+n+"']");if(e.element.data("multiple")&&0<d.length)return void e.element.remove();e.element.addClass("card");var o=e.element.find(".dashboard-card-body");o.empty();var r=m("<img/>").addClass("dashboard-card-drawer-category").attr("src",A.addBuildDateQuery("../../src/main/resources/static-dev/images/icon/ic_drawer_chart_"+e.element.data("view-type")+".png")),l=e.element.find(".dashboard-card-header"),c=m("<div/>").addClass("count");m("<span/>").addClass("row").text(s).appendTo(c),m("<span/>").text("X").appendTo(c),m("<span/>").addClass("col").text(n).appendTo(c),c.appendTo(l),r.appendTo(o),e.element.appendTo(t),e.options.cardDraggableOptions&&(e.element.data("uiDraggable")&&e.element.data("uiDraggable").destroy(),e.element.data("uiResizable")&&e.element.data("uiResizable").destroy(),e.element.draggable(e.options.cardDraggableOptions))}e.trigger("onClosed")},_renderTemplate:function(){var e,a=this,t=a.options.template;a.titleElem.text(a.options.title),a.options.viewModel=g.observable(a.options.viewModel);var i,s=a.options.viewModel;if(a.options.localeTemplateData){i=m.extend(!0,{},a.options.localeTemplateData);var n=u.I18N;for(e in i)i[e]=n.prop(i[e])}a.options.templateData&&(i=m.extend(i,a.options.templateData)),i&&(t=(t=g.template(t))(i)),a.bodyElem.html(t);var d=a.bodyElem.find(".dashboard-body-content");if(g.bind(d,s),this.content=d,this.viewModel=s,this.viewModel.thisOptions=a.options,(a.options.widget=a).options.init&&m.isFunction(a.options.init)){var o,r=a.element.data(),l={};for(e in r)-1!=e.indexOf("arg")&&(o=e.replace("arg",""),e.charAt(0).toLowerCase(),l[o]=r[e]);m.isEmptyObject(l)&&(l=null),a.options.init(l)}},destroy:function(){void 0!==this.refreshInterval&&clearInterval(this.refreshInterval),g.unbind(this.content,this.viewModel),f.fn.destroy.call(this)},_refresh:function(){var t=this,e=t.options.refreshUrl,a=t.options.refreshFunc;return a&&m.isFunction(a)?a():e?(t.loading.open(t.element.find(".dashboard-card-wrapper")),m.ajax({url:e}).done(function(e){var a;if(t.bodyElem.find(".dashboard-error-panel").remove(),t.options.viewModel)if(t.options.mockData)for(a in e=t.options.mockData)t.options.viewModel.set(a,e[a]);else t.options.parseData&&t.options.parseData(e)}).fail(function(e){t.responseFailCallback(e)}).always(function(){t.loading.close()})):void 0},refresh:function(){return this._refresh()},moveMenu:function(){var e=this.options.menuUrl,a=u.location.protocol+"//"+u.location.host+"/front"+e;u.location.href=a},_pin:function(e){this.gridStack.movable(this.element,!e)},responseFailCallback:function(e){var a,t,i,s=e.status,n=u.I18N;i=0==s?(t=n.prop("COMMON_ERROR_DISCONNECTED_TITLE"),n.prop("COMMON_ERROR_DISCONNECTED_MSG")):401==s?(t=n.prop("DASHBOARD_ERROR_AUTH_TITLE"),n.prop("DASHBOARD_ERROR_AUTH_MSG")):(t=n.prop("DASHBOARD_ERROR_LOADING_TITLE"),n.prop("DASHBOARD_ERROR_LOADING_MSG")),a=d({title:t,message:i}),this.bodyElem.append(a)}});g.ui.plugin(e)}(window,jQuery);