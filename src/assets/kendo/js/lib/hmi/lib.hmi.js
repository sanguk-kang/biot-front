if(!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(x){x.ui=x.ui||{};x.ui.version="1.12.1";var s,i=0,a=Array.prototype.slice;x.cleanData=(s=x.cleanData,function(t){var e,i,n;for(n=0;null!=(i=t[n]);n++)try{(e=x._data(i,"events"))&&e.remove&&x(i).triggerHandler("remove")}catch(t){}s(t)}),x.widget=function(t,i,e){var n,s,r,o={},a=t.split(".")[0],l=a+"-"+(t=t.split(".")[1]);return e||(e=i,i=x.Widget),x.isArray(e)&&(e=x.extend.apply(null,[{}].concat(e))),x.expr[":"][l.toLowerCase()]=function(t){return!!x.data(t,l)},x[a]=x[a]||{},n=x[a][t],s=x[a][t]=function(t,e){if(!this._createWidget)return new s(t,e);arguments.length&&this._createWidget(t,e)},x.extend(s,n,{version:e.version,_proto:x.extend({},e),_childConstructors:[]}),(r=new i).options=x.widget.extend({},r.options),x.each(e,function(e,n){function s(){return i.prototype[e].apply(this,arguments)}function r(t){return i.prototype[e].apply(this,t)}x.isFunction(n)?o[e]=function(){var t,e=this._super,i=this._superApply;return this._super=s,this._superApply=r,t=n.apply(this,arguments),this._super=e,this._superApply=i,t}:o[e]=n}),s.prototype=x.widget.extend(r,{widgetEventPrefix:n&&r.widgetEventPrefix||t},o,{constructor:s,namespace:a,widgetName:t,widgetFullName:l}),n?(x.each(n._childConstructors,function(t,e){var i=e.prototype;x.widget(i.namespace+"."+i.widgetName,s,e._proto)}),delete n._childConstructors):i._childConstructors.push(s),x.widget.bridge(t,s),s},x.widget.extend=function(t){for(var e,i,n=a.call(arguments,1),s=0,r=n.length;s<r;s++)for(e in n[s])i=n[s][e],n[s].hasOwnProperty(e)&&void 0!==i&&(x.isPlainObject(i)?t[e]=x.isPlainObject(t[e])?x.widget.extend({},t[e],i):x.widget.extend({},i):t[e]=i);return t},x.widget.bridge=function(r,e){var o=e.prototype.widgetFullName||r;x.fn[r]=function(i){var t="string"==typeof i,n=a.call(arguments,1),s=this;return t?this.length||"instance"!==i?this.each(function(){var t,e=x.data(this,o);return"instance"===i?(s=e,!1):e?x.isFunction(e[i])&&"_"!==i.charAt(0)?(t=e[i].apply(e,n))!==e&&void 0!==t?(s=t&&t.jquery?s.pushStack(t.get()):t,!1):void 0:x.error("no such method '"+i+"' for "+r+" widget instance"):x.error("cannot call methods on "+r+" prior to initialization; attempted to call method '"+i+"'")}):s=void 0:(n.length&&(i=x.widget.extend.apply(null,[i].concat(n))),this.each(function(){var t=x.data(this,o);t?(t.option(i||{}),t._init&&t._init()):x.data(this,o,new e(i,this))})),s}},x.Widget=function(){},x.Widget._childConstructors=[],x.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(t,e){e=x(e||this.defaultElement||this)[0],this.element=x(e),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=x(),this.hoverable=x(),this.focusable=x(),this.classesElementLookup={},e!==this&&(x.data(e,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===e&&this.destroy()}}),this.document=x(e.style?e.ownerDocument:e.document||e),this.window=x(this.document[0].defaultView||this.document[0].parentWindow)),this.options=x.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:x.noop,_create:x.noop,_init:x.noop,destroy:function(){var i=this;this._destroy(),x.each(this.classesElementLookup,function(t,e){i._removeClass(e,t)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:x.noop,widget:function(){return this.element},option:function(t,e){var i,n,s,r=t;if(0===arguments.length)return x.widget.extend({},this.options);if("string"==typeof t)if(r={},t=(i=t.split(".")).shift(),i.length){for(n=r[t]=x.widget.extend({},this.options[t]),s=0;s<i.length-1;s++)n[i[s]]=n[i[s]]||{},n=n[i[s]];if(t=i.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=e}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];r[t]=e}return this._setOptions(r),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(t){var e,i,n;for(e in t)n=this.classesElementLookup[e],t[e]!==this.options.classes[e]&&n&&n.length&&(i=x(n.get()),this._removeClass(n,e),i.addClass(this._classes({element:i,keys:e,classes:t,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(s){var r=[],o=this;function t(t,e){var i,n;for(n=0;n<t.length;n++)i=o.classesElementLookup[t[n]]||x(),i=s.add?x(x.unique(i.get().concat(s.element.get()))):x(i.not(s.element).get()),o.classesElementLookup[t[n]]=i,r.push(t[n]),e&&s.classes[t[n]]&&r.push(s.classes[t[n]])}return s=x.extend({element:this.element,classes:this.options.classes||{}},s),this._on(s.element,{remove:"_untrackClassesElement"}),s.keys&&t(s.keys.match(/\S+/g)||[],!0),s.extra&&t(s.extra.match(/\S+/g)||[]),r.join(" ")},_untrackClassesElement:function(i){var n=this;x.each(n.classesElementLookup,function(t,e){-1!==x.inArray(i.target,e)&&(n.classesElementLookup[t]=x(e.not(i.target).get()))})},_removeClass:function(t,e,i){return this._toggleClass(t,e,i,!1)},_addClass:function(t,e,i){return this._toggleClass(t,e,i,!0)},_toggleClass:function(t,e,i,n){n="boolean"==typeof n?n:i;var s="string"==typeof t||null===t,r={extra:s?e:i,keys:s?t:e,element:s?this.element:t,add:n};return r.element.toggleClass(this._classes(r),n),this},_on:function(o,a,t){var l,h=this;"boolean"!=typeof o&&(t=a,a=o,o=!1),t?(a=l=x(a),this.bindings=this.bindings.add(a)):(t=a,a=this.element,l=this.widget()),x.each(t,function(t,e){function i(){if(o||!0!==h.options.disabled&&!x(this).hasClass("ui-state-disabled"))return("string"==typeof e?h[e]:e).apply(h,arguments)}"string"!=typeof e&&(i.guid=e.guid=e.guid||i.guid||x.guid++);var n=t.match(/^([\w:-]*)\s*(.*)$/),s=n[1]+h.eventNamespace,r=n[2];r?l.on(s,r,i):a.on(s,i)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.off(e).off(e),this.bindings=x(this.bindings.not(t).get()),this.focusable=x(this.focusable.not(t).get()),this.hoverable=x(this.hoverable.not(t).get())},_delay:function(t,e){var i=this;return setTimeout(function(){return("string"==typeof t?i[t]:t).apply(i,arguments)},e||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){this._addClass(x(t.currentTarget),null,"ui-state-hover")},mouseleave:function(t){this._removeClass(x(t.currentTarget),null,"ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){this._addClass(x(t.currentTarget),null,"ui-state-focus")},focusout:function(t){this._removeClass(x(t.currentTarget),null,"ui-state-focus")}})},_trigger:function(t,e,i){var n,s,r=this.options[t];if(i=i||{},(e=x.Event(e)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),e.target=this.element[0],s=e.originalEvent)for(n in s)n in e||(e[n]=s[n]);return this.element.trigger(e,i),!(x.isFunction(r)&&!1===r.apply(this.element[0],[e].concat(i))||e.isDefaultPrevented())}},x.each({show:"fadeIn",hide:"fadeOut"},function(r,o){x.Widget.prototype["_"+r]=function(e,t,i){var n;"string"==typeof t&&(t={effect:t});var s=t?!0===t||"number"==typeof t?o:t.effect||o:r;"number"==typeof(t=t||{})&&(t={duration:t}),n=!x.isEmptyObject(t),t.complete=i,t.delay&&e.delay(t.delay),n&&x.effects&&x.effects.effect[s]?e[r](t):s!==r&&e[s]?e[s](t.duration,t.easing,i):e.queue(function(t){x(this)[r](),i&&i.call(e[0]),t()})}});var r,I,A,n,o,l,h,c,S;x.widget;function _(t,e,i){return[parseFloat(t[0])*(c.test(t[0])?e/100:1),parseFloat(t[1])*(c.test(t[1])?i/100:1)]}function P(t,e){return parseInt(x.css(t,e),10)||0}I=Math.max,A=Math.abs,n=/left|center|right/,o=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,h=/^\w+/,c=/%$/,S=x.fn.position,x.position={scrollbarWidth:function(){if(void 0!==r)return r;var t,e,i=x("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),n=i.children()[0];return x("body").append(i),t=n.offsetWidth,i.css("overflow","scroll"),t===(e=n.offsetWidth)&&(e=i[0].clientWidth),i.remove(),r=t-e},getScrollInfo:function(t){var e=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),i=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),n="scroll"===e||"auto"===e&&t.width<t.element[0].scrollWidth;return{width:"scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight?x.position.scrollbarWidth():0,height:n?x.position.scrollbarWidth():0}},getWithinInfo:function(t){var e=x(t||window),i=x.isWindow(e[0]),n=!!e[0]&&9===e[0].nodeType;return{element:e,isWindow:i,isDocument:n,offset:!i&&!n?x(t).offset():{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:e.outerWidth(),height:e.outerHeight()}}},x.fn.position=function(u){if(!u||!u.of)return S.apply(this,arguments);u=x.extend({},u);var d,p,g,f,m,t,e,i,v=x(u.of),y=x.position.getWithinInfo(u.within),b=x.position.getScrollInfo(y),w=(u.collision||"flip").split(" "),C={};return t=9===(i=(e=v)[0]).nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:x.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()},v[0].preventDefault&&(u.at="left top"),p=t.width,g=t.height,f=t.offset,m=x.extend({},f),x.each(["my","at"],function(){var t,e,i=(u[this]||"").split(" ");1===i.length&&(i=n.test(i[0])?i.concat(["center"]):o.test(i[0])?["center"].concat(i):["center","center"]),i[0]=n.test(i[0])?i[0]:"center",i[1]=o.test(i[1])?i[1]:"center",t=l.exec(i[0]),e=l.exec(i[1]),C[this]=[t?t[0]:0,e?e[0]:0],u[this]=[h.exec(i[0])[0],h.exec(i[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===u.at[0]?m.left+=p:"center"===u.at[0]&&(m.left+=p/2),"bottom"===u.at[1]?m.top+=g:"center"===u.at[1]&&(m.top+=g/2),d=_(C.at,p,g),m.left+=d[0],m.top+=d[1],this.each(function(){var i,t,o=x(this),a=o.outerWidth(),l=o.outerHeight(),e=P(this,"marginLeft"),n=P(this,"marginTop"),s=a+e+P(this,"marginRight")+b.width,r=l+n+P(this,"marginBottom")+b.height,h=x.extend({},m),c=_(C.my,o.outerWidth(),o.outerHeight());"right"===u.my[0]?h.left-=a:"center"===u.my[0]&&(h.left-=a/2),"bottom"===u.my[1]?h.top-=l:"center"===u.my[1]&&(h.top-=l/2),h.left+=c[0],h.top+=c[1],i={marginLeft:e,marginTop:n},x.each(["left","top"],function(t,e){x.ui.position[w[t]]&&x.ui.position[w[t]][e](h,{targetWidth:p,targetHeight:g,elemWidth:a,elemHeight:l,collisionPosition:i,collisionWidth:s,collisionHeight:r,offset:[d[0]+c[0],d[1]+c[1]],my:u.my,at:u.at,within:y,elem:o})}),u.using&&(t=function(t){var e=f.left-h.left,i=e+p-a,n=f.top-h.top,s=n+g-l,r={target:{element:v,left:f.left,top:f.top,width:p,height:g},element:{element:o,left:h.left,top:h.top,width:a,height:l},horizontal:i<0?"left":0<e?"right":"center",vertical:s<0?"top":0<n?"bottom":"middle"};p<a&&A(e+i)<p&&(r.horizontal="center"),g<l&&A(n+s)<g&&(r.vertical="middle"),I(A(e),A(i))>I(A(n),A(s))?r.important="horizontal":r.important="vertical",u.using.call(this,t,r)}),o.offset(x.extend(h,{using:t}))})},x.ui.position={fit:{left:function(t,e){var i,n=e.within,s=n.isWindow?n.scrollLeft:n.offset.left,r=n.width,o=t.left-e.collisionPosition.marginLeft,a=s-o,l=o+e.collisionWidth-r-s;e.collisionWidth>r?0<a&&l<=0?(i=t.left+a+e.collisionWidth-r-s,t.left+=a-i):t.left=0<l&&a<=0?s:l<a?s+r-e.collisionWidth:s:0<a?t.left+=a:0<l?t.left-=l:t.left=I(t.left-o,t.left)},top:function(t,e){var i,n=e.within,s=n.isWindow?n.scrollTop:n.offset.top,r=e.within.height,o=t.top-e.collisionPosition.marginTop,a=s-o,l=o+e.collisionHeight-r-s;e.collisionHeight>r?0<a&&l<=0?(i=t.top+a+e.collisionHeight-r-s,t.top+=a-i):t.top=0<l&&a<=0?s:l<a?s+r-e.collisionHeight:s:0<a?t.top+=a:0<l?t.top-=l:t.top=I(t.top-o,t.top)}},flip:{left:function(t,e){var i,n,s=e.within,r=s.offset.left+s.scrollLeft,o=s.width,a=s.isWindow?s.scrollLeft:s.offset.left,l=t.left-e.collisionPosition.marginLeft,h=l-a,c=l+e.collisionWidth-o-a,u="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,d="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,p=-2*e.offset[0];h<0?((i=t.left+u+d+p+e.collisionWidth-o-r)<0||i<A(h))&&(t.left+=u+d+p):0<c&&(0<(n=t.left-e.collisionPosition.marginLeft+u+d+p-a)||A(n)<c)&&(t.left+=u+d+p)},top:function(t,e){var i,n,s=e.within,r=s.offset.top+s.scrollTop,o=s.height,a=s.isWindow?s.scrollTop:s.offset.top,l=t.top-e.collisionPosition.marginTop,h=l-a,c=l+e.collisionHeight-o-a,u="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,d="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,p=-2*e.offset[1];h<0?((n=t.top+u+d+p+e.collisionHeight-o-r)<0||n<A(h))&&(t.top+=u+d+p):0<c&&(0<(i=t.top-e.collisionPosition.marginTop+u+d+p-a)||A(i)<c)&&(t.top+=u+d+p)}},flipfit:{left:function(){x.ui.position.flip.left.apply(this,arguments),x.ui.position.fit.left.apply(this,arguments)},top:function(){x.ui.position.flip.top.apply(this,arguments),x.ui.position.fit.top.apply(this,arguments)}}};x.ui.position,x.extend(x.expr[":"],{data:x.expr.createPseudo?x.expr.createPseudo(function(e){return function(t){return!!x.data(t,e)}}):function(t,e,i){return!!x.data(t,i[3])}}),x.fn.extend({disableSelection:(t="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.on(t+".ui-disableSelection",function(t){t.preventDefault()})}),enableSelection:function(){return this.off(".ui-disableSelection")}});var t,u,d,p,g,e,f,m,v,y,b,w,C,M,k,T,N,D,E,L,z,O,G="ui-effects-",B="ui-effects-style",j="ui-effects-animated",R=x;function V(t,e,i){var n=v[e.type]||{};return null==t?i||!e.def?null:e.def:(t=n.floor?~~t:parseFloat(t),isNaN(t)?e.def:n.mod?(t+n.mod)%n.mod:t<0?0:n.max<t?n.max:t)}function Z(o){var a=f(),l=a._rgba=[];return o=o.toLowerCase(),w(e,function(t,e){var i,n=e.re.exec(o),s=n&&e.parse(n),r=e.space||"rgba";if(s)return i=a[r](s),a[m[r].cache]=i[m[r].cache],l=a._rgba=i._rgba,!1}),l.length?("0,0,0,0"===l.join()&&u.extend(l,p.transparent),a):p[o]}function W(t,e,i){return 6*(i=(i+1)%1)<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function Y(t){var e,i,n=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,s={};if(n&&n.length&&n[0]&&n[n[0]])for(i=n.length;i--;)"string"==typeof n[e=n[i]]&&(s[x.camelCase(e)]=n[e]);else for(e in n)"string"==typeof n[e]&&(s[e]=n[e]);return s}function H(t,e,i,n){return x.isPlainObject(t)&&(t=(e=t).effect),t={effect:t},null==e&&(e={}),x.isFunction(e)&&(n=e,i=null,e={}),"number"!=typeof e&&!x.fx.speeds[e]||(n=i,i=e,e={}),x.isFunction(i)&&(n=i,i=null),e&&x.extend(t,e),i=i||e.duration,t.duration=x.fx.off?0:"number"==typeof i?i:i in x.fx.speeds?x.fx.speeds[i]:x.fx.speeds._default,t.complete=n||e.complete,t}function F(t){return!(t&&"number"!=typeof t&&!x.fx.speeds[t])||("string"==typeof t&&!x.effects.effect[t]||(!!x.isFunction(t)||"object"==typeof t&&!t.effect))}function U(t,e){var i=e.outerWidth(),n=e.outerHeight(),s=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/.exec(t)||["",0,i,n,0];return{top:parseFloat(s[1])||0,right:"auto"===s[2]?i:parseFloat(s[2]),bottom:"auto"===s[3]?n:parseFloat(s[3]),left:parseFloat(s[4])||0}}x.effects={effect:{}},g=/^([\-+])=\s*(\d+\.?\d*)/,e=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],f=(u=R).Color=function(t,e,i,n){return new u.Color.fn.parse(t,e,i,n)},m={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},v={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},y=f.support={},b=u("<p>")[0],w=u.each,b.style.cssText="background-color:rgba(1,1,1,.5)",y.rgba=-1<b.style.backgroundColor.indexOf("rgba"),w(m,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),f.fn=u.extend(f.prototype,{parse:function(s,t,e,i){if(s===d)return this._rgba=[null,null,null,null],this;(s.jquery||s.nodeType)&&(s=u(s).css(t),t=d);var r=this,n=u.type(s),o=this._rgba=[];return t!==d&&(s=[s,t,e,i],n="array"),"string"===n?this.parse(Z(s)||p._default):"array"===n?(w(m.rgba.props,function(t,e){o[e.idx]=V(s[e.idx],e)}),this):"object"===n?(w(m,s instanceof f?function(t,e){s[e.cache]&&(r[e.cache]=s[e.cache].slice())}:function(t,i){var n=i.cache;w(i.props,function(t,e){if(!r[n]&&i.to){if("alpha"===t||null==s[t])return;r[n]=i.to(r._rgba)}r[n][e.idx]=V(s[t],e,!0)}),r[n]&&u.inArray(null,r[n].slice(0,3))<0&&(r[n][3]=1,i.from&&(r._rgba=i.from(r[n])))}),this):void 0},is:function(t){var s=f(t),r=!0,o=this;return w(m,function(t,e){var i,n=s[e.cache];return n&&(i=o[e.cache]||e.to&&e.to(o._rgba)||[],w(e.props,function(t,e){if(null!=n[e.idx])return r=n[e.idx]===i[e.idx]})),r}),r},_space:function(){var i=[],n=this;return w(m,function(t,e){n[e.cache]&&i.push(t)}),i.pop()},transition:function(t,o){var a=f(t),e=a._space(),i=m[e],n=0===this.alpha()?f("transparent"):this,l=n[i.cache]||i.to(n._rgba),h=l.slice();return a=a[i.cache],w(i.props,function(t,e){var i=e.idx,n=l[i],s=a[i],r=v[e.type]||{};null!==s&&(null===n?h[i]=s:(r.mod&&(r.mod/2<s-n?n+=r.mod:r.mod/2<n-s&&(n-=r.mod)),h[i]=V((s-n)*o+n,e)))}),this[e](h)},blend:function(t){if(1===this._rgba[3])return this;var e=this._rgba.slice(),i=e.pop(),n=f(t)._rgba;return f(u.map(e,function(t,e){return(1-i)*n[e]+i*t}))},toRgbaString:function(){var t="rgba(",e=u.map(this._rgba,function(t,e){return null==t?2<e?1:0:t});return 1===e[3]&&(e.pop(),t="rgb("),t+e.join()+")"},toHslaString:function(){var t="hsla(",e=u.map(this.hsla(),function(t,e){return null==t&&(t=2<e?1:0),e&&e<3&&(t=Math.round(100*t)+"%"),t});return 1===e[3]&&(e.pop(),t="hsl("),t+e.join()+")"},toHexString:function(t){var e=this._rgba.slice(),i=e.pop();return t&&e.push(~~(255*i)),"#"+u.map(e,function(t){return 1===(t=(t||0).toString(16)).length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),f.fn.parse.prototype=f.fn,m.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,n=t[0]/255,s=t[1]/255,r=t[2]/255,o=t[3],a=Math.max(n,s,r),l=Math.min(n,s,r),h=a-l,c=a+l,u=.5*c;return e=l===a?0:n===a?60*(s-r)/h+360:s===a?60*(r-n)/h+120:60*(n-s)/h+240,i=0==h?0:u<=.5?h/c:h/(2-c),[Math.round(e)%360,i,u,null==o?1:o]},m.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],n=t[2],s=t[3],r=n<=.5?n*(1+i):n+i-n*i,o=2*n-r;return[Math.round(255*W(o,r,e+1/3)),Math.round(255*W(o,r,e)),Math.round(255*W(o,r,e-1/3)),s]},w(m,function(l,t){var i=t.props,o=t.cache,a=t.to,h=t.from;f.fn[l]=function(t){if(a&&!this[o]&&(this[o]=a(this._rgba)),t===d)return this[o].slice();var e,n=u.type(t),s="array"===n||"object"===n?t:arguments,r=this[o].slice();return w(i,function(t,e){var i=s["object"===n?t:e.idx];null==i&&(i=r[e.idx]),r[e.idx]=V(i,e)}),h?((e=f(h(r)))[o]=r,e):f(r)},w(i,function(o,a){f.fn[o]||(f.fn[o]=function(t){var e,i=u.type(t),n="alpha"===o?this._hsla?"hsla":"rgba":l,s=this[n](),r=s[a.idx];return"undefined"===i?r:("function"===i&&(t=t.call(this,r),i=u.type(t)),null==t&&a.empty?this:("string"===i&&(e=g.exec(t))&&(t=r+parseFloat(e[2])*("+"===e[1]?1:-1)),s[a.idx]=t,this[n](s)))})})}),f.hook=function(t){var e=t.split(" ");w(e,function(t,r){u.cssHooks[r]={set:function(t,e){var i,n,s="";if("transparent"!==e&&("string"!==u.type(e)||(i=Z(e)))){if(e=f(i||e),!y.rgba&&1!==e._rgba[3]){for(n="backgroundColor"===r?t.parentNode:t;(""===s||"transparent"===s)&&n&&n.style;)try{s=u.css(n,"backgroundColor"),n=n.parentNode}catch(t){}e=e.blend(s&&"transparent"!==s?s:"_default")}e=e.toRgbaString()}try{t.style[r]=e}catch(t){}}},u.fx.step[r]=function(t){t.colorInit||(t.start=f(t.elem,r),t.end=f(t.end),t.colorInit=!0),u.cssHooks[r].set(t.elem,t.start.transition(t.end,t.pos))}})},f.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),u.cssHooks.borderColor={expand:function(i){var n={};return w(["Top","Right","Bottom","Left"],function(t,e){n["border"+e+"Color"]=i}),n}},p=u.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"},T=["add","remove","toggle"],N={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1},x.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,e){x.fx.step[e]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(R.style(t.elem,e,t.end),t.setAttr=!0)}}),x.fn.addBack||(x.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),x.effects.animateClass=function(s,t,e,i){var r=x.speed(t,e,i);return this.queue(function(){var t,i=x(this),e=i.attr("class")||"",n=r.children?i.find("*").addBack():i;n=n.map(function(){return{el:x(this),start:Y(this)}}),(t=function(){x.each(T,function(t,e){s[e]&&i[e+"Class"](s[e])})})(),n=n.map(function(){return this.end=Y(this.el[0]),this.diff=function(t,e){var i,n,s={};for(i in e)n=e[i],t[i]!==n&&(N[i]||!x.fx.step[i]&&isNaN(parseFloat(n))||(s[i]=n));return s}(this.start,this.end),this}),i.attr("class",e),n=n.map(function(){var t=this,e=x.Deferred(),i=x.extend({},r,{queue:!1,complete:function(){e.resolve(t)}});return this.el.animate(this.diff,i),e.promise()}),x.when.apply(x,n.get()).done(function(){t(),x.each(arguments,function(){var e=this.el;x.each(this.diff,function(t){e.css(t,"")})}),r.complete.call(i[0])})})},x.fn.extend({addClass:(k=x.fn.addClass,function(t,e,i,n){return e?x.effects.animateClass.call(this,{add:t},e,i,n):k.apply(this,arguments)}),removeClass:(M=x.fn.removeClass,function(t,e,i,n){return 1<arguments.length?x.effects.animateClass.call(this,{remove:t},e,i,n):M.apply(this,arguments)}),toggleClass:(C=x.fn.toggleClass,function(t,e,i,n,s){return"boolean"==typeof e||void 0===e?i?x.effects.animateClass.call(this,e?{add:t}:{remove:t},i,n,s):C.apply(this,arguments):x.effects.animateClass.call(this,{toggle:t},e,i,n)}),switchClass:function(t,e,i,n,s){return x.effects.animateClass.call(this,{add:e,remove:t},i,n,s)}}),x.expr&&x.expr.filters&&x.expr.filters.animated&&(x.expr.filters.animated=(D=x.expr.filters.animated,function(t){return!!x(t).data(j)||D(t)})),!1!==x.uiBackCompat&&x.extend(x.effects,{save:function(t,e){for(var i=0,n=e.length;i<n;i++)null!==e[i]&&t.data(G+e[i],t[0].style[e[i]])},restore:function(t,e){for(var i,n=0,s=e.length;n<s;n++)null!==e[n]&&(i=t.data(G+e[n]),t.css(e[n],i))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},createWrapper:function(i){if(i.parent().is(".ui-effects-wrapper"))return i.parent();var n={width:i.outerWidth(!0),height:i.outerHeight(!0),float:i.css("float")},t=x("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e={width:i.width(),height:i.height()},s=document.activeElement;try{s.id}catch(t){s=document.body}return i.wrap(t),i[0]!==s&&!x.contains(i[0],s)||x(s).trigger("focus"),t=i.parent(),"static"===i.css("position")?(t.css({position:"relative"}),i.css({position:"relative"})):(x.extend(n,{position:i.css("position"),zIndex:i.css("z-index")}),x.each(["top","left","bottom","right"],function(t,e){n[e]=i.css(e),isNaN(parseInt(n[e],10))&&(n[e]="auto")}),i.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),i.css(e),t.css(n).show()},removeWrapper:function(t){var e=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),t[0]!==e&&!x.contains(t[0],e)||x(e).trigger("focus")),t}}),x.extend(x.effects,{version:"1.12.1",define:function(t,e,i){return i||(i=e,e="effect"),x.effects.effect[t]=i,x.effects.effect[t].mode=e,i},scaledDimensions:function(t,e,i){if(0===e)return{height:0,width:0,outerHeight:0,outerWidth:0};var n="horizontal"!==i?(e||100)/100:1,s="vertical"!==i?(e||100)/100:1;return{height:t.height()*s,width:t.width()*n,outerHeight:t.outerHeight()*s,outerWidth:t.outerWidth()*n}},clipToBox:function(t){return{width:t.clip.right-t.clip.left,height:t.clip.bottom-t.clip.top,left:t.clip.left,top:t.clip.top}},unshift:function(t,e,i){var n=t.queue();1<e&&n.splice.apply(n,[1,0].concat(n.splice(e,i))),t.dequeue()},saveStyle:function(t){t.data(B,t[0].style.cssText)},restoreStyle:function(t){t[0].style.cssText=t.data(B)||"",t.removeData(B)},mode:function(t,e){var i=t.is(":hidden");return"toggle"===e&&(e=i?"show":"hide"),(i?"hide"===e:"show"===e)&&(e="none"),e},getBaseline:function(t,e){var i,n;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=t[1]/e.width}return{x:n,y:i}},createPlaceholder:function(t){var e,i=t.css("position"),n=t.position();return t.css({marginTop:t.css("marginTop"),marginBottom:t.css("marginBottom"),marginLeft:t.css("marginLeft"),marginRight:t.css("marginRight")}).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()),/^(static|relative)/.test(i)&&(i="absolute",e=x("<"+t[0].nodeName+">").insertAfter(t).css({display:/^(inline|ruby)/.test(t.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:t.css("marginTop"),marginBottom:t.css("marginBottom"),marginLeft:t.css("marginLeft"),marginRight:t.css("marginRight"),float:t.css("float")}).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).addClass("ui-effects-placeholder"),t.data(G+"placeholder",e)),t.css({position:i,left:n.left,top:n.top}),e},removePlaceholder:function(t){var e=G+"placeholder",i=t.data(e);i&&(i.remove(),t.removeData(e))},cleanUp:function(t){x.effects.restoreStyle(t),x.effects.removePlaceholder(t)},setTransition:function(n,t,s,r){return r=r||{},x.each(t,function(t,e){var i=n.cssUnit(e);0<i[0]&&(r[e]=i[0]*s+i[1])}),r}}),x.fn.extend({effect:function(){function t(t){var e=x(this),i=x.effects.mode(e,a)||r;e.data(j,!0),l.push(i),r&&("show"===i||i===r&&"hide"===i)&&e.show(),r&&"none"===i||x.effects.saveStyle(e),x.isFunction(t)&&t()}var n=H.apply(this,arguments),s=x.effects.effect[n.effect],r=s.mode,e=n.queue,i=e||"fx",o=n.complete,a=n.mode,l=[];if(x.fx.off||!s)return a?this[a](n.duration,o):this.each(function(){o&&o.call(this)});function h(t){var e=x(this);function i(){x.isFunction(o)&&o.call(e[0]),x.isFunction(t)&&t()}n.mode=l.shift(),!1===x.uiBackCompat||r?"none"===n.mode?(e[a](),i()):s.call(e[0],n,function(){e.removeData(j),x.effects.cleanUp(e),"hide"===n.mode&&e.hide(),i()}):(e.is(":hidden")?"hide"===a:"show"===a)?(e[a](),i()):s.call(e[0],n,i)}return!1===e?this.each(t).each(h):this.queue(i,t).queue(i,h)},show:(z=x.fn.show,function(t){if(F(t))return z.apply(this,arguments);var e=H.apply(this,arguments);return e.mode="show",this.effect.call(this,e)}),hide:(L=x.fn.hide,function(t){if(F(t))return L.apply(this,arguments);var e=H.apply(this,arguments);return e.mode="hide",this.effect.call(this,e)}),toggle:(E=x.fn.toggle,function(t){if(F(t)||"boolean"==typeof t)return E.apply(this,arguments);var e=H.apply(this,arguments);return e.mode="toggle",this.effect.call(this,e)}),cssUnit:function(t){var i=this.css(t),n=[];return x.each(["em","px","%","pt"],function(t,e){0<i.indexOf(e)&&(n=[parseFloat(i),e])}),n},cssClip:function(t){return t?this.css("clip","rect("+t.top+"px "+t.right+"px "+t.bottom+"px "+t.left+"px)"):U(this.css("clip"),this)},transfer:function(t,e){var i=x(this),n=x(t.to),s="fixed"===n.css("position"),r=x("body"),o=s?r.scrollTop():0,a=s?r.scrollLeft():0,l=n.offset(),h={top:l.top-o,left:l.left-a,height:n.innerHeight(),width:n.innerWidth()},c=i.offset(),u=x("<div class='ui-effects-transfer'></div>").appendTo("body").addClass(t.className).css({top:c.top-o,left:c.left-a,height:i.innerHeight(),width:i.innerWidth(),position:s?"fixed":"absolute"}).animate(h,t.duration,t.easing,function(){u.remove(),x.isFunction(e)&&e()})}}),x.fx.step.clip=function(t){t.clipInit||(t.start=x(t.elem).cssClip(),"string"==typeof t.end&&(t.end=U(t.end,t.elem)),t.clipInit=!0),x(t.elem).cssClip({top:t.pos*(t.end.top-t.start.top)+t.start.top,right:t.pos*(t.end.right-t.start.right)+t.start.right,bottom:t.pos*(t.end.bottom-t.start.bottom)+t.start.bottom,left:t.pos*(t.end.left-t.start.left)+t.start.left})},O={},x.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,t){O[t]=function(t){return Math.pow(t,e+2)}}),x.extend(O,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;t<((e=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),x.each(O,function(t,e){x.easing["easeIn"+t]=e,x.easing["easeOut"+t]=function(t){return 1-e(1-t)},x.easing["easeInOut"+t]=function(t){return t<.5?e(2*t)/2:1-e(-2*t+2)/2}});x.effects,x.effects.define("blind","hide",function(t,e){var i={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},n=x(this),s=t.direction||"up",r=n.cssClip(),o={clip:x.extend({},r)},a=x.effects.createPlaceholder(n);o.clip[i[s][0]]=o.clip[i[s][1]],"show"===t.mode&&(n.cssClip(o.clip),a&&a.css(x.effects.clipToBox(o)),o.clip=r),a&&a.animate(x.effects.clipToBox(o),t.duration,t.easing),n.animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:e})}),x.effects.define("bounce",function(t,e){var i,n,s,r=x(this),o=t.mode,a="hide"===o,l="show"===o,h=t.direction||"up",c=t.distance,u=t.times||5,d=2*u+(l||a?1:0),p=t.duration/d,g=t.easing,f="up"===h||"down"===h?"top":"left",m="up"===h||"left"===h,v=0,y=r.queue().length;for(x.effects.createPlaceholder(r),s=r.css(f),c=c||r["top"==f?"outerHeight":"outerWidth"]()/3,l&&((n={opacity:1})[f]=s,r.css("opacity",0).css(f,m?2*-c:2*c).animate(n,p,g)),a&&(c/=Math.pow(2,u-1)),(n={})[f]=s;v<u;v++)(i={})[f]=(m?"-=":"+=")+c,r.animate(i,p,g).animate(n,p,g),c=a?2*c:c/2;a&&((i={opacity:0})[f]=(m?"-=":"+=")+c,r.animate(i,p,g)),r.queue(e),x.effects.unshift(r,y,1+d)}),x.effects.define("clip","hide",function(t,e){var i,n={},s=x(this),r=t.direction||"vertical",o="both"===r,a=o||"horizontal"===r,l=o||"vertical"===r;i=s.cssClip(),n.clip={top:l?(i.bottom-i.top)/2:i.top,right:a?(i.right-i.left)/2:i.right,bottom:l?(i.bottom-i.top)/2:i.bottom,left:a?(i.right-i.left)/2:i.left},x.effects.createPlaceholder(s),"show"===t.mode&&(s.cssClip(n.clip),n.clip=i),s.animate(n,{queue:!1,duration:t.duration,easing:t.easing,complete:e})}),x.effects.define("drop","hide",function(t,e){var i,n=x(this),s="show"===t.mode,r=t.direction||"left",o="up"===r||"down"===r?"top":"left",a="up"===r||"left"===r?"-=":"+=",l="+="==a?"-=":"+=",h={opacity:0};x.effects.createPlaceholder(n),i=t.distance||n["top"==o?"outerHeight":"outerWidth"](!0)/2,h[o]=a+i,s&&(n.css(h),h[o]=l+i,h.opacity=1),n.animate(h,{queue:!1,duration:t.duration,easing:t.easing,complete:e})}),x.effects.define("explode","hide",function(t,e){var i,n,s,r,o,a,l=t.pieces?Math.round(Math.sqrt(t.pieces)):3,h=l,c=x(this),u="show"===t.mode,d=c.show().css("visibility","hidden").offset(),p=Math.ceil(c.outerWidth()/h),g=Math.ceil(c.outerHeight()/l),f=[];function m(){f.push(this),f.length===l*h&&(c.css({visibility:"visible"}),x(f).remove(),e())}for(i=0;i<l;i++)for(r=d.top+i*g,a=i-(l-1)/2,n=0;n<h;n++)s=d.left+n*p,o=n-(h-1)/2,c.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-n*p,top:-i*g}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:p,height:g,left:s+(u?o*p:0),top:r+(u?a*g:0),opacity:u?0:1}).animate({left:s+(u?0:o*p),top:r+(u?0:a*g),opacity:u?1:0},t.duration||500,t.easing,m)}),x.effects.define("fade","toggle",function(t,e){var i="show"===t.mode;x(this).css("opacity",i?0:1).animate({opacity:i?1:0},{queue:!1,duration:t.duration,easing:t.easing,complete:e})}),x.effects.define("fold","hide",function(e,t){var i=x(this),n=e.mode,s="show"===n,r="hide"===n,o=e.size||15,a=/([0-9]+)%/.exec(o),l=!!e.horizFirst?["right","bottom"]:["bottom","right"],h=e.duration/2,c=x.effects.createPlaceholder(i),u=i.cssClip(),d={clip:x.extend({},u)},p={clip:x.extend({},u)},g=[u[l[0]],u[l[1]]],f=i.queue().length;a&&(o=parseInt(a[1],10)/100*g[r?0:1]),d.clip[l[0]]=o,p.clip[l[0]]=o,p.clip[l[1]]=0,s&&(i.cssClip(p.clip),c&&c.css(x.effects.clipToBox(p)),p.clip=u),i.queue(function(t){c&&c.animate(x.effects.clipToBox(d),h,e.easing).animate(x.effects.clipToBox(p),h,e.easing),t()}).animate(d,h,e.easing).animate(p,h,e.easing).queue(t),x.effects.unshift(i,f,4)}),x.effects.define("highlight","show",function(t,e){var i=x(this),n={backgroundColor:i.css("backgroundColor")};"hide"===t.mode&&(n.opacity=0),x.effects.saveStyle(i),i.css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(n,{queue:!1,duration:t.duration,easing:t.easing,complete:e})}),x.effects.define("size",function(s,e){var t,r,i,n=x(this),o=["fontSize"],a=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],l=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],h=s.mode,c="effect"!==h,u=s.scale||"both",d=s.origin||["middle","center"],p=n.css("position"),g=n.position(),f=x.effects.scaledDimensions(n),m=s.from||f,v=s.to||x.effects.scaledDimensions(n,0);x.effects.createPlaceholder(n),"show"===h&&(i=m,m=v,v=i),r={from:{y:m.height/f.height,x:m.width/f.width},to:{y:v.height/f.height,x:v.width/f.width}},"box"!==u&&"both"!==u||(r.from.y!==r.to.y&&(m=x.effects.setTransition(n,a,r.from.y,m),v=x.effects.setTransition(n,a,r.to.y,v)),r.from.x!==r.to.x&&(m=x.effects.setTransition(n,l,r.from.x,m),v=x.effects.setTransition(n,l,r.to.x,v))),"content"!==u&&"both"!==u||r.from.y!==r.to.y&&(m=x.effects.setTransition(n,o,r.from.y,m),v=x.effects.setTransition(n,o,r.to.y,v)),d&&(t=x.effects.getBaseline(d,f),m.top=(f.outerHeight-m.outerHeight)*t.y+g.top,m.left=(f.outerWidth-m.outerWidth)*t.x+g.left,v.top=(f.outerHeight-v.outerHeight)*t.y+g.top,v.left=(f.outerWidth-v.outerWidth)*t.x+g.left),n.css(m),"content"!==u&&"both"!==u||(a=a.concat(["marginTop","marginBottom"]).concat(o),l=l.concat(["marginLeft","marginRight"]),n.find("*[width]").each(function(){var t=x(this),e=x.effects.scaledDimensions(t),i={height:e.height*r.from.y,width:e.width*r.from.x,outerHeight:e.outerHeight*r.from.y,outerWidth:e.outerWidth*r.from.x},n={height:e.height*r.to.y,width:e.width*r.to.x,outerHeight:e.height*r.to.y,outerWidth:e.width*r.to.x};r.from.y!==r.to.y&&(i=x.effects.setTransition(t,a,r.from.y,i),n=x.effects.setTransition(t,a,r.to.y,n)),r.from.x!==r.to.x&&(i=x.effects.setTransition(t,l,r.from.x,i),n=x.effects.setTransition(t,l,r.to.x,n)),c&&x.effects.saveStyle(t),t.css(i),t.animate(n,s.duration,s.easing,function(){c&&x.effects.restoreStyle(t)})})),n.animate(v,{queue:!1,duration:s.duration,easing:s.easing,complete:function(){var t=n.offset();0===v.opacity&&n.css("opacity",m.opacity),c||(n.css("position","static"===p?"relative":p).offset(t),x.effects.saveStyle(n)),e()}})}),x.effects.define("scale",function(t,e){var i=x(this),n=t.mode,s=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"effect"!==n?0:100),r=x.extend(!0,{from:x.effects.scaledDimensions(i),to:x.effects.scaledDimensions(i,s,t.direction||"both"),origin:t.origin||["middle","center"]},t);t.fade&&(r.from.opacity=1,r.to.opacity=0),x.effects.effect.size.call(this,r,e)}),x.effects.define("puff","hide",function(t,e){var i=x.extend(!0,{},t,{fade:!0,percent:parseInt(t.percent,10)||150});x.effects.effect.scale.call(this,i,e)}),x.effects.define("pulsate","show",function(t,e){var i=x(this),n=t.mode,s="show"===n,r=s||"hide"===n,o=2*(t.times||5)+(r?1:0),a=t.duration/o,l=0,h=1,c=i.queue().length;for(!s&&i.is(":visible")||(i.css("opacity",0).show(),l=1);h<o;h++)i.animate({opacity:l},a,t.easing),l=1-l;i.animate({opacity:l},a,t.easing),i.queue(e),x.effects.unshift(i,c,1+o)}),x.effects.define("shake",function(t,e){var i=1,n=x(this),s=t.direction||"left",r=t.distance||20,o=t.times||3,a=2*o+1,l=Math.round(t.duration/a),h="up"===s||"down"===s?"top":"left",c="up"===s||"left"===s,u={},d={},p={},g=n.queue().length;for(x.effects.createPlaceholder(n),u[h]=(c?"-=":"+=")+r,d[h]=(c?"+=":"-=")+2*r,p[h]=(c?"-=":"+=")+2*r,n.animate(u,l,t.easing);i<o;i++)n.animate(d,l,t.easing).animate(p,l,t.easing);n.animate(d,l,t.easing).animate(u,l/2,t.easing).queue(e),x.effects.unshift(n,g,1+a)}),x.effects.define("slide","show",function(t,e){var i,n,s=x(this),r={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},o=t.mode,a=t.direction||"left",l="up"===a||"down"===a?"top":"left",h="up"===a||"left"===a,c=t.distance||s["top"==l?"outerHeight":"outerWidth"](!0),u={};x.effects.createPlaceholder(s),i=s.cssClip(),n=s.position()[l],u[l]=(h?-1:1)*c+n,u.clip=s.cssClip(),u.clip[r[a][1]]=u.clip[r[a][0]],"show"===o&&(s.cssClip(u.clip),s.css(l,u[l]),u.clip=i,u[l]=n),s.animate(u,{queue:!1,duration:t.duration,easing:t.easing,complete:e})});!1!==x.uiBackCompat&&x.effects.define("transfer",function(t,e){x(this).transfer(t,e)});x.ui.focusable=function(t,e){var i,n,s,r,o,a=t.nodeName.toLowerCase();return"area"===a?(n=(i=t.parentNode).name,!(!t.href||!n||"map"!==i.nodeName.toLowerCase())&&(0<(s=x("img[usemap='#"+n+"']")).length&&s.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(a)?(r=!t.disabled)&&(o=x(t).closest("fieldset")[0])&&(r=!o.disabled):r="a"===a&&t.href||e,r&&x(t).is(":visible")&&function(t){var e=t.css("visibility");for(;"inherit"===e;)t=t.parent(),e=t.css("visibility");return"hidden"!==e}(x(t)))},x.extend(x.expr[":"],{focusable:function(t){return x.ui.focusable(t,null!=x.attr(t,"tabindex"))}});x.ui.focusable,x.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):x(this[0].form)},x.ui.formResetMixin={_formResetHandler:function(){var e=x(this);setTimeout(function(){var t=e.data("ui-form-reset-instances");x.each(t,function(){this.refresh()})})},_bindFormResetHandler:function(){if(this.form=this.element.form(),this.form.length){var t=this.form.data("ui-form-reset-instances")||[];t.length||this.form.on("reset.ui-form-reset",this._formResetHandler),t.push(this),this.form.data("ui-form-reset-instances",t)}},_unbindFormResetHandler:function(){if(this.form.length){var t=this.form.data("ui-form-reset-instances");t.splice(x.inArray(this,t),1),t.length?this.form.data("ui-form-reset-instances",t):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}};"1.7"===x.fn.jquery.substring(0,3)&&(x.each(["Width","Height"],function(t,i){var s="Width"===i?["Left","Right"]:["Top","Bottom"],n=i.toLowerCase(),r={innerWidth:x.fn.innerWidth,innerHeight:x.fn.innerHeight,outerWidth:x.fn.outerWidth,outerHeight:x.fn.outerHeight};function o(t,e,i,n){return x.each(s,function(){e-=parseFloat(x.css(t,"padding"+this))||0,i&&(e-=parseFloat(x.css(t,"border"+this+"Width"))||0),n&&(e-=parseFloat(x.css(t,"margin"+this))||0)}),e}x.fn["inner"+i]=function(t){return void 0===t?r["inner"+i].call(this):this.each(function(){x(this).css(n,o(this,t)+"px")})},x.fn["outer"+i]=function(t,e){return"number"!=typeof t?r["outer"+i].call(this,t):this.each(function(){x(this).css(n,o(this,t,!0,e)+"px")})}}),x.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))});var X,J;x.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},x.ui.escapeSelector=(X=/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,function(t){return t.replace(X,"\\$1")}),x.fn.labels=function(){var t,e,i,n,s;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(n=this.eq(0).parents("label"),(i=this.attr("id"))&&(s=(t=this.eq(0).parents().last()).add(t.length?t.siblings():this.siblings()),e="label[for='"+x.ui.escapeSelector(i)+"']",n=n.add(s.find(e).addBack(e))),this.pushStack(n))},x.fn.scrollParent=function(t){var e=this.css("position"),i="absolute"===e,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,s=this.parents().filter(function(){var t=x(this);return(!i||"static"!==t.css("position"))&&n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==e&&s.length?s:x(this[0].ownerDocument||document)},x.extend(x.expr[":"],{tabbable:function(t){var e=x.attr(t,"tabindex"),i=null!=e;return(!i||0<=e)&&x.ui.focusable(t,i)}}),x.fn.extend({uniqueId:(J=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++J)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&x(this).removeAttr("id")})}}),x.widget("ui.accordion",{version:"1.12.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:"> li > :first-child, > :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=x(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),t.collapsible||!1!==t.active&&null!=t.active||(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():x()}},_createIcons:function(){var t,e,i=this.options.icons;i&&(t=x("<span>"),this._addClass(t,"ui-accordion-header-icon","ui-icon "+i.header),t.prependTo(this.headers),e=this.active.children(".ui-accordion-header-icon"),this._removeClass(e,i.header)._addClass(e,null,i.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),t=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){"active"!==t?("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||!1!==this.options.active||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons())):this._activate(e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t),this._toggleClass(null,"ui-state-disabled",!!t),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!t)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var e=x.ui.keyCode,i=this.headers.length,n=this.headers.index(t.target),s=!1;switch(t.keyCode){case e.RIGHT:case e.DOWN:s=this.headers[(n+1)%i];break;case e.LEFT:case e.UP:s=this.headers[(n-1+i)%i];break;case e.SPACE:case e.ENTER:this._eventHandler(t);break;case e.HOME:s=this.headers[0];break;case e.END:s=this.headers[i-1]}s&&(x(t.target).attr("tabIndex",-1),x(s).attr("tabIndex",0),x(s).trigger("focus"),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===x.ui.keyCode.UP&&t.ctrlKey&&x(t.currentTarget).prev().trigger("focus")},refresh:function(){var t=this.options;this._processPanels(),!1===t.active&&!0===t.collapsible||!this.headers.length?(t.active=!1,this.active=x()):!1===t.active?this._activate(0):this.active.length&&!x.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=x()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var t=this.headers,e=this.panels;this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),e&&(this._off(t.not(this.headers)),this._off(e.not(this.panels)))},_refresh:function(){var i,t=this.options,e=t.heightStyle,n=this.element.parent();this.active=this._findActive(t.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each(function(){var t=x(this),e=t.uniqueId().attr("id"),i=t.next(),n=i.uniqueId().attr("id");t.attr("aria-controls",n),i.attr("aria-labelledby",e)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(t.event),"fill"===e?(i=n.height(),this.element.siblings(":visible").each(function(){var t=x(this),e=t.css("position");"absolute"!==e&&"fixed"!==e&&(i-=t.outerHeight(!0))}),this.headers.each(function(){i-=x(this).outerHeight(!0)}),this.headers.next().each(function(){x(this).height(Math.max(0,i-x(this).innerHeight()+x(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.headers.next().each(function(){var t=x(this).is(":visible");t||x(this).show(),i=Math.max(i,x(this).css("height","").height()),t||x(this).hide()}).height(i))},_activate:function(t){var e=this._findActive(t)[0];e!==this.active[0]&&(e=e||this.active[0],this._eventHandler({target:e,currentTarget:e,preventDefault:x.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):x()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&x.each(t.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var e,i,n=this.options,s=this.active,r=x(t.currentTarget),o=r[0]===s[0],a=o&&n.collapsible,l=a?x():r.next(),h=s.next(),c={oldHeader:s,oldPanel:h,newHeader:a?x():r,newPanel:l};t.preventDefault(),o&&!n.collapsible||!1===this._trigger("beforeActivate",t,c)||(n.active=!a&&this.headers.index(r),this.active=o?x():r,this._toggle(c),this._removeClass(s,"ui-accordion-header-active","ui-state-active"),n.icons&&(e=s.children(".ui-accordion-header-icon"),this._removeClass(e,null,n.icons.activeHeader)._addClass(e,null,n.icons.header)),o||(this._removeClass(r,"ui-accordion-header-collapsed")._addClass(r,"ui-accordion-header-active","ui-state-active"),n.icons&&(i=r.children(".ui-accordion-header-icon"),this._removeClass(i,null,n.icons.header)._addClass(i,null,n.icons.activeHeader)),this._addClass(r.next(),"ui-accordion-content-active")))},_toggle:function(t){var e=t.newPanel,i=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=e,this.prevHide=i,this.options.animate?this._animate(e,i,t):(i.hide(),e.show(),this._toggleComplete(t)),i.attr({"aria-hidden":"true"}),i.prev().attr({"aria-selected":"false","aria-expanded":"false"}),e.length&&i.length?i.prev().attr({tabIndex:-1,"aria-expanded":"false"}):e.length&&this.headers.filter(function(){return 0===parseInt(x(this).attr("tabIndex"),10)}).attr("tabIndex",-1),e.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(t,i,e){function n(){a._toggleComplete(e)}var s,r,o,a=this,l=0,h=t.css("box-sizing"),c=t.length&&(!i.length||t.index()<i.index()),u=this.options.animate||{},d=c&&u.down||u;return"number"==typeof d&&(o=d),"string"==typeof d&&(r=d),r=r||d.easing||u.easing,o=o||d.duration||u.duration,i.length?t.length?(s=t.show().outerHeight(),i.animate(this.hideProps,{duration:o,easing:r,step:function(t,e){e.now=Math.round(t)}}),void t.hide().animate(this.showProps,{duration:o,easing:r,complete:n,step:function(t,e){e.now=Math.round(t),"height"!==e.prop?"content-box"===h&&(l+=e.now):"content"!==a.options.heightStyle&&(e.now=Math.round(s-i.outerHeight()-l),l=0)}})):i.animate(this.hideProps,o,r,n):t.animate(this.showProps,o,r,n)},_toggleComplete:function(t){var e=t.oldPanel,i=e.prev();this._removeClass(e,"ui-accordion-content-active"),this._removeClass(i,"ui-accordion-header-active")._addClass(i,"ui-accordion-header-collapsed"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}}),x.ui.safeActiveElement=function(e){var i;try{i=e.activeElement}catch(t){i=e.body}return(i=i||e.body).nodeName||(i=e.body),i},x.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(t){var e=x(t.target),i=x(x.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&e.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),e.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&i.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){if(!this.previousFilter){var e=x(t.target).closest(".ui-menu-item"),i=x(t.currentTarget);e[0]===i[0]&&(this._removeClass(i.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(t,i))}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,i)},blur:function(t){this._delay(function(){x.contains(this.element[0],x.ui.safeActiveElement(this.document[0]))||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){var t=this.element.find(".ui-menu-item").removeAttr("role aria-disabled").children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),t.children().each(function(){var t=x(this);t.data("ui-menu-submenu-caret")&&t.remove()})},_keydown:function(t){var e,i,n,s,r=!0;switch(t.keyCode){case x.ui.keyCode.PAGE_UP:this.previousPage(t);break;case x.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case x.ui.keyCode.HOME:this._move("first","first",t);break;case x.ui.keyCode.END:this._move("last","last",t);break;case x.ui.keyCode.UP:this.previous(t);break;case x.ui.keyCode.DOWN:this.next(t);break;case x.ui.keyCode.LEFT:this.collapse(t);break;case x.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case x.ui.keyCode.ENTER:case x.ui.keyCode.SPACE:this._activate(t);break;case x.ui.keyCode.ESCAPE:this.collapse(t);break;default:r=!1,i=this.previousFilter||"",s=!1,n=96<=t.keyCode&&t.keyCode<=105?(t.keyCode-96).toString():String.fromCharCode(t.keyCode),clearTimeout(this.filterTimer),n===i?s=!0:n=i+n,e=this._filterMenuItems(n),(e=s&&-1!==e.index(this.active.next())?this.active.nextAll(".ui-menu-item"):e).length||(n=String.fromCharCode(t.keyCode),e=this._filterMenuItems(n)),e.length?(this.focus(t,e),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}r&&t.preventDefault()},_activate:function(t){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var t,e,i,n,s=this,r=this.options.icons.submenu,o=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),e=o.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=x(this),e=t.prev(),i=x("<span>").data("ui-menu-submenu-caret",!0);s._addClass(i,"ui-menu-icon","ui-icon "+r),e.attr("aria-haspopup","true").prepend(i),t.attr("aria-labelledby",e.attr("id"))}),this._addClass(e,"ui-menu","ui-widget ui-widget-content ui-front"),(t=o.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var t=x(this);s._isDivider(t)&&s._addClass(t,"ui-menu-divider","ui-widget-content")}),n=(i=t.not(".ui-menu-item, .ui-menu-divider")).children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(i,"ui-menu-item")._addClass(n,"ui-menu-item-wrapper"),t.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!x.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){if("icons"===t){var i=this.element.find(".ui-menu-icon");this._removeClass(i,null,this.options.icons.submenu)._addClass(i,null,e.submenu)}this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",String(t)),this._toggleClass(null,"ui-state-disabled",!!t)},focus:function(t,e){var i,n,s;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),n=this.active.children(".ui-menu-item-wrapper"),this._addClass(n,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),s=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(s,null,"ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(i=e.children(".ui-menu")).length&&t&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(t){var e,i,n,s,r,o;this._hasScroll()&&(e=parseFloat(x.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat(x.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-e-i,s=this.activeMenu.scrollTop(),r=this.activeMenu.height(),o=t.outerHeight(),n<0?this.activeMenu.scrollTop(s+n):r<n+o&&this.activeMenu.scrollTop(s+n-r+o))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",t,{item:this.active}),this.active=null)},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(t){var e=x.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(e)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var t=i?this.element:x(e&&e.target).closest(this.element.find(".ui-menu"));t.length||(t=this.element),this._close(t),this.blur(e),this._removeClass(t.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=t},this.delay)},_close:function(t){(t=t||(this.active?this.active.parent():this.element)).find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(t){return!x(t.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var n;this.active&&(n="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.find(this.options.items)[e]()),this.focus(i,n)},nextPage:function(t){var e,i,n;this.active?this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(e=x(this)).offset().top-i-n<0}),this.focus(t,e)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())):this.next(t)},previousPage:function(t){var e,i,n;this.active?this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return 0<(e=x(this)).offset().top-i+n}),this.focus(t,e)):this.focus(t,this.activeMenu.find(this.options.items).first())):this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||x(t.target).closest(".ui-menu-item");var e={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,e)},_filterMenuItems:function(t){var e=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),i=new RegExp("^"+e,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return i.test(x.trim(x(this).children(".ui-menu-item-wrapper").text()))})}});x.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var i,n,s,t=this.element[0].nodeName.toLowerCase(),e="textarea"===t,r="input"===t;this.isMultiLine=e||!r&&this._isContentEditable(this.element),this.valueMethod=this.element[e||r?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(t){if(this.element.prop("readOnly"))n=s=i=!0;else{n=s=i=!1;var e=x.ui.keyCode;switch(t.keyCode){case e.PAGE_UP:i=!0,this._move("previousPage",t);break;case e.PAGE_DOWN:i=!0,this._move("nextPage",t);break;case e.UP:i=!0,this._keyEvent("previous",t);break;case e.DOWN:i=!0,this._keyEvent("next",t);break;case e.ENTER:this.menu.active&&(i=!0,t.preventDefault(),this.menu.select(t));break;case e.TAB:this.menu.active&&this.menu.select(t);break;case e.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(t),t.preventDefault());break;default:n=!0,this._searchTimeout(t)}}},keypress:function(t){if(i)return i=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||t.preventDefault());if(!n){var e=x.ui.keyCode;switch(t.keyCode){case e.PAGE_UP:this._move("previousPage",t);break;case e.PAGE_DOWN:this._move("nextPage",t);break;case e.UP:this._keyEvent("previous",t);break;case e.DOWN:this._keyEvent("next",t)}}},input:function(t){if(s)return s=!1,void t.preventDefault();this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),this._change(t))}}),this._initSource(),this.menu=x("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,this.element[0]!==x.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")})},menufocus:function(t,e){var i,n;if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){x(t.target).trigger(t.originalEvent)});n=e.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:n})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(n.value),(i=e.item.attr("aria-label")||n.value)&&x.trim(i).length&&(this.liveRegion.children().hide(),x("<div>").text(i).appendTo(this.liveRegion))},menuselect:function(t,e){var i=e.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==x.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=i})),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=x("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(t){var e=this.menu.element[0];return t.target===this.element[0]||t.target===e||x.contains(e,t.target)},_closeOnClickOutside:function(t){this._isEventTargetInWidget(t)||this.close()},_appendTo:function(){var t=this.options.appendTo;return(t=t&&(t.jquery||t.nodeType?x(t):this.document.find(t).eq(0)))&&t[0]||(t=this.element.closest(".ui-front, dialog")),t.length||(t=this.document[0].body),t},_initSource:function(){var i,n,s=this;x.isArray(this.options.source)?(i=this.options.source,this.source=function(t,e){e(x.ui.autocomplete.filter(i,t.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(t,e){s.xhr&&s.xhr.abort(),s.xhr=x.ajax({url:n,data:t,dataType:"json",success:function(t){e(t)},error:function(){e([])}})}):this.source=this.options.source},_searchTimeout:function(n){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),e=this.menu.element.is(":visible"),i=n.altKey||n.ctrlKey||n.metaKey||n.shiftKey;t&&(!t||e||i)||(this.selectedItem=null,this.search(null,n))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):!1!==this._trigger("search",e)?this._search(t):void 0},_search:function(t){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return x.proxy(function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")},this)},__response:function(t){t=t&&this._normalize(t),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:x.map(t,function(t){return"string"==typeof t?{label:t,value:t}:x.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var e=this.menu.element.empty();this._renderMenu(e,t),this.isNewMenu=!0,this.menu.refresh(),e.show(),this._resizeMenu(),e.position(x.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(i,t){var n=this;x.each(t,function(t,e){n._renderItemData(i,e)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(t,e){return x("<li>").append(x("<div>").text(e.label)).appendTo(t)},_move:function(t,e){if(this.menu.element.is(":visible"))return this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[t](e);this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(t,e),e.preventDefault())},_isContentEditable:function(t){if(!t.length)return!1;var e=t.prop("contentEditable");return"inherit"===e?this._isContentEditable(t.parent()):"true"===e}}),x.extend(x.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,e){var i=new RegExp(x.ui.autocomplete.escapeRegex(e),"i");return x.grep(t,function(t){return i.test(t.label||t.value||t)})}}),x.widget("ui.autocomplete",x.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(1<t?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var e;this._superApply(arguments),this.options.disabled||this.cancelSearch||(e=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),x("<div>").text(e).appendTo(this.liveRegion))}});x.ui.autocomplete;var $=/ui-corner-([a-z]){2,6}/g;x.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var o=this,a=[];x.each(this.options.items,function(s,t){var e,r={};if(t)return"controlgroupLabel"===s?((e=o.element.find(t)).each(function(){var t=x(this);t.children(".ui-controlgroup-label-contents").length||t.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),o._addClass(e,null,"ui-widget ui-widget-content ui-state-default"),void(a=a.concat(e.get()))):void(x.fn[s]&&(r=o["_"+s+"Options"]?o["_"+s+"Options"]("middle"):{classes:{}},o.element.find(t).each(function(){var t=x(this),e=t[s]("instance"),i=x.widget.extend({},r);if("button"!==s||!t.parent(".ui-spinner").length){(e=e||t[s]()[s]("instance"))&&(i.classes=o._resolveClassesValues(i.classes,e)),t[s](i);var n=t[s]("widget");x.data(n[0],"ui-controlgroup-data",e||t[s]("instance")),a.push(n[0])}})))}),this.childWidgets=x(x.unique(a)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(e){this.childWidgets.each(function(){var t=x(this).data("ui-controlgroup-data");t&&t[e]&&t[e]()})},_updateCornerClass:function(t,e){var i=this._buildSimpleOptions(e,"label").classes.label;this._removeClass(t,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(t,null,i)},_buildSimpleOptions:function(t,e){var i="vertical"===this.options.direction,n={classes:{}};return n.classes[e]={middle:"",first:"ui-corner-"+(i?"top":"left"),last:"ui-corner-"+(i?"bottom":"right"),only:"ui-corner-all"}[t],n},_spinnerOptions:function(t){var e=this._buildSimpleOptions(t,"ui-spinner");return e.classes["ui-spinner-up"]="",e.classes["ui-spinner-down"]="",e},_buttonOptions:function(t){return this._buildSimpleOptions(t,"ui-button")},_checkboxradioOptions:function(t){return this._buildSimpleOptions(t,"ui-checkboxradio-label")},_selectmenuOptions:function(t){var e="vertical"===this.options.direction;return{width:e&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(e?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(e?"top":"left")},last:{"ui-selectmenu-button-open":e?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(e?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[t]}},_resolveClassesValues:function(i,n){var s={};return x.each(i,function(t){var e=n.options.classes[t]||"";e=x.trim(e.replace($,"")),s[t]=(e+" "+i[t]).replace(/\s+/g," ")}),s},_setOption:function(t,e){"direction"===t&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(t,e),"disabled"!==t?this.refresh():this._callChildMethod(e?"disable":"enable")},refresh:function(){var s,r=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),s=this.childWidgets,this.options.onlyVisible&&(s=s.filter(":visible")),s.length&&(x.each(["first","last"],function(t,e){var i=s[e]().data("ui-controlgroup-data");if(i&&r["_"+i.widgetName+"Options"]){var n=r["_"+i.widgetName+"Options"](1===s.length?"only":e);n.classes=r._resolveClassesValues(n.classes,i),i.element[i.widgetName](n)}else r._updateCornerClass(s[e](),e)}),this._callChildMethod("refresh"))}});x.widget("ui.checkboxradio",[x.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var t,e,i=this,n=this._super()||{};return this._readType(),e=this.element.labels(),this.label=x(e[e.length-1]),this.label.length||x.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each(function(){i.originalLabel+=3===this.nodeType?x(this).text():this.outerHTML}),this.originalLabel&&(n.label=this.originalLabel),null!=(t=this.element[0].disabled)&&(n.disabled=t),n},_create:function(){var t=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),t&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var t=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===t&&/radio|checkbox/.test(this.type)||x.error("Can't create checkboxradio on element.nodeName="+t+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var t=this.element[0].name,e="input[name='"+x.ui.escapeSelector(t)+"']";return t?(this.form.length?x(this.form[0].elements).filter(e):x(e).filter(function(){return 0===x(this).form().length})).not(this.element):x([])},_toggleClasses:function(){var t=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",t)._toggleClass(this.icon,null,"ui-icon-blank",!t),"radio"===this.type&&this._getRadioGroup().each(function(){var t=x(this).checkboxradio("instance");t&&t._removeClass(t.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(t,e){if("label"!==t||e){if(this._super(t,e),"disabled"===t)return this._toggleClass(this.label,null,"ui-state-disabled",e),void(this.element[0].disabled=e);this.refresh()}},_updateIcon:function(t){var e="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=x("<span>"),this.iconSpace=x("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(e+=t?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,t?"ui-icon-blank":"ui-icon-check")):e+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",e),t||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var t=this.label.contents().not(this.element[0]);this.icon&&(t=t.not(this.icon[0])),this.iconSpace&&(t=t.not(this.iconSpace[0])),t.remove(),this.label.append(this.options.label)},refresh:function(){var t=this.element[0].checked,e=this.element[0].disabled;this._updateIcon(t),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),null!==this.options.label&&this._updateLabel(),e!==this.options.disabled&&this._setOptions({disabled:e})}}]);var K;x.ui.checkboxradio;x.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var t,e=this._super()||{};return this.isInput=this.element.is("input"),null!=(t=this.element[0].disabled)&&(e.disabled=t),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(e.label=this.originalLabel),e},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(t){t.keyCode===x.ui.keyCode.SPACE&&(t.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(t,e){var i="iconPosition"!==t,n=i?this.options.iconPosition:e,s="top"===n||"bottom"===n;this.icon?i&&this._removeClass(this.icon,null,this.options.icon):(this.icon=x("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),i&&this._addClass(this.icon,null,e),this._attachIcon(n),s?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=x("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(n))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(t){this.icon[/^(?:end|bottom)/.test(t)?"before":"after"](this.iconSpace)},_attachIcon:function(t){this.element[/^(?:end|bottom)/.test(t)?"append":"prepend"](this.icon)},_setOptions:function(t){var e=void 0===t.showLabel?this.options.showLabel:t.showLabel,i=void 0===t.icon?this.options.icon:t.icon;e||i||(t.showLabel=!0),this._super(t)},_setOption:function(t,e){"icon"===t&&(e?this._updateIcon(t,e):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===t&&this._updateIcon(t,e),"showLabel"===t&&(this._toggleClass("ui-button-icon-only",null,!e),this._updateTooltip()),"label"===t&&(this.isInput?this.element.val(e):(this.element.html(e),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(t,e),"disabled"===t&&(this._toggleClass(null,"ui-state-disabled",e),(this.element[0].disabled=e)&&this.element.blur())},refresh:function(){var t=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOptions({disabled:t}),this._updateTooltip()}}),!1!==x.uiBackCompat&&(x.widget("ui.button",x.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(t,e){"text"!==t?("showLabel"===t&&(this.options.text=e),"icon"===t&&(this.options.icons.primary=e),"icons"===t&&(e.primary?(this._super("icon",e.primary),this._super("iconPosition","beginning")):e.secondary&&(this._super("icon",e.secondary),this._super("iconPosition","end"))),this._superApply(arguments)):this._super("showLabel",e)}}),x.fn.button=(K=x.fn.button,function(){return!this.length||this.length&&"INPUT"!==this[0].tagName||this.length&&"INPUT"===this[0].tagName&&"checkbox"!==this.attr("type")&&"radio"!==this.attr("type")?K.apply(this,arguments):(x.ui.checkboxradio||x.error("Checkboxradio widget missing"),0===arguments.length?this.checkboxradio({icon:!1}):this.checkboxradio.apply(this,arguments))}),x.fn.buttonset=function(){return x.ui.controlgroup||x.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))});var Q;x.ui.button;function q(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},x.extend(this._defaults,this.regional[""]),this.regional.en=x.extend(!0,{},this.regional[""]),this.regional["en-US"]=x.extend(!0,{},this.regional.en),this.dpDiv=tt(x("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function tt(t){var e="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.on("mouseout",e,function(){x(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&x(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&x(this).removeClass("ui-datepicker-next-hover")}).on("mouseover",e,et)}function et(){x.datepicker._isDisabledDatepicker(Q.inline?Q.dpDiv.parent()[0]:Q.input[0])||(x(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),x(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&x(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&x(this).addClass("ui-datepicker-next-hover"))}function it(t,e){for(var i in x.extend(t,e),e)null==e[i]&&(t[i]=e[i]);return t}x.extend(x.ui,{datepicker:{version:"1.12.1"}}),x.extend(q.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return it(this._defaults,t||{}),this},_attachDatepicker:function(t,e){var i,n,s;n="div"===(i=t.nodeName.toLowerCase())||"span"===i,t.id||(this.uuid+=1,t.id="dp"+this.uuid),(s=this._newInst(x(t),n)).settings=x.extend({},e||{}),"input"===i?this._connectDatepicker(t,s):n&&this._inlineDatepicker(t,s)},_newInst:function(t,e){return{id:t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:e,dpDiv:e?tt(x("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,e){var i=x(t);e.append=x([]),e.trigger=x([]),i.hasClass(this.markerClassName)||(this._attachments(i,e),i.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(e),x.data(t,"datepicker",e),e.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,e){var i,n,s,r=this._get(e,"appendText"),o=this._get(e,"isRTL");e.append&&e.append.remove(),r&&(e.append=x("<span class='"+this._appendClass+"'>"+r+"</span>"),t[o?"before":"after"](e.append)),t.off("focus",this._showDatepicker),e.trigger&&e.trigger.remove(),"focus"!==(i=this._get(e,"showOn"))&&"both"!==i||t.on("focus",this._showDatepicker),"button"!==i&&"both"!==i||(n=this._get(e,"buttonText"),s=this._get(e,"buttonImage"),e.trigger=x(this._get(e,"buttonImageOnly")?x("<img/>").addClass(this._triggerClass).attr({src:s,alt:n,title:n}):x("<button type='button'></button>").addClass(this._triggerClass).html(s?x("<img/>").attr({src:s,alt:n,title:n}):n)),t[o?"before":"after"](e.trigger),e.trigger.on("click",function(){return x.datepicker._datepickerShowing&&x.datepicker._lastInput===t[0]?x.datepicker._hideDatepicker():(x.datepicker._datepickerShowing&&x.datepicker._lastInput!==t[0]&&x.datepicker._hideDatepicker(),x.datepicker._showDatepicker(t[0])),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,n,s,r=new Date(2009,11,20),o=this._get(t,"dateFormat");o.match(/[DM]/)&&(e=function(t){for(s=n=i=0;s<t.length;s++)t[s].length>i&&(i=t[s].length,n=s);return n},r.setMonth(e(this._get(t,o.match(/MM/)?"monthNames":"monthNamesShort"))),r.setDate(e(this._get(t,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-r.getDay())),t.input.attr("size",this._formatDate(t,r).length)}},_inlineDatepicker:function(t,e){var i=x(t);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(e.dpDiv),x.data(t,"datepicker",e),this._setDate(e,this._getDefaultDate(e),!0),this._updateDatepicker(e),this._updateAlternate(e),e.settings.disabled&&this._disableDatepicker(t),e.dpDiv.css("display","block"))},_dialogDatepicker:function(t,e,i,n,s){var r,o,a,l,h,c=this._dialogInst;return c||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=x("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),x("body").append(this._dialogInput),(c=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},x.data(this._dialogInput[0],"datepicker",c)),it(c.settings,n||{}),e=e&&e.constructor===Date?this._formatDate(c,e):e,this._dialogInput.val(e),this._pos=s?s.length?s:[s.pageX,s.pageY]:null,this._pos||(o=document.documentElement.clientWidth,a=document.documentElement.clientHeight,l=document.documentElement.scrollLeft||document.body.scrollLeft,h=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[o/2-100+l,a/2-150+h]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),c.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),x.blockUI&&x.blockUI(this.dpDiv),x.data(this._dialogInput[0],"datepicker",c),this},_destroyDatepicker:function(t){var e,i=x(t),n=x.data(t,"datepicker");i.hasClass(this.markerClassName)&&(e=t.nodeName.toLowerCase(),x.removeData(t,"datepicker"),"input"===e?(n.append.remove(),n.trigger.remove(),i.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):"div"!==e&&"span"!==e||i.removeClass(this.markerClassName).empty(),Q===n&&(Q=null))},_enableDatepicker:function(e){var t,i,n=x(e),s=x.data(e,"datepicker");n.hasClass(this.markerClassName)&&("input"===(t=e.nodeName.toLowerCase())?(e.disabled=!1,s.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==t&&"span"!==t||((i=n.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=x.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var t,i,n=x(e),s=x.data(e,"datepicker");n.hasClass(this.markerClassName)&&("input"===(t=e.nodeName.toLowerCase())?(e.disabled=!0,s.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==t&&"span"!==t||((i=n.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=x.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;e<this._disabledInputs.length;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(t){try{return x.data(t,"datepicker")}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,e,i){var n,s,r,o,a=this._getInst(t);if(2===arguments.length&&"string"==typeof e)return"defaults"===e?x.extend({},x.datepicker._defaults):a?"all"===e?x.extend({},a.settings):this._get(a,e):null;n=e||{},"string"==typeof e&&((n={})[e]=i),a&&(this._curInst===a&&this._hideDatepicker(),s=this._getDateDatepicker(t,!0),r=this._getMinMaxDate(a,"min"),o=this._getMinMaxDate(a,"max"),it(a.settings,n),null!==r&&void 0!==n.dateFormat&&void 0===n.minDate&&(a.settings.minDate=this._formatDate(a,r)),null!==o&&void 0!==n.dateFormat&&void 0===n.maxDate&&(a.settings.maxDate=this._formatDate(a,o)),"disabled"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(x(t),a),this._autoSize(a),this._setDate(a,s),this._updateAlternate(a),this._updateDatepicker(a))},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(t){var e,i,n,s=x.datepicker._getInst(t.target),r=!0,o=s.dpDiv.is(".ui-datepicker-rtl");if(s._keyEvent=!0,x.datepicker._datepickerShowing)switch(t.keyCode){case 9:x.datepicker._hideDatepicker(),r=!1;break;case 13:return(n=x("td."+x.datepicker._dayOverClass+":not(."+x.datepicker._currentClass+")",s.dpDiv))[0]&&x.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,n[0]),(e=x.datepicker._get(s,"onSelect"))?(i=x.datepicker._formatDate(s),e.apply(s.input?s.input[0]:null,[i,s])):x.datepicker._hideDatepicker(),!1;case 27:x.datepicker._hideDatepicker();break;case 33:x.datepicker._adjustDate(t.target,t.ctrlKey?-x.datepicker._get(s,"stepBigMonths"):-x.datepicker._get(s,"stepMonths"),"M");break;case 34:x.datepicker._adjustDate(t.target,t.ctrlKey?+x.datepicker._get(s,"stepBigMonths"):+x.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&x.datepicker._clearDate(t.target),r=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&x.datepicker._gotoToday(t.target),r=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&x.datepicker._adjustDate(t.target,o?1:-1,"D"),r=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&x.datepicker._adjustDate(t.target,t.ctrlKey?-x.datepicker._get(s,"stepBigMonths"):-x.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&x.datepicker._adjustDate(t.target,-7,"D"),r=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&x.datepicker._adjustDate(t.target,o?-1:1,"D"),r=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&x.datepicker._adjustDate(t.target,t.ctrlKey?+x.datepicker._get(s,"stepBigMonths"):+x.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&x.datepicker._adjustDate(t.target,7,"D"),r=t.ctrlKey||t.metaKey;break;default:r=!1}else 36===t.keyCode&&t.ctrlKey?x.datepicker._showDatepicker(this):r=!1;r&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var e,i,n=x.datepicker._getInst(t.target);if(x.datepicker._get(n,"constrainInput"))return e=x.datepicker._possibleChars(x.datepicker._get(n,"dateFormat")),i=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||i<" "||!e||-1<e.indexOf(i)},_doKeyUp:function(t){var e=x.datepicker._getInst(t.target);if(e.input.val()!==e.lastVal)try{x.datepicker.parseDate(x.datepicker._get(e,"dateFormat"),e.input?e.input.val():null,x.datepicker._getFormatConfig(e))&&(x.datepicker._setDateFromField(e),x.datepicker._updateAlternate(e),x.datepicker._updateDatepicker(e))}catch(t){}return!0},_showDatepicker:function(t){var e,i,n,s,r,o,a;"input"!==(t=t.target||t).nodeName.toLowerCase()&&(t=x("input",t.parentNode)[0]),x.datepicker._isDisabledDatepicker(t)||x.datepicker._lastInput===t||(e=x.datepicker._getInst(t),x.datepicker._curInst&&x.datepicker._curInst!==e&&(x.datepicker._curInst.dpDiv.stop(!0,!0),e&&x.datepicker._datepickerShowing&&x.datepicker._hideDatepicker(x.datepicker._curInst.input[0])),!1!==(n=(i=x.datepicker._get(e,"beforeShow"))?i.apply(t,[t,e]):{})&&(it(e.settings,n),e.lastVal=null,x.datepicker._lastInput=t,x.datepicker._setDateFromField(e),x.datepicker._inDialog&&(t.value=""),x.datepicker._pos||(x.datepicker._pos=x.datepicker._findPos(t),x.datepicker._pos[1]+=t.offsetHeight),s=!1,x(t).parents().each(function(){return!(s|="fixed"===x(this).css("position"))}),r={left:x.datepicker._pos[0],top:x.datepicker._pos[1]},x.datepicker._pos=null,e.dpDiv.empty(),e.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),x.datepicker._updateDatepicker(e),r=x.datepicker._checkOffset(e,r,s),e.dpDiv.css({position:x.datepicker._inDialog&&x.blockUI?"static":s?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),e.inline||(o=x.datepicker._get(e,"showAnim"),a=x.datepicker._get(e,"duration"),e.dpDiv.css("z-index",function(t){for(var e,i;t.length&&t[0]!==document;){if(("absolute"===(e=t.css("position"))||"relative"===e||"fixed"===e)&&(i=parseInt(t.css("zIndex"),10),!isNaN(i)&&0!==i))return i;t=t.parent()}return 0}(x(t))+1),x.datepicker._datepickerShowing=!0,x.effects&&x.effects.effect[o]?e.dpDiv.show(o,x.datepicker._get(e,"showOptions"),a):e.dpDiv[o||"show"](o?a:null),x.datepicker._shouldFocusInput(e)&&e.input.trigger("focus"),x.datepicker._curInst=e)))},_updateDatepicker:function(t){this.maxRows=4,(Q=t).dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var e,i=this._getNumberOfMonths(t),n=i[1],s=t.dpDiv.find("."+this._dayOverClass+" a");0<s.length&&et.apply(s.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),1<n&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",17*n+"em"),t.dpDiv[(1!==i[0]||1!==i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===x.datepicker._curInst&&x.datepicker._datepickerShowing&&x.datepicker._shouldFocusInput(t)&&t.input.trigger("focus"),t.yearshtml&&(e=t.yearshtml,setTimeout(function(){e===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),e=t.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(t,e,i){var n=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),r=t.input?t.input.outerWidth():0,o=t.input?t.input.outerHeight():0,a=document.documentElement.clientWidth+(i?0:x(document).scrollLeft()),l=document.documentElement.clientHeight+(i?0:x(document).scrollTop());return e.left-=this._get(t,"isRTL")?n-r:0,e.left-=i&&e.left===t.input.offset().left?x(document).scrollLeft():0,e.top-=i&&e.top===t.input.offset().top+o?x(document).scrollTop():0,e.left-=Math.min(e.left,e.left+n>a&&n<a?Math.abs(e.left+n-a):0),e.top-=Math.min(e.top,e.top+s>l&&s<l?Math.abs(s+o):0),e},_findPos:function(t){for(var e,i=this._getInst(t),n=this._get(i,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||x.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return[(e=x(t).offset()).left,e.top]},_hideDatepicker:function(t){var e,i,n,s,r=this._curInst;!r||t&&r!==x.data(t,"datepicker")||this._datepickerShowing&&(e=this._get(r,"showAnim"),i=this._get(r,"duration"),n=function(){x.datepicker._tidyDialog(r)},x.effects&&(x.effects.effect[e]||x.effects[e])?r.dpDiv.hide(e,x.datepicker._get(r,"showOptions"),i,n):r.dpDiv["slideDown"===e?"slideUp":"fadeIn"===e?"fadeOut":"hide"](e?i:null,n),e||n(),this._datepickerShowing=!1,(s=this._get(r,"onClose"))&&s.apply(r.input?r.input[0]:null,[r.input?r.input.val():"",r]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),x.blockUI&&(x.unblockUI(),x("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(x.datepicker._curInst){var e=x(t.target),i=x.datepicker._getInst(e[0]);(e[0].id===x.datepicker._mainDivId||0!==e.parents("#"+x.datepicker._mainDivId).length||e.hasClass(x.datepicker.markerClassName)||e.closest("."+x.datepicker._triggerClass).length||!x.datepicker._datepickerShowing||x.datepicker._inDialog&&x.blockUI)&&(!e.hasClass(x.datepicker.markerClassName)||x.datepicker._curInst===i)||x.datepicker._hideDatepicker()}},_adjustDate:function(t,e,i){var n=x(t),s=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(s,e+("M"===i?this._get(s,"showCurrentAtPos"):0),i),this._updateDatepicker(s))},_gotoToday:function(t){var e,i=x(t),n=this._getInst(i[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(e=new Date,n.selectedDay=e.getDate(),n.drawMonth=n.selectedMonth=e.getMonth(),n.drawYear=n.selectedYear=e.getFullYear()),this._notifyChange(n),this._adjustDate(i)},_selectMonthYear:function(t,e,i){var n=x(t),s=this._getInst(n[0]);s["selected"+("M"===i?"Month":"Year")]=s["draw"+("M"===i?"Month":"Year")]=parseInt(e.options[e.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(n)},_selectDay:function(t,e,i,n){var s,r=x(t);x(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(r[0])||((s=this._getInst(r[0])).selectedDay=s.currentDay=x("a",n).html(),s.selectedMonth=s.currentMonth=e,s.selectedYear=s.currentYear=i,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear)))},_clearDate:function(t){var e=x(t);this._selectDate(e,"")},_selectDate:function(t,e){var i,n=x(t),s=this._getInst(n[0]);e=null!=e?e:this._formatDate(s),s.input&&s.input.val(e),this._updateAlternate(s),(i=this._get(s,"onSelect"))?i.apply(s.input?s.input[0]:null,[e,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],"object"!=typeof s.input[0]&&s.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(t){var e,i,n,s=this._get(t,"altField");s&&(e=this._get(t,"altFormat")||this._get(t,"dateFormat"),i=this._getDate(t),n=this.formatDate(e,i,this._getFormatConfig(t)),x(s).val(n))},noWeekends:function(t){var e=t.getDay();return[0<e&&e<6,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(i,r,t){if(null==i||null==r)throw"Invalid arguments";if(""===(r="object"==typeof r?r.toString():r+""))return null;function o(t){var e=a+1<i.length&&i.charAt(a+1)===t;return e&&a++,e}function e(t){var e=o(t),i="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,n=new RegExp("^\\d{"+("y"===t?i:1)+","+i+"}"),s=r.substring(u).match(n);if(!s)throw"Missing number at position "+u;return u+=s[0].length,parseInt(s[0],10)}function n(t,e,i){var n=-1,s=x.map(o(t)?i:e,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(x.each(s,function(t,e){var i=e[1];if(r.substr(u,i.length).toLowerCase()===i.toLowerCase())return n=e[0],u+=i.length,!1}),-1!==n)return n+1;throw"Unknown name at position "+u}function s(){if(r.charAt(u)!==i.charAt(a))throw"Unexpected literal at position "+u;u++}var a,l,h,c,u=0,d=(t?t.shortYearCutoff:null)||this._defaults.shortYearCutoff,p="string"!=typeof d?d:(new Date).getFullYear()%100+parseInt(d,10),g=(t?t.dayNamesShort:null)||this._defaults.dayNamesShort,f=(t?t.dayNames:null)||this._defaults.dayNames,m=(t?t.monthNamesShort:null)||this._defaults.monthNamesShort,v=(t?t.monthNames:null)||this._defaults.monthNames,y=-1,b=-1,w=-1,C=-1,I=!1;for(a=0;a<i.length;a++)if(I)"'"!==i.charAt(a)||o("'")?s():I=!1;else switch(i.charAt(a)){case"d":w=e("d");break;case"D":n("D",g,f);break;case"o":C=e("o");break;case"m":b=e("m");break;case"M":b=n("M",m,v);break;case"y":y=e("y");break;case"@":y=(c=new Date(e("@"))).getFullYear(),b=c.getMonth()+1,w=c.getDate();break;case"!":y=(c=new Date((e("!")-this._ticksTo1970)/1e4)).getFullYear(),b=c.getMonth()+1,w=c.getDate();break;case"'":o("'")?s():I=!0;break;default:s()}if(u<r.length&&(h=r.substr(u),!/^\s+/.test(h)))throw"Extra/unparsed characters found in date: "+h;if(-1===y?y=(new Date).getFullYear():y<100&&(y+=(new Date).getFullYear()-(new Date).getFullYear()%100+(y<=p?0:-100)),-1<C)for(b=1,w=C;;){if(w<=(l=this._getDaysInMonth(y,b-1)))break;b++,w-=l}if((c=this._daylightSavingAdjust(new Date(y,b-1,w))).getFullYear()!==y||c.getMonth()+1!==b||c.getDate()!==w)throw"Invalid date";return c},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(i,t,e){if(!t)return"";function s(t){var e=o+1<i.length&&i.charAt(o+1)===t;return e&&o++,e}function n(t,e,i){var n=""+e;if(s(t))for(;n.length<i;)n="0"+n;return n}function r(t,e,i,n){return s(t)?n[e]:i[e]}var o,a=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,l=(e?e.dayNames:null)||this._defaults.dayNames,h=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,c=(e?e.monthNames:null)||this._defaults.monthNames,u="",d=!1;if(t)for(o=0;o<i.length;o++)if(d)"'"!==i.charAt(o)||s("'")?u+=i.charAt(o):d=!1;else switch(i.charAt(o)){case"d":u+=n("d",t.getDate(),2);break;case"D":u+=r("D",t.getDay(),a,l);break;case"o":u+=n("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=n("m",t.getMonth()+1,2);break;case"M":u+=r("M",t.getMonth(),h,c);break;case"y":u+=s("y")?t.getFullYear():(t.getFullYear()%100<10?"0":"")+t.getFullYear()%100;break;case"@":u+=t.getTime();break;case"!":u+=1e4*t.getTime()+this._ticksTo1970;break;case"'":s("'")?u+="'":d=!0;break;default:u+=i.charAt(o)}return u},_possibleChars:function(i){function t(t){var e=n+1<i.length&&i.charAt(n+1)===t;return e&&n++,e}var n,e="",s=!1;for(n=0;n<i.length;n++)if(s)"'"!==i.charAt(n)||t("'")?e+=i.charAt(n):s=!1;else switch(i.charAt(n)){case"d":case"m":case"y":case"@":e+="0123456789";break;case"D":case"M":return null;case"'":t("'")?e+="'":s=!0;break;default:e+=i.charAt(n)}return e},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),n=t.lastVal=t.input?t.input.val():null,s=this._getDefaultDate(t),r=s,o=this._getFormatConfig(t);try{r=this.parseDate(i,n,o)||s}catch(t){n=e?"":n}t.selectedDay=r.getDate(),t.drawMonth=t.selectedMonth=r.getMonth(),t.drawYear=t.selectedYear=r.getFullYear(),t.currentDay=n?r.getDate():0,t.currentMonth=n?r.getMonth():0,t.currentYear=n?r.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(a,t,e){var i,n,s=null==t||""===t?e:"string"==typeof t?function(t){try{return x.datepicker.parseDate(x.datepicker._get(a,"dateFormat"),t,x.datepicker._getFormatConfig(a))}catch(t){}for(var e=(t.toLowerCase().match(/^c/)?x.datepicker._getDate(a):null)||new Date,i=e.getFullYear(),n=e.getMonth(),s=e.getDate(),r=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,o=r.exec(t);o;){switch(o[2]||"d"){case"d":case"D":s+=parseInt(o[1],10);break;case"w":case"W":s+=7*parseInt(o[1],10);break;case"m":case"M":n+=parseInt(o[1],10),s=Math.min(s,x.datepicker._getDaysInMonth(i,n));break;case"y":case"Y":i+=parseInt(o[1],10),s=Math.min(s,x.datepicker._getDaysInMonth(i,n))}o=r.exec(t)}return new Date(i,n,s)}(t):"number"==typeof t?isNaN(t)?e:(i=t,(n=new Date).setDate(n.getDate()+i),n):new Date(t.getTime());return(s=s&&"Invalid Date"===s.toString()?e:s)&&(s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0)),this._daylightSavingAdjust(s)},_daylightSavingAdjust:function(t){return t?(t.setHours(12<t.getHours()?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var n=!e,s=t.selectedMonth,r=t.selectedYear,o=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=o.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=o.getMonth(),t.drawYear=t.selectedYear=t.currentYear=o.getFullYear(),s===t.selectedMonth&&r===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(n?"":this._formatDate(t))},_getDate:function(t){return!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay))},_attachHandlers:function(t){var e=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){x.datepicker._adjustDate(i,-e,"M")},next:function(){x.datepicker._adjustDate(i,+e,"M")},hide:function(){x.datepicker._hideDatepicker()},today:function(){x.datepicker._gotoToday(i)},selectDay:function(){return x.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return x.datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return x.datepicker._selectMonthYear(i,this,"Y"),!1}};x(this).on(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,n,s,r,o,a,l,h,c,u,d,p,g,f,m,v,y,b,w,C,I,x,A,S,_,P,M,k,T,N,D,E,L,z,O,G,B,j,R=new Date,V=this._daylightSavingAdjust(new Date(R.getFullYear(),R.getMonth(),R.getDate())),Z=this._get(t,"isRTL"),W=this._get(t,"showButtonPanel"),Y=this._get(t,"hideIfNoPrevNext"),H=this._get(t,"navigationAsDateFormat"),F=this._getNumberOfMonths(t),U=this._get(t,"showCurrentAtPos"),X=this._get(t,"stepMonths"),J=1!==F[0]||1!==F[1],$=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),K=this._getMinMaxDate(t,"min"),Q=this._getMinMaxDate(t,"max"),q=t.drawMonth-U,tt=t.drawYear;if(q<0&&(q+=12,tt--),Q)for(e=this._daylightSavingAdjust(new Date(Q.getFullYear(),Q.getMonth()-F[0]*F[1]+1,Q.getDate())),e=K&&e<K?K:e;this._daylightSavingAdjust(new Date(tt,q,1))>e;)--q<0&&(q=11,tt--);for(t.drawMonth=q,t.drawYear=tt,i=this._get(t,"prevText"),i=H?this.formatDate(i,this._daylightSavingAdjust(new Date(tt,q-X,1)),this._getFormatConfig(t)):i,n=this._canAdjustMonth(t,-1,tt,q)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Z?"e":"w")+"'>"+i+"</span></a>":Y?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Z?"e":"w")+"'>"+i+"</span></a>",s=this._get(t,"nextText"),s=H?this.formatDate(s,this._daylightSavingAdjust(new Date(tt,q+X,1)),this._getFormatConfig(t)):s,r=this._canAdjustMonth(t,1,tt,q)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+s+"'><span class='ui-icon ui-icon-circle-triangle-"+(Z?"w":"e")+"'>"+s+"</span></a>":Y?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+s+"'><span class='ui-icon ui-icon-circle-triangle-"+(Z?"w":"e")+"'>"+s+"</span></a>",o=this._get(t,"currentText"),a=this._get(t,"gotoCurrent")&&t.currentDay?$:V,o=H?this.formatDate(o,a,this._getFormatConfig(t)):o,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",h=W?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Z?l:"")+(this._isInRange(t,a)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(Z?"":l)+"</div>":"",c=parseInt(this._get(t,"firstDay"),10),c=isNaN(c)?0:c,u=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),g=this._get(t,"monthNames"),f=this._get(t,"monthNamesShort"),m=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),y=this._get(t,"selectOtherMonths"),b=this._getDefaultDate(t),w="",I=0;I<F[0];I++){for(x="",this.maxRows=4,A=0;A<F[1];A++){if(S=this._daylightSavingAdjust(new Date(tt,q,t.selectedDay)),_=" ui-corner-all",P="",J){if(P+="<div class='ui-datepicker-group",1<F[1])switch(A){case 0:P+=" ui-datepicker-group-first",_=" ui-corner-"+(Z?"right":"left");break;case F[1]-1:P+=" ui-datepicker-group-last",_=" ui-corner-"+(Z?"left":"right");break;default:P+=" ui-datepicker-group-middle",_=""}P+="'>"}for(P+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+_+"'>"+(/all|left/.test(_)&&0===I?Z?r:n:"")+(/all|right/.test(_)&&0===I?Z?n:r:"")+this._generateMonthYearHeader(t,q,tt,K,Q,0<I||0<A,g,f)+"</div><table class='ui-datepicker-calendar'><thead><tr>",M=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",C=0;C<7;C++)M+="<th scope='col'"+(5<=(C+c+6)%7?" class='ui-datepicker-week-end'":"")+"><span title='"+d[k=(C+c)%7]+"'>"+p[k]+"</span></th>";for(P+=M+"</tr></thead><tbody>",T=this._getDaysInMonth(tt,q),tt===t.selectedYear&&q===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,T)),N=(this._getFirstDayOfMonth(tt,q)-c+7)%7,D=Math.ceil((N+T)/7),E=J&&this.maxRows>D?this.maxRows:D,this.maxRows=E,L=this._daylightSavingAdjust(new Date(tt,q,1-N)),z=0;z<E;z++){for(P+="<tr>",O=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(L)+"</td>":"",C=0;C<7;C++)G=m?m.apply(t.input?t.input[0]:null,[L]):[!0,""],j=(B=L.getMonth()!==q)&&!y||!G[0]||K&&L<K||Q&&Q<L,O+="<td class='"+(5<=(C+c+6)%7?" ui-datepicker-week-end":"")+(B?" ui-datepicker-other-month":"")+(L.getTime()===S.getTime()&&q===t.selectedMonth&&t._keyEvent||b.getTime()===L.getTime()&&b.getTime()===S.getTime()?" "+this._dayOverClass:"")+(j?" "+this._unselectableClass+" ui-state-disabled":"")+(B&&!v?"":" "+G[1]+(L.getTime()===$.getTime()?" "+this._currentClass:"")+(L.getTime()===V.getTime()?" ui-datepicker-today":""))+"'"+(B&&!v||!G[2]?"":" title='"+G[2].replace(/'/g,"&#39;")+"'")+(j?"":" data-handler='selectDay' data-event='click' data-month='"+L.getMonth()+"' data-year='"+L.getFullYear()+"'")+">"+(B&&!v?"&#xa0;":j?"<span class='ui-state-default'>"+L.getDate()+"</span>":"<a class='ui-state-default"+(L.getTime()===V.getTime()?" ui-state-highlight":"")+(L.getTime()===$.getTime()?" ui-state-active":"")+(B?" ui-priority-secondary":"")+"' href='#'>"+L.getDate()+"</a>")+"</td>",L.setDate(L.getDate()+1),L=this._daylightSavingAdjust(L);P+=O+"</tr>"}11<++q&&(q=0,tt++),x+=P+="</tbody></table>"+(J?"</div>"+(0<F[0]&&A===F[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}w+=x}return w+=h,t._keyEvent=!1,w},_generateMonthYearHeader:function(t,e,i,n,s,r,o,a){var l,h,c,u,d,p,g,f,m=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),y=this._get(t,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(r||!m)w+="<span class='ui-datepicker-month'>"+o[e]+"</span>";else{for(l=n&&n.getFullYear()===i,h=s&&s.getFullYear()===i,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;c<12;c++)(!l||c>=n.getMonth())&&(!h||c<=s.getMonth())&&(w+="<option value='"+c+"'"+(c===e?" selected='selected'":"")+">"+a[c]+"</option>");w+="</select>"}if(y||(b+=w+(!r&&m&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",r||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),g=(p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e})(u[0]),f=Math.max(g,p(u[1]||"")),g=n?Math.max(g,n.getFullYear()):g,f=s?Math.min(f,s.getFullYear()):f,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";g<=f;g++)t.yearshtml+="<option value='"+g+"'"+(g===i?" selected='selected'":"")+">"+g+"</option>";t.yearshtml+="</select>",b+=t.yearshtml,t.yearshtml=null}return b+=this._get(t,"yearSuffix"),y&&(b+=(!r&&m&&v?"":"&#xa0;")+w),b+="</div>"},_adjustInstDate:function(t,e,i){var n=t.selectedYear+("Y"===i?e:0),s=t.selectedMonth+("M"===i?e:0),r=Math.min(t.selectedDay,this._getDaysInMonth(n,s))+("D"===i?e:0),o=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(n,s,r)));t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),"M"!==i&&"Y"!==i||this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max"),s=i&&e<i?i:e;return n&&n<s?n:s},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,n){var s=this._getNumberOfMonths(t),r=this._daylightSavingAdjust(new Date(i,n+(e<0?e:s[0]*s[1]),1));return e<0&&r.setDate(this._getDaysInMonth(r.getFullYear(),r.getMonth())),this._isInRange(t,r)},_isInRange:function(t,e){var i,n,s=this._getMinMaxDate(t,"min"),r=this._getMinMaxDate(t,"max"),o=null,a=null,l=this._get(t,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),o=parseInt(i[0],10),a=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=n),i[1].match(/[+\-].*/)&&(a+=n)),(!s||e.getTime()>=s.getTime())&&(!r||e.getTime()<=r.getTime())&&(!o||e.getFullYear()>=o)&&(!a||e.getFullYear()<=a)},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return{shortYearCutoff:e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,n){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var s=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(n,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),s,this._getFormatConfig(t))}}),x.fn.datepicker=function(t){if(!this.length)return this;x.datepicker.initialized||(x(document).on("mousedown",x.datepicker._checkExternalClick),x.datepicker.initialized=!0),0===x("#"+x.datepicker._mainDivId).length&&x("body").append(x.datepicker.dpDiv);var e=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?x.datepicker["_"+t+"Datepicker"].apply(x.datepicker,[this[0]].concat(e)):this.each(function(){"string"==typeof t?x.datepicker["_"+t+"Datepicker"].apply(x.datepicker,[this].concat(e)):x.datepicker._attachDatepicker(this,t)}):x.datepicker["_"+t+"Datepicker"].apply(x.datepicker,[this[0]].concat(e))},x.datepicker=new q,x.datepicker.initialized=!1,x.datepicker.uuid=(new Date).getTime(),x.datepicker.version="1.12.1";x.datepicker,x.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var nt=!1;x(document).on("mouseup",function(){nt=!1});x.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.on("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).on("click."+this.widgetName,function(t){if(!0===x.data(t.target,e.widgetName+".preventClickEvent"))return x.removeData(t.target,e.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!nt){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var e=this,i=1===t.which,n=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&x(t.target).closest(this.options.cancel).length;return!(i&&!n&&this._mouseCapture(t))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?(t.preventDefault(),!0):(!0===x.data(t.target,this.widgetName+".preventClickEvent")&&x.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return e._mouseMove(t)},this._mouseUpDelegate=function(t){return e._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),nt=!0))}},_mouseMove:function(t){if(this._mouseMoved){if(x.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)if(t.originalEvent.altKey||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&x.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,nt=!1,t.preventDefault()},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),x.ui.plugin={add:function(t,e,i){var n,s=x.ui[t].prototype;for(n in i)s.plugins[n]=s.plugins[n]||[],s.plugins[n].push([e,i[n]])},call:function(t,e,i,n){var s,r=t.plugins[e];if(r&&(n||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(s=0;s<r.length;s++)t.options[r[s][0]]&&r[s][1].apply(t.element,i)}},x.ui.safeBlur=function(t){t&&"body"!==t.nodeName.toLowerCase()&&x(t).trigger("blur")};x.widget("ui.draggable",x.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(t){var e=this.options;return!(this.helper||e.disabled||0<x(t.target).closest(".ui-resizable-handle").length)&&(this.handle=this._getHandle(t),!!this.handle&&(this._blurActiveElement(t),this._blockFrames(!0===e.iframeFix?"iframe":e.iframeFix),!0))},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=x(this);return x("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var e=x.ui.safeActiveElement(this.document[0]);x(t.target).closest(e).length||x.ui.safeBlur(e)},_mouseStart:function(t){var e=this.options;return this.helper=this._createHelper(t),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),x.ui.ddmanager&&(x.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=0<this.helper.parents().filter(function(){return"fixed"===x(this).css("position")}).length,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),x.ui.ddmanager&&!e.dropBehaviour&&x.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),x.ui.ddmanager&&x.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(t,e){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!e){var i=this._uiHash();if(!1===this._trigger("drag",t,i))return this._mouseUp(new x.Event("mouseup",t)),!1;this.position=i.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",x.ui.ddmanager&&x.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var e=this,i=!1;return x.ui.ddmanager&&!this.options.dropBehaviour&&(i=x.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||!0===this.options.revert||x.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?x(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==e._trigger("stop",t)&&e._clear()}):!1!==this._trigger("stop",t)&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),x.ui.ddmanager&&x.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.trigger("focus"),x.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new x.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(t){return!this.options.handle||!!x(t.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(t){var e=this.options,i=x.isFunction(e.helper),n=i?x(e.helper.apply(this.element[0],[t])):"clone"===e.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===e.appendTo?this.element[0].parentNode:e.appendTo),i&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),x.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),e=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==e&&x.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,e,i,n=this.options,s=this.document[0];this.relativeContainer=null,n.containment?"window"!==n.containment?"document"!==n.containment?n.containment.constructor!==Array?("parent"===n.containment&&(n.containment=this.helper[0].parentNode),(i=(e=x(n.containment))[0])&&(t=/(scroll|auto)/.test(e.css("overflow")),this.containment=[(parseInt(e.css("borderLeftWidth"),10)||0)+(parseInt(e.css("paddingLeft"),10)||0),(parseInt(e.css("borderTopWidth"),10)||0)+(parseInt(e.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e.css("borderRightWidth"),10)||0)-(parseInt(e.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e.css("borderBottomWidth"),10)||0)-(parseInt(e.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=e)):this.containment=n.containment:this.containment=[0,0,x(s).width()-this.helperProportions.width-this.margins.left,(x(s).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[x(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,x(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,x(window).scrollLeft()+x(window).width()-this.helperProportions.width-this.margins.left,x(window).scrollTop()+(x(window).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(t,e){e=e||this.position;var i="absolute"===t?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,n,s,r,o=this.options,a=this._isRootNode(this.scrollParent[0]),l=t.pageX,h=t.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(i=this.relativeContainer?(n=this.relativeContainer.offset(),[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(h=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(h=i[3]+this.offset.click.top)),o.grid&&(s=o.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,h=i?s-this.offset.click.top>=i[1]||s-this.offset.click.top>i[3]?s:s-this.offset.click.top>=i[1]?s-o.grid[1]:s+o.grid[1]:s,r=o.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,l=i?r-this.offset.click.left>=i[0]||r-this.offset.click.left>i[2]?r:r-this.offset.click.left>=i[0]?r-o.grid[0]:r+o.grid[0]:r),"y"===o.axis&&(l=this.originalPageX),"x"===o.axis&&(h=this.originalPageY)),{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,e,i){return i=i||this._uiHash(),x.ui.plugin.call(this,t,[e,i,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),x.Widget.prototype._trigger.call(this,t,e,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),x.ui.plugin.add("draggable","connectToSortable",{start:function(e,t,i){var n=x.extend({},t,{item:i.element});i.sortables=[],x(i.options.connectToSortable).each(function(){var t=x(this).sortable("instance");t&&!t.options.disabled&&(i.sortables.push(t),t.refreshPositions(),t._trigger("activate",e,n))})},stop:function(e,t,i){var n=x.extend({},t,{item:i.element});i.cancelHelperRemoval=!1,x.each(i.sortables,function(){var t=this;t.isOver?(t.isOver=0,i.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,n))})},drag:function(i,n,s){x.each(s.sortables,function(){var t=!1,e=this;e.positionAbs=s.positionAbs,e.helperProportions=s.helperProportions,e.offset.click=s.offset.click,e._intersectsWith(e.containerCache)&&(t=!0,x.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==e&&this._intersectsWith(this.containerCache)&&x.contains(e.element[0],this.element[0])&&(t=!1),t})),t?(e.isOver||(e.isOver=1,s._parent=n.helper.parent(),e.currentItem=n.helper.appendTo(e.element).data("ui-sortable-item",!0),e.options._helper=e.options.helper,e.options.helper=function(){return n.helper[0]},i.target=e.currentItem[0],e._mouseCapture(i,!0),e._mouseStart(i,!0,!0),e.offset.click.top=s.offset.click.top,e.offset.click.left=s.offset.click.left,e.offset.parent.left-=s.offset.parent.left-e.offset.parent.left,e.offset.parent.top-=s.offset.parent.top-e.offset.parent.top,s._trigger("toSortable",i),s.dropped=e.element,x.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,e.fromOutside=s),e.currentItem&&(e._mouseDrag(i),n.position=e.position)):e.isOver&&(e.isOver=0,e.cancelHelperRemoval=!0,e.options._revert=e.options.revert,e.options.revert=!1,e._trigger("out",i,e._uiHash(e)),e._mouseStop(i,!0),e.options.revert=e.options._revert,e.options.helper=e.options._helper,e.placeholder&&e.placeholder.remove(),n.helper.appendTo(s._parent),s._refreshOffsets(i),n.position=s._generatePosition(i,!0),s._trigger("fromSortable",i),s.dropped=!1,x.each(s.sortables,function(){this.refreshPositions()}))})}}),x.ui.plugin.add("draggable","cursor",{start:function(t,e,i){var n=x("body"),s=i.options;n.css("cursor")&&(s._cursor=n.css("cursor")),n.css("cursor",s.cursor)},stop:function(t,e,i){var n=i.options;n._cursor&&x("body").css("cursor",n._cursor)}}),x.ui.plugin.add("draggable","opacity",{start:function(t,e,i){var n=x(e.helper),s=i.options;n.css("opacity")&&(s._opacity=n.css("opacity")),n.css("opacity",s.opacity)},stop:function(t,e,i){var n=i.options;n._opacity&&x(e.helper).css("opacity",n._opacity)}}),x.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,e,i){var n=i.options,s=!1,r=i.scrollParentNotHidden[0],o=i.document[0];r!==o&&"HTML"!==r.tagName?(n.axis&&"x"===n.axis||(i.overflowOffset.top+r.offsetHeight-t.pageY<n.scrollSensitivity?r.scrollTop=s=r.scrollTop+n.scrollSpeed:t.pageY-i.overflowOffset.top<n.scrollSensitivity&&(r.scrollTop=s=r.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(i.overflowOffset.left+r.offsetWidth-t.pageX<n.scrollSensitivity?r.scrollLeft=s=r.scrollLeft+n.scrollSpeed:t.pageX-i.overflowOffset.left<n.scrollSensitivity&&(r.scrollLeft=s=r.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-x(o).scrollTop()<n.scrollSensitivity?s=x(o).scrollTop(x(o).scrollTop()-n.scrollSpeed):x(window).height()-(t.pageY-x(o).scrollTop())<n.scrollSensitivity&&(s=x(o).scrollTop(x(o).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-x(o).scrollLeft()<n.scrollSensitivity?s=x(o).scrollLeft(x(o).scrollLeft()-n.scrollSpeed):x(window).width()-(t.pageX-x(o).scrollLeft())<n.scrollSensitivity&&(s=x(o).scrollLeft(x(o).scrollLeft()+n.scrollSpeed)))),!1!==s&&x.ui.ddmanager&&!n.dropBehaviour&&x.ui.ddmanager.prepareOffsets(i,t)}}),x.ui.plugin.add("draggable","snap",{start:function(t,e,i){var n=i.options;i.snapElements=[],x(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var t=x(this),e=t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:e.top,left:e.left})})},drag:function(t,e,i){var n,s,r,o,a,l,h,c,u,d,p=i.options,g=p.snapTolerance,f=e.offset.left,m=f+i.helperProportions.width,v=e.offset.top,y=v+i.helperProportions.height;for(u=i.snapElements.length-1;0<=u;u--)l=(a=i.snapElements[u].left-i.margins.left)+i.snapElements[u].width,c=(h=i.snapElements[u].top-i.margins.top)+i.snapElements[u].height,m<a-g||l+g<f||y<h-g||c+g<v||!x.contains(i.snapElements[u].item.ownerDocument,i.snapElements[u].item)?(i.snapElements[u].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,t,x.extend(i._uiHash(),{snapItem:i.snapElements[u].item})),i.snapElements[u].snapping=!1):("inner"!==p.snapMode&&(n=Math.abs(h-y)<=g,s=Math.abs(c-v)<=g,r=Math.abs(a-m)<=g,o=Math.abs(l-f)<=g,n&&(e.position.top=i._convertPositionTo("relative",{top:h-i.helperProportions.height,left:0}).top),s&&(e.position.top=i._convertPositionTo("relative",{top:c,left:0}).top),r&&(e.position.left=i._convertPositionTo("relative",{top:0,left:a-i.helperProportions.width}).left),o&&(e.position.left=i._convertPositionTo("relative",{top:0,left:l}).left)),d=n||s||r||o,"outer"!==p.snapMode&&(n=Math.abs(h-v)<=g,s=Math.abs(c-y)<=g,r=Math.abs(a-f)<=g,o=Math.abs(l-m)<=g,n&&(e.position.top=i._convertPositionTo("relative",{top:h,left:0}).top),s&&(e.position.top=i._convertPositionTo("relative",{top:c-i.helperProportions.height,left:0}).top),r&&(e.position.left=i._convertPositionTo("relative",{top:0,left:a}).left),o&&(e.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left)),!i.snapElements[u].snapping&&(n||s||r||o||d)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,x.extend(i._uiHash(),{snapItem:i.snapElements[u].item})),i.snapElements[u].snapping=n||s||r||o||d)}}),x.ui.plugin.add("draggable","stack",{start:function(t,e,i){var n,s=i.options,r=x.makeArray(x(s.stack)).sort(function(t,e){return(parseInt(x(t).css("zIndex"),10)||0)-(parseInt(x(e).css("zIndex"),10)||0)});r.length&&(n=parseInt(x(r[0]).css("zIndex"),10)||0,x(r).each(function(t){x(this).css("zIndex",n+t)}),this.css("zIndex",n+r.length))}}),x.ui.plugin.add("draggable","zIndex",{start:function(t,e,i){var n=x(e.helper),s=i.options;n.css("zIndex")&&(s._zIndex=n.css("zIndex")),n.css("zIndex",s.zIndex)},stop:function(t,e,i){var n=i.options;n._zIndex&&x(e.helper).css("zIndex",n._zIndex)}});x.ui.draggable;x.widget("ui.resizable",x.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseFloat(t)||0},_isNumber:function(t){return!isNaN(parseFloat(t))},_hasScroll:function(t,e){if("hidden"===x(t).css("overflow"))return!1;var i,n=e&&"left"===e?"scrollLeft":"scrollTop";return 0<t[n]||(t[n]=1,i=0<t[n],t[n]=0,i)},_create:function(){var t,e=this.options,i=this;this._addClass("ui-resizable"),x.extend(this,{_aspectRatio:!!e.aspectRatio,aspectRatio:e.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:e.helper||e.ghost||e.animate?e.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(x("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,t={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(t),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(t),this._proportionallyResize()),this._setupHandles(),e.autoHide&&x(this.element).on("mouseenter",function(){e.disabled||(i._removeClass("ui-resizable-autohide"),i._handles.show())}).on("mouseleave",function(){e.disabled||i.resizing||(i._addClass("ui-resizable-autohide"),i._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy();function t(t){x(t).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()}var e;return this.elementIsWrapper&&(t(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_setOption:function(t,e){switch(this._super(t,e),t){case"handles":this._removeHandles(),this._setupHandles()}},_setupHandles:function(){var t,e,i,n,s,r=this.options,o=this;if(this.handles=r.handles||(x(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=x(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),i=this.handles.split(","),this.handles={},e=0;e<i.length;e++)n="ui-resizable-"+(t=x.trim(i[e])),s=x("<div>"),this._addClass(s,"ui-resizable-handle "+n),s.css({zIndex:r.zIndex}),this.handles[t]=".ui-resizable-"+t,this.element.append(s);this._renderAxis=function(t){var e,i,n,s;for(e in t=t||this.element,this.handles)this.handles[e].constructor===String?this.handles[e]=this.element.children(this.handles[e]).first().show():(this.handles[e].jquery||this.handles[e].nodeType)&&(this.handles[e]=x(this.handles[e]),this._on(this.handles[e],{mousedown:o._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(i=x(this.handles[e],this.element),s=/sw|ne|nw|se|n|s/.test(e)?i.outerHeight():i.outerWidth(),n=["padding",/ne|nw|n/.test(e)?"Top":/se|sw|s/.test(e)?"Bottom":/^e$/.test(e)?"Right":"Left"].join(""),t.css(n,s),this._proportionallyResize()),this._handles=this._handles.add(this.handles[e])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){o.resizing||(this.className&&(s=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=s&&s[1]?s[1]:"se")}),r.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(t){var e,i,n=!1;for(e in this.handles)(i=x(this.handles[e])[0])!==t.target&&!x.contains(i,t.target)||(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var e,i,n,s=this.options,r=this.element;return this.resizing=!0,this._renderProxy(),e=this._num(this.helper.css("left")),i=this._num(this.helper.css("top")),s.containment&&(e+=x(s.containment).scrollLeft()||0,i+=x(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:e,top:i},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:r.width(),height:r.height()},this.originalSize=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.sizeDiff={width:r.outerWidth()-r.width(),height:r.outerHeight()-r.height()},this.originalPosition={left:e,top:i},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=x(".ui-resizable-"+this.axis).css("cursor"),x("body").css("cursor","auto"===n?this.axis+"-resize":n),this._addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var e,i,n=this.originalMousePosition,s=this.axis,r=t.pageX-n.left||0,o=t.pageY-n.top||0,a=this._change[s];return this._updatePrevProperties(),a&&(e=a.apply(this,[t,r,o]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(e=this._updateRatio(e,t)),e=this._respectSize(e,t),this._updateCache(e),this._propagate("resize",t),i=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),x.isEmptyObject(i)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges())),!1},_mouseStop:function(t){this.resizing=!1;var e,i,n,s,r,o,a,l=this.options,h=this;return this._helper&&(n=(i=(e=this._proportionallyResizeElements).length&&/textarea/i.test(e[0].nodeName))&&this._hasScroll(e[0],"left")?0:h.sizeDiff.height,s=i?0:h.sizeDiff.width,r={width:h.helper.width()-s,height:h.helper.height()-n},o=parseFloat(h.element.css("left"))+(h.position.left-h.originalPosition.left)||null,a=parseFloat(h.element.css("top"))+(h.position.top-h.originalPosition.top)||null,l.animate||this.element.css(x.extend(r,{top:a,left:o})),h.helper.height(h.size.height),h.helper.width(h.size.width),this._helper&&!l.animate&&this._proportionallyResize()),x("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,i,n,s,r,o=this.options;r={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||t)&&(e=r.minHeight*this.aspectRatio,n=r.minWidth/this.aspectRatio,i=r.maxHeight*this.aspectRatio,s=r.maxWidth/this.aspectRatio,e>r.minWidth&&(r.minWidth=e),n>r.minHeight&&(r.minHeight=n),i<r.maxWidth&&(r.maxWidth=i),s<r.maxHeight&&(r.maxHeight=s)),this._vBoundaries=r},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,n=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===n&&(t.left=e.left+(i.width-t.width),t.top=null),"nw"===n&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,n=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,s=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,r=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,o=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,a=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,h=/sw|nw|w/.test(i),c=/nw|ne|n/.test(i);return r&&(t.width=e.minWidth),o&&(t.height=e.minHeight),n&&(t.width=e.maxWidth),s&&(t.height=e.maxHeight),r&&h&&(t.left=a-e.minWidth),n&&h&&(t.left=a-e.maxWidth),o&&c&&(t.top=l-e.minHeight),s&&c&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,i=[],n=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],s=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];e<4;e++)i[e]=parseFloat(n[e])||0,i[e]+=parseFloat(s[e])||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,i=this.helper||this.element;e<this._proportionallyResizeElements.length;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,e=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||x("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++e.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize;return{left:this.originalPosition.left+e,width:i.width-e}},n:function(t,e,i){var n=this.originalSize;return{top:this.originalPosition.top+i,height:n.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(t,e,i){return x.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},sw:function(t,e,i){return x.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,e,i]))},ne:function(t,e,i){return x.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},nw:function(t,e,i){return x.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,e,i]))}},_propagate:function(t,e){x.ui.plugin.call(this,t,[e,this.ui()]),"resize"!==t&&this._trigger(t,e,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),x.ui.plugin.add("resizable","animate",{stop:function(e){var i=x(this).resizable("instance"),t=i.options,n=i._proportionallyResizeElements,s=n.length&&/textarea/i.test(n[0].nodeName),r=s&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,o=s?0:i.sizeDiff.width,a={width:i.size.width-o,height:i.size.height-r},l=parseFloat(i.element.css("left"))+(i.position.left-i.originalPosition.left)||null,h=parseFloat(i.element.css("top"))+(i.position.top-i.originalPosition.top)||null;i.element.animate(x.extend(a,h&&l?{top:h,left:l}:{}),{duration:t.animateDuration,easing:t.animateEasing,step:function(){var t={width:parseFloat(i.element.css("width")),height:parseFloat(i.element.css("height")),top:parseFloat(i.element.css("top")),left:parseFloat(i.element.css("left"))};n&&n.length&&x(n[0]).css({width:t.width,height:t.height}),i._updateCache(t),i._propagate("resize",e)}})}}),x.ui.plugin.add("resizable","containment",{start:function(){var i,n,t,e,s,r,o,a=x(this).resizable("instance"),l=a.options,h=a.element,c=l.containment,u=c instanceof x?c.get(0):/parent/.test(c)?h.parent().get(0):c;u&&(a.containerElement=x(u),/document/.test(c)||c===document?(a.containerOffset={left:0,top:0},a.containerPosition={left:0,top:0},a.parentData={element:x(document),left:0,top:0,width:x(document).width(),height:x(document).height()||document.body.parentNode.scrollHeight}):(i=x(u),n=[],x(["Top","Right","Left","Bottom"]).each(function(t,e){n[t]=a._num(i.css("padding"+e))}),a.containerOffset=i.offset(),a.containerPosition=i.position(),a.containerSize={height:i.innerHeight()-n[3],width:i.innerWidth()-n[1]},t=a.containerOffset,e=a.containerSize.height,s=a.containerSize.width,r=a._hasScroll(u,"left")?u.scrollWidth:s,o=a._hasScroll(u)?u.scrollHeight:e,a.parentData={element:u,left:t.left,top:t.top,width:r,height:o}))},resize:function(t){var e,i,n,s,r=x(this).resizable("instance"),o=r.options,a=r.containerOffset,l=r.position,h=r._aspectRatio||t.shiftKey,c={top:0,left:0},u=r.containerElement,d=!0;u[0]!==document&&/static/.test(u.css("position"))&&(c=a),l.left<(r._helper?a.left:0)&&(r.size.width=r.size.width+(r._helper?r.position.left-a.left:r.position.left-c.left),h&&(r.size.height=r.size.width/r.aspectRatio,d=!1),r.position.left=o.helper?a.left:0),l.top<(r._helper?a.top:0)&&(r.size.height=r.size.height+(r._helper?r.position.top-a.top:r.position.top),h&&(r.size.width=r.size.height*r.aspectRatio,d=!1),r.position.top=r._helper?a.top:0),n=r.containerElement.get(0)===r.element.parent().get(0),s=/relative|absolute/.test(r.containerElement.css("position")),n&&s?(r.offset.left=r.parentData.left+r.position.left,r.offset.top=r.parentData.top+r.position.top):(r.offset.left=r.element.offset().left,r.offset.top=r.element.offset().top),e=Math.abs(r.sizeDiff.width+(r._helper?r.offset.left-c.left:r.offset.left-a.left)),i=Math.abs(r.sizeDiff.height+(r._helper?r.offset.top-c.top:r.offset.top-a.top)),e+r.size.width>=r.parentData.width&&(r.size.width=r.parentData.width-e,h&&(r.size.height=r.size.width/r.aspectRatio,d=!1)),i+r.size.height>=r.parentData.height&&(r.size.height=r.parentData.height-i,h&&(r.size.width=r.size.height*r.aspectRatio,d=!1)),d||(r.position.left=r.prevPosition.left,r.position.top=r.prevPosition.top,r.size.width=r.prevSize.width,r.size.height=r.prevSize.height)},stop:function(){var t=x(this).resizable("instance"),e=t.options,i=t.containerOffset,n=t.containerPosition,s=t.containerElement,r=x(t.helper),o=r.offset(),a=r.outerWidth()-t.sizeDiff.width,l=r.outerHeight()-t.sizeDiff.height;t._helper&&!e.animate&&/relative/.test(s.css("position"))&&x(this).css({left:o.left-n.left-i.left,width:a,height:l}),t._helper&&!e.animate&&/static/.test(s.css("position"))&&x(this).css({left:o.left-n.left-i.left,width:a,height:l})}}),x.ui.plugin.add("resizable","alsoResize",{start:function(){var t=x(this).resizable("instance").options;x(t.alsoResize).each(function(){var t=x(this);t.data("ui-resizable-alsoresize",{width:parseFloat(t.width()),height:parseFloat(t.height()),left:parseFloat(t.css("left")),top:parseFloat(t.css("top"))})})},resize:function(t,i){var e=x(this).resizable("instance"),n=e.options,s=e.originalSize,r=e.originalPosition,o={height:e.size.height-s.height||0,width:e.size.width-s.width||0,top:e.position.top-r.top||0,left:e.position.left-r.left||0};x(n.alsoResize).each(function(){var t=x(this),n=x(this).data("ui-resizable-alsoresize"),s={},e=t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];x.each(e,function(t,e){var i=(n[e]||0)+(o[e]||0);i&&0<=i&&(s[e]=i||null)}),t.css(s)})},stop:function(){x(this).removeData("ui-resizable-alsoresize")}}),x.ui.plugin.add("resizable","ghost",{start:function(){var t=x(this).resizable("instance"),e=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:e.height,width:e.width,margin:0,left:0,top:0}),t._addClass(t.ghost,"ui-resizable-ghost"),!1!==x.uiBackCompat&&"string"==typeof t.options.ghost&&t.ghost.addClass(this.options.ghost),t.ghost.appendTo(t.helper)},resize:function(){var t=x(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=x(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),x.ui.plugin.add("resizable","grid",{resize:function(){var t,e=x(this).resizable("instance"),i=e.options,n=e.size,s=e.originalSize,r=e.originalPosition,o=e.axis,a="number"==typeof i.grid?[i.grid,i.grid]:i.grid,l=a[0]||1,h=a[1]||1,c=Math.round((n.width-s.width)/l)*l,u=Math.round((n.height-s.height)/h)*h,d=s.width+c,p=s.height+u,g=i.maxWidth&&i.maxWidth<d,f=i.maxHeight&&i.maxHeight<p,m=i.minWidth&&i.minWidth>d,v=i.minHeight&&i.minHeight>p;i.grid=a,m&&(d+=l),v&&(p+=h),g&&(d-=l),f&&(p-=h),/^(se|s|e)$/.test(o)?(e.size.width=d,e.size.height=p):/^(ne)$/.test(o)?(e.size.width=d,e.size.height=p,e.position.top=r.top-u):/^(sw)$/.test(o)?(e.size.width=d,e.size.height=p,e.position.left=r.left-c):((p-h<=0||d-l<=0)&&(t=e._getPaddingPlusBorderDimensions(this)),0<p-h?(e.size.height=p,e.position.top=r.top-u):(p=h-t.height,e.size.height=p,e.position.top=r.top+s.height-p),0<d-l?(e.size.width=d,e.position.left=r.left-c):(d=l-t.width,e.size.width=d,e.position.left=r.left+s.width-d))}});x.ui.resizable;x.widget("ui.dialog",{version:"1.12.1",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var e=x(this).css(t).offset().top;e<0&&x(this).css("top",t.top-e)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&x.fn.draggable&&this._makeDraggable(),this.options.resizable&&x.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?x(t):this.document.find(t||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(t=e.parent.children().eq(e.index)).length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:x.noop,enable:x.noop,close:function(t){var e=this;this._isOpen&&!1!==this._trigger("beforeClose",t)&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||x.ui.safeBlur(x.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,function(){e._trigger("close",t)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,e){var i=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+x(this).css("z-index")}).get(),s=Math.max.apply(null,n);return s>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",s+1),i=!0),i&&!e&&this._trigger("focus",t),i},open:function(){var t=this;this._isOpen?this._moveToTop()&&this._focusTabbable():(this._isOpen=!0,this.opener=x(x.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"))},_focusTabbable:function(){var t=this._focusedElement;(t=t||this.element.find("[autofocus]")).length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).trigger("focus")},_keepFocus:function(t){function e(){var t=x.ui.safeActiveElement(this.document[0]);this.uiDialog[0]===t||x.contains(this.uiDialog[0],t)||this._focusTabbable()}t.preventDefault(),e.call(this),this._delay(e)},_createWrapper:function(){this.uiDialog=x("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===x.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);if(t.keyCode===x.ui.keyCode.TAB&&!t.isDefaultPrevented()){var e=this.uiDialog.find(":tabbable"),i=e.filter(":first"),n=e.filter(":last");t.target!==n[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==i[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){n.trigger("focus")}),t.preventDefault()):(this._delay(function(){i.trigger("focus")}),t.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=x("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(t){x(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=x("<button type='button'></button>").button({label:x("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),t=x("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(t,"ui-dialog-title"),this._title(t),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(t){this.options.title?t.text(this.options.title):t.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=x("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=x("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var s=this,t=this.options.buttons;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),x.isEmptyObject(t)||x.isArray(t)&&!t.length?this._removeClass(this.uiDialog,"ui-dialog-buttons"):(x.each(t,function(t,e){var i,n;e=x.isFunction(e)?{click:e,text:t}:e,e=x.extend({type:"button"},e),i=e.click,n={icon:e.icon,iconPosition:e.iconPosition,showLabel:e.showLabel,icons:e.icons,text:e.text},delete e.click,delete e.icon,delete e.iconPosition,delete e.showLabel,delete e.icons,"boolean"==typeof e.text&&delete e.text,x("<button></button>",e).button(n).appendTo(s.uiButtonSet).on("click",function(){i.apply(s.element[0],arguments)})}),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){var s=this,r=this.options;function o(t){return{position:t.position,offset:t.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(t,e){s._addClass(x(this),"ui-dialog-dragging"),s._blockFrames(),s._trigger("dragStart",t,o(e))},drag:function(t,e){s._trigger("drag",t,o(e))},stop:function(t,e){var i=e.offset.left-s.document.scrollLeft(),n=e.offset.top-s.document.scrollTop();r.position={my:"left top",at:"left"+(0<=i?"+":"")+i+" top"+(0<=n?"+":"")+n,of:s.window},s._removeClass(x(this),"ui-dialog-dragging"),s._unblockFrames(),s._trigger("dragStop",t,o(e))}})},_makeResizable:function(){var r=this,o=this.options,t=o.resizable,e=this.uiDialog.css("position"),i="string"==typeof t?t:"n,e,s,w,se,sw,ne,nw";function a(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:o.maxWidth,maxHeight:o.maxHeight,minWidth:o.minWidth,minHeight:this._minHeight(),handles:i,start:function(t,e){r._addClass(x(this),"ui-dialog-resizing"),r._blockFrames(),r._trigger("resizeStart",t,a(e))},resize:function(t,e){r._trigger("resize",t,a(e))},stop:function(t,e){var i=r.uiDialog.offset(),n=i.left-r.document.scrollLeft(),s=i.top-r.document.scrollTop();o.height=r.uiDialog.height(),o.width=r.uiDialog.width(),o.position={my:"left top",at:"left"+(0<=n?"+":"")+n+" top"+(0<=s?"+":"")+s,of:r.window},r._removeClass(x(this),"ui-dialog-resizing"),r._unblockFrames(),r._trigger("resizeStop",t,a(e))}}).css("position",e)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=x(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),e=x.inArray(this,t);-1!==e&&t.splice(e,1)},_trackingInstances:function(){var t=this.document.data("ui-dialog-instances");return t||(t=[],this.document.data("ui-dialog-instances",t)),t},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(t){var i=this,n=!1,s={};x.each(t,function(t,e){i._setOption(t,e),t in i.sizeRelatedOptions&&(n=!0),t in i.resizableRelatedOptions&&(s[t]=e)}),n&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",s)},_setOption:function(t,e){var i,n,s=this.uiDialog;"disabled"!==t&&(this._super(t,e),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:x("<a>").text(""+this.options.closeText).html()}),"draggable"===t&&((i=s.is(":data(ui-draggable)"))&&!e&&s.draggable("destroy"),!i&&e&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&((n=s.is(":data(ui-resizable)"))&&!e&&s.resizable("destroy"),n&&"string"==typeof e&&s.resizable("option","handles",e),n||!1===e||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),t=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),e=Math.max(0,n.minHeight-t),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-t):"none","auto"===n.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=x(this);return x("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return!!x(t.target).closest(".ui-dialog").length||!!x(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=!0;this._delay(function(){e=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(t){e||this._allowInteraction(t)||(t.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=x("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var t=this.document.data("ui-dialog-overlays")-1;t?this.document.data("ui-dialog-overlays",t):(this._off(this.document,"focusin"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),!1!==x.uiBackCompat&&x.widget("ui.dialog",x.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(t,e){"dialogClass"===t&&this.uiDialog.removeClass(this.options.dialogClass).addClass(e),this._superApply(arguments)}});x.ui.dialog;x.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,e=this.options,i=e.accept;this.isover=!1,this.isout=!0,this.accept=x.isFunction(i)?i:function(t){return t.is(i)},this.proportions=function(){if(!arguments.length)return t||(t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});t=arguments[0]},this._addToManager(e.scope),e.addClasses&&this._addClass("ui-droppable")},_addToManager:function(t){x.ui.ddmanager.droppables[t]=x.ui.ddmanager.droppables[t]||[],x.ui.ddmanager.droppables[t].push(this)},_splice:function(t){for(var e=0;e<t.length;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var t=x.ui.ddmanager.droppables[this.options.scope];this._splice(t)},_setOption:function(t,e){if("accept"===t)this.accept=x.isFunction(e)?e:function(t){return t.is(e)};else if("scope"===t){var i=x.ui.ddmanager.droppables[this.options.scope];this._splice(i),this._addToManager(e)}this._super(t,e)},_activate:function(t){var e=x.ui.ddmanager.current;this._addActiveClass(),e&&this._trigger("activate",t,this.ui(e))},_deactivate:function(t){var e=x.ui.ddmanager.current;this._removeActiveClass(),e&&this._trigger("deactivate",t,this.ui(e))},_over:function(t){var e=x.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!==this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this._addHoverClass(),this._trigger("over",t,this.ui(e)))},_out:function(t){var e=x.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!==this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this._removeHoverClass(),this._trigger("out",t,this.ui(e)))},_drop:function(e,t){var i=t||x.ui.ddmanager.current,n=!1;return!(!i||(i.currentItem||i.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=x(this).droppable("instance");if(t.options.greedy&&!t.options.disabled&&t.options.scope===i.options.scope&&t.accept.call(t.element[0],i.currentItem||i.element)&&st(i,x.extend(t,{offset:t.element.offset()}),t.options.tolerance,e))return!(n=!0)}),!n&&(!!this.accept.call(this.element[0],i.currentItem||i.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",e,this.ui(i)),this.element)))},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var st=x.ui.intersect=function(t,e,i,n){if(!e.offset)return!1;var s=(t.positionAbs||t.position.absolute).left+t.margins.left,r=(t.positionAbs||t.position.absolute).top+t.margins.top,o=s+t.helperProportions.width,a=r+t.helperProportions.height,l=e.offset.left,h=e.offset.top,c=l+e.proportions().width,u=h+e.proportions().height;switch(i){case"fit":return l<=s&&o<=c&&h<=r&&a<=u;case"intersect":return l<s+t.helperProportions.width/2&&o-t.helperProportions.width/2<c&&h<r+t.helperProportions.height/2&&a-t.helperProportions.height/2<u;case"pointer":return rt(n.pageY,h,e.proportions().height)&&rt(n.pageX,l,e.proportions().width);case"touch":return(h<=r&&r<=u||h<=a&&a<=u||r<h&&u<a)&&(l<=s&&s<=c||l<=o&&o<=c||s<l&&c<o);default:return!1}};function rt(t,e,i){return e<=t&&t<e+i}!(x.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,e){var i,n,s=x.ui.ddmanager.droppables[t.options.scope]||[],r=e?e.type:null,o=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();t:for(i=0;i<s.length;i++)if(!(s[i].options.disabled||t&&!s[i].accept.call(s[i].element[0],t.currentItem||t.element))){for(n=0;n<o.length;n++)if(o[n]===s[i].element[0]){s[i].proportions().height=0;continue t}s[i].visible="none"!==s[i].element.css("display"),s[i].visible&&("mousedown"===r&&s[i]._activate.call(s[i],e),s[i].offset=s[i].element.offset(),s[i].proportions({width:s[i].element[0].offsetWidth,height:s[i].element[0].offsetHeight}))}},drop:function(t,e){var i=!1;return x.each((x.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&st(t,this,this.options.tolerance,e)&&(i=this._drop.call(this,e)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,e)))}),i},dragStart:function(t,e){t.element.parentsUntil("body").on("scroll.droppable",function(){t.options.refreshPositions||x.ui.ddmanager.prepareOffsets(t,e)})},drag:function(r,o){r.options.refreshPositions&&x.ui.ddmanager.prepareOffsets(r,o),x.each(x.ui.ddmanager.droppables[r.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var t,e,i,n=st(r,this,this.options.tolerance,o),s=!n&&this.isover?"isout":n&&!this.isover?"isover":null;s&&(this.options.greedy&&(e=this.options.scope,(i=this.element.parents(":data(ui-droppable)").filter(function(){return x(this).droppable("instance").options.scope===e})).length&&((t=x(i[0]).droppable("instance")).greedyChild="isover"===s)),t&&"isover"===s&&(t.isover=!1,t.isout=!0,t._out.call(t,o)),this[s]=!0,this["isout"===s?"isover":"isout"]=!1,this["isover"===s?"_over":"_out"].call(this,o),t&&"isout"===s&&(t.isout=!1,t.isover=!0,t._over.call(t,o)))}})},dragStop:function(t,e){t.element.parentsUntil("body").off("scroll.droppable"),t.options.refreshPositions||x.ui.ddmanager.prepareOffsets(t,e)}})!==x.uiBackCompat&&x.widget("ui.droppable",x.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}});x.ui.droppable,x.widget("ui.progressbar",{version:"1.12.1",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=x("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(t){if(void 0===t)return this.options.value;this.options.value=this._constrainedValue(t),this._refreshValue()},_constrainedValue:function(t){return void 0===t&&(t=this.options.value),this.indeterminate=!1===t,"number"!=typeof t&&(t=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t),this._toggleClass(null,"ui-state-disabled",!!t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,e=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).width(e.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,t===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=x("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),x.widget("ui.selectable",x.ui.mouse,{version:"1.12.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var n=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){n.elementPos=x(n.element[0]).offset(),n.selectees=x(n.options.filter,n.element[0]),n._addClass(n.selectees,"ui-selectee"),n.selectees.each(function(){var t=x(this),e=t.offset(),i={left:e.left-n.elementPos.left,top:e.top-n.elementPos.top};x.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this._mouseInit(),this.helper=x("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(i){var n=this,t=this.options;this.opos=[i.pageX,i.pageY],this.elementPos=x(this.element[0]).offset(),this.options.disabled||(this.selectees=x(t.filter,this.element[0]),this._trigger("start",i),x(t.appendTo).append(this.helper),this.helper.css({left:i.pageX,top:i.pageY,width:0,height:0}),t.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var t=x.data(this,"selectable-item");t.startselected=!0,i.metaKey||i.ctrlKey||(n._removeClass(t.$element,"ui-selected"),t.selected=!1,n._addClass(t.$element,"ui-unselecting"),t.unselecting=!0,n._trigger("unselecting",i,{unselecting:t.element}))}),x(i.target).parents().addBack().each(function(){var t,e=x.data(this,"selectable-item");if(e)return t=!i.metaKey&&!i.ctrlKey||!e.$element.hasClass("ui-selected"),n._removeClass(e.$element,t?"ui-unselecting":"ui-selected")._addClass(e.$element,t?"ui-selecting":"ui-unselecting"),e.unselecting=!t,e.selecting=t,(e.selected=t)?n._trigger("selecting",i,{selecting:e.element}):n._trigger("unselecting",i,{unselecting:e.element}),!1}))},_mouseDrag:function(n){if(this.dragged=!0,!this.options.disabled){var t,s=this,r=this.options,o=this.opos[0],a=this.opos[1],l=n.pageX,h=n.pageY;return l<o&&(t=l,l=o,o=t),h<a&&(t=h,h=a,a=t),this.helper.css({left:o,top:a,width:l-o,height:h-a}),this.selectees.each(function(){var t=x.data(this,"selectable-item"),e=!1,i={};t&&t.element!==s.element[0]&&(i.left=t.left+s.elementPos.left,i.right=t.right+s.elementPos.left,i.top=t.top+s.elementPos.top,i.bottom=t.bottom+s.elementPos.top,"touch"===r.tolerance?e=!(i.left>l||i.right<o||i.top>h||i.bottom<a):"fit"===r.tolerance&&(e=i.left>o&&i.right<l&&i.top>a&&i.bottom<h),e?(t.selected&&(s._removeClass(t.$element,"ui-selected"),t.selected=!1),t.unselecting&&(s._removeClass(t.$element,"ui-unselecting"),t.unselecting=!1),t.selecting||(s._addClass(t.$element,"ui-selecting"),t.selecting=!0,s._trigger("selecting",n,{selecting:t.element}))):(t.selecting&&((n.metaKey||n.ctrlKey)&&t.startselected?(s._removeClass(t.$element,"ui-selecting"),t.selecting=!1,s._addClass(t.$element,"ui-selected"),t.selected=!0):(s._removeClass(t.$element,"ui-selecting"),t.selecting=!1,t.startselected&&(s._addClass(t.$element,"ui-unselecting"),t.unselecting=!0),s._trigger("unselecting",n,{unselecting:t.element}))),t.selected&&(n.metaKey||n.ctrlKey||t.startselected||(s._removeClass(t.$element,"ui-selected"),t.selected=!1,s._addClass(t.$element,"ui-unselecting"),t.unselecting=!0,s._trigger("unselecting",n,{unselecting:t.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,x(".ui-unselecting",this.element[0]).each(function(){var t=x.data(this,"selectable-item");i._removeClass(t.$element,"ui-unselecting"),t.unselecting=!1,t.startselected=!1,i._trigger("unselected",e,{unselected:t.element})}),x(".ui-selecting",this.element[0]).each(function(){var t=x.data(this,"selectable-item");i._removeClass(t.$element,"ui-selecting")._addClass(t.$element,"ui-selected"),t.selecting=!1,t.selected=!0,t.startselected=!0,i._trigger("selected",e,{selected:t.element})}),this._trigger("stop",e),this.helper.remove(),!1}}),x.widget("ui.selectmenu",[x.ui.formResetMixin,{version:"1.12.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var t=this.element.uniqueId().attr("id");this.ids={element:t,button:t+"-button",menu:t+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=x()},_drawButton:function(){var t,e=this,i=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(t){this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=x("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),t=x("<span>").appendTo(this.button),this._addClass(t,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(i).appendTo(this.button),!1!==this.options.width&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){e._rendered||e._refreshMenu()})},_drawMenu:function(){var n=this;this.menu=x("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=x("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(t,e){t.preventDefault(),n._setSelection(),n._select(e.item.data("ui-selectmenu-item"),t)},focus:function(t,e){var i=e.item.data("ui-selectmenu-item");null!=n.focusIndex&&i.index!==n.focusIndex&&(n._trigger("focus",t,{item:i}),n.isOpen||n._select(i,t)),n.focusIndex=i.index,n.button.attr("aria-activedescendant",n.menuItems.eq(i.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var t,e=this.element.find("option");this.menu.empty(),this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,e.length&&(t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t)))},_position:function(){this.menuWrap.position(x.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(t){var e=x("<span>");return this._setText(e,t.label),this._addClass(e,"ui-selectmenu-text"),e},_renderMenu:function(n,t){var s=this,r="";x.each(t,function(t,e){var i;e.optgroup!==r&&(i=x("<li>",{text:e.optgroup}),s._addClass(i,"ui-selectmenu-optgroup","ui-menu-divider"+(e.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),i.appendTo(n),r=e.optgroup),s._renderItemData(n,e)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(t,e){var i=x("<li>"),n=x("<div>",{title:e.element.attr("title")});return e.disabled&&this._addClass(i,null,"ui-state-disabled"),this._setText(n,e.label),i.append(n).appendTo(t)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var i,n,s=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex).parent("li"):(i=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),s+=":not(.ui-state-disabled)"),(n="first"===t||"last"===t?i["first"===t?"prevAll":"nextAll"](s).eq(-1):i[t+"All"](s).eq(0)).length&&this.menuInstance.focus(e,n)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?((t=window.getSelection()).removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(t){this.isOpen&&(x(t.target).closest(".ui-selectmenu-menu, #"+x.ui.escapeSelector(this.ids.button)).length||this.close(t))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection()).rangeCount&&(this.range=t.getRangeAt(0)):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(t){var e=!0;switch(t.keyCode){case x.ui.keyCode.TAB:case x.ui.keyCode.ESCAPE:this.close(t),e=!1;break;case x.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case x.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case x.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case x.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case x.ui.keyCode.LEFT:this._move("prev",t);break;case x.ui.keyCode.RIGHT:this._move("next",t);break;case x.ui.keyCode.HOME:case x.ui.keyCode.PAGE_UP:this._move("first",t);break;case x.ui.keyCode.END:case x.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),e=!1}e&&t.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex).parent("li");e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(t)),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==i&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){var e=this.menuItems.eq(t.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(t,e){if("icons"===t){var i=this.button.find("span.ui-icon");this._removeClass(i,null,this.options.icons.button)._addClass(i,null,e.button)}this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"width"===t&&this._resizeButton()},_setOptionDisabled:function(t){this._super(t),this.menuInstance.option("disabled",t),this.button.attr("aria-disabled",t),this._toggleClass(this.button,null,"ui-state-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var t=this.options.appendTo;return(t=t&&(t.jquery||t.nodeType?x(t):this.document.find(t).eq(0)))&&t[0]||(t=this.element.closest(".ui-front, dialog")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;!1!==t?(null===t&&(t=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(t)):this.button.css("width","")},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var t=this._super();return t.disabled=this.element.prop("disabled"),t},_parseOptions:function(t){var i=this,n=[];t.each(function(t,e){n.push(i._parseOption(x(e),t))}),this.items=n},_parseOption:function(t,e){var i=t.parent("optgroup");return{element:t,index:e,value:t.val(),label:t.text(),optgroup:i.attr("label")||"",disabled:i.prop("disabled")||t.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),x.widget("ui.slider",x.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,e,i=this.options,n=this.element.find(".ui-slider-handle"),s=[];for(e=i.values&&i.values.length||1,n.length>e&&(n.slice(e).remove(),n=n.slice(0,e)),t=n.length;t<e;t++)s.push("<span tabindex='0'></span>");this.handles=n.add(x(s.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(t){x(this).data("ui-slider-handle-index",t).attr("tabIndex",0)})},_createRange:function(){var t=this.options;t.range?(!0===t.range&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:x.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=x("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),"min"!==t.range&&"max"!==t.range||this._addClass(this.range,"ui-slider-range-"+t.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(t){var e,i,n,s,r,o,a,l=this,h=this.options;return!h.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var e=Math.abs(i-l.values(t));(e<n||n===e&&(t===l._lastChangedValue||l.values(t)===h.min))&&(n=e,s=x(this),r=t)}),!1!==this._start(t,r)&&(this._mouseSliding=!0,this._handleIndex=r,this._addClass(s,null,"ui-state-active"),s.trigger("focus"),o=s.offset(),a=!x(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=a?{left:0,top:0}:{left:t.pageX-o.left-s.width()/2,top:t.pageY-o.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,r,i),this._animateOff=!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,n,s;return 1<(i=("horizontal"===this.orientation?(e=this.elementSize.width,t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)))/e)&&(i=1),i<0&&(i=0),"vertical"===this.orientation&&(i=1-i),n=this._valueMax()-this._valueMin(),s=this._valueMin()+i*n,this._trimAlignValue(s)},_uiHash:function(t,e,i){var n={handle:this.handles[t],handleIndex:t,value:void 0!==e?e:this.value()};return this._hasMultipleValues()&&(n.value=void 0!==e?e:this.values(t),n.values=i||this.values()),n},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(t,e){return this._trigger("start",t,this._uiHash(e))},_slide:function(t,e,i){var n,s=this.value(),r=this.values();this._hasMultipleValues()&&(n=this.values(e?0:1),s=this.values(e),2===this.options.values.length&&!0===this.options.range&&(i=0===e?Math.min(n,i):Math.max(n,i)),r[e]=i),i!==s&&!1!==this._trigger("slide",t,this._uiHash(e,i,r))&&(this._hasMultipleValues()?this.values(e,i):this.value(i))},_stop:function(t,e){this._trigger("stop",t,this._uiHash(e))},_change:function(t,e){this._keySliding||this._mouseSliding||(this._lastChangedValue=e,this._trigger("change",t,this._uiHash(e)))},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,e){var i,n,s;if(1<arguments.length)return this.options.values[t]=this._trimAlignValue(e),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!x.isArray(t))return this._hasMultipleValues()?this._values(t):this.value();for(i=this.options.values,n=t,s=0;s<i.length;s+=1)i[s]=this._trimAlignValue(n[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,e){var i,n=0;switch("range"===t&&!0===this.options.range&&("min"===e?(this.options.value=this._values(0),this.options.values=null):"max"===e&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),x.isArray(this.options.values)&&(n=this.options.values.length),this._super(t,e),t){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(e),this.handles.css("horizontal"===e?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=n-1;0<=i;i--)this._change(null,i);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(t){this._super(t),this._toggleClass(null,"ui-state-disabled",!!t)},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,n;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this._hasMultipleValues()){for(i=this.options.values.slice(),n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=0<this.options.step?this.options.step:1,i=(t-this._valueMin())%e,n=t-i;return 2*Math.abs(i)>=e&&(n+=0<i?e:-e),parseFloat(n.toFixed(5))},_calculateNewMax:function(){var t=this.options.max,e=this._valueMin(),i=this.options.step;(t=Math.round((t-e)/i)*i+e)>this.options.max&&(t-=i),this.max=parseFloat(t.toFixed(this._precision()))},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=t.toString(),i=e.indexOf(".");return-1===i?0:e.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(t){"vertical"===t&&this.range.css({width:"",left:""}),"horizontal"===t&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var e,i,t,n,s,r=this.options.range,o=this.options,a=this,l=!this._animateOff&&o.animate,h={};this._hasMultipleValues()?this.handles.each(function(t){i=(a.values(t)-a._valueMin())/(a._valueMax()-a._valueMin())*100,h["horizontal"===a.orientation?"left":"bottom"]=i+"%",x(this).stop(1,1)[l?"animate":"css"](h,o.animate),!0===a.options.range&&("horizontal"===a.orientation?(0===t&&a.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},o.animate),1===t&&a.range[l?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:o.animate})):(0===t&&a.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},o.animate),1===t&&a.range[l?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:o.animate}))),e=i}):(t=this.value(),n=this._valueMin(),s=this._valueMax(),i=s!==n?(t-n)/(s-n)*100:0,h["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](h,o.animate),"min"===r&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},o.animate),"max"===r&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:100-i+"%"},o.animate),"min"===r&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},o.animate),"max"===r&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:100-i+"%"},o.animate))},_handleEvents:{keydown:function(t){var e,i,n,s=x(t.target).data("ui-slider-handle-index");switch(t.keyCode){case x.ui.keyCode.HOME:case x.ui.keyCode.END:case x.ui.keyCode.PAGE_UP:case x.ui.keyCode.PAGE_DOWN:case x.ui.keyCode.UP:case x.ui.keyCode.RIGHT:case x.ui.keyCode.DOWN:case x.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(x(t.target),null,"ui-state-active"),!1===this._start(t,s)))return}switch(n=this.options.step,e=i=this._hasMultipleValues()?this.values(s):this.value(),t.keyCode){case x.ui.keyCode.HOME:i=this._valueMin();break;case x.ui.keyCode.END:i=this._valueMax();break;case x.ui.keyCode.PAGE_UP:i=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/this.numPages);break;case x.ui.keyCode.PAGE_DOWN:i=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/this.numPages);break;case x.ui.keyCode.UP:case x.ui.keyCode.RIGHT:if(e===this._valueMax())return;i=this._trimAlignValue(e+n);break;case x.ui.keyCode.DOWN:case x.ui.keyCode.LEFT:if(e===this._valueMin())return;i=this._trimAlignValue(e-n)}this._slide(t,s,i)},keyup:function(t){var e=x(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,e),this._change(t,e),this._removeClass(x(t.target),null,"ui-state-active"))}}}),x.widget("ui.sortable",x.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return e<=t&&t<e+i},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){var t=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),x.each(this.items,function(){t._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var t=this.items.length-1;0<=t;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,e){var i=null,n=!1,s=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(t),x(t.target).parents().each(function(){if(x.data(this,s.widgetName+"-item")===s)return i=x(this),!1}),x.data(t.target,s.widgetName+"-item")===s&&(i=x(t.target)),!!i&&(!(this.options.handle&&!e&&(x(this.options.handle,i).find("*").addBack().each(function(){this===t.target&&(n=!0)}),!n))&&(this.currentItem=i,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(t,e,i){var n,s,r=this.options;if((this.currentContainer=this).refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},x.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,r.cursorAt&&this._adjustOffsetFromHelper(r.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),r.containment&&this._setContainment(),r.cursor&&"auto"!==r.cursor&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",r.cursor),this.storedStylesheet=x("<style>*{ cursor: "+r.cursor+" !important; }</style>").appendTo(s)),r.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",r.opacity)),r.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",r.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(n=this.containers.length-1;0<=n;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));return x.ui.ddmanager&&(x.ui.ddmanager.current=this),x.ui.ddmanager&&!r.dropBehaviour&&x.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var e,i,n,s,r=this.options,o=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?this.scrollParent[0].scrollTop=o=this.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-this.overflowOffset.top<r.scrollSensitivity&&(this.scrollParent[0].scrollTop=o=this.scrollParent[0].scrollTop-r.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?this.scrollParent[0].scrollLeft=o=this.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-this.overflowOffset.left<r.scrollSensitivity&&(this.scrollParent[0].scrollLeft=o=this.scrollParent[0].scrollLeft-r.scrollSpeed)):(t.pageY-this.document.scrollTop()<r.scrollSensitivity?o=this.document.scrollTop(this.document.scrollTop()-r.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<r.scrollSensitivity&&(o=this.document.scrollTop(this.document.scrollTop()+r.scrollSpeed)),t.pageX-this.document.scrollLeft()<r.scrollSensitivity?o=this.document.scrollLeft(this.document.scrollLeft()-r.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<r.scrollSensitivity&&(o=this.document.scrollLeft(this.document.scrollLeft()+r.scrollSpeed))),!1!==o&&x.ui.ddmanager&&!r.dropBehaviour&&x.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e=this.items.length-1;0<=e;e--)if(n=(i=this.items[e]).item[0],(s=this._intersectsWithPointer(i))&&i.instance===this.currentContainer&&!(n===this.currentItem[0]||this.placeholder[1===s?"next":"prev"]()[0]===n||x.contains(this.placeholder[0],n)||"semi-dynamic"===this.options.type&&x.contains(this.element[0],n))){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(t,i),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),x.ui.ddmanager&&x.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,e){if(t){if(x.ui.ddmanager&&!this.options.dropBehaviour&&x.ui.ddmanager.drop(this,t),this.options.revert){var i=this,n=this.placeholder.offset(),s=this.options.axis,r={};s&&"x"!==s||(r.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),s&&"y"!==s||(r.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,x(this.helper).animate(r,parseInt(this.options.revert,10)||500,function(){i._clear(t)})}else this._clear(t,e);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new x.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var t=this.containers.length-1;0<=t;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),x.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?x(this.domPosition.prev).after(this.currentItem):x(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var t=this._getItemsAsjQuery(e&&e.connected),i=[];return e=e||{},x(t).each(function(){var t=(x(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);t&&i.push((e.key||t[1]+"[]")+"="+(e.key&&e.expression?t[1]:t[2]))}),!i.length&&e.key&&i.push(e.key+"="),i.join("&")},toArray:function(t){var e=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e.each(function(){i.push(x(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,n=this.positionAbs.top,s=n+this.helperProportions.height,r=t.left,o=r+t.width,a=t.top,l=a+t.height,h=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||a<n+h&&n+h<l,d="y"===this.options.axis||r<e+c&&e+c<o,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:r<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<o&&a<n+this.helperProportions.height/2&&s-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var e,i,n="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),s="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width);return!(!n||!s)&&(e=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection(),this.floating?"right"===i||"down"===e?2:1:e&&("down"===e?2:1))},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),n=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?"right"===s&&i||"left"===s&&!i:n&&("down"===n&&e||"up"===n&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!=t&&(0<t?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!=t&&(0<t?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(t){var e,i,n,s,r=[],o=[],a=this._connectWith();if(a&&t)for(e=a.length-1;0<=e;e--)for(i=(n=x(a[e],this.document[0])).length-1;0<=i;i--)(s=x.data(n[i],this.widgetFullName))&&s!==this&&!s.options.disabled&&o.push([x.isFunction(s.options.items)?s.options.items.call(s.element):x(s.options.items,s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),s]);function l(){r.push(this)}for(o.push([x.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):x(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),e=o.length-1;0<=e;e--)o[e][0].each(l);return x(r)},_removeCurrentsFromItems:function(){var i=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=x.grep(this.items,function(t){for(var e=0;e<i.length;e++)if(i[e]===t.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var e,i,n,s,r,o,a,l,h=this.items,c=[[x.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):x(this.options.items,this.element),this]],u=this._connectWith();if(u&&this.ready)for(e=u.length-1;0<=e;e--)for(i=(n=x(u[e],this.document[0])).length-1;0<=i;i--)(s=x.data(n[i],this.widgetFullName))&&s!==this&&!s.options.disabled&&(c.push([x.isFunction(s.options.items)?s.options.items.call(s.element[0],t,{item:this.currentItem}):x(s.options.items,s.element),s]),this.containers.push(s));for(e=c.length-1;0<=e;e--)for(r=c[e][1],i=0,l=(o=c[e][0]).length;i<l;i++)(a=x(o[i])).data(this.widgetName+"-item",r),h.push({item:a,instance:r,width:0,height:0,left:0,top:0})},refreshPositions:function(t){var e,i,n,s;for(this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),e=this.items.length-1;0<=e;e--)(i=this.items[e]).instance!==this.currentContainer&&this.currentContainer&&i.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?x(this.options.toleranceElement,i.item):i.item,t||(i.width=n.outerWidth(),i.height=n.outerHeight()),s=n.offset(),i.left=s.left,i.top=s.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(e=this.containers.length-1;0<=e;e--)s=this.containers[e].element.offset(),this.containers[e].containerCache.left=s.left,this.containers[e].containerCache.top=s.top,this.containers[e].containerCache.width=this.containers[e].element.outerWidth(),this.containers[e].containerCache.height=this.containers[e].element.outerHeight();return this},_createPlaceholder:function(i){var n,s=(i=i||this).options;s.placeholder&&s.placeholder.constructor!==String||(n=s.placeholder,s.placeholder={element:function(){var t=i.currentItem[0].nodeName.toLowerCase(),e=x("<"+t+">",i.document[0]);return i._addClass(e,"ui-sortable-placeholder",n||i.currentItem[0].className)._removeClass(e,"ui-sortable-helper"),"tbody"===t?i._createTrPlaceholder(i.currentItem.find("tr").eq(0),x("<tr>",i.document[0]).appendTo(e)):"tr"===t?i._createTrPlaceholder(i.currentItem,e):"img"===t&&e.attr("src",i.currentItem.attr("src")),n||e.css("visibility","hidden"),e},update:function(t,e){n&&!s.forcePlaceholderSize||(e.height()||e.height(i.currentItem.innerHeight()-parseInt(i.currentItem.css("paddingTop")||0,10)-parseInt(i.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(i.currentItem.innerWidth()-parseInt(i.currentItem.css("paddingLeft")||0,10)-parseInt(i.currentItem.css("paddingRight")||0,10)))}}),i.placeholder=x(s.placeholder.element.call(i.element,i.currentItem)),i.currentItem.after(i.placeholder),s.placeholder.update(i,i.placeholder)},_createTrPlaceholder:function(t,e){var i=this;t.children().each(function(){x("<td>&#160;</td>",i.document[0]).attr("colspan",x(this).attr("colspan")||1).appendTo(e)})},_contactContainers:function(t){var e,i,n,s,r,o,a,l,h,c,u=null,d=null;for(e=this.containers.length-1;0<=e;e--)if(!x.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(u&&x.contains(this.containers[e].element[0],u.element[0]))continue;u=this.containers[e],d=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",t,this._uiHash(this)),this.containers[e].containerCache.over=0);if(u)if(1===this.containers.length)this.containers[d].containerCache.over||(this.containers[d]._trigger("over",t,this._uiHash(this)),this.containers[d].containerCache.over=1);else{for(n=1e4,s=null,r=(h=u.floating||this._isFloating(this.currentItem))?"left":"top",o=h?"width":"height",c=h?"pageX":"pageY",i=this.items.length-1;0<=i;i--)x.contains(this.containers[d].element[0],this.items[i].item[0])&&this.items[i].item[0]!==this.currentItem[0]&&(a=this.items[i].item.offset()[r],l=!1,t[c]-a>this.items[i][o]/2&&(l=!0),Math.abs(t[c]-a)<n&&(n=Math.abs(t[c]-a),s=this.items[i],this.direction=l?"up":"down"));if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[d])return void(this.currentContainer.containerCache.over||(this.containers[d]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1));s?this._rearrange(t,s,null,!0):this._rearrange(t,null,this.containers[d].element,!0),this._trigger("change",t,this._uiHash()),this.containers[d]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[d],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",t,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(t){var e=this.options,i=x.isFunction(e.helper)?x(e.helper.apply(this.element[0],[t,this.currentItem])):"clone"===e.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||x("parent"!==e.appendTo?e.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),i[0].style.width&&!e.forceHelperSize||i.width(this.currentItem.width()),i[0].style.height&&!e.forceHelperSize||i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),x.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&x.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&x.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,e,i,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),"document"!==n.containment&&"window"!==n.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=x(n.containment)[0],e=x(n.containment).offset(),i="hidden"!==x(t).css("overflow"),this.containment=[e.left+(parseInt(x(t).css("borderLeftWidth"),10)||0)+(parseInt(x(t).css("paddingLeft"),10)||0)-this.margins.left,e.top+(parseInt(x(t).css("borderTopWidth"),10)||0)+(parseInt(x(t).css("paddingTop"),10)||0)-this.margins.top,e.left+(i?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(x(t).css("borderLeftWidth"),10)||0)-(parseInt(x(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,e.top+(i?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(x(t).css("borderTopWidth"),10)||0)-(parseInt(x(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,e){e=e||this.position;var i="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&x.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(n[0].tagName);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:n.scrollTop())*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:n.scrollLeft())*i}},_generatePosition:function(t){var e,i,n=this.options,s=t.pageX,r=t.pageY,o="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&x.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(o[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(r=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(r=this.containment[3]+this.offset.click.top)),n.grid&&(e=this.originalPageY+Math.round((r-this.originalPageY)/n.grid[1])*n.grid[1],r=this.containment?e-this.offset.click.top>=this.containment[1]&&e-this.offset.click.top<=this.containment[3]?e:e-this.offset.click.top>=this.containment[1]?e-n.grid[1]:e+n.grid[1]:e,i=this.originalPageX+Math.round((s-this.originalPageX)/n.grid[0])*n.grid[0],s=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-n.grid[0]:i+n.grid[0]:i)),{top:r-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:o.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:o.scrollLeft())}},_rearrange:function(t,e,i,n){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var s=this.counter;this._delay(function(){s===this.counter&&this.refreshPositions(!n)})},_clear:function(t,e){this.reverting=!1;var i,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)"auto"!==this._storedCSS[i]&&"static"!==this._storedCSS[i]||(this._storedCSS[i]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();function s(e,i,n){return function(t){n._trigger(e,t,i._uiHash(i))}}for(this.fromOutside&&!e&&n.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(n.push(function(t){this._trigger("remove",t,this._uiHash())}),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;0<=i;i--)e||n.push(s("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(n.push(s("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(i=0;i<n.length;i++)n[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===x.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var e=t||this;return{helper:e.helper,placeholder:e.placeholder||x([]),position:e.position,originalPosition:e.originalPosition,offset:e.positionAbs,item:e.currentItem,sender:t?t.element:null}}});function ot(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}x.widget("ui.spinner",{version:"1.12.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var n=this._super(),s=this.element;return x.each(["min","max","step"],function(t,e){var i=s.attr(e);null!=i&&i.length&&(n[e]=i)}),n},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){this.cancelBlur?delete this.cancelBlur:(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",t))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((0<e?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(t){var e;function i(){this.element[0]===x.ui.safeActiveElement(this.document[0])||(this.element.trigger("focus"),this.previous=e,this._delay(function(){this.previous=e}))}e=this.element[0]===x.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),t.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),!1!==this._start(t)&&this._repeat(null,x(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){if(x(t.currentTarget).hasClass("ui-state-active"))return!1!==this._start(t)&&void this._repeat(null,x(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&0<this.uiSpinner.height()&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(t){var e=this.options,i=x.ui.keyCode;switch(t.keyCode){case i.UP:return this._repeat(null,1,t),!0;case i.DOWN:return this._repeat(null,-1,t),!0;case i.PAGE_UP:return this._repeat(null,e.page,t),!0;case i.PAGE_DOWN:return this._repeat(null,-e.page,t),!0}return!1},_start:function(t){return!(!this.spinning&&!1===this._trigger("start",t))&&(this.counter||(this.counter=1),this.spinning=!0)},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",e,{value:i})||(this._value(i),this.counter++)},_increment:function(t){var e=this.options.incremental;return e?x.isFunction(e)?e(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=t.toString(),i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,n=this.options;return i=t-(e=null!==n.min?n.min:0),t=e+(i=Math.round(i/n.step)*n.step),t=parseFloat(t.toFixed(this._precision())),null!==n.max&&t>n.max?n.max:null!==n.min&&t<n.min?n.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){var i,n,s;if("culture"===t||"numberFormat"===t)return i=this._parse(this.element.val()),this.options[t]=e,void this.element.val(this._format(i));"max"!==t&&"min"!==t&&"step"!==t||"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(n=this.buttons.first().find(".ui-icon"),this._removeClass(n,null,this.options.icons.up),this._addClass(n,null,e.up),s=this.buttons.last().find(".ui-icon"),this._removeClass(s,null,this.options.icons.down),this._addClass(s,null,e.down)),this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable")},_setOptions:ot(function(t){this._super(t)}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null!==t&&t===this._adjustValue(t)},_value:function(t,e){var i;""!==t&&null!==(i=this._parse(t))&&(e||(i=this._adjustValue(i)),t=this._format(i)),this.element.val(t),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:ot(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:ot(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:ot(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:ot(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){if(!arguments.length)return this._parse(this.element.val());ot(this._value).call(this,t)},widget:function(){return this.uiSpinner}}),!1!==x.uiBackCompat&&x.widget("ui.spinner",x.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}});var at;x.ui.spinner;x.widget("ui.tabs",{version:"1.12.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(at=/#.*$/,function(t){var e,i;e=t.href.replace(at,""),i=location.href.replace(at,"");try{e=decodeURIComponent(e)}catch(t){}try{i=decodeURIComponent(i)}catch(t){}return 1<t.hash.length&&e===i}),_create:function(){var e=this,t=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,t.collapsible),this._processTabs(),t.active=this._initialActive(),x.isArray(t.disabled)&&(t.disabled=x.unique(t.disabled.concat(x.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),!1!==this.options.active&&this.anchors.length?this.active=this._findActive(t.active):this.active=x(),this._refresh(),this.active.length&&this.load(t.active)},_initialActive:function(){var i=this.options.active,t=this.options.collapsible,n=location.hash.substring(1);return null===i&&(n&&this.tabs.each(function(t,e){if(x(e).attr("aria-controls")===n)return i=t,!1}),null===i&&(i=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==i&&-1!==i||(i=!!this.tabs.length&&0)),!1!==i&&-1===(i=this.tabs.index(this.tabs.eq(i)))&&(i=!t&&0),!t&&!1===i&&this.anchors.length&&(i=0),i},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):x()}},_tabKeydown:function(t){var e=x(x.ui.safeActiveElement(this.document[0])).closest("li"),i=this.tabs.index(e),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case x.ui.keyCode.RIGHT:case x.ui.keyCode.DOWN:i++;break;case x.ui.keyCode.UP:case x.ui.keyCode.LEFT:n=!1,i--;break;case x.ui.keyCode.END:i=this.anchors.length-1;break;case x.ui.keyCode.HOME:i=0;break;case x.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i);case x.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i!==this.options.active&&i);default:return}t.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,n),t.ctrlKey||t.metaKey||(e.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===x.ui.keyCode.UP&&(t.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(t){return t.altKey&&t.keyCode===x.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===x.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,e){var i=this.tabs.length-1;for(;-1!==x.inArray((i<t&&(t=0),t<0&&(t=i),t),this.options.disabled);)t=e?t+1:t-1;return t},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).trigger("focus"),t},_setOption:function(t,e){"active"!==t?(this._super(t,e),"collapsible"===t&&(this._toggleClass("ui-tabs-collapsible",null,e),e||!1!==this.options.active||this._activate(0)),"event"===t&&this._setupEvents(e),"heightStyle"===t&&this._setupHeightStyle(e)):this._activate(e)},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,e=this.tablist.children(":has(a[href])");t.disabled=x.map(e.filter(".ui-state-disabled"),function(t){return e.index(t)}),this._processTabs(),!1!==t.active&&this.anchors.length?this.active.length&&!x.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=x()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=x()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var l=this,t=this.tabs,e=this.anchors,i=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",function(t){x(this).is(".ui-state-disabled")&&t.preventDefault()}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){x(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map(function(){return x("a",this)[0]}).attr({role:"presentation",tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=x(),this.anchors.each(function(t,e){var i,n,s,r=x(e).uniqueId().attr("id"),o=x(e).closest("li"),a=o.attr("aria-controls");l._isLocal(e)?(s=(i=e.hash).substring(1),n=l.element.find(l._sanitizeSelector(i))):(i="#"+(s=o.attr("aria-controls")||x({}).uniqueId()[0].id),(n=l.element.find(i)).length||(n=l._createPanel(s)).insertAfter(l.panels[t-1]||l.tablist),n.attr("aria-live","polite")),n.length&&(l.panels=l.panels.add(n)),a&&o.data("ui-tabs-aria-controls",a),o.attr({"aria-controls":s,"aria-labelledby":r}),n.attr("aria-labelledby",r)}),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),t&&(this._off(t.not(this.tabs)),this._off(e.not(this.anchors)),this._off(i.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(t){return x("<div>").attr("id",t).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(t){var e,i,n;for(x.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1),n=0;i=this.tabs[n];n++)e=x(i),!0===t||-1!==x.inArray(n,t)?(e.attr("aria-disabled","true"),this._addClass(e,null,"ui-state-disabled")):(e.removeAttr("aria-disabled"),this._removeClass(e,null,"ui-state-disabled"));this.options.disabled=t,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!0===t)},_setupEvents:function(t){var i={};t&&x.each(t.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(t){t.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,e=this.element.parent();"fill"===t?(i=e.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=x(this),e=t.css("position");"absolute"!==e&&"fixed"!==e&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=x(this).outerHeight(!0)}),this.panels.each(function(){x(this).height(Math.max(0,i-x(this).innerHeight()+x(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,x(this).height("").height())}).height(i))},_eventHandler:function(t){var e=this.options,i=this.active,n=x(t.currentTarget).closest("li"),s=n[0]===i[0],r=s&&e.collapsible,o=r?x():this._getPanelForTab(n),a=i.length?this._getPanelForTab(i):x(),l={oldTab:i,oldPanel:a,newTab:r?x():n,newPanel:o};t.preventDefault(),n.hasClass("ui-state-disabled")||n.hasClass("ui-tabs-loading")||this.running||s&&!e.collapsible||!1===this._trigger("beforeActivate",t,l)||(e.active=!r&&this.tabs.index(n),this.active=s?x():n,this.xhr&&this.xhr.abort(),a.length||o.length||x.error("jQuery UI Tabs: Mismatching fragment identifier."),o.length&&this.load(this.tabs.index(n),t),this._toggle(t,l))},_toggle:function(t,e){var i=this,n=e.newPanel,s=e.oldPanel;function r(){i.running=!1,i._trigger("activate",t,e)}function o(){i._addClass(e.newTab.closest("li"),"ui-tabs-active","ui-state-active"),n.length&&i.options.show?i._show(n,i.options.show,r):(n.show(),r())}this.running=!0,s.length&&this.options.hide?this._hide(s,this.options.hide,function(){i._removeClass(e.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),o()}):(this._removeClass(e.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),s.hide(),o()),s.attr("aria-hidden","true"),e.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),n.length&&s.length?e.oldTab.attr("tabIndex",-1):n.length&&this.tabs.filter(function(){return 0===x(this).attr("tabIndex")}).attr("tabIndex",-1),n.attr("aria-hidden","false"),e.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var e,i=this._findActive(t);i[0]!==this.active[0]&&(i.length||(i=this.active),e=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:e,currentTarget:e,preventDefault:x.noop}))},_findActive:function(t){return!1===t?x():this.tabs.eq(t)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+x.ui.escapeSelector(t)+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){x.data(this,"ui-tabs-destroy")?x(this).remove():x(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")}),this.tabs.each(function(){var t=x(this),e=t.data("ui-tabs-aria-controls");e?t.attr("aria-controls",e).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var t=this.options.disabled;!1!==t&&(t=void 0!==i&&(i=this._getIndex(i),x.isArray(t)?x.map(t,function(t){return t!==i?t:null}):x.map(this.tabs,function(t,e){return e!==i?e:null})),this._setOptionDisabled(t))},disable:function(t){var e=this.options.disabled;if(!0!==e){if(void 0===t)e=!0;else{if(t=this._getIndex(t),-1!==x.inArray(t,e))return;e=x.isArray(e)?x.merge([t],e).sort():[t]}this._setOptionDisabled(e)}},load:function(t,n){t=this._getIndex(t);function s(t,e){"abort"===e&&r.panels.stop(!1,!0),r._removeClass(i,"ui-tabs-loading"),o.removeAttr("aria-busy"),t===r.xhr&&delete r.xhr}var r=this,i=this.tabs.eq(t),e=i.find(".ui-tabs-anchor"),o=this._getPanelForTab(i),a={tab:i,panel:o};this._isLocal(e[0])||(this.xhr=x.ajax(this._ajaxSettings(e,n,a)),this.xhr&&"canceled"!==this.xhr.statusText&&(this._addClass(i,"ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.done(function(t,e,i){setTimeout(function(){o.html(t),r._trigger("load",n,a),s(i,e)},1)}).fail(function(t,e){setTimeout(function(){s(t,e)},1)})))},_ajaxSettings:function(t,i,n){var s=this;return{url:t.attr("href").replace(/#.*$/,""),beforeSend:function(t,e){return s._trigger("beforeLoad",i,x.extend({jqXHR:t,ajaxSettings:e},n))}}},_getPanelForTab:function(t){var e=x(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+e))}}),!1!==x.uiBackCompat&&x.widget("ui.tabs",x.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}});x.ui.tabs;x.widget("ui.tooltip",{version:"1.12.1",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var t=x(this).attr("title")||"";return x("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(t,e){var i=(t.attr("aria-describedby")||"").split(/\s+/);i.push(e),t.data("ui-tooltip-id",e).attr("aria-describedby",x.trim(i.join(" ")))},_removeDescribedBy:function(t){var e=t.data("ui-tooltip-id"),i=(t.attr("aria-describedby")||"").split(/\s+/),n=x.inArray(e,i);-1!==n&&i.splice(n,1),t.removeData("ui-tooltip-id"),(i=x.trim(i.join(" ")))?t.attr("aria-describedby",i):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=x("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=x([])},_setOption:function(t,e){var i=this;this._super(t,e),"content"===t&&x.each(this.tooltips,function(t,e){i._updateContent(e.element)})},_setOptionDisabled:function(t){this[t?"_disable":"_enable"]()},_disable:function(){var n=this;x.each(this.tooltips,function(t,e){var i=x.Event("blur");i.target=i.currentTarget=e.element[0],n.close(i,!0)}),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var t=x(this);if(t.is("[title]"))return t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")}))},_enable:function(){this.disabledTitles.each(function(){var t=x(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))}),this.disabledTitles=x([])},open:function(t){var i=this,e=x(t?t.target:this.element).closest(this.options.items);e.length&&!e.data("ui-tooltip-id")&&(e.attr("title")&&e.data("ui-tooltip-title",e.attr("title")),e.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&e.parents().each(function(){var t,e=x(this);e.data("ui-tooltip-open")&&((t=x.Event("blur")).target=t.currentTarget=this,i.close(t,!0)),e.attr("title")&&(e.uniqueId(),i.parents[this.id]={element:this,title:e.attr("title")},e.attr("title",""))}),this._registerCloseHandlers(t,e),this._updateContent(e,t))},_updateContent:function(e,i){var t,n=this.options.content,s=this,r=i?i.type:null;if("string"==typeof n||n.nodeType||n.jquery)return this._open(i,e,n);(t=n.call(e[0],function(t){s._delay(function(){e.data("ui-tooltip-open")&&(i&&(i.type=r),this._open(i,e,t))})}))&&this._open(i,e,t)},_open:function(t,e,i){var n,s,r,o,a=x.extend({},this.options.position);function l(t){a.of=t,s.is(":hidden")||s.position(a)}i&&((n=this._find(e))?n.tooltip.find(".ui-tooltip-content").html(i):(e.is("[title]")&&(t&&"mouseover"===t.type?e.attr("title",""):e.removeAttr("title")),n=this._tooltip(e),s=n.tooltip,this._addDescribedBy(e,s.attr("id")),s.find(".ui-tooltip-content").html(i),this.liveRegion.children().hide(),(o=x("<div>").html(s.find(".ui-tooltip-content").html())).removeAttr("name").find("[name]").removeAttr("name"),o.removeAttr("id").find("[id]").removeAttr("id"),o.appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:l}),l(t)):s.position(x.extend({of:e},this.options.position)),s.hide(),this._show(s,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval(function(){s.is(":visible")&&(l(a.of),clearInterval(r))},x.fx.interval)),this._trigger("open",t,{tooltip:s})))},_registerCloseHandlers:function(t,i){var e={keyup:function(t){if(t.keyCode===x.ui.keyCode.ESCAPE){var e=x.Event(t);e.currentTarget=i[0],this.close(e,!0)}}};i[0]!==this.element[0]&&(e.remove=function(){this._removeTooltip(this._find(i).tooltip)}),t&&"mouseover"!==t.type||(e.mouseleave="close"),t&&"focusin"!==t.type||(e.focusout="close"),this._on(!0,i,e)},close:function(t){var e,i=this,n=x(t?t.currentTarget:this.element),s=this._find(n);s?(e=s.tooltip,s.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),s.hiding=!0,e.stop(!0),this._hide(e,this.options.hide,function(){i._removeTooltip(x(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&x.each(this.parents,function(t,e){x(e.element).attr("title",e.title),delete i.parents[t]}),s.closing=!0,this._trigger("close",t,{tooltip:e}),s.hiding||(s.closing=!1))):n.removeData("ui-tooltip-open")},_tooltip:function(t){var e=x("<div>").attr("role","tooltip"),i=x("<div>").appendTo(e),n=e.uniqueId().attr("id");return this._addClass(i,"ui-tooltip-content"),this._addClass(e,"ui-tooltip","ui-widget ui-widget-content"),e.appendTo(this._appendTo(t)),this.tooltips[n]={element:t,tooltip:e}},_find:function(t){var e=t.data("ui-tooltip-id");return e?this.tooltips[e]:null},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_appendTo:function(t){var e=t.closest(".ui-front, dialog");return e.length||(e=this.document[0].body),e},_destroy:function(){var s=this;x.each(this.tooltips,function(t,e){var i=x.Event("blur"),n=e.element;i.target=i.currentTarget=n[0],s.close(i,!0),x("#"+t).remove(),n.data("ui-tooltip-title")&&(n.attr("title")||n.attr("title",n.data("ui-tooltip-title")),n.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}}),!1!==x.uiBackCompat&&x.widget("ui.tooltip",x.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var t=this._superApply(arguments);return this.options.tooltipClass&&t.tooltip.addClass(this.options.tooltipClass),t}});x.ui.tooltip}),function(){var no,so="Expected a function",ro="__lodash_hash_undefined__",oo="__lodash_placeholder__",ao=128,lo=9007199254740991,ho=NaN,co=4294967295,uo=[["ary",ao],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],po="[object Arguments]",go="[object Array]",fo="[object Boolean]",mo="[object Date]",vo="[object Error]",yo="[object Function]",bo="[object GeneratorFunction]",wo="[object Map]",Co="[object Number]",Io="[object Object]",xo="[object Promise]",Ao="[object RegExp]",So="[object Set]",_o="[object String]",Po="[object Symbol]",Mo="[object WeakMap]",ko="[object ArrayBuffer]",To="[object DataView]",No="[object Float32Array]",Do="[object Float64Array]",Eo="[object Int8Array]",Lo="[object Int16Array]",zo="[object Int32Array]",Oo="[object Uint8Array]",Go="[object Uint8ClampedArray]",Bo="[object Uint16Array]",jo="[object Uint32Array]",Ro=/\b__p \+= '';/g,Vo=/\b(__p \+=) '' \+/g,Zo=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Wo=/&(?:amp|lt|gt|quot|#39);/g,Yo=/[&<>"']/g,Ho=RegExp(Wo.source),Fo=RegExp(Yo.source),Uo=/<%-([\s\S]+?)%>/g,Xo=/<%([\s\S]+?)%>/g,Jo=/<%=([\s\S]+?)%>/g,$o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ko=/^\w*$/,Qo=/^\./,qo=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ta=/[\\^$.*+?()[\]{}|]/g,ea=RegExp(ta.source),ia=/^\s+|\s+$/g,na=/^\s+/,sa=/\s+$/,ra=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,oa=/\{\n\/\* \[wrapped with (.+)\] \*/,aa=/,? & /,la=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ha=/\\(\\)?/g,ca=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ua=/\w*$/,da=/^[-+]0x[0-9a-f]+$/i,pa=/^0b[01]+$/i,ga=/^\[object .+?Constructor\]$/,fa=/^0o[0-7]+$/i,ma=/^(?:0|[1-9]\d*)$/,va=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ya=/($^)/,ba=/['\n\r\u2028\u2029\\]/g,t="\\ud800-\\udfff",e="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",i="\\u2700-\\u27bf",n="a-z\\xdf-\\xf6\\xf8-\\xff",s="A-Z\\xc0-\\xd6\\xd8-\\xde",r="\\ufe0e\\ufe0f",o="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",a="['\u2019]",l="["+t+"]",h="["+o+"]",c="["+e+"]",u="\\d+",d="["+i+"]",p="["+n+"]",g="[^"+t+o+u+i+n+s+"]",f="\\ud83c[\\udffb-\\udfff]",m="[^"+t+"]",v="(?:\\ud83c[\\udde6-\\uddff]){2}",y="[\\ud800-\\udbff][\\udc00-\\udfff]",b="["+s+"]",w="\\u200d",C="(?:"+p+"|"+g+")",I="(?:"+b+"|"+g+")",x="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",A="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",S="(?:"+c+"|"+f+")"+"?",_="["+r+"]?",P=_+S+("(?:"+w+"(?:"+[m,v,y].join("|")+")"+_+S+")*"),M="(?:"+[d,v,y].join("|")+")"+P,k="(?:"+[m+c+"?",c,v,y,l].join("|")+")",wa=RegExp(a,"g"),Ca=RegExp(c,"g"),T=RegExp(f+"(?="+f+")|"+k+P,"g"),Ia=RegExp([b+"?"+p+"+"+x+"(?="+[h,b,"$"].join("|")+")",I+"+"+A+"(?="+[h,b+C,"$"].join("|")+")",b+"?"+C+"+"+x,b+"+"+A,"\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)","\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",u,M].join("|"),"g"),N=RegExp("["+w+t+e+r+"]"),xa=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Aa=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Sa=-1,_a={};_a[No]=_a[Do]=_a[Eo]=_a[Lo]=_a[zo]=_a[Oo]=_a[Go]=_a[Bo]=_a[jo]=!0,_a[po]=_a[go]=_a[ko]=_a[fo]=_a[To]=_a[mo]=_a[vo]=_a[yo]=_a[wo]=_a[Co]=_a[Io]=_a[Ao]=_a[So]=_a[_o]=_a[Mo]=!1;var Pa={};Pa[po]=Pa[go]=Pa[ko]=Pa[To]=Pa[fo]=Pa[mo]=Pa[No]=Pa[Do]=Pa[Eo]=Pa[Lo]=Pa[zo]=Pa[wo]=Pa[Co]=Pa[Io]=Pa[Ao]=Pa[So]=Pa[_o]=Pa[Po]=Pa[Oo]=Pa[Go]=Pa[Bo]=Pa[jo]=!0,Pa[vo]=Pa[yo]=Pa[Mo]=!1;var D={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ma=parseFloat,ka=parseInt,E="object"==typeof global&&global&&global.Object===Object&&global,L="object"==typeof self&&self&&self.Object===Object&&self,Ta=E||L||Function("return this")(),z="object"==typeof exports&&exports&&!exports.nodeType&&exports,O=z&&"object"==typeof module&&module&&!module.nodeType&&module,Na=O&&O.exports===z,G=Na&&E.process,B=function(){try{return G&&G.binding&&G.binding("util")}catch(t){}}(),Da=B&&B.isArrayBuffer,Ea=B&&B.isDate,La=B&&B.isMap,za=B&&B.isRegExp,Oa=B&&B.isSet,Ga=B&&B.isTypedArray;function Ba(t,e){return t.set(e[0],e[1]),t}function ja(t,e){return t.add(e),t}function Ra(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}function Va(t,e,i,n){for(var s=-1,r=null==t?0:t.length;++s<r;){var o=t[s];e(n,o,i(o),t)}return n}function Za(t,e){for(var i=-1,n=null==t?0:t.length;++i<n&&!1!==e(t[i],i,t););return t}function Wa(t,e){for(var i=null==t?0:t.length;i--&&!1!==e(t[i],i,t););return t}function Ya(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(!e(t[i],i,t))return!1;return!0}function Ha(t,e){for(var i=-1,n=null==t?0:t.length,s=0,r=[];++i<n;){var o=t[i];e(o,i,t)&&(r[s++]=o)}return r}function Fa(t,e){return!!(null==t?0:t.length)&&-1<el(t,e,0)}function Ua(t,e,i){for(var n=-1,s=null==t?0:t.length;++n<s;)if(i(e,t[n]))return!0;return!1}function Xa(t,e){for(var i=-1,n=null==t?0:t.length,s=Array(n);++i<n;)s[i]=e(t[i],i,t);return s}function Ja(t,e){for(var i=-1,n=e.length,s=t.length;++i<n;)t[s+i]=e[i];return t}function $a(t,e,i,n){var s=-1,r=null==t?0:t.length;for(n&&r&&(i=t[++s]);++s<r;)i=e(i,t[s],s,t);return i}function Ka(t,e,i,n){var s=null==t?0:t.length;for(n&&s&&(i=t[--s]);s--;)i=e(i,t[s],s,t);return i}function Qa(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}var j=rl("length");function qa(t,n,e){var s;return e(t,function(t,e,i){if(n(t,e,i))return s=e,!1}),s}function tl(t,e,i,n){for(var s=t.length,r=i+(n?1:-1);n?r--:++r<s;)if(e(t[r],r,t))return r;return-1}function el(t,e,i){return e==e?function(t,e,i){var n=i-1,s=t.length;for(;++n<s;)if(t[n]===e)return n;return-1}(t,e,i):tl(t,nl,i)}function il(t,e,i,n){for(var s=i-1,r=t.length;++s<r;)if(n(t[s],e))return s;return-1}function nl(t){return t!=t}function sl(t,e){var i=null==t?0:t.length;return i?al(t,e)/i:ho}function rl(e){return function(t){return null==t?no:t[e]}}function R(e){return function(t){return null==e?no:e[t]}}function ol(t,n,s,r,e){return e(t,function(t,e,i){s=r?(r=!1,t):n(s,t,e,i)}),s}function al(t,e){for(var i,n=-1,s=t.length;++n<s;){var r=e(t[n]);r!==no&&(i=i===no?r:i+r)}return i}function ll(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}function hl(e){return function(t){return e(t)}}function cl(e,t){return Xa(t,function(t){return e[t]})}function ul(t,e){return t.has(e)}function dl(t,e){for(var i=-1,n=t.length;++i<n&&-1<el(e,t[i],0););return i}function pl(t,e){for(var i=t.length;i--&&-1<el(e,t[i],0););return i}var gl=R({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),fl=R({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function ml(t){return"\\"+D[t]}function vl(t){return N.test(t)}function yl(t){var i=-1,n=Array(t.size);return t.forEach(function(t,e){n[++i]=[e,t]}),n}function bl(e,i){return function(t){return e(i(t))}}function wl(t,e){for(var i=-1,n=t.length,s=0,r=[];++i<n;){var o=t[i];o!==e&&o!==oo||(t[i]=oo,r[s++]=i)}return r}function Cl(t){var e=-1,i=Array(t.size);return t.forEach(function(t){i[++e]=t}),i}function Il(t){return vl(t)?function(t){var e=T.lastIndex=0;for(;T.test(t);)++e;return e}(t):j(t)}function xl(t){return vl(t)?t.match(T)||[]:t.split("")}var Al=R({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Sl=function t(e){var i,S=(e=null==e?Ta:Sl.defaults(Ta.Object(),e,Sl.pick(Ta,Aa))).Array,n=e.Date,s=e.Error,m=e.Function,r=e.Math,C=e.Object,v=e.RegExp,c=e.String,b=e.TypeError,o=S.prototype,a=m.prototype,l=C.prototype,h=e["__core-js_shared__"],u=a.toString,I=l.hasOwnProperty,d=0,p=(i=/[^.]+$/.exec(h&&h.keys&&h.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",g=l.toString,f=u.call(C),y=Ta._,w=v("^"+u.call(I).replace(ta,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),x=Na?e.Buffer:no,A=e.Symbol,_=e.Uint8Array,P=x?x.allocUnsafe:no,M=bl(C.getPrototypeOf,C),k=C.create,T=l.propertyIsEnumerable,N=o.splice,D=A?A.isConcatSpreadable:no,E=A?A.iterator:no,L=A?A.toStringTag:no,z=function(){try{var t=Zi(C,"defineProperty");return t({},"",{}),t}catch(t){}}(),O=e.clearTimeout!==Ta.clearTimeout&&e.clearTimeout,G=n&&n.now!==Ta.Date.now&&n.now,B=e.setTimeout!==Ta.setTimeout&&e.setTimeout,j=r.ceil,R=r.floor,V=C.getOwnPropertySymbols,Z=x?x.isBuffer:no,W=e.isFinite,Y=o.join,H=bl(C.keys,C),F=r.max,U=r.min,X=n.now,J=e.parseInt,$=r.random,K=o.reverse,Q=Zi(e,"DataView"),q=Zi(e,"Map"),tt=Zi(e,"Promise"),et=Zi(e,"Set"),it=Zi(e,"WeakMap"),nt=Zi(C,"create"),st=it&&new it,rt={},ot=mn(Q),at=mn(q),lt=mn(tt),ht=mn(et),ct=mn(it),ut=A?A.prototype:no,dt=ut?ut.valueOf:no,pt=ut?ut.toString:no;function gt(t){if(Es(t)&&!Is(t)&&!(t instanceof bt)){if(t instanceof yt)return t;if(I.call(t,"__wrapped__"))return vn(t)}return new yt(t)}var ft=function(t){if(!Ds(t))return{};if(k)return k(t);mt.prototype=t;var e=new mt;return mt.prototype=no,e};function mt(){}function vt(){}function yt(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=no}function bt(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=co,this.__views__=[]}function wt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Ct(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function It(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function xt(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new It;++e<i;)this.add(t[e])}function At(t){var e=this.__data__=new Ct(t);this.size=e.size}function St(t,e){var i=Is(t),n=!i&&Cs(t),s=!i&&!n&&_s(t),r=!i&&!n&&!s&&Vs(t),o=i||n||s||r,a=o?ll(t.length,c):[],l=a.length;for(var h in t)!e&&!I.call(t,h)||o&&("length"==h||s&&("offset"==h||"parent"==h)||r&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||Ji(h,l))||a.push(h);return a}function _t(t){var e=t.length;return e?t[xe(0,e-1)]:no}function Pt(t,e){return un(si(t),Ot(e,0,t.length))}function Mt(t){return un(si(t))}function kt(t,e,i){(i===no||ys(t[e],i))&&(i!==no||e in t)||Lt(t,e,i)}function Tt(t,e,i){var n=t[e];I.call(t,e)&&ys(n,i)&&(i!==no||e in t)||Lt(t,e,i)}function Nt(t,e){for(var i=t.length;i--;)if(ys(t[i][0],e))return i;return-1}function Dt(t,n,s,r){return Vt(t,function(t,e,i){n(r,t,s(t),i)}),r}function Et(t,e){return t&&ri(e,hr(e),t)}function Lt(t,e,i){"__proto__"==e&&z?z(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}function zt(t,e){for(var i=-1,n=e.length,s=S(n),r=null==t;++i<n;)s[i]=r?no:sr(t,e[i]);return s}function Ot(t,e,i){return t==t&&(i!==no&&(t=t<=i?t:i),e!==no&&(t=e<=t?t:e)),t}function Gt(i,n,s,t,e,r){var o,a=1&n,l=2&n,h=4&n;if(s&&(o=e?s(i,t,e,r):s(i)),o!==no)return o;if(!Ds(i))return i;var c,u,d,p,g,f,m=Is(i);if(m){if(o=function(t){var e=t.length,i=t.constructor(e);e&&"string"==typeof t[0]&&I.call(t,"index")&&(i.index=t.index,i.input=t.input);return i}(i),!a)return si(i,o)}else{var v=Hi(i),y=v==yo||v==bo;if(_s(i))return Qe(i,a);if(v==Io||v==po||y&&!e){if(o=l||y?{}:Ui(i),!a)return l?(f=d=i,p=(g=o)&&ri(f,cr(f),g),ri(d,Yi(d),p)):(u=Et(o,c=i),ri(c,Wi(c),u))}else{if(!Pa[v])return e?i:{};o=function(t,e,i,n){var s=t.constructor;switch(e){case ko:return qe(t);case fo:case mo:return new s(+t);case To:return function(t,e){var i=e?qe(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}(t,n);case No:case Do:case Eo:case Lo:case zo:case Oo:case Go:case Bo:case jo:return ti(t,n);case wo:return function(t,e,i){return $a(e?i(yl(t),1):yl(t),Ba,new t.constructor)}(t,n,i);case Co:case _o:return new s(t);case Ao:return function(t){var e=new t.constructor(t.source,ua.exec(t));return e.lastIndex=t.lastIndex,e}(t);case So:return function(t,e,i){return $a(e?i(Cl(t),1):Cl(t),ja,new t.constructor)}(t,n,i);case Po:return function(t){return dt?C(dt.call(t)):{}}(t)}}(i,v,Gt,a)}}var b=(r=r||new At).get(i);if(b)return b;r.set(i,o);var w=m?no:(h?l?zi:Li:l?cr:hr)(i);return Za(w||i,function(t,e){w&&(t=i[e=t]),Tt(o,e,Gt(t,n,s,e,i,r))}),o}function Bt(t,e,i){var n=i.length;if(null==t)return!n;for(t=C(t);n--;){var s=i[n],r=e[s],o=t[s];if(o===no&&!(s in t)||!r(o))return!1}return!0}function jt(t,e,i){if("function"!=typeof t)throw new b(so);return an(function(){t.apply(no,i)},e)}function Rt(t,e,i,n){var s=-1,r=Fa,o=!0,a=t.length,l=[],h=e.length;if(!a)return l;i&&(e=Xa(e,hl(i))),n?(r=Ua,o=!1):200<=e.length&&(r=ul,o=!1,e=new xt(e));t:for(;++s<a;){var c=t[s],u=null==i?c:i(c);if(c=n||0!==c?c:0,o&&u==u){for(var d=h;d--;)if(e[d]===u)continue t;l.push(c)}else r(e,u,n)||l.push(c)}return l}gt.templateSettings={escape:Uo,evaluate:Xo,interpolate:Jo,variable:"",imports:{_:gt}},(gt.prototype=vt.prototype).constructor=gt,(yt.prototype=ft(vt.prototype)).constructor=yt,(bt.prototype=ft(vt.prototype)).constructor=bt,wt.prototype.clear=function(){this.__data__=nt?nt(null):{},this.size=0},wt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},wt.prototype.get=function(t){var e=this.__data__;if(nt){var i=e[t];return i===ro?no:i}return I.call(e,t)?e[t]:no},wt.prototype.has=function(t){var e=this.__data__;return nt?e[t]!==no:I.call(e,t)},wt.prototype.set=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=nt&&e===no?ro:e,this},Ct.prototype.clear=function(){this.__data__=[],this.size=0},Ct.prototype.delete=function(t){var e=this.__data__,i=Nt(e,t);return!(i<0)&&(i==e.length-1?e.pop():N.call(e,i,1),--this.size,!0)},Ct.prototype.get=function(t){var e=this.__data__,i=Nt(e,t);return i<0?no:e[i][1]},Ct.prototype.has=function(t){return-1<Nt(this.__data__,t)},Ct.prototype.set=function(t,e){var i=this.__data__,n=Nt(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this},It.prototype.clear=function(){this.size=0,this.__data__={hash:new wt,map:new(q||Ct),string:new wt}},It.prototype.delete=function(t){var e=Ri(this,t).delete(t);return this.size-=e?1:0,e},It.prototype.get=function(t){return Ri(this,t).get(t)},It.prototype.has=function(t){return Ri(this,t).has(t)},It.prototype.set=function(t,e){var i=Ri(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this},xt.prototype.add=xt.prototype.push=function(t){return this.__data__.set(t,ro),this},xt.prototype.has=function(t){return this.__data__.has(t)},At.prototype.clear=function(){this.__data__=new Ct,this.size=0},At.prototype.delete=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i},At.prototype.get=function(t){return this.__data__.get(t)},At.prototype.has=function(t){return this.__data__.has(t)},At.prototype.set=function(t,e){var i=this.__data__;if(i instanceof Ct){var n=i.__data__;if(!q||n.length<199)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new It(n)}return i.set(t,e),this.size=i.size,this};var Vt=li(Jt),Zt=li($t,!0);function Wt(t,n){var s=!0;return Vt(t,function(t,e,i){return s=!!n(t,e,i)}),s}function Yt(t,e,i){for(var n=-1,s=t.length;++n<s;){var r=t[n],o=e(r);if(null!=o&&(a===no?o==o&&!Rs(o):i(o,a)))var a=o,l=r}return l}function Ht(t,n){var s=[];return Vt(t,function(t,e,i){n(t,e,i)&&s.push(t)}),s}function Ft(t,e,i,n,s){var r=-1,o=t.length;for(i=i||Xi,s=s||[];++r<o;){var a=t[r];0<e&&i(a)?1<e?Ft(a,e-1,i,n,s):Ja(s,a):n||(s[s.length]=a)}return s}var Ut=hi(),Xt=hi(!0);function Jt(t,e){return t&&Ut(t,e,hr)}function $t(t,e){return t&&Xt(t,e,hr)}function Kt(e,t){return Ha(t,function(t){return ks(e[t])})}function Qt(t,e){for(var i=0,n=(e=Xe(e,t)).length;null!=t&&i<n;)t=t[fn(e[i++])];return i&&i==n?t:no}function qt(t,e,i){var n=e(t);return Is(t)?n:Ja(n,i(t))}function te(t){return null==t?t===no?"[object Undefined]":"[object Null]":L&&L in C(t)?function(t){var e=I.call(t,L),i=t[L];try{t[L]=no;var n=!0}catch(t){}var s=g.call(t);n&&(e?t[L]=i:delete t[L]);return s}(t):(e=t,g.call(e));var e}function ee(t,e){return e<t}function ie(t,e){return null!=t&&I.call(t,e)}function ne(t,e){return null!=t&&e in C(t)}function se(t,e,i){for(var n=i?Ua:Fa,s=t[0].length,r=t.length,o=r,a=S(r),l=1/0,h=[];o--;){var c=t[o];o&&e&&(c=Xa(c,hl(e))),l=U(c.length,l),a[o]=!i&&(e||120<=s&&120<=c.length)?new xt(o&&c):no}c=t[0];var u=-1,d=a[0];t:for(;++u<s&&h.length<l;){var p=c[u],g=e?e(p):p;if(p=i||0!==p?p:0,!(d?ul(d,g):n(h,g,i))){for(o=r;--o;){var f=a[o];if(!(f?ul(f,g):n(t[o],g,i)))continue t}d&&d.push(g),h.push(p)}}return h}function re(t,e,i){var n=null==(t=rn(t,e=Xe(e,t)))?t:t[fn(Mn(e))];return null==n?no:Ra(n,t,i)}function oe(t){return Es(t)&&te(t)==po}function ae(t,e,i,n,s){return t===e||(null==t||null==e||!Es(t)&&!Es(e)?t!=t&&e!=e:function(t,e,i,n,s,r){var o=Is(t),a=Is(e),l=o?go:Hi(t),h=a?go:Hi(e),c=(l=l==po?Io:l)==Io,u=(h=h==po?Io:h)==Io,d=l==h;if(d&&_s(t)){if(!_s(e))return!1;c=!(o=!0)}if(d&&!c)return r=r||new At,o||Vs(t)?Di(t,e,i,n,s,r):function(t,e,i,n,s,r,o){switch(i){case To:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ko:return!(t.byteLength!=e.byteLength||!r(new _(t),new _(e)));case fo:case mo:case Co:return ys(+t,+e);case vo:return t.name==e.name&&t.message==e.message;case Ao:case _o:return t==e+"";case wo:var a=yl;case So:var l=1&n;if(a=a||Cl,t.size!=e.size&&!l)return!1;var h=o.get(t);if(h)return h==e;n|=2,o.set(t,e);var c=Di(a(t),a(e),n,s,r,o);return o.delete(t),c;case Po:if(dt)return dt.call(t)==dt.call(e)}return!1}(t,e,l,i,n,s,r);if(!(1&i)){var p=c&&I.call(t,"__wrapped__"),g=u&&I.call(e,"__wrapped__");if(p||g){var f=p?t.value():t,m=g?e.value():e;return r=r||new At,s(f,m,i,n,r)}}return d&&(r=r||new At,function(t,e,i,n,s,r){var o=1&i,a=Li(t),l=a.length,h=Li(e).length;if(l!=h&&!o)return!1;var c=l;for(;c--;){var u=a[c];if(!(o?u in e:I.call(e,u)))return!1}var d=r.get(t);if(d&&r.get(e))return d==e;var p=!0;r.set(t,e),r.set(e,t);var g=o;for(;++c<l;){u=a[c];var f=t[u],m=e[u];if(n)var v=o?n(m,f,u,e,t,r):n(f,m,u,t,e,r);if(!(v===no?f===m||s(f,m,i,n,r):v)){p=!1;break}g=g||"constructor"==u}if(p&&!g){var y=t.constructor,b=e.constructor;y!=b&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(p=!1)}return r.delete(t),r.delete(e),p}(t,e,i,n,s,r))}(t,e,i,n,ae,s))}function le(t,e,i,n){var s=i.length,r=s,o=!n;if(null==t)return!r;for(t=C(t);s--;){var a=i[s];if(o&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++s<r;){var l=(a=i[s])[0],h=t[l],c=a[1];if(o&&a[2]){if(h===no&&!(l in t))return!1}else{var u=new At;if(n)var d=n(h,c,l,t,e,u);if(!(d===no?ae(c,h,3,n,u):d))return!1}}return!0}function he(t){return!(!Ds(t)||(e=t,p&&p in e))&&(ks(t)?w:ga).test(mn(t));var e}function ce(t){return"function"==typeof t?t:null==t?zr:"object"==typeof t?Is(t)?me(t[0],t[1]):fe(t):Yr(t)}function ue(t){if(!tn(t))return H(t);var e=[];for(var i in C(t))I.call(t,i)&&"constructor"!=i&&e.push(i);return e}function de(t){if(!Ds(t))return function(t){var e=[];if(null!=t)for(var i in C(t))e.push(i);return e}(t);var e=tn(t),i=[];for(var n in t)("constructor"!=n||!e&&I.call(t,n))&&i.push(n);return i}function pe(t,e){return t<e}function ge(t,n){var s=-1,r=As(t)?S(t.length):[];return Vt(t,function(t,e,i){r[++s]=n(t,e,i)}),r}function fe(e){var i=Vi(e);return 1==i.length&&i[0][2]?nn(i[0][0],i[0][1]):function(t){return t===e||le(t,e,i)}}function me(i,n){return Ki(i)&&en(n)?nn(fn(i),n):function(t){var e=sr(t,i);return e===no&&e===n?rr(t,i):ae(n,e,3)}}function ve(n,s,r,o,a){n!==s&&Ut(s,function(t,e){if(Ds(t))a=a||new At,function(t,e,i,n,s,r,o){var a=t[i],l=e[i],h=o.get(l);if(h)return kt(t,i,h);var c=r?r(a,l,i+"",t,e,o):no,u=c===no;if(u){var d=Is(l),p=!d&&_s(l),g=!d&&!p&&Vs(l);c=l,d||p||g?c=Is(a)?a:Ss(a)?si(a):p?Qe(l,!(u=!1)):g?ti(l,!(u=!1)):[]:Os(l)||Cs(l)?Cs(c=a)?c=Js(a):(!Ds(a)||n&&ks(a))&&(c=Ui(l)):u=!1}u&&(o.set(l,c),s(c,l,n,r,o),o.delete(l));kt(t,i,c)}(n,s,e,r,ve,o,a);else{var i=o?o(n[e],t,e+"",n,s,a):no;i===no&&(i=t),kt(n,e,i)}},cr)}function ye(t,e){var i=t.length;if(i)return Ji(e+=e<0?i:0,i)?t[e]:no}function be(t,n,i){var s=-1;return n=Xa(n.length?n:[zr],hl(ji())),function(t,e){var i=t.length;for(t.sort(e);i--;)t[i]=t[i].value;return t}(ge(t,function(e,t,i){return{criteria:Xa(n,function(t){return t(e)}),index:++s,value:e}}),function(t,e){return function(t,e,i){var n=-1,s=t.criteria,r=e.criteria,o=s.length,a=i.length;for(;++n<o;){var l=ei(s[n],r[n]);if(l){if(a<=n)return l;var h=i[n];return l*("desc"==h?-1:1)}}return t.index-e.index}(t,e,i)})}function we(t,e,i){for(var n=-1,s=e.length,r={};++n<s;){var o=e[n],a=Qt(t,o);i(a,o)&&Me(r,Xe(o,t),a)}return r}function Ce(t,e,i,n){var s=n?il:el,r=-1,o=e.length,a=t;for(t===e&&(e=si(e)),i&&(a=Xa(t,hl(i)));++r<o;)for(var l=0,h=e[r],c=i?i(h):h;-1<(l=s(a,c,l,n));)a!==t&&N.call(a,l,1),N.call(t,l,1);return t}function Ie(t,e){for(var i=t?e.length:0,n=i-1;i--;){var s=e[i];if(i==n||s!==r){var r=s;Ji(s)?N.call(t,s,1):Re(t,s)}}return t}function xe(t,e){return t+R($()*(e-t+1))}function Ae(t,e){var i="";if(!t||e<1||lo<e)return i;for(;e%2&&(i+=t),(e=R(e/2))&&(t+=t),e;);return i}function Se(t,e){return ln(sn(t,e,zr),t+"")}function _e(t){return _t(yr(t))}function Pe(t,e){var i=yr(t);return un(i,Ot(e,0,i.length))}function Me(t,e,i,n){if(!Ds(t))return t;for(var s=-1,r=(e=Xe(e,t)).length,o=r-1,a=t;null!=a&&++s<r;){var l=fn(e[s]),h=i;if(s!=o){var c=a[l];(h=n?n(c,l,a):no)===no&&(h=Ds(c)?c:Ji(e[s+1])?[]:{})}Tt(a,l,h),a=a[l]}return t}var ke=st?function(t,e){return st.set(t,e),t}:zr,Te=z?function(t,e){return z(t,"toString",{configurable:!0,enumerable:!1,value:Dr(e),writable:!0})}:zr;function Ne(t){return un(yr(t))}function De(t,e,i){var n=-1,s=t.length;e<0&&(e=s<-e?0:s+e),(i=s<i?s:i)<0&&(i+=s),s=i<e?0:i-e>>>0,e>>>=0;for(var r=S(s);++n<s;)r[n]=t[n+e];return r}function Ee(t,n){var s;return Vt(t,function(t,e,i){return!(s=n(t,e,i))}),!!s}function Le(t,e,i){var n=0,s=null==t?n:t.length;if("number"==typeof e&&e==e&&s<=2147483647){for(;n<s;){var r=n+s>>>1,o=t[r];null!==o&&!Rs(o)&&(i?o<=e:o<e)?n=1+r:s=r}return s}return ze(t,e,zr,i)}function ze(t,e,i,n){e=i(e);for(var s=0,r=null==t?0:t.length,o=e!=e,a=null===e,l=Rs(e),h=e===no;s<r;){var c=R((s+r)/2),u=i(t[c]),d=u!==no,p=null===u,g=u==u,f=Rs(u);if(o)var m=n||g;else m=h?g&&(n||d):a?g&&d&&(n||!p):l?g&&d&&!p&&(n||!f):!p&&!f&&(n?u<=e:u<e);m?s=c+1:r=c}return U(r,4294967294)}function Oe(t,e){for(var i=-1,n=t.length,s=0,r=[];++i<n;){var o=t[i],a=e?e(o):o;if(!i||!ys(a,l)){var l=a;r[s++]=0===o?0:o}}return r}function Ge(t){return"number"==typeof t?t:Rs(t)?ho:+t}function Be(t){if("string"==typeof t)return t;if(Is(t))return Xa(t,Be)+"";if(Rs(t))return pt?pt.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function je(t,e,i){var n=-1,s=Fa,r=t.length,o=!0,a=[],l=a;if(i)o=!1,s=Ua;else if(200<=r){var h=e?null:_i(t);if(h)return Cl(h);o=!1,s=ul,l=new xt}else l=e?[]:a;t:for(;++n<r;){var c=t[n],u=e?e(c):c;if(c=i||0!==c?c:0,o&&u==u){for(var d=l.length;d--;)if(l[d]===u)continue t;e&&l.push(u),a.push(c)}else s(l,u,i)||(l!==a&&l.push(u),a.push(c))}return a}function Re(t,e){return null==(t=rn(t,e=Xe(e,t)))||delete t[fn(Mn(e))]}function Ve(t,e,i,n){return Me(t,e,i(Qt(t,e)),n)}function Ze(t,e,i,n){for(var s=t.length,r=n?s:-1;(n?r--:++r<s)&&e(t[r],r,t););return i?De(t,n?0:r,n?r+1:s):De(t,n?r+1:0,n?s:r)}function We(t,e){var i=t;return i instanceof bt&&(i=i.value()),$a(e,function(t,e){return e.func.apply(e.thisArg,Ja([t],e.args))},i)}function Ye(t,e,i){var n=t.length;if(n<2)return n?je(t[0]):[];for(var s=-1,r=S(n);++s<n;)for(var o=t[s],a=-1;++a<n;)a!=s&&(r[s]=Rt(r[s]||o,t[a],e,i));return je(Ft(r,1),e,i)}function He(t,e,i){for(var n=-1,s=t.length,r=e.length,o={};++n<s;){var a=n<r?e[n]:no;i(o,t[n],a)}return o}function Fe(t){return Ss(t)?t:[]}function Ue(t){return"function"==typeof t?t:zr}function Xe(t,e){return Is(t)?t:Ki(t,e)?[t]:gn($s(t))}var Je=Se;function $e(t,e,i){var n=t.length;return i=i===no?n:i,!e&&n<=i?t:De(t,e,i)}var Ke=O||function(t){return Ta.clearTimeout(t)};function Qe(t,e){if(e)return t.slice();var i=t.length,n=P?P(i):new t.constructor(i);return t.copy(n),n}function qe(t){var e=new t.constructor(t.byteLength);return new _(e).set(new _(t)),e}function ti(t,e){var i=e?qe(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}function ei(t,e){if(t!==e){var i=t!==no,n=null===t,s=t==t,r=Rs(t),o=e!==no,a=null===e,l=e==e,h=Rs(e);if(!a&&!h&&!r&&e<t||r&&o&&l&&!a&&!h||n&&o&&l||!i&&l||!s)return 1;if(!n&&!r&&!h&&t<e||h&&i&&s&&!n&&!r||a&&i&&s||!o&&s||!l)return-1}return 0}function ii(t,e,i,n){for(var s=-1,r=t.length,o=i.length,a=-1,l=e.length,h=F(r-o,0),c=S(l+h),u=!n;++a<l;)c[a]=e[a];for(;++s<o;)(u||s<r)&&(c[i[s]]=t[s]);for(;h--;)c[a++]=t[s++];return c}function ni(t,e,i,n){for(var s=-1,r=t.length,o=-1,a=i.length,l=-1,h=e.length,c=F(r-a,0),u=S(c+h),d=!n;++s<c;)u[s]=t[s];for(var p=s;++l<h;)u[p+l]=e[l];for(;++o<a;)(d||s<r)&&(u[p+i[o]]=t[s++]);return u}function si(t,e){var i=-1,n=t.length;for(e=e||S(n);++i<n;)e[i]=t[i];return e}function ri(t,e,i,n){var s=!i;i=i||{};for(var r=-1,o=e.length;++r<o;){var a=e[r],l=n?n(i[a],t[a],a,i,t):no;l===no&&(l=t[a]),s?Lt(i,a,l):Tt(i,a,l)}return i}function oi(s,r){return function(t,e){var i=Is(t)?Va:Dt,n=r?r():{};return i(t,s,ji(e,2),n)}}function ai(a){return Se(function(t,e){var i=-1,n=e.length,s=1<n?e[n-1]:no,r=2<n?e[2]:no;for(s=3<a.length&&"function"==typeof s?(n--,s):no,r&&$i(e[0],e[1],r)&&(s=n<3?no:s,n=1),t=C(t);++i<n;){var o=e[i];o&&a(t,o,i,s)}return t})}function li(r,o){return function(t,e){if(null==t)return t;if(!As(t))return r(t,e);for(var i=t.length,n=o?i:-1,s=C(t);(o?n--:++n<i)&&!1!==e(s[n],n,s););return t}}function hi(l){return function(t,e,i){for(var n=-1,s=C(t),r=i(t),o=r.length;o--;){var a=r[l?o:++n];if(!1===e(s[a],a,s))break}return t}}function ci(s){return function(t){var e=vl(t=$s(t))?xl(t):no,i=e?e[0]:t.charAt(0),n=e?$e(e,1).join(""):t.slice(1);return i[s]()+n}}function ui(e){return function(t){return $a(kr(Cr(t).replace(wa,"")),e,"")}}function di(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var e=ft(n.prototype),i=n.apply(e,t);return Ds(i)?i:e}}function pi(o,a,l){var h=di(o);return function t(){for(var e=arguments.length,i=S(e),n=e,s=Bi(t);n--;)i[n]=arguments[n];var r=e<3&&i[0]!==s&&i[e-1]!==s?[]:wl(i,s);return(e-=r.length)<l?Ai(o,a,mi,t.placeholder,no,i,r,no,no,l-e):Ra(this&&this!==Ta&&this instanceof t?h:o,this,i)}}function gi(o){return function(t,e,i){var n=C(t);if(!As(t)){var s=ji(e,3);t=hr(t),e=function(t){return s(n[t],t,n)}}var r=o(t,e,i);return-1<r?n[s?t[r]:r]:no}}function fi(l){return Ei(function(s){var r=s.length,t=r,e=yt.prototype.thru;for(l&&s.reverse();t--;){var i=s[t];if("function"!=typeof i)throw new b(so);if(e&&!o&&"wrapper"==Gi(i))var o=new yt([],!0)}for(t=o?t:r;++t<r;){var n=Gi(i=s[t]),a="wrapper"==n?Oi(i):no;o=a&&Qi(a[0])&&424==a[1]&&!a[4].length&&1==a[9]?o[Gi(a[0])].apply(o,a[3]):1==i.length&&Qi(i)?o[n]():o.thru(i)}return function(){var t=arguments,e=t[0];if(o&&1==t.length&&Is(e))return o.plant(e).value();for(var i=0,n=r?s[i].apply(this,t):e;++i<r;)n=s[i].call(this,n);return n}})}function mi(h,c,u,d,p,g,f,m,v,y){var b=c&ao,w=1&c,C=2&c,I=24&c,x=512&c,A=C?no:di(h);return function t(){for(var e=arguments.length,i=S(e),n=e;n--;)i[n]=arguments[n];if(I)var s=Bi(t),r=function(t,e){for(var i=t.length,n=0;i--;)t[i]===e&&++n;return n}(i,s);if(d&&(i=ii(i,d,p,I)),g&&(i=ni(i,g,f,I)),e-=r,I&&e<y){var o=wl(i,s);return Ai(h,c,mi,t.placeholder,u,i,o,m,v,y-e)}var a=w?u:this,l=C?a[h]:h;return e=i.length,m?i=function(t,e){for(var i=t.length,n=U(e.length,i),s=si(t);n--;){var r=e[n];t[n]=Ji(r,i)?s[r]:no}return t}(i,m):x&&1<e&&i.reverse(),b&&v<e&&(i.length=v),this&&this!==Ta&&this instanceof t&&(l=A||di(l)),l.apply(a,i)}}function vi(o,a){return function(t,e){return i=t,n=o,s=a(e),r={},Jt(i,function(t,e,i){n(r,s(t),e,i)}),r;var i,n,s,r}}function yi(n,s){return function(t,e){var i;if(t===no&&e===no)return s;if(t!==no&&(i=t),e!==no){if(i===no)return e;e="string"==typeof t||"string"==typeof e?(t=Be(t),Be(e)):(t=Ge(t),Ge(e)),i=n(t,e)}return i}}function bi(n){return Ei(function(t){return t=Xa(t,hl(ji())),Se(function(e){var i=this;return n(t,function(t){return Ra(t,i,e)})})})}function wi(t,e){var i=(e=e===no?" ":Be(e)).length;if(i<2)return i?Ae(e,t):e;var n=Ae(e,j(t/Il(e)));return vl(e)?$e(xl(n),0,t).join(""):n.slice(0,t)}function Ci(a,t,l,h){var c=1&t,u=di(a);return function t(){for(var e=-1,i=arguments.length,n=-1,s=h.length,r=S(s+i),o=this&&this!==Ta&&this instanceof t?u:a;++n<s;)r[n]=h[n];for(;i--;)r[n++]=arguments[++e];return Ra(o,c?l:this,r)}}function Ii(n){return function(t,e,i){return i&&"number"!=typeof i&&$i(t,e,i)&&(e=i=no),t=Hs(t),e===no?(e=t,t=0):e=Hs(e),function(t,e,i,n){for(var s=-1,r=F(j((e-t)/(i||1)),0),o=S(r);r--;)o[n?r:++s]=t,t+=i;return o}(t,e,i=i===no?t<e?1:-1:Hs(i),n)}}function xi(i){return function(t,e){return"string"==typeof t&&"string"==typeof e||(t=Xs(t),e=Xs(e)),i(t,e)}}function Ai(t,e,i,n,s,r,o,a,l,h){var c=8&e;e|=c?32:64,4&(e&=~(c?64:32))||(e&=-4);var u=[t,e,s,c?r:no,c?o:no,c?no:r,c?no:o,a,l,h],d=i.apply(no,u);return Qi(t)&&on(d,u),d.placeholder=n,hn(d,t,e)}function Si(t){var n=r[t];return function(t,e){if(t=Xs(t),e=null==e?0:U(Fs(e),292)){var i=($s(t)+"e").split("e");return+((i=($s(n(i[0]+"e"+(+i[1]+e)))+"e").split("e"))[0]+"e"+(i[1]-e))}return n(t)}}var _i=et&&1/Cl(new et([,-0]))[1]==1/0?function(t){return new et(t)}:Rr;function Pi(o){return function(t){var e,i,n,s,r=Hi(t);return r==wo?yl(t):r==So?(e=t,i=-1,n=Array(e.size),e.forEach(function(t){n[++i]=[t,t]}),n):Xa(o(s=t),function(t){return[t,s[t]]})}}function Mi(t,e,i,n,s,r,o,a){var l=2&e;if(!l&&"function"!=typeof t)throw new b(so);var h=n?n.length:0;if(h||(e&=-97,n=s=no),o=o===no?o:F(Fs(o),0),a=a===no?a:Fs(a),h-=s?s.length:0,64&e){var c=n,u=s;n=s=no}var d,p,g,f,m=l?no:Oi(t),v=[t,e,i,n,s,c,u,r,o,a];if(m&&function(t,e){var i=t[1],n=e[1],s=i|n,r=s<131,o=n==ao&&8==i||n==ao&&256==i&&t[7].length<=e[8]||384==n&&e[7].length<=e[8]&&8==i;if(!r&&!o)return;1&n&&(t[2]=e[2],s|=1&i?0:4);var a=e[3];if(a){var l=t[3];t[3]=l?ii(l,a,e[4]):a,t[4]=l?wl(t[3],oo):e[4]}(a=e[5])&&(l=t[5],t[5]=l?ni(l,a,e[6]):a,t[6]=l?wl(t[5],oo):e[6]);(a=e[7])&&(t[7]=a);n&ao&&(t[8]=null==t[8]?e[8]:U(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=s}(v,m),t=v[0],e=v[1],i=v[2],n=v[3],s=v[4],!(a=v[9]=v[9]===no?l?0:t.length:F(v[9]-h,0))&&24&e&&(e&=-25),e&&1!=e)y=8==e||16==e?pi(t,e,a):32!=e&&33!=e||s.length?mi.apply(no,v):Ci(t,e,i,n);else var y=(p=i,g=1&e,f=di(d=t),function t(){return(this&&this!==Ta&&this instanceof t?f:d).apply(g?p:this,arguments)});return hn((m?ke:on)(y,v),t,e)}function ki(t,e,i,n){return t===no||ys(t,l[i])&&!I.call(n,i)?e:t}function Ti(t,e,i,n,s,r){return Ds(t)&&Ds(e)&&(r.set(e,t),ve(t,e,no,Ti,r),r.delete(e)),t}function Ni(t){return Os(t)?no:t}function Di(t,e,i,n,s,r){var o=1&i,a=t.length,l=e.length;if(a!=l&&!(o&&a<l))return!1;var h=r.get(t);if(h&&r.get(e))return h==e;var c=-1,u=!0,d=2&i?new xt:no;for(r.set(t,e),r.set(e,t);++c<a;){var p=t[c],g=e[c];if(n)var f=o?n(g,p,c,e,t,r):n(p,g,c,t,e,r);if(f!==no){if(f)continue;u=!1;break}if(d){if(!Qa(e,function(t,e){if(!ul(d,e)&&(p===t||s(p,t,i,n,r)))return d.push(e)})){u=!1;break}}else if(p!==g&&!s(p,g,i,n,r)){u=!1;break}}return r.delete(t),r.delete(e),u}function Ei(t){return ln(sn(t,no,xn),t+"")}function Li(t){return qt(t,hr,Wi)}function zi(t){return qt(t,cr,Yi)}var Oi=st?function(t){return st.get(t)}:Rr;function Gi(t){for(var e=t.name+"",i=rt[e],n=I.call(rt,e)?i.length:0;n--;){var s=i[n],r=s.func;if(null==r||r==t)return s.name}return e}function Bi(t){return(I.call(gt,"placeholder")?gt:t).placeholder}function ji(){var t=gt.iteratee||Or;return t=t===Or?ce:t,arguments.length?t(arguments[0],arguments[1]):t}function Ri(t,e){var i,n,s=t.__data__;return("string"==(n=typeof(i=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==i:null===i)?s["string"==typeof e?"string":"hash"]:s.map}function Vi(t){for(var e=hr(t),i=e.length;i--;){var n=e[i],s=t[n];e[i]=[n,s,en(s)]}return e}function Zi(t,e){var i,n,s=(n=e,null==(i=t)?no:i[n]);return he(s)?s:no}var Wi=V?function(e){return null==e?[]:(e=C(e),Ha(V(e),function(t){return T.call(e,t)}))}:Ur,Yi=V?function(t){for(var e=[];t;)Ja(e,Wi(t)),t=M(t);return e}:Ur,Hi=te;function Fi(t,e,i){for(var n=-1,s=(e=Xe(e,t)).length,r=!1;++n<s;){var o=fn(e[n]);if(!(r=null!=t&&i(t,o)))break;t=t[o]}return r||++n!=s?r:!!(s=null==t?0:t.length)&&Ns(s)&&Ji(o,s)&&(Is(t)||Cs(t))}function Ui(t){return"function"!=typeof t.constructor||tn(t)?{}:ft(M(t))}function Xi(t){return Is(t)||Cs(t)||!!(D&&t&&t[D])}function Ji(t,e){return!!(e=null==e?lo:e)&&("number"==typeof t||ma.test(t))&&-1<t&&t%1==0&&t<e}function $i(t,e,i){if(!Ds(i))return!1;var n=typeof e;return!!("number"==n?As(i)&&Ji(e,i.length):"string"==n&&e in i)&&ys(i[e],t)}function Ki(t,e){if(Is(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!Rs(t))||(Ko.test(t)||!$o.test(t)||null!=e&&t in C(e))}function Qi(t){var e=Gi(t),i=gt[e];if("function"!=typeof i||!(e in bt.prototype))return!1;if(t===i)return!0;var n=Oi(i);return!!n&&t===n[0]}(Q&&Hi(new Q(new ArrayBuffer(1)))!=To||q&&Hi(new q)!=wo||tt&&Hi(tt.resolve())!=xo||et&&Hi(new et)!=So||it&&Hi(new it)!=Mo)&&(Hi=function(t){var e=te(t),i=e==Io?t.constructor:no,n=i?mn(i):"";if(n)switch(n){case ot:return To;case at:return wo;case lt:return xo;case ht:return So;case ct:return Mo}return e});var qi=h?ks:Xr;function tn(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||l)}function en(t){return t==t&&!Ds(t)}function nn(e,i){return function(t){return null!=t&&(t[e]===i&&(i!==no||e in C(t)))}}function sn(r,o,a){return o=F(o===no?r.length-1:o,0),function(){for(var t=arguments,e=-1,i=F(t.length-o,0),n=S(i);++e<i;)n[e]=t[o+e];e=-1;for(var s=S(o+1);++e<o;)s[e]=t[e];return s[o]=a(n),Ra(r,this,s)}}function rn(t,e){return e.length<2?t:Qt(t,De(e,0,-1))}var on=cn(ke),an=B||function(t,e){return Ta.setTimeout(t,e)},ln=cn(Te);function hn(t,e,i){var n,s,r,o=e+"";return ln(t,function(t,e){var i=e.length;if(!i)return t;var n=i-1;return e[n]=(1<i?"& ":"")+e[n],e=e.join(2<i?", ":" "),t.replace(ra,"{\n/* [wrapped with "+e+"] */\n")}(o,(r=o.match(oa),n=r?r[1].split(aa):[],s=i,Za(uo,function(t){var e="_."+t[0];s&t[1]&&!Fa(n,e)&&n.push(e)}),n.sort())))}function cn(i){var n=0,s=0;return function(){var t=X(),e=16-(t-s);if(s=t,0<e){if(800<=++n)return arguments[0]}else n=0;return i.apply(no,arguments)}}function un(t,e){var i=-1,n=t.length,s=n-1;for(e=e===no?n:e;++i<e;){var r=xe(i,s),o=t[r];t[r]=t[i],t[i]=o}return t.length=e,t}var dn,pn,gn=(pn=(dn=ds(function(t){var s=[];return Qo.test(t)&&s.push(""),t.replace(qo,function(t,e,i,n){s.push(i?n.replace(ha,"$1"):e||t)}),s},function(t){return 500===pn.size&&pn.clear(),t})).cache,dn);function fn(t){if("string"==typeof t||Rs(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function mn(t){if(null!=t){try{return u.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function vn(t){if(t instanceof bt)return t.clone();var e=new yt(t.__wrapped__,t.__chain__);return e.__actions__=si(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var yn=Se(function(t,e){return Ss(t)?Rt(t,Ft(e,1,Ss,!0)):[]}),bn=Se(function(t,e){var i=Mn(e);return Ss(i)&&(i=no),Ss(t)?Rt(t,Ft(e,1,Ss,!0),ji(i,2)):[]}),wn=Se(function(t,e){var i=Mn(e);return Ss(i)&&(i=no),Ss(t)?Rt(t,Ft(e,1,Ss,!0),no,i):[]});function Cn(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var s=null==i?0:Fs(i);return s<0&&(s=F(n+s,0)),tl(t,ji(e,3),s)}function In(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var s=n-1;return i!==no&&(s=Fs(i),s=i<0?F(n+s,0):U(s,n-1)),tl(t,ji(e,3),s,!0)}function xn(t){return(null==t?0:t.length)?Ft(t,1):[]}function An(t){return t&&t.length?t[0]:no}var Sn=Se(function(t){var e=Xa(t,Fe);return e.length&&e[0]===t[0]?se(e):[]}),_n=Se(function(t){var e=Mn(t),i=Xa(t,Fe);return e===Mn(i)?e=no:i.pop(),i.length&&i[0]===t[0]?se(i,ji(e,2)):[]}),Pn=Se(function(t){var e=Mn(t),i=Xa(t,Fe);return(e="function"==typeof e?e:no)&&i.pop(),i.length&&i[0]===t[0]?se(i,no,e):[]});function Mn(t){var e=null==t?0:t.length;return e?t[e-1]:no}var kn=Se(Tn);function Tn(t,e){return t&&t.length&&e&&e.length?Ce(t,e):t}var Nn=Ei(function(t,e){var i=null==t?0:t.length,n=zt(t,e);return Ie(t,Xa(e,function(t){return Ji(t,i)?+t:t}).sort(ei)),n});function Dn(t){return null==t?t:K.call(t)}var En=Se(function(t){return je(Ft(t,1,Ss,!0))}),Ln=Se(function(t){var e=Mn(t);return Ss(e)&&(e=no),je(Ft(t,1,Ss,!0),ji(e,2))}),zn=Se(function(t){var e=Mn(t);return e="function"==typeof e?e:no,je(Ft(t,1,Ss,!0),no,e)});function On(e){if(!e||!e.length)return[];var i=0;return e=Ha(e,function(t){if(Ss(t))return i=F(t.length,i),!0}),ll(i,function(t){return Xa(e,rl(t))})}function Gn(t,e){if(!t||!t.length)return[];var i=On(t);return null==e?i:Xa(i,function(t){return Ra(e,no,t)})}var Bn=Se(function(t,e){return Ss(t)?Rt(t,e):[]}),jn=Se(function(t){return Ye(Ha(t,Ss))}),Rn=Se(function(t){var e=Mn(t);return Ss(e)&&(e=no),Ye(Ha(t,Ss),ji(e,2))}),Vn=Se(function(t){var e=Mn(t);return e="function"==typeof e?e:no,Ye(Ha(t,Ss),no,e)}),Zn=Se(On);var Wn=Se(function(t){var e=t.length,i=1<e?t[e-1]:no;return i="function"==typeof i?(t.pop(),i):no,Gn(t,i)});function Yn(t){var e=gt(t);return e.__chain__=!0,e}function Hn(t,e){return e(t)}var Fn=Ei(function(e){function t(t){return zt(t,e)}var i=e.length,n=i?e[0]:0,s=this.__wrapped__;return!(1<i||this.__actions__.length)&&s instanceof bt&&Ji(n)?((s=s.slice(n,+n+(i?1:0))).__actions__.push({func:Hn,args:[t],thisArg:no}),new yt(s,this.__chain__).thru(function(t){return i&&!t.length&&t.push(no),t})):this.thru(t)});var Un=oi(function(t,e,i){I.call(t,i)?++t[i]:Lt(t,i,1)});var Xn=gi(Cn),Jn=gi(In);function $n(t,e){return(Is(t)?Za:Vt)(t,ji(e,3))}function Kn(t,e){return(Is(t)?Wa:Zt)(t,ji(e,3))}var Qn=oi(function(t,e,i){I.call(t,i)?t[i].push(e):Lt(t,i,[e])});var qn=Se(function(t,e,i){var n=-1,s="function"==typeof e,r=As(t)?S(t.length):[];return Vt(t,function(t){r[++n]=s?Ra(e,t,i):re(t,e,i)}),r}),ts=oi(function(t,e,i){Lt(t,i,e)});function es(t,e){return(Is(t)?Xa:ge)(t,ji(e,3))}var is=oi(function(t,e,i){t[i?0:1].push(e)},function(){return[[],[]]});var ns=Se(function(t,e){if(null==t)return[];var i=e.length;return 1<i&&$i(t,e[0],e[1])?e=[]:2<i&&$i(e[0],e[1],e[2])&&(e=[e[0]]),be(t,Ft(e,1),[])}),ss=G||function(){return Ta.Date.now()};function rs(t,e,i){return e=i?no:e,e=t&&null==e?t.length:e,Mi(t,ao,no,no,no,no,e)}function os(t,e){var i;if("function"!=typeof e)throw new b(so);return t=Fs(t),function(){return 0<--t&&(i=e.apply(this,arguments)),t<=1&&(e=no),i}}var as=Se(function(t,e,i){var n=1;if(i.length){var s=wl(i,Bi(as));n|=32}return Mi(t,n,e,i,s)}),ls=Se(function(t,e,i){var n=3;if(i.length){var s=wl(i,Bi(ls));n|=32}return Mi(e,n,t,i,s)});function hs(n,s,t){var r,o,a,l,h,c,u=0,d=!1,p=!1,e=!0;if("function"!=typeof n)throw new b(so);function g(t){var e=r,i=o;return r=o=no,u=t,l=n.apply(i,e)}function f(t){var e=t-c;return c===no||s<=e||e<0||p&&a<=t-u}function m(){var t,e,i=ss();if(f(i))return v(i);h=an(m,(e=s-((t=i)-c),p?U(e,a-(t-u)):e))}function v(t){return h=no,e&&r?g(t):(r=o=no,l)}function i(){var t,e=ss(),i=f(e);if(r=arguments,o=this,c=e,i){if(h===no)return u=t=c,h=an(m,s),d?g(t):l;if(p)return h=an(m,s),g(c)}return h===no&&(h=an(m,s)),l}return s=Xs(s)||0,Ds(t)&&(d=!!t.leading,a=(p="maxWait"in t)?F(Xs(t.maxWait)||0,s):a,e="trailing"in t?!!t.trailing:e),i.cancel=function(){h!==no&&Ke(h),u=0,r=c=o=h=no},i.flush=function(){return h===no?l:v(ss())},i}var cs=Se(function(t,e){return jt(t,1,e)}),us=Se(function(t,e,i){return jt(t,Xs(e)||0,i)});function ds(s,r){if("function"!=typeof s||null!=r&&"function"!=typeof r)throw new b(so);var o=function(){var t=arguments,e=r?r.apply(this,t):t[0],i=o.cache;if(i.has(e))return i.get(e);var n=s.apply(this,t);return o.cache=i.set(e,n)||i,n};return o.cache=new(ds.Cache||It),o}function ps(e){if("function"!=typeof e)throw new b(so);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}ds.Cache=It;var gs=Je(function(n,s){var r=(s=1==s.length&&Is(s[0])?Xa(s[0],hl(ji())):Xa(Ft(s,1),hl(ji()))).length;return Se(function(t){for(var e=-1,i=U(t.length,r);++e<i;)t[e]=s[e].call(this,t[e]);return Ra(n,this,t)})}),fs=Se(function(t,e){var i=wl(e,Bi(fs));return Mi(t,32,no,e,i)}),ms=Se(function(t,e){var i=wl(e,Bi(ms));return Mi(t,64,no,e,i)}),vs=Ei(function(t,e){return Mi(t,256,no,no,no,e)});function ys(t,e){return t===e||t!=t&&e!=e}var bs=xi(ee),ws=xi(function(t,e){return e<=t}),Cs=oe(function(){return arguments}())?oe:function(t){return Es(t)&&I.call(t,"callee")&&!T.call(t,"callee")},Is=S.isArray,xs=Da?hl(Da):function(t){return Es(t)&&te(t)==ko};function As(t){return null!=t&&Ns(t.length)&&!ks(t)}function Ss(t){return Es(t)&&As(t)}var _s=Z||Xr,Ps=Ea?hl(Ea):function(t){return Es(t)&&te(t)==mo};function Ms(t){if(!Es(t))return!1;var e=te(t);return e==vo||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!Os(t)}function ks(t){if(!Ds(t))return!1;var e=te(t);return e==yo||e==bo||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Ts(t){return"number"==typeof t&&t==Fs(t)}function Ns(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=lo}function Ds(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Es(t){return null!=t&&"object"==typeof t}var Ls=La?hl(La):function(t){return Es(t)&&Hi(t)==wo};function zs(t){return"number"==typeof t||Es(t)&&te(t)==Co}function Os(t){if(!Es(t)||te(t)!=Io)return!1;var e=M(t);if(null===e)return!0;var i=I.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&u.call(i)==f}var Gs=za?hl(za):function(t){return Es(t)&&te(t)==Ao};var Bs=Oa?hl(Oa):function(t){return Es(t)&&Hi(t)==So};function js(t){return"string"==typeof t||!Is(t)&&Es(t)&&te(t)==_o}function Rs(t){return"symbol"==typeof t||Es(t)&&te(t)==Po}var Vs=Ga?hl(Ga):function(t){return Es(t)&&Ns(t.length)&&!!_a[te(t)]};var Zs=xi(pe),Ws=xi(function(t,e){return t<=e});function Ys(t){if(!t)return[];if(As(t))return js(t)?xl(t):si(t);if(E&&t[E])return function(t){for(var e,i=[];!(e=t.next()).done;)i.push(e.value);return i}(t[E]());var e=Hi(t);return(e==wo?yl:e==So?Cl:yr)(t)}function Hs(t){return t?(t=Xs(t))!==1/0&&t!==-1/0?t==t?t:0:17976931348623157e292*(t<0?-1:1):0===t?t:0}function Fs(t){var e=Hs(t),i=e%1;return e==e?i?e-i:e:0}function Us(t){return t?Ot(Fs(t),0,co):0}function Xs(t){if("number"==typeof t)return t;if(Rs(t))return ho;if(Ds(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Ds(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(ia,"");var i=pa.test(t);return i||fa.test(t)?ka(t.slice(2),i?2:8):da.test(t)?ho:+t}function Js(t){return ri(t,cr(t))}function $s(t){return null==t?"":Be(t)}var Ks=ai(function(t,e){if(tn(e)||As(e))ri(e,hr(e),t);else for(var i in e)I.call(e,i)&&Tt(t,i,e[i])}),Qs=ai(function(t,e){ri(e,cr(e),t)}),qs=ai(function(t,e,i,n){ri(e,cr(e),t,n)}),tr=ai(function(t,e,i,n){ri(e,hr(e),t,n)}),er=Ei(zt);var ir=Se(function(t){return t.push(no,ki),Ra(qs,no,t)}),nr=Se(function(t){return t.push(no,Ti),Ra(dr,no,t)});function sr(t,e,i){var n=null==t?no:Qt(t,e);return n===no?i:n}function rr(t,e){return null!=t&&Fi(t,e,ne)}var or=vi(function(t,e,i){t[e]=i},Dr(zr)),ar=vi(function(t,e,i){I.call(t,e)?t[e].push(i):t[e]=[i]},ji),lr=Se(re);function hr(t){return As(t)?St(t):ue(t)}function cr(t){return As(t)?St(t,!0):de(t)}var ur=ai(function(t,e,i){ve(t,e,i)}),dr=ai(function(t,e,i,n){ve(t,e,i,n)}),pr=Ei(function(e,t){var i={};if(null==e)return i;var n=!1;t=Xa(t,function(t){return t=Xe(t,e),n=n||1<t.length,t}),ri(e,zi(e),i),n&&(i=Gt(i,7,Ni));for(var s=t.length;s--;)Re(i,t[s]);return i});var gr=Ei(function(t,e){return null==t?{}:we(i=t,e,function(t,e){return rr(i,e)});var i});function fr(t,i){if(null==t)return{};var e=Xa(zi(t),function(t){return[t]});return i=ji(i),we(t,e,function(t,e){return i(t,e[0])})}var mr=Pi(hr),vr=Pi(cr);function yr(t){return null==t?[]:cl(t,hr(t))}var br=ui(function(t,e,i){return e=e.toLowerCase(),t+(i?wr(e):e)});function wr(t){return Mr($s(t).toLowerCase())}function Cr(t){return(t=$s(t))&&t.replace(va,gl).replace(Ca,"")}var Ir=ui(function(t,e,i){return t+(i?"-":"")+e.toLowerCase()}),xr=ui(function(t,e,i){return t+(i?" ":"")+e.toLowerCase()}),Ar=ci("toLowerCase");var Sr=ui(function(t,e,i){return t+(i?"_":"")+e.toLowerCase()});var _r=ui(function(t,e,i){return t+(i?" ":"")+Mr(e)});var Pr=ui(function(t,e,i){return t+(i?" ":"")+e.toUpperCase()}),Mr=ci("toUpperCase");function kr(t,e,i){return t=$s(t),(e=i?no:e)===no?(n=t,xa.test(n)?t.match(Ia)||[]:t.match(la)||[]):t.match(e)||[];var n}var Tr=Se(function(t,e){try{return Ra(t,no,e)}catch(t){return Ms(t)?t:new s(t)}}),Nr=Ei(function(e,t){return Za(t,function(t){t=fn(t),Lt(e,t,as(e[t],e))}),e});function Dr(t){return function(){return t}}var Er=fi(),Lr=fi(!0);function zr(t){return t}function Or(t){return ce("function"==typeof t?t:Gt(t,1))}var Gr=Se(function(e,i){return function(t){return re(t,e,i)}}),Br=Se(function(e,i){return function(t){return re(e,t,i)}});function jr(n,e,t){var i=hr(e),s=Kt(e,i);null!=t||Ds(e)&&(s.length||!i.length)||(t=e,e=n,n=this,s=Kt(e,hr(e)));var r=!(Ds(t)&&"chain"in t&&!t.chain),o=ks(n);return Za(s,function(t){var i=e[t];n[t]=i,o&&(n.prototype[t]=function(){var t=this.__chain__;if(r||t){var e=n(this.__wrapped__);return(e.__actions__=si(this.__actions__)).push({func:i,args:arguments,thisArg:n}),e.__chain__=t,e}return i.apply(n,Ja([this.value()],arguments))})}),n}function Rr(){}var Vr=bi(Xa),Zr=bi(Ya),Wr=bi(Qa);function Yr(t){return Ki(t)?rl(fn(t)):(e=t,function(t){return Qt(t,e)});var e}var Hr=Ii(),Fr=Ii(!0);function Ur(){return[]}function Xr(){return!1}var Jr=yi(function(t,e){return t+e},0),$r=Si("ceil"),Kr=yi(function(t,e){return t/e},1),Qr=Si("floor");var qr,to=yi(function(t,e){return t*e},1),eo=Si("round"),io=yi(function(t,e){return t-e},0);return gt.after=function(t,e){if("function"!=typeof e)throw new b(so);return t=Fs(t),function(){if(--t<1)return e.apply(this,arguments)}},gt.ary=rs,gt.assign=Ks,gt.assignIn=Qs,gt.assignInWith=qs,gt.assignWith=tr,gt.at=er,gt.before=os,gt.bind=as,gt.bindAll=Nr,gt.bindKey=ls,gt.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Is(t)?t:[t]},gt.chain=Yn,gt.chunk=function(t,e,i){e=(i?$i(t,e,i):e===no)?1:F(Fs(e),0);var n=null==t?0:t.length;if(!n||e<1)return[];for(var s=0,r=0,o=S(j(n/e));s<n;)o[r++]=De(t,s,s+=e);return o},gt.compact=function(t){for(var e=-1,i=null==t?0:t.length,n=0,s=[];++e<i;){var r=t[e];r&&(s[n++]=r)}return s},gt.concat=function(){var t=arguments.length;if(!t)return[];for(var e=S(t-1),i=arguments[0],n=t;n--;)e[n-1]=arguments[n];return Ja(Is(i)?si(i):[i],Ft(e,1))},gt.cond=function(n){var s=null==n?0:n.length,e=ji();return n=s?Xa(n,function(t){if("function"!=typeof t[1])throw new b(so);return[e(t[0]),t[1]]}):[],Se(function(t){for(var e=-1;++e<s;){var i=n[e];if(Ra(i[0],this,t))return Ra(i[1],this,t)}})},gt.conforms=function(t){return e=Gt(t,1),i=hr(e),function(t){return Bt(t,e,i)};var e,i},gt.constant=Dr,gt.countBy=Un,gt.create=function(t,e){var i=ft(t);return null==e?i:Et(i,e)},gt.curry=function t(e,i,n){var s=Mi(e,8,no,no,no,no,no,i=n?no:i);return s.placeholder=t.placeholder,s},gt.curryRight=function t(e,i,n){var s=Mi(e,16,no,no,no,no,no,i=n?no:i);return s.placeholder=t.placeholder,s},gt.debounce=hs,gt.defaults=ir,gt.defaultsDeep=nr,gt.defer=cs,gt.delay=us,gt.difference=yn,gt.differenceBy=bn,gt.differenceWith=wn,gt.drop=function(t,e,i){var n=null==t?0:t.length;return n?De(t,(e=i||e===no?1:Fs(e))<0?0:e,n):[]},gt.dropRight=function(t,e,i){var n=null==t?0:t.length;return n?De(t,0,(e=n-(e=i||e===no?1:Fs(e)))<0?0:e):[]},gt.dropRightWhile=function(t,e){return t&&t.length?Ze(t,ji(e,3),!0,!0):[]},gt.dropWhile=function(t,e){return t&&t.length?Ze(t,ji(e,3),!0):[]},gt.fill=function(t,e,i,n){var s=null==t?0:t.length;return s?(i&&"number"!=typeof i&&$i(t,e,i)&&(i=0,n=s),function(t,e,i,n){var s=t.length;for((i=Fs(i))<0&&(i=s<-i?0:s+i),(n=n===no||s<n?s:Fs(n))<0&&(n+=s),n=n<i?0:Us(n);i<n;)t[i++]=e;return t}(t,e,i,n)):[]},gt.filter=function(t,e){return(Is(t)?Ha:Ht)(t,ji(e,3))},gt.flatMap=function(t,e){return Ft(es(t,e),1)},gt.flatMapDeep=function(t,e){return Ft(es(t,e),1/0)},gt.flatMapDepth=function(t,e,i){return i=i===no?1:Fs(i),Ft(es(t,e),i)},gt.flatten=xn,gt.flattenDeep=function(t){return(null==t?0:t.length)?Ft(t,1/0):[]},gt.flattenDepth=function(t,e){return(null==t?0:t.length)?Ft(t,e=e===no?1:Fs(e)):[]},gt.flip=function(t){return Mi(t,512)},gt.flow=Er,gt.flowRight=Lr,gt.fromPairs=function(t){for(var e=-1,i=null==t?0:t.length,n={};++e<i;){var s=t[e];n[s[0]]=s[1]}return n},gt.functions=function(t){return null==t?[]:Kt(t,hr(t))},gt.functionsIn=function(t){return null==t?[]:Kt(t,cr(t))},gt.groupBy=Qn,gt.initial=function(t){return(null==t?0:t.length)?De(t,0,-1):[]},gt.intersection=Sn,gt.intersectionBy=_n,gt.intersectionWith=Pn,gt.invert=or,gt.invertBy=ar,gt.invokeMap=qn,gt.iteratee=Or,gt.keyBy=ts,gt.keys=hr,gt.keysIn=cr,gt.map=es,gt.mapKeys=function(t,n){var s={};return n=ji(n,3),Jt(t,function(t,e,i){Lt(s,n(t,e,i),t)}),s},gt.mapValues=function(t,n){var s={};return n=ji(n,3),Jt(t,function(t,e,i){Lt(s,e,n(t,e,i))}),s},gt.matches=function(t){return fe(Gt(t,1))},gt.matchesProperty=function(t,e){return me(t,Gt(e,1))},gt.memoize=ds,gt.merge=ur,gt.mergeWith=dr,gt.method=Gr,gt.methodOf=Br,gt.mixin=jr,gt.negate=ps,gt.nthArg=function(e){return e=Fs(e),Se(function(t){return ye(t,e)})},gt.omit=pr,gt.omitBy=function(t,e){return fr(t,ps(ji(e)))},gt.once=function(t){return os(2,t)},gt.orderBy=function(t,e,i,n){return null==t?[]:(Is(e)||(e=null==e?[]:[e]),Is(i=n?no:i)||(i=null==i?[]:[i]),be(t,e,i))},gt.over=Vr,gt.overArgs=gs,gt.overEvery=Zr,gt.overSome=Wr,gt.partial=fs,gt.partialRight=ms,gt.partition=is,gt.pick=gr,gt.pickBy=fr,gt.property=Yr,gt.propertyOf=function(e){return function(t){return null==e?no:Qt(e,t)}},gt.pull=kn,gt.pullAll=Tn,gt.pullAllBy=function(t,e,i){return t&&t.length&&e&&e.length?Ce(t,e,ji(i,2)):t},gt.pullAllWith=function(t,e,i){return t&&t.length&&e&&e.length?Ce(t,e,no,i):t},gt.pullAt=Nn,gt.range=Hr,gt.rangeRight=Fr,gt.rearg=vs,gt.reject=function(t,e){return(Is(t)?Ha:Ht)(t,ps(ji(e,3)))},gt.remove=function(t,e){var i=[];if(!t||!t.length)return i;var n=-1,s=[],r=t.length;for(e=ji(e,3);++n<r;){var o=t[n];e(o,n,t)&&(i.push(o),s.push(n))}return Ie(t,s),i},gt.rest=function(t,e){if("function"!=typeof t)throw new b(so);return Se(t,e=e===no?e:Fs(e))},gt.reverse=Dn,gt.sampleSize=function(t,e,i){return e=(i?$i(t,e,i):e===no)?1:Fs(e),(Is(t)?Pt:Pe)(t,e)},gt.set=function(t,e,i){return null==t?t:Me(t,e,i)},gt.setWith=function(t,e,i,n){return n="function"==typeof n?n:no,null==t?t:Me(t,e,i,n)},gt.shuffle=function(t){return(Is(t)?Mt:Ne)(t)},gt.slice=function(t,e,i){var n=null==t?0:t.length;return n?(i=i&&"number"!=typeof i&&$i(t,e,i)?(e=0,n):(e=null==e?0:Fs(e),i===no?n:Fs(i)),De(t,e,i)):[]},gt.sortBy=ns,gt.sortedUniq=function(t){return t&&t.length?Oe(t):[]},gt.sortedUniqBy=function(t,e){return t&&t.length?Oe(t,ji(e,2)):[]},gt.split=function(t,e,i){return i&&"number"!=typeof i&&$i(t,e,i)&&(e=i=no),(i=i===no?co:i>>>0)?(t=$s(t))&&("string"==typeof e||null!=e&&!Gs(e))&&!(e=Be(e))&&vl(t)?$e(xl(t),0,i):t.split(e,i):[]},gt.spread=function(n,s){if("function"!=typeof n)throw new b(so);return s=null==s?0:F(Fs(s),0),Se(function(t){var e=t[s],i=$e(t,0,s);return e&&Ja(i,e),Ra(n,this,i)})},gt.tail=function(t){var e=null==t?0:t.length;return e?De(t,1,e):[]},gt.take=function(t,e,i){return t&&t.length?De(t,0,(e=i||e===no?1:Fs(e))<0?0:e):[]},gt.takeRight=function(t,e,i){var n=null==t?0:t.length;return n?De(t,(e=n-(e=i||e===no?1:Fs(e)))<0?0:e,n):[]},gt.takeRightWhile=function(t,e){return t&&t.length?Ze(t,ji(e,3),!1,!0):[]},gt.takeWhile=function(t,e){return t&&t.length?Ze(t,ji(e,3)):[]},gt.tap=function(t,e){return e(t),t},gt.throttle=function(t,e,i){var n=!0,s=!0;if("function"!=typeof t)throw new b(so);return Ds(i)&&(n="leading"in i?!!i.leading:n,s="trailing"in i?!!i.trailing:s),hs(t,e,{leading:n,maxWait:e,trailing:s})},gt.thru=Hn,gt.toArray=Ys,gt.toPairs=mr,gt.toPairsIn=vr,gt.toPath=function(t){return Is(t)?Xa(t,fn):Rs(t)?[t]:si(gn($s(t)))},gt.toPlainObject=Js,gt.transform=function(t,n,s){var e=Is(t),i=e||_s(t)||Vs(t);if(n=ji(n,4),null==s){var r=t&&t.constructor;s=i?e?new r:[]:Ds(t)&&ks(r)?ft(M(t)):{}}return(i?Za:Jt)(t,function(t,e,i){return n(s,t,e,i)}),s},gt.unary=function(t){return rs(t,1)},gt.union=En,gt.unionBy=Ln,gt.unionWith=zn,gt.uniq=function(t){return t&&t.length?je(t):[]},gt.uniqBy=function(t,e){return t&&t.length?je(t,ji(e,2)):[]},gt.uniqWith=function(t,e){return e="function"==typeof e?e:no,t&&t.length?je(t,no,e):[]},gt.unset=function(t,e){return null==t||Re(t,e)},gt.unzip=On,gt.unzipWith=Gn,gt.update=function(t,e,i){return null==t?t:Ve(t,e,Ue(i))},gt.updateWith=function(t,e,i,n){return n="function"==typeof n?n:no,null==t?t:Ve(t,e,Ue(i),n)},gt.values=yr,gt.valuesIn=function(t){return null==t?[]:cl(t,cr(t))},gt.without=Bn,gt.words=kr,gt.wrap=function(t,e){return fs(Ue(e),t)},gt.xor=jn,gt.xorBy=Rn,gt.xorWith=Vn,gt.zip=Zn,gt.zipObject=function(t,e){return He(t||[],e||[],Tt)},gt.zipObjectDeep=function(t,e){return He(t||[],e||[],Me)},gt.zipWith=Wn,gt.entries=mr,gt.entriesIn=vr,gt.extend=Qs,gt.extendWith=qs,jr(gt,gt),gt.add=Jr,gt.attempt=Tr,gt.camelCase=br,gt.capitalize=wr,gt.ceil=$r,gt.clamp=function(t,e,i){return i===no&&(i=e,e=no),i!==no&&(i=(i=Xs(i))==i?i:0),e!==no&&(e=(e=Xs(e))==e?e:0),Ot(Xs(t),e,i)},gt.clone=function(t){return Gt(t,4)},gt.cloneDeep=function(t){return Gt(t,5)},gt.cloneDeepWith=function(t,e){return Gt(t,5,e="function"==typeof e?e:no)},gt.cloneWith=function(t,e){return Gt(t,4,e="function"==typeof e?e:no)},gt.conformsTo=function(t,e){return null==e||Bt(t,e,hr(e))},gt.deburr=Cr,gt.defaultTo=function(t,e){return null==t||t!=t?e:t},gt.divide=Kr,gt.endsWith=function(t,e,i){t=$s(t),e=Be(e);var n=t.length,s=i=i===no?n:Ot(Fs(i),0,n);return 0<=(i-=e.length)&&t.slice(i,s)==e},gt.eq=ys,gt.escape=function(t){return(t=$s(t))&&Fo.test(t)?t.replace(Yo,fl):t},gt.escapeRegExp=function(t){return(t=$s(t))&&ea.test(t)?t.replace(ta,"\\$&"):t},gt.every=function(t,e,i){var n=Is(t)?Ya:Wt;return i&&$i(t,e,i)&&(e=no),n(t,ji(e,3))},gt.find=Xn,gt.findIndex=Cn,gt.findKey=function(t,e){return qa(t,ji(e,3),Jt)},gt.findLast=Jn,gt.findLastIndex=In,gt.findLastKey=function(t,e){return qa(t,ji(e,3),$t)},gt.floor=Qr,gt.forEach=$n,gt.forEachRight=Kn,gt.forIn=function(t,e){return null==t?t:Ut(t,ji(e,3),cr)},gt.forInRight=function(t,e){return null==t?t:Xt(t,ji(e,3),cr)},gt.forOwn=function(t,e){return t&&Jt(t,ji(e,3))},gt.forOwnRight=function(t,e){return t&&$t(t,ji(e,3))},gt.get=sr,gt.gt=bs,gt.gte=ws,gt.has=function(t,e){return null!=t&&Fi(t,e,ie)},gt.hasIn=rr,gt.head=An,gt.identity=zr,gt.includes=function(t,e,i,n){t=As(t)?t:yr(t),i=i&&!n?Fs(i):0;var s=t.length;return i<0&&(i=F(s+i,0)),js(t)?i<=s&&-1<t.indexOf(e,i):!!s&&-1<el(t,e,i)},gt.indexOf=function(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var s=null==i?0:Fs(i);return s<0&&(s=F(n+s,0)),el(t,e,s)},gt.inRange=function(t,e,i){return e=Hs(e),i===no?(i=e,e=0):i=Hs(i),t=Xs(t),(n=t)>=U(s=e,r=i)&&n<F(s,r);var n,s,r},gt.invoke=lr,gt.isArguments=Cs,gt.isArray=Is,gt.isArrayBuffer=xs,gt.isArrayLike=As,gt.isArrayLikeObject=Ss,gt.isBoolean=function(t){return!0===t||!1===t||Es(t)&&te(t)==fo},gt.isBuffer=_s,gt.isDate=Ps,gt.isElement=function(t){return Es(t)&&1===t.nodeType&&!Os(t)},gt.isEmpty=function(t){if(null==t)return!0;if(As(t)&&(Is(t)||"string"==typeof t||"function"==typeof t.splice||_s(t)||Vs(t)||Cs(t)))return!t.length;var e=Hi(t);if(e==wo||e==So)return!t.size;if(tn(t))return!ue(t).length;for(var i in t)if(I.call(t,i))return!1;return!0},gt.isEqual=function(t,e){return ae(t,e)},gt.isEqualWith=function(t,e,i){var n=(i="function"==typeof i?i:no)?i(t,e):no;return n===no?ae(t,e,no,i):!!n},gt.isError=Ms,gt.isFinite=function(t){return"number"==typeof t&&W(t)},gt.isFunction=ks,gt.isInteger=Ts,gt.isLength=Ns,gt.isMap=Ls,gt.isMatch=function(t,e){return t===e||le(t,e,Vi(e))},gt.isMatchWith=function(t,e,i){return i="function"==typeof i?i:no,le(t,e,Vi(e),i)},gt.isNaN=function(t){return zs(t)&&t!=+t},gt.isNative=function(t){if(qi(t))throw new s("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return he(t)},gt.isNil=function(t){return null==t},gt.isNull=function(t){return null===t},gt.isNumber=zs,gt.isObject=Ds,gt.isObjectLike=Es,gt.isPlainObject=Os,gt.isRegExp=Gs,gt.isSafeInteger=function(t){return Ts(t)&&-lo<=t&&t<=lo},gt.isSet=Bs,gt.isString=js,gt.isSymbol=Rs,gt.isTypedArray=Vs,gt.isUndefined=function(t){return t===no},gt.isWeakMap=function(t){return Es(t)&&Hi(t)==Mo},gt.isWeakSet=function(t){return Es(t)&&"[object WeakSet]"==te(t)},gt.join=function(t,e){return null==t?"":Y.call(t,e)},gt.kebabCase=Ir,gt.last=Mn,gt.lastIndexOf=function(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var s=n;return i!==no&&(s=(s=Fs(i))<0?F(n+s,0):U(s,n-1)),e==e?function(t,e,i){for(var n=i+1;n--;)if(t[n]===e)return n;return n}(t,e,s):tl(t,nl,s,!0)},gt.lowerCase=xr,gt.lowerFirst=Ar,gt.lt=Zs,gt.lte=Ws,gt.max=function(t){return t&&t.length?Yt(t,zr,ee):no},gt.maxBy=function(t,e){return t&&t.length?Yt(t,ji(e,2),ee):no},gt.mean=function(t){return sl(t,zr)},gt.meanBy=function(t,e){return sl(t,ji(e,2))},gt.min=function(t){return t&&t.length?Yt(t,zr,pe):no},gt.minBy=function(t,e){return t&&t.length?Yt(t,ji(e,2),pe):no},gt.stubArray=Ur,gt.stubFalse=Xr,gt.stubObject=function(){return{}},gt.stubString=function(){return""},gt.stubTrue=function(){return!0},gt.multiply=to,gt.nth=function(t,e){return t&&t.length?ye(t,Fs(e)):no},gt.noConflict=function(){return Ta._===this&&(Ta._=y),this},gt.noop=Rr,gt.now=ss,gt.pad=function(t,e,i){t=$s(t);var n=(e=Fs(e))?Il(t):0;if(!e||e<=n)return t;var s=(e-n)/2;return wi(R(s),i)+t+wi(j(s),i)},gt.padEnd=function(t,e,i){t=$s(t);var n=(e=Fs(e))?Il(t):0;return e&&n<e?t+wi(e-n,i):t},gt.padStart=function(t,e,i){t=$s(t);var n=(e=Fs(e))?Il(t):0;return e&&n<e?wi(e-n,i)+t:t},gt.parseInt=function(t,e,i){return e=i||null==e?0:e&&+e,J($s(t).replace(na,""),e||0)},gt.random=function(t,e,i){if(i&&"boolean"!=typeof i&&$i(t,e,i)&&(e=i=no),i===no&&("boolean"==typeof e?(i=e,e=no):"boolean"==typeof t&&(i=t,t=no)),t===no&&e===no?(t=0,e=1):(t=Hs(t),e===no?(e=t,t=0):e=Hs(e)),e<t){var n=t;t=e,e=n}if(i||t%1||e%1){var s=$();return U(t+s*(e-t+Ma("1e-"+((s+"").length-1))),e)}return xe(t,e)},gt.reduce=function(t,e,i){var n=Is(t)?$a:ol,s=arguments.length<3;return n(t,ji(e,4),i,s,Vt)},gt.reduceRight=function(t,e,i){var n=Is(t)?Ka:ol,s=arguments.length<3;return n(t,ji(e,4),i,s,Zt)},gt.repeat=function(t,e,i){return e=(i?$i(t,e,i):e===no)?1:Fs(e),Ae($s(t),e)},gt.replace=function(){var t=arguments,e=$s(t[0]);return t.length<3?e:e.replace(t[1],t[2])},gt.result=function(t,e,i){var n=-1,s=(e=Xe(e,t)).length;for(s||(s=1,t=no);++n<s;){var r=null==t?no:t[fn(e[n])];r===no&&(n=s,r=i),t=ks(r)?r.call(t):r}return t},gt.round=eo,gt.runInContext=t,gt.sample=function(t){return(Is(t)?_t:_e)(t)},gt.size=function(t){if(null==t)return 0;if(As(t))return js(t)?Il(t):t.length;var e=Hi(t);return e==wo||e==So?t.size:ue(t).length},gt.snakeCase=Sr,gt.some=function(t,e,i){var n=Is(t)?Qa:Ee;return i&&$i(t,e,i)&&(e=no),n(t,ji(e,3))},gt.sortedIndex=function(t,e){return Le(t,e)},gt.sortedIndexBy=function(t,e,i){return ze(t,e,ji(i,2))},gt.sortedIndexOf=function(t,e){var i=null==t?0:t.length;if(i){var n=Le(t,e);if(n<i&&ys(t[n],e))return n}return-1},gt.sortedLastIndex=function(t,e){return Le(t,e,!0)},gt.sortedLastIndexBy=function(t,e,i){return ze(t,e,ji(i,2),!0)},gt.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var i=Le(t,e,!0)-1;if(ys(t[i],e))return i}return-1},gt.startCase=_r,gt.startsWith=function(t,e,i){return t=$s(t),i=null==i?0:Ot(Fs(i),0,t.length),e=Be(e),t.slice(i,i+e.length)==e},gt.subtract=io,gt.sum=function(t){return t&&t.length?al(t,zr):0},gt.sumBy=function(t,e){return t&&t.length?al(t,ji(e,2)):0},gt.template=function(o,t,e){var i=gt.templateSettings;e&&$i(o,t,e)&&(t=no),o=$s(o),t=qs({},t,i,ki);var a,l,n=qs({},t.imports,i.imports,ki),s=hr(n),r=cl(n,s),h=0,c=t.interpolate||ya,u="__p += '",d=v((t.escape||ya).source+"|"+c.source+"|"+(c===Jo?ca:ya).source+"|"+(t.evaluate||ya).source+"|$","g"),p="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++Sa+"]")+"\n";o.replace(d,function(t,e,i,n,s,r){return i=i||n,u+=o.slice(h,r).replace(ba,ml),e&&(a=!0,u+="' +\n__e("+e+") +\n'"),s&&(l=!0,u+="';\n"+s+";\n__p += '"),i&&(u+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),h=r+t.length,t}),u+="';\n";var g=t.variable;g||(u="with (obj) {\n"+u+"\n}\n"),u=(l?u.replace(Ro,""):u).replace(Vo,"$1").replace(Zo,"$1;"),u="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(l?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+u+"return __p\n}";var f=Tr(function(){return m(s,p+"return "+u).apply(no,r)});if(f.source=u,Ms(f))throw f;return f},gt.times=function(t,e){if((t=Fs(t))<1||lo<t)return[];var i=co,n=U(t,co);e=ji(e),t-=co;for(var s=ll(n,e);++i<t;)e(i);return s},gt.toFinite=Hs,gt.toInteger=Fs,gt.toLength=Us,gt.toLower=function(t){return $s(t).toLowerCase()},gt.toNumber=Xs,gt.toSafeInteger=function(t){return t?Ot(Fs(t),-lo,lo):0===t?t:0},gt.toString=$s,gt.toUpper=function(t){return $s(t).toUpperCase()},gt.trim=function(t,e,i){if((t=$s(t))&&(i||e===no))return t.replace(ia,"");if(!t||!(e=Be(e)))return t;var n=xl(t),s=xl(e);return $e(n,dl(n,s),pl(n,s)+1).join("")},gt.trimEnd=function(t,e,i){if((t=$s(t))&&(i||e===no))return t.replace(sa,"");if(!t||!(e=Be(e)))return t;var n=xl(t);return $e(n,0,pl(n,xl(e))+1).join("")},gt.trimStart=function(t,e,i){if((t=$s(t))&&(i||e===no))return t.replace(na,"");if(!t||!(e=Be(e)))return t;var n=xl(t);return $e(n,dl(n,xl(e))).join("")},gt.truncate=function(t,e){var i=30,n="...";if(Ds(e)){var s="separator"in e?e.separator:s;i="length"in e?Fs(e.length):i,n="omission"in e?Be(e.omission):n}var r=(t=$s(t)).length;if(vl(t)){var o=xl(t);r=o.length}if(r<=i)return t;var a=i-Il(n);if(a<1)return n;var l=o?$e(o,0,a).join(""):t.slice(0,a);if(s===no)return l+n;if(o&&(a+=l.length-a),Gs(s)){if(t.slice(a).search(s)){var h,c=l;for(s.global||(s=v(s.source,$s(ua.exec(s))+"g")),s.lastIndex=0;h=s.exec(c);)var u=h.index;l=l.slice(0,u===no?a:u)}}else if(t.indexOf(Be(s),a)!=a){var d=l.lastIndexOf(s);-1<d&&(l=l.slice(0,d))}return l+n},gt.unescape=function(t){return(t=$s(t))&&Ho.test(t)?t.replace(Wo,Al):t},gt.uniqueId=function(t){var e=++d;return $s(t)+e},gt.upperCase=Pr,gt.upperFirst=Mr,gt.each=$n,gt.eachRight=Kn,gt.first=An,jr(gt,(qr={},Jt(gt,function(t,e){I.call(gt.prototype,e)||(qr[e]=t)}),qr),{chain:!1}),gt.VERSION="4.17.4",Za(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){gt[t].placeholder=gt}),Za(["drop","take"],function(i,n){bt.prototype[i]=function(t){t=t===no?1:F(Fs(t),0);var e=this.__filtered__&&!n?new bt(this):this.clone();return e.__filtered__?e.__takeCount__=U(t,e.__takeCount__):e.__views__.push({size:U(t,co),type:i+(e.__dir__<0?"Right":"")}),e},bt.prototype[i+"Right"]=function(t){return this.reverse()[i](t).reverse()}}),Za(["filter","map","takeWhile"],function(t,e){var i=e+1,n=1==i||3==i;bt.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:ji(t,3),type:i}),e.__filtered__=e.__filtered__||n,e}}),Za(["head","last"],function(t,e){var i="take"+(e?"Right":"");bt.prototype[t]=function(){return this[i](1).value()[0]}}),Za(["initial","tail"],function(t,e){var i="drop"+(e?"":"Right");bt.prototype[t]=function(){return this.__filtered__?new bt(this):this[i](1)}}),bt.prototype.compact=function(){return this.filter(zr)},bt.prototype.find=function(t){return this.filter(t).head()},bt.prototype.findLast=function(t){return this.reverse().find(t)},bt.prototype.invokeMap=Se(function(e,i){return"function"==typeof e?new bt(this):this.map(function(t){return re(t,e,i)})}),bt.prototype.reject=function(t){return this.filter(ps(ji(t)))},bt.prototype.slice=function(t,e){t=Fs(t);var i=this;return i.__filtered__&&(0<t||e<0)?new bt(i):(t<0?i=i.takeRight(-t):t&&(i=i.drop(t)),e!==no&&(i=(e=Fs(e))<0?i.dropRight(-e):i.take(e-t)),i)},bt.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},bt.prototype.toArray=function(){return this.take(co)},Jt(bt.prototype,function(u,t){var d=/^(?:filter|find|map|reject)|While$/.test(t),p=/^(?:head|last)$/.test(t),g=gt[p?"take"+("last"==t?"Right":""):t],f=p||/^find/.test(t);g&&(gt.prototype[t]=function(){function t(t){var e=g.apply(gt,Ja([t],i));return p&&o?e[0]:e}var e=this.__wrapped__,i=p?[1]:arguments,n=e instanceof bt,s=i[0],r=n||Is(e);r&&d&&"function"==typeof s&&1!=s.length&&(n=r=!1);var o=this.__chain__,a=!!this.__actions__.length,l=f&&!o,h=n&&!a;if(f||!r)return l&&h?u.apply(this,i):(c=this.thru(t),l?p?c.value()[0]:c.value():c);e=h?e:new bt(this);var c=u.apply(e,i);return c.__actions__.push({func:Hn,args:[t],thisArg:no}),new yt(c,o)})}),Za(["pop","push","shift","sort","splice","unshift"],function(t){var i=o[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",s=/^(?:pop|shift)$/.test(t);gt.prototype[t]=function(){var e=arguments;if(!s||this.__chain__)return this[n](function(t){return i.apply(Is(t)?t:[],e)});var t=this.value();return i.apply(Is(t)?t:[],e)}}),Jt(bt.prototype,function(t,e){var i=gt[e];if(i){var n=i.name+"";(rt[n]||(rt[n]=[])).push({name:e,func:i})}}),rt[mi(no,2).name]=[{name:"wrapper",func:no}],bt.prototype.clone=function(){var t=new bt(this.__wrapped__);return t.__actions__=si(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=si(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=si(this.__views__),t},bt.prototype.reverse=function(){if(this.__filtered__){var t=new bt(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},bt.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,i=Is(t),n=e<0,s=i?t.length:0,r=function(t,e,i){var n=-1,s=i.length;for(;++n<s;){var r=i[n],o=r.size;switch(r.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=U(e,t+o);break;case"takeRight":t=F(t,e-o)}}return{start:t,end:e}}(0,s,this.__views__),o=r.start,a=r.end,l=a-o,h=n?a:o-1,c=this.__iteratees__,u=c.length,d=0,p=U(l,this.__takeCount__);if(!i||!n&&s==l&&p==l)return We(t,this.__actions__);var g=[];t:for(;l--&&d<p;){for(var f=-1,m=t[h+=e];++f<u;){var v=c[f],y=v.iteratee,b=v.type,w=y(m);if(2==b)m=w;else if(!w){if(1==b)continue t;break t}}g[d++]=m}return g},gt.prototype.at=Fn,gt.prototype.chain=function(){return Yn(this)},gt.prototype.commit=function(){return new yt(this.value(),this.__chain__)},gt.prototype.next=function(){this.__values__===no&&(this.__values__=Ys(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?no:this.__values__[this.__index__++]}},gt.prototype.plant=function(t){for(var e,i=this;i instanceof vt;){var n=vn(i);n.__index__=0,n.__values__=no,e?s.__wrapped__=n:e=n;var s=n;i=i.__wrapped__}return s.__wrapped__=t,e},gt.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof bt){var e=t;return this.__actions__.length&&(e=new bt(this)),(e=e.reverse()).__actions__.push({func:Hn,args:[Dn],thisArg:no}),new yt(e,this.__chain__)}return this.thru(Dn)},gt.prototype.toJSON=gt.prototype.valueOf=gt.prototype.value=function(){return We(this.__wrapped__,this.__actions__)},gt.prototype.first=gt.prototype.head,E&&(gt.prototype[E]=function(){return this}),gt}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Ta._=Sl,define(function(){return Sl})):O?((O.exports=Sl)._=Sl,z._=Sl):Ta._=Sl}.call(this),function(n){var s="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(t,e,i){s.Backbone=n(s,i,t,e)});else if("undefined"!=typeof exports){var t,e=require("underscore");try{t=require("jquery")}catch(t){}n(s,exports,e,t)}else s.Backbone=n(s,{},s._,s.jQuery||s.Zepto||s.ender||s.$)}(function(t,l,C,e){var i=t.Backbone,o=Array.prototype.slice;l.VERSION="1.4.0",l.$=e,l.noConflict=function(){return t.Backbone=i,this},l.emulateHTTP=!1,l.emulateJSON=!1;var a,n=l.Events={},h=/\s+/,c=function(t,e,i,n,s){var r,o=0;if(i&&"object"==typeof i){void 0!==n&&"context"in s&&void 0===s.context&&(s.context=n);for(r=C.keys(i);o<r.length;o++)e=c(t,e,r[o],i[r[o]],s)}else if(i&&h.test(i))for(r=i.split(h);o<r.length;o++)e=t(e,r[o],n,s);else e=t(e,i,n,s);return e};n.on=function(t,e,i){this._events=c(s,this._events||{},t,e,{context:i,ctx:this,listening:a}),a&&(((this._listeners||(this._listeners={}))[a.id]=a).interop=!1);return this},n.listenTo=function(t,e,i){if(!t)return this;var n=t._listenId||(t._listenId=C.uniqueId("l")),s=this._listeningTo||(this._listeningTo={}),r=a=s[n];r||(this._listenId||(this._listenId=C.uniqueId("l")),r=a=s[n]=new f(this,t));var o=u(t,e,i,this);if(a=void 0,o)throw o;return r.interop&&r.on(e,i),this};var s=function(t,e,i,n){if(i){var s=t[e]||(t[e]=[]),r=n.context,o=n.ctx,a=n.listening;a&&a.count++,s.push({callback:i,context:r,ctx:r||o,listening:a})}return t},u=function(t,e,i,n){try{t.on(e,i,n)}catch(t){return t}};n.off=function(t,e,i){return this._events&&(this._events=c(r,this._events,t,e,{context:i,listeners:this._listeners})),this},n.stopListening=function(t,e,i){var n=this._listeningTo;if(!n)return this;for(var s=t?[t._listenId]:C.keys(n),r=0;r<s.length;r++){var o=n[s[r]];if(!o)break;o.obj.off(e,i,this),o.interop&&o.off(e,i)}return C.isEmpty(n)&&(this._listeningTo=void 0),this};var r=function(t,e,i,n){if(t){var s,r=n.context,o=n.listeners,a=0;if(e||r||i){for(s=e?[e]:C.keys(t);a<s.length;a++){var l=t[e=s[a]];if(!l)break;for(var h=[],c=0;c<l.length;c++){var u=l[c];if(i&&i!==u.callback&&i!==u.callback._callback||r&&r!==u.context)h.push(u);else{var d=u.listening;d&&d.off(e,i)}}h.length?t[e]=h:delete t[e]}return t}for(s=C.keys(o);a<s.length;a++)o[s[a]].cleanup()}};n.once=function(t,e,i){var n=c(d,{},t,e,this.off.bind(this));return"string"==typeof t&&null==i&&(e=void 0),this.on(n,e,i)},n.listenToOnce=function(t,e,i){var n=c(d,{},e,i,this.stopListening.bind(this,t));return this.listenTo(t,n)};var d=function(t,e,i,n){if(i){var s=t[e]=C.once(function(){n(e,s),i.apply(this,arguments)});s._callback=i}return t};n.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),i=Array(e),n=0;n<e;n++)i[n]=arguments[n+1];return c(p,this._events,t,void 0,i),this};var p=function(t,e,i,n){if(t){var s=t[e],r=t.all;s&&r&&(r=r.slice()),s&&g(s,n),r&&g(r,[e].concat(n))}return t},g=function(t,e){var i,n=-1,s=t.length,r=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++n<s;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r);return;case 2:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,o);return;case 3:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,o,a);return;default:for(;++n<s;)(i=t[n]).callback.apply(i.ctx,e);return}},f=function(t,e){this.id=t._listenId,this.listener=t,this.obj=e,this.interop=!0,this.count=0,this._events=void 0};f.prototype.on=n.on,f.prototype.off=function(t,e){(this.interop?(this._events=c(r,this._events,t,e,{context:void 0,listeners:void 0}),this._events):(this.count--,0!==this.count))||this.cleanup()},f.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},n.bind=n.on,n.unbind=n.off,C.extend(l,n);var m=l.Model=function(t,e){var i=t||{};e=e||{},this.preinitialize.apply(this,arguments),this.cid=C.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{});var n=C.result(this,"defaults");i=C.defaults(C.extend({},n,i),n),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};C.extend(m.prototype,n,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(t){return C.clone(this.attributes)},sync:function(){return l.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return C.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!C.iteratee(t,this)(this.attributes)},set:function(t,e,i){if(null==t)return this;var n;if("object"==typeof t?(n=t,i=e):(n={})[t]=e,i=i||{},!this._validate(n,i))return!1;var s=i.unset,r=i.silent,o=[],a=this._changing;this._changing=!0,a||(this._previousAttributes=C.clone(this.attributes),this.changed={});var l=this.attributes,h=this.changed,c=this._previousAttributes;for(var u in n)e=n[u],C.isEqual(l[u],e)||o.push(u),C.isEqual(c[u],e)?delete h[u]:h[u]=e,s?delete l[u]:l[u]=e;if(this.idAttribute in n&&(this.id=this.get(this.idAttribute)),!r){o.length&&(this._pending=i);for(var d=0;d<o.length;d++)this.trigger("change:"+o[d],this,l[o[d]],i)}if(a)return this;if(!r)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,C.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,C.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!C.isEmpty(this.changed):C.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&C.clone(this.changed);var e,i=this._changing?this._previousAttributes:this.attributes,n={};for(var s in t){var r=t[s];C.isEqual(i[s],r)||(n[s]=r,e=!0)}return!!e&&n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return C.clone(this._previousAttributes)},fetch:function(i){i=C.extend({parse:!0},i);var n=this,s=i.success;return i.success=function(t){var e=i.parse?n.parse(t,i):t;if(!n.set(e,i))return!1;s&&s.call(i.context,n,t,i),n.trigger("sync",n,t,i)},Y(this,i),this.sync("read",this,i)},save:function(t,e,i){var n;null==t||"object"==typeof t?(n=t,i=e):(n={})[t]=e;var s=(i=C.extend({validate:!0,parse:!0},i)).wait;if(n&&!s){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;var r=this,o=i.success,a=this.attributes;i.success=function(t){r.attributes=a;var e=i.parse?r.parse(t,i):t;if(s&&(e=C.extend({},n,e)),e&&!r.set(e,i))return!1;o&&o.call(i.context,r,t,i),r.trigger("sync",r,t,i)},Y(this,i),n&&s&&(this.attributes=C.extend({},a,n));var l=this.isNew()?"create":i.patch?"patch":"update";"patch"!=l||i.attrs||(i.attrs=n);var h=this.sync(l,this,i);return this.attributes=a,h},destroy:function(e){e=e?C.clone(e):{};function i(){n.stopListening(),n.trigger("destroy",n,n.collection,e)}var n=this,s=e.success,r=e.wait,t=!(e.success=function(t){r&&i(),s&&s.call(e.context,n,t,e),n.isNew()||n.trigger("sync",n,t,e)});return this.isNew()?C.defer(e.success):(Y(this,e),t=this.sync("delete",this,e)),r||i(),t},url:function(){var t=C.result(this,"urlRoot")||C.result(this.collection,"url")||W();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},C.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=C.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,C.extend(e,{validationError:i})),!1)}});function I(t,e,i){i=Math.min(Math.max(i,0),t.length);var n,s=Array(t.length-i),r=e.length;for(n=0;n<s.length;n++)s[n]=t[n+i];for(n=0;n<r;n++)t[n+i]=e[n];for(n=0;n<s.length;n++)t[n+r+i]=s[n]}var v=l.Collection=function(t,e){e=e||{},this.preinitialize.apply(this,arguments),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,C.extend({silent:!0},e))},x={add:!0,remove:!0,merge:!0},y={add:!0,remove:!1};C.extend(v.prototype,n,{model:m,preinitialize:function(){},initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return l.sync.apply(this,arguments)},add:function(t,e){return this.set(t,C.extend({merge:!1},e,y))},remove:function(t,e){e=C.extend({},e);var i=!C.isArray(t);t=i?[t]:t.slice();var n=this._removeModels(t,e);return!e.silent&&n.length&&(e.changes={added:[],merged:[],removed:n},this.trigger("update",this,e)),i?n[0]:n},set:function(t,e){if(null!=t){(e=C.extend({},x,e)).parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);var i=!C.isArray(t);t=i?[t]:t.slice();var n=e.at;null!=n&&(n=+n),n>this.length&&(n=this.length),n<0&&(n+=this.length+1);var s,r,o=[],a=[],l=[],h=[],c={},u=e.add,d=e.merge,p=e.remove,g=!1,f=this.comparator&&null==n&&!1!==e.sort,m=C.isString(this.comparator)?this.comparator:null;for(r=0;r<t.length;r++){s=t[r];var v=this.get(s);if(v){if(d&&s!==v){var y=this._isModel(s)?s.attributes:s;e.parse&&(y=v.parse(y,e)),v.set(y,e),l.push(v),f&&!g&&(g=v.hasChanged(m))}c[v.cid]||(c[v.cid]=!0,o.push(v)),t[r]=v}else u&&(s=t[r]=this._prepareModel(s,e))&&(a.push(s),this._addReference(s,e),c[s.cid]=!0,o.push(s))}if(p){for(r=0;r<this.length;r++)c[(s=this.models[r]).cid]||h.push(s);h.length&&this._removeModels(h,e)}var b=!1,w=!f&&u&&p;if(o.length&&w?(b=this.length!==o.length||C.some(this.models,function(t,e){return t!==o[e]}),this.models.length=0,I(this.models,o,0),this.length=this.models.length):a.length&&(f&&(g=!0),I(this.models,a,null==n?this.length:n),this.length=this.models.length),g&&this.sort({silent:!0}),!e.silent){for(r=0;r<a.length;r++)null!=n&&(e.index=n+r),(s=a[r]).trigger("add",s,this,e);(g||b)&&this.trigger("sort",this,e),(a.length||h.length||l.length)&&(e.changes={added:a,removed:h,merged:l},this.trigger("update",this,e))}return i?t[0]:t}},reset:function(t,e){e=e?C.clone(e):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,C.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,C.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,C.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(this._isModel(t)?t.attributes:t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t=t||{};var i=e.length;return C.isFunction(e)&&(e=e.bind(this)),1===i||C.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(i){var n=(i=C.extend({parse:!0},i)).success,s=this;return i.success=function(t){var e=i.reset?"reset":"set";s[e](t,i),n&&n.call(i.context,s,t,i),s.trigger("sync",s,t,i)},Y(this,i),this.sync("read",this,i)},create:function(t,e){var n=(e=e?C.clone(e):{}).wait;if(!(t=this._prepareModel(t,e)))return!1;n||this.add(t,e);var s=this,r=e.success;return e.success=function(t,e,i){n&&s.add(t,i),r&&r.call(i.context,t,e,i)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},values:function(){return new w(this,A)},keys:function(){return new w(this,S)},entries:function(){return new w(this,_)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;var i=new(((e=e?C.clone(e):{}).collection=this).model)(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_removeModels:function(t,e){for(var i=[],n=0;n<t.length;n++){var s=this.get(t[n]);if(s){var r=this.indexOf(s);this.models.splice(r,1),this.length--,delete this._byId[s.cid];var o=this.modelId(s.attributes);null!=o&&delete this._byId[o],e.silent||(e.index=r,s.trigger("remove",s,this,e)),i.push(s),this._removeReference(s,e)}}return i},_isModel:function(t){return t instanceof m},_addReference:function(t,e){this._byId[t.cid]=t;var i=this.modelId(t.attributes);null!=i&&(this._byId[i]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var i=this.modelId(t.attributes);null!=i&&delete this._byId[i],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){if(e){if(("add"===t||"remove"===t)&&i!==this)return;if("destroy"===t&&this.remove(e,n),"change"===t){var s=this.modelId(e.previousAttributes()),r=this.modelId(e.attributes);s!==r&&(null!=s&&delete this._byId[s],null!=r&&(this._byId[r]=e))}}this.trigger.apply(this,arguments)}});var b="function"==typeof Symbol&&Symbol.iterator;b&&(v.prototype[b]=v.prototype.values);var w=function(t,e){this._collection=t,this._kind=e,this._index=0},A=1,S=2,_=3;b&&(w.prototype[b]=function(){return this}),w.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var t,e=this._collection.at(this._index);if(this._index++,this._kind===A)t=e;else{var i=this._collection.modelId(e.attributes);t=this._kind===S?i:[i,e]}return{value:t,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var P=l.View=function(t){this.cid=C.uniqueId("view"),this.preinitialize.apply(this,arguments),C.extend(this,C.pick(t,k)),this._ensureElement(),this.initialize.apply(this,arguments)},M=/^(\S+)\s*(.*)$/,k=["model","collection","el","id","attributes","className","tagName","events"];C.extend(P.prototype,n,{tagName:"div",$:function(t){return this.$el.find(t)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof l.$?t:l.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(!(t=t||C.result(this,"events")))return this;for(var e in this.undelegateEvents(),t){var i=t[e];if(C.isFunction(i)||(i=this[i]),i){var n=e.match(M);this.delegate(n[1],n[2],i.bind(this))}}return this},delegate:function(t,e,i){return this.$el.on(t+".delegateEvents"+this.cid,e,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,i){return this.$el.off(t+".delegateEvents"+this.cid,e,i),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(C.result(this,"el"));else{var t=C.extend({},C.result(this,"attributes"));this.id&&(t.id=C.result(this,"id")),this.className&&(t.class=C.result(this,"className")),this.setElement(this._createElement(C.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}});function T(i,n,t,s){C.each(t,function(t,e){n[e]&&(i.prototype[e]=function(n,t,s,r){switch(t){case 1:return function(){return n[s](this[r])};case 2:return function(t){return n[s](this[r],t)};case 3:return function(t,e){return n[s](this[r],N(t,this),e)};case 4:return function(t,e,i){return n[s](this[r],N(t,this),e,i)};default:return function(){var t=o.call(arguments);return t.unshift(this[r]),n[s].apply(n,t)}}}(n,t,e,s))})}var N=function(e,t){return C.isFunction(e)?e:C.isObject(e)&&!t._isModel(e)?D(e):C.isString(e)?function(t){return t.get(e)}:e},D=function(t){var e=C.matches(t);return function(t){return e(t.attributes)}};C.each([[v,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models"],[m,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes"]],function(t){var i=t[0],e=t[1],n=t[2];i.mixin=function(t){var e=C.reduce(C.functions(t),function(t,e){return t[e]=0,t},{});T(i,t,e,n)},T(i,C,e,n)}),l.sync=function(t,e,n){var i=E[t];C.defaults(n=n||{},{emulateHTTP:l.emulateHTTP,emulateJSON:l.emulateJSON});var s={type:i,dataType:"json"};if(n.url||(s.url=C.result(e,"url")||W()),null!=n.data||!e||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(n.attrs||e.toJSON(n))),n.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),n.emulateHTTP&&("PUT"===i||"DELETE"===i||"PATCH"===i)){s.type="POST",n.emulateJSON&&(s.data._method=i);var r=n.beforeSend;n.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",i),r)return r.apply(this,arguments)}}"GET"===s.type||n.emulateJSON||(s.processData=!1);var o=n.error;n.error=function(t,e,i){n.textStatus=e,n.errorThrown=i,o&&o.call(n.context,t,e,i)};var a=n.xhr=l.ajax(C.extend(s,n));return e.trigger("request",e,a,n),a};var E={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};l.ajax=function(){return l.$.ajax.apply(l.$,arguments)};var L=l.Router=function(t){t=t||{},this.preinitialize.apply(this,arguments),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},z=/\((.*?)\)/g,O=/(\(\?)?:\w+/g,G=/\*\w+/g,B=/[\-{}\[\]+?.,\\\^$|#\s]/g;C.extend(L.prototype,n,{preinitialize:function(){},initialize:function(){},route:function(i,n,s){C.isRegExp(i)||(i=this._routeToRegExp(i)),C.isFunction(n)&&(s=n,n=""),s=s||this[n];var r=this;return l.history.route(i,function(t){var e=r._extractParameters(i,t);!1!==r.execute(s,e,n)&&(r.trigger.apply(r,["route:"+n].concat(e)),r.trigger("route",n,e),l.history.trigger("route",r,n,e))}),this},execute:function(t,e,i){t&&t.apply(this,e)},navigate:function(t,e){return l.history.navigate(t,e),this},_bindRoutes:function(){if(this.routes){this.routes=C.result(this,"routes");for(var t,e=C.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(B,"\\$&").replace(z,"(?:$1)?").replace(O,function(t,e){return e?t:"([^/?]+)"}).replace(G,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return C.map(i,function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})}});var j=l.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},R=/^[#\/]|\s+$/g,V=/^\/+|\/+$/g,Z=/#.*$/;j.started=!1,C.extend(j.prototype,n,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(R,"")},start:function(t){if(j.started)throw new Error("Backbone.history has already been started");if(j.started=!0,this.options=C.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||7<document.documentMode),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(V,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,n=i.insertBefore(this.iframe,i.firstChild).contentWindow;n.document.open(),n.document.close(),n.location.hash="#"+this.fragment}var s=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?s("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?s("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),j.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),C.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0}))},navigate:function(t,e){if(!j.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var i=this.root;""!==t&&"?"!==t.charAt(0)||(i=i.slice(0,-1)||"/");var n=i+t;t=t.replace(Z,"");var s=this.decodeFragment(t);if(this.fragment!==s){if(this.fragment=s,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var r=this.iframe.contentWindow;e.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),l.history=new j;m.extend=v.extend=L.extend=P.extend=j.extend=function(t,e){var i,n=this;return i=t&&C.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},C.extend(i,n,e),i.prototype=C.create(n.prototype,t),(i.prototype.constructor=i).__super__=n.prototype,i};var W=function(){throw new Error('A "url" property or function must be specified')},Y=function(e,i){var n=i.error;i.error=function(t){n&&n.call(i.context,e,t,i),e.trigger("error",e,t,i)}};return l}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("backbone"),require("lodash"),require("jquery")):"function"==typeof define&&define.amd?define(["exports","backbone","lodash","jquery"],e):e((t=t||self).joint={},t.Backbone,t._,t.$)}(this,function(e,o,i,P){"use strict";function c(t){return"function"==typeof t||"[object Function]"===n.call(t)}function u(t){var e,i=(e=Number(t),isNaN(e)?0:0!==e&&isFinite(e)?(0<e?1:-1)*Math.floor(Math.abs(e)):e);return Math.min(Math.max(i,0),s)}var n,s;function r(t,e){return this.slice(t,e)}function a(t,e){arguments.length<2&&(e=0);for(var i=0,n=t.length;i<n;++i,++e)this[e]=255&t[i]}function t(t){var e;if("number"==typeof t){e=new Array(t);for(var i=0;i<t;++i)e[i]=0}else e=t.slice(0);return e.subarray=r,(e.buffer=e).byteLength=e.length,e.set=a,"object"==typeof t&&t.buffer&&(e.buffer=t.buffer),e}o=o&&o.hasOwnProperty("default")?o.default:o,i=i&&i.hasOwnProperty("default")?i.default:i,P=P&&P.hasOwnProperty("default")?P.default:P,"undefined"==typeof window||"SVGPathSeg"in window||(window.SVGPathSeg=function(t,e,i){this.pathSegType=t,this.pathSegTypeAsLetter=e,this._owningPathSegList=i},window.SVGPathSeg.prototype.classname="SVGPathSeg",window.SVGPathSeg.PATHSEG_UNKNOWN=0,window.SVGPathSeg.PATHSEG_CLOSEPATH=1,window.SVGPathSeg.PATHSEG_MOVETO_ABS=2,window.SVGPathSeg.PATHSEG_MOVETO_REL=3,window.SVGPathSeg.PATHSEG_LINETO_ABS=4,window.SVGPathSeg.PATHSEG_LINETO_REL=5,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS=6,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL=7,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS=8,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL=9,window.SVGPathSeg.PATHSEG_ARC_ABS=10,window.SVGPathSeg.PATHSEG_ARC_REL=11,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS=12,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL=13,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS=14,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL=15,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS=16,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL=17,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS=18,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL=19,window.SVGPathSeg.prototype._segmentChanged=function(){this._owningPathSegList&&this._owningPathSegList.segmentChanged(this)},window.SVGPathSegClosePath=function(t){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CLOSEPATH,"z",t)},window.SVGPathSegClosePath.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegClosePath.prototype.toString=function(){return"[object SVGPathSegClosePath]"},window.SVGPathSegClosePath.prototype._asPathString=function(){return this.pathSegTypeAsLetter},window.SVGPathSegClosePath.prototype.clone=function(){return new window.SVGPathSegClosePath(void 0)},window.SVGPathSegMovetoAbs=function(t,e,i){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_MOVETO_ABS,"M",t),this._x=e,this._y=i},window.SVGPathSegMovetoAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegMovetoAbs.prototype.toString=function(){return"[object SVGPathSegMovetoAbs]"},window.SVGPathSegMovetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegMovetoAbs.prototype.clone=function(){return new window.SVGPathSegMovetoAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegMovetoAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegMovetoAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegMovetoRel=function(t,e,i){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_MOVETO_REL,"m",t),this._x=e,this._y=i},window.SVGPathSegMovetoRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegMovetoRel.prototype.toString=function(){return"[object SVGPathSegMovetoRel]"},window.SVGPathSegMovetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegMovetoRel.prototype.clone=function(){return new window.SVGPathSegMovetoRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegMovetoRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegMovetoRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoAbs=function(t,e,i){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_ABS,"L",t),this._x=e,this._y=i},window.SVGPathSegLinetoAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoAbs.prototype.toString=function(){return"[object SVGPathSegLinetoAbs]"},window.SVGPathSegLinetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegLinetoAbs.prototype.clone=function(){return new window.SVGPathSegLinetoAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegLinetoAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegLinetoAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoRel=function(t,e,i){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_REL,"l",t),this._x=e,this._y=i},window.SVGPathSegLinetoRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoRel.prototype.toString=function(){return"[object SVGPathSegLinetoRel]"},window.SVGPathSegLinetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegLinetoRel.prototype.clone=function(){return new window.SVGPathSegLinetoRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegLinetoRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegLinetoRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicAbs=function(t,e,i,n,s,r,o){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS,"C",t),this._x=e,this._y=i,this._x1=n,this._y1=s,this._x2=r,this._y2=o},window.SVGPathSegCurvetoCubicAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicAbs]"},window.SVGPathSegCurvetoCubicAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicAbs(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicRel=function(t,e,i,n,s,r,o){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL,"c",t),this._x=e,this._y=i,this._x1=n,this._y1=s,this._x2=r,this._y2=o},window.SVGPathSegCurvetoCubicRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicRel]"},window.SVGPathSegCurvetoCubicRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicRel.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicRel(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticAbs=function(t,e,i,n,s){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS,"Q",t),this._x=e,this._y=i,this._x1=n,this._y1=s},window.SVGPathSegCurvetoQuadraticAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticAbs]"},window.SVGPathSegCurvetoQuadraticAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticAbs(void 0,this._x,this._y,this._x1,this._y1)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticRel=function(t,e,i,n,s){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL,"q",t),this._x=e,this._y=i,this._x1=n,this._y1=s},window.SVGPathSegCurvetoQuadraticRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticRel]"},window.SVGPathSegCurvetoQuadraticRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticRel.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticRel(void 0,this._x,this._y,this._x1,this._y1)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegArcAbs=function(t,e,i,n,s,r,o,a){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_ARC_ABS,"A",t),this._x=e,this._y=i,this._r1=n,this._r2=s,this._angle=r,this._largeArcFlag=o,this._sweepFlag=a},window.SVGPathSegArcAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegArcAbs.prototype.toString=function(){return"[object SVGPathSegArcAbs]"},window.SVGPathSegArcAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y},window.SVGPathSegArcAbs.prototype.clone=function(){return new window.SVGPathSegArcAbs(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)},Object.defineProperty(window.SVGPathSegArcAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"r1",{get:function(){return this._r1},set:function(t){this._r1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"r2",{get:function(){return this._r2},set:function(t){this._r2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(t){this._largeArcFlag=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(t){this._sweepFlag=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegArcRel=function(t,e,i,n,s,r,o,a){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_ARC_REL,"a",t),this._x=e,this._y=i,this._r1=n,this._r2=s,this._angle=r,this._largeArcFlag=o,this._sweepFlag=a},window.SVGPathSegArcRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegArcRel.prototype.toString=function(){return"[object SVGPathSegArcRel]"},window.SVGPathSegArcRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y},window.SVGPathSegArcRel.prototype.clone=function(){return new window.SVGPathSegArcRel(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)},Object.defineProperty(window.SVGPathSegArcRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"r1",{get:function(){return this._r1},set:function(t){this._r1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"r2",{get:function(){return this._r2},set:function(t){this._r2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(t){this._largeArcFlag=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(t){this._sweepFlag=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoHorizontalAbs=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS,"H",t),this._x=e},window.SVGPathSegLinetoHorizontalAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoHorizontalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalAbs]"},window.SVGPathSegLinetoHorizontalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x},window.SVGPathSegLinetoHorizontalAbs.prototype.clone=function(){return new window.SVGPathSegLinetoHorizontalAbs(void 0,this._x)},Object.defineProperty(window.SVGPathSegLinetoHorizontalAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoHorizontalRel=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL,"h",t),this._x=e},window.SVGPathSegLinetoHorizontalRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoHorizontalRel.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalRel]"},window.SVGPathSegLinetoHorizontalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x},window.SVGPathSegLinetoHorizontalRel.prototype.clone=function(){return new window.SVGPathSegLinetoHorizontalRel(void 0,this._x)},Object.defineProperty(window.SVGPathSegLinetoHorizontalRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoVerticalAbs=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS,"V",t),this._y=e},window.SVGPathSegLinetoVerticalAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoVerticalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalAbs]"},window.SVGPathSegLinetoVerticalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y},window.SVGPathSegLinetoVerticalAbs.prototype.clone=function(){return new window.SVGPathSegLinetoVerticalAbs(void 0,this._y)},Object.defineProperty(window.SVGPathSegLinetoVerticalAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoVerticalRel=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL,"v",t),this._y=e},window.SVGPathSegLinetoVerticalRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoVerticalRel.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalRel]"},window.SVGPathSegLinetoVerticalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y},window.SVGPathSegLinetoVerticalRel.prototype.clone=function(){return new window.SVGPathSegLinetoVerticalRel(void 0,this._y)},Object.defineProperty(window.SVGPathSegLinetoVerticalRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicSmoothAbs=function(t,e,i,n,s){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS,"S",t),this._x=e,this._y=i,this._x2=n,this._y2=s},window.SVGPathSegCurvetoCubicSmoothAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothAbs]"},window.SVGPathSegCurvetoCubicSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicSmoothAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicSmoothAbs(void 0,this._x,this._y,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicSmoothRel=function(t,e,i,n,s){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL,"s",t),this._x=e,this._y=i,this._x2=n,this._y2=s},window.SVGPathSegCurvetoCubicSmoothRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothRel]"},window.SVGPathSegCurvetoCubicSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicSmoothRel.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicSmoothRel(void 0,this._x,this._y,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticSmoothAbs=function(t,e,i){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS,"T",t),this._x=e,this._y=i},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothAbs]"},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticSmoothAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticSmoothRel=function(t,e,i){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL,"t",t),this._x=e,this._y=i},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothRel]"},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticSmoothRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathElement.prototype.createSVGPathSegClosePath=function(){return new window.SVGPathSegClosePath(void 0)},window.SVGPathElement.prototype.createSVGPathSegMovetoAbs=function(t,e){return new window.SVGPathSegMovetoAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegMovetoRel=function(t,e){return new window.SVGPathSegMovetoRel(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegLinetoAbs=function(t,e){return new window.SVGPathSegLinetoAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegLinetoRel=function(t,e){return new window.SVGPathSegLinetoRel(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicAbs=function(t,e,i,n,s,r){return new window.SVGPathSegCurvetoCubicAbs(void 0,t,e,i,n,s,r)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicRel=function(t,e,i,n,s,r){return new window.SVGPathSegCurvetoCubicRel(void 0,t,e,i,n,s,r)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticAbs=function(t,e,i,n){return new window.SVGPathSegCurvetoQuadraticAbs(void 0,t,e,i,n)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticRel=function(t,e,i,n){return new window.SVGPathSegCurvetoQuadraticRel(void 0,t,e,i,n)},window.SVGPathElement.prototype.createSVGPathSegArcAbs=function(t,e,i,n,s,r,o){return new window.SVGPathSegArcAbs(void 0,t,e,i,n,s,r,o)},window.SVGPathElement.prototype.createSVGPathSegArcRel=function(t,e,i,n,s,r,o){return new window.SVGPathSegArcRel(void 0,t,e,i,n,s,r,o)},window.SVGPathElement.prototype.createSVGPathSegLinetoHorizontalAbs=function(t){return new window.SVGPathSegLinetoHorizontalAbs(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoHorizontalRel=function(t){return new window.SVGPathSegLinetoHorizontalRel(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoVerticalAbs=function(t){return new window.SVGPathSegLinetoVerticalAbs(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoVerticalRel=function(t){return new window.SVGPathSegLinetoVerticalRel(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothAbs=function(t,e,i,n){return new window.SVGPathSegCurvetoCubicSmoothAbs(void 0,t,e,i,n)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothRel=function(t,e,i,n){return new window.SVGPathSegCurvetoCubicSmoothRel(void 0,t,e,i,n)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothAbs=function(t,e){return new window.SVGPathSegCurvetoQuadraticSmoothAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothRel=function(t,e){return new window.SVGPathSegCurvetoQuadraticSmoothRel(void 0,t,e)},"getPathSegAtLength"in window.SVGPathElement.prototype||(window.SVGPathElement.prototype.getPathSegAtLength=function(t){if(void 0===t||!isFinite(t))throw"Invalid arguments.";var e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",this.getAttribute("d"));var i=e.pathSegList.numberOfItems-1;if(i<=0)return 0;do{if(e.pathSegList.removeItem(i),t>e.getTotalLength())break;i--}while(0<i);return i})),"undefined"==typeof window||"SVGPathSegList"in window&&"appendItem"in window.SVGPathSegList.prototype||(window.SVGPathSegList=function(t){this._pathElement=t,this._list=this._parsePath(this._pathElement.getAttribute("d")),this._mutationObserverConfig={attributes:!0,attributeFilter:["d"]},this._pathElementMutationObserver=new MutationObserver(this._updateListFromPathMutations.bind(this)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)},window.SVGPathSegList.prototype.classname="SVGPathSegList",Object.defineProperty(window.SVGPathSegList.prototype,"numberOfItems",{get:function(){return this._checkPathSynchronizedToList(),this._list.length},enumerable:!0}),Object.defineProperty(window.SVGPathSegList.prototype,"length",{get:function(){return this._checkPathSynchronizedToList(),this._list.length},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"pathSegList",{get:function(){return this._pathSegList||(this._pathSegList=new window.SVGPathSegList(this)),this._pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"normalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"animatedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"animatedNormalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),window.SVGPathSegList.prototype._checkPathSynchronizedToList=function(){this._updateListFromPathMutations(this._pathElementMutationObserver.takeRecords())},window.SVGPathSegList.prototype._updateListFromPathMutations=function(t){if(this._pathElement){var e=!1;t.forEach(function(t){"d"==t.attributeName&&(e=!0)}),e&&(this._list=this._parsePath(this._pathElement.getAttribute("d")))}},window.SVGPathSegList.prototype._writeListToPath=function(){this._pathElementMutationObserver.disconnect(),this._pathElement.setAttribute("d",window.SVGPathSegList._pathSegArrayAsString(this._list)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)},window.SVGPathSegList.prototype.segmentChanged=function(t){this._writeListToPath()},window.SVGPathSegList.prototype.clear=function(){this._checkPathSynchronizedToList(),this._list.forEach(function(t){t._owningPathSegList=null}),this._list=[],this._writeListToPath()},window.SVGPathSegList.prototype.initialize=function(t){return this._checkPathSynchronizedToList(),this._list=[t],(t._owningPathSegList=this)._writeListToPath(),t},window.SVGPathSegList.prototype._checkValidIndex=function(t){if(isNaN(t)||t<0||t>=this.numberOfItems)throw"INDEX_SIZE_ERR"},window.SVGPathSegList.prototype.getItem=function(t){return this._checkPathSynchronizedToList(),this._checkValidIndex(t),this._list[t]},window.SVGPathSegList.prototype.insertItemBefore=function(t,e){return this._checkPathSynchronizedToList(),e>this.numberOfItems&&(e=this.numberOfItems),t._owningPathSegList&&(t=t.clone()),this._list.splice(e,0,t),(t._owningPathSegList=this)._writeListToPath(),t},window.SVGPathSegList.prototype.replaceItem=function(t,e){return this._checkPathSynchronizedToList(),t._owningPathSegList&&(t=t.clone()),this._checkValidIndex(e),((this._list[e]=t)._owningPathSegList=this)._writeListToPath(),t},window.SVGPathSegList.prototype.removeItem=function(t){this._checkPathSynchronizedToList(),this._checkValidIndex(t);var e=this._list[t];return this._list.splice(t,1),this._writeListToPath(),e},window.SVGPathSegList.prototype.appendItem=function(t){return this._checkPathSynchronizedToList(),t._owningPathSegList&&(t=t.clone()),this._list.push(t),(t._owningPathSegList=this)._writeListToPath(),t},window.SVGPathSegList._pathSegArrayAsString=function(t){var e="",i=!0;return t.forEach(function(t){i?(i=!1,e+=t._asPathString()):e+=" "+t._asPathString()}),e},window.SVGPathSegList.prototype._parsePath=function(t){if(!t||0==t.length)return[];function e(){this.pathSegList=[]}var n=this;e.prototype.appendSegment=function(t){this.pathSegList.push(t)};function i(t){this._string=t,this._currentIndex=0,this._endIndex=this._string.length,this._previousCommand=window.SVGPathSeg.PATHSEG_UNKNOWN,this._skipOptionalSpaces()}i.prototype._isCurrentSpace=function(){var t=this._string[this._currentIndex];return t<=" "&&(" "==t||"\n"==t||"\t"==t||"\r"==t||"\f"==t)},i.prototype._skipOptionalSpaces=function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex++;return this._currentIndex<this._endIndex},i.prototype._skipOptionalSpacesOrDelimiter=function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!=this._string.charAt(this._currentIndex))&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","==this._string.charAt(this._currentIndex)&&(this._currentIndex++,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},i.prototype.hasMoreData=function(){return this._currentIndex<this._endIndex},i.prototype.peekSegmentType=function(){var t=this._string[this._currentIndex];return this._pathSegTypeFromChar(t)},i.prototype._pathSegTypeFromChar=function(t){switch(t){case"Z":case"z":return window.SVGPathSeg.PATHSEG_CLOSEPATH;case"M":return window.SVGPathSeg.PATHSEG_MOVETO_ABS;case"m":return window.SVGPathSeg.PATHSEG_MOVETO_REL;case"L":return window.SVGPathSeg.PATHSEG_LINETO_ABS;case"l":return window.SVGPathSeg.PATHSEG_LINETO_REL;case"C":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS;case"c":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL;case"Q":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS;case"q":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL;case"A":return window.SVGPathSeg.PATHSEG_ARC_ABS;case"a":return window.SVGPathSeg.PATHSEG_ARC_REL;case"H":return window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS;case"h":return window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL;case"V":return window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS;case"v":return window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL;case"S":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS;case"s":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL;case"T":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS;case"t":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL;default:return window.SVGPathSeg.PATHSEG_UNKNOWN}},i.prototype._nextCommandHelper=function(t,e){return("+"==t||"-"==t||"."==t||"0"<=t&&t<="9")&&e!=window.SVGPathSeg.PATHSEG_CLOSEPATH?e==window.SVGPathSeg.PATHSEG_MOVETO_ABS?window.SVGPathSeg.PATHSEG_LINETO_ABS:e==window.SVGPathSeg.PATHSEG_MOVETO_REL?window.SVGPathSeg.PATHSEG_LINETO_REL:e:window.SVGPathSeg.PATHSEG_UNKNOWN},i.prototype.initialCommandIsMoveTo=function(){if(!this.hasMoreData())return!0;var t=this.peekSegmentType();return t==window.SVGPathSeg.PATHSEG_MOVETO_ABS||t==window.SVGPathSeg.PATHSEG_MOVETO_REL},i.prototype._parseNumber=function(){var t=0,e=0,i=1,n=0,s=1,r=1,o=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"==this._string.charAt(this._currentIndex)?this._currentIndex++:this._currentIndex<this._endIndex&&"-"==this._string.charAt(this._currentIndex)&&(this._currentIndex++,s=-1),!(this._currentIndex==this._endIndex||(this._string.charAt(this._currentIndex)<"0"||"9"<this._string.charAt(this._currentIndex))&&"."!=this._string.charAt(this._currentIndex))){for(var a=this._currentIndex;this._currentIndex<this._endIndex&&"0"<=this._string.charAt(this._currentIndex)&&this._string.charAt(this._currentIndex)<="9";)this._currentIndex++;if(this._currentIndex!=a)for(var l=this._currentIndex-1,h=1;a<=l;)e+=h*(this._string.charAt(l--)-"0"),h*=10;if(this._currentIndex<this._endIndex&&"."==this._string.charAt(this._currentIndex)){if(this._currentIndex++,this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||"9"<this._string.charAt(this._currentIndex))return;for(;this._currentIndex<this._endIndex&&"0"<=this._string.charAt(this._currentIndex)&&this._string.charAt(this._currentIndex)<="9";)i*=10,n+=(this._string.charAt(this._currentIndex)-"0")/i,this._currentIndex+=1}if(this._currentIndex!=o&&this._currentIndex+1<this._endIndex&&("e"==this._string.charAt(this._currentIndex)||"E"==this._string.charAt(this._currentIndex))&&"x"!=this._string.charAt(this._currentIndex+1)&&"m"!=this._string.charAt(this._currentIndex+1)){if(this._currentIndex++,"+"==this._string.charAt(this._currentIndex)?this._currentIndex++:"-"==this._string.charAt(this._currentIndex)&&(this._currentIndex++,r=-1),this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||"9"<this._string.charAt(this._currentIndex))return;for(;this._currentIndex<this._endIndex&&"0"<=this._string.charAt(this._currentIndex)&&this._string.charAt(this._currentIndex)<="9";)t*=10,t+=this._string.charAt(this._currentIndex)-"0",this._currentIndex++}var c=e+n;if(c*=s,t&&(c*=Math.pow(10,r*t)),o!=this._currentIndex)return this._skipOptionalSpacesOrDelimiter(),c}},i.prototype._parseArcFlag=function(){if(!(this._currentIndex>=this._endIndex)){var t=!1,e=this._string.charAt(this._currentIndex++);if("0"==e)t=!1;else{if("1"!=e)return;t=!0}return this._skipOptionalSpacesOrDelimiter(),t}},i.prototype.parseSegment=function(){var t,e=this._string[this._currentIndex],i=this._pathSegTypeFromChar(e);if(i==window.SVGPathSeg.PATHSEG_UNKNOWN){if(this._previousCommand==window.SVGPathSeg.PATHSEG_UNKNOWN)return null;if((i=this._nextCommandHelper(e,this._previousCommand))==window.SVGPathSeg.PATHSEG_UNKNOWN)return null}else this._currentIndex++;switch(this._previousCommand=i){case window.SVGPathSeg.PATHSEG_MOVETO_REL:return new window.SVGPathSegMovetoRel(n,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_MOVETO_ABS:return new window.SVGPathSegMovetoAbs(n,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_REL:return new window.SVGPathSegLinetoRel(n,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_ABS:return new window.SVGPathSegLinetoAbs(n,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:return new window.SVGPathSegLinetoHorizontalRel(n,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:return new window.SVGPathSegLinetoHorizontalAbs(n,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:return new window.SVGPathSegLinetoVerticalRel(n,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:return new window.SVGPathSegLinetoVerticalAbs(n,this._parseNumber());case window.SVGPathSeg.PATHSEG_CLOSEPATH:return this._skipOptionalSpaces(),new window.SVGPathSegClosePath(n);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:return t={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegCurvetoCubicRel(n,t.x,t.y,t.x1,t.y1,t.x2,t.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:return t={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegCurvetoCubicAbs(n,t.x,t.y,t.x1,t.y1,t.x2,t.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:return t={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegCurvetoCubicSmoothRel(n,t.x,t.y,t.x2,t.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:return t={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegCurvetoCubicSmoothAbs(n,t.x,t.y,t.x2,t.y2);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:return t={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegCurvetoQuadraticRel(n,t.x,t.y,t.x1,t.y1);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:return t={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegCurvetoQuadraticAbs(n,t.x,t.y,t.x1,t.y1);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:return new window.SVGPathSegCurvetoQuadraticSmoothRel(n,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:return new window.SVGPathSegCurvetoQuadraticSmoothAbs(n,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_ARC_REL:return t={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegArcRel(n,t.x,t.y,t.x1,t.y1,t.arcAngle,t.arcLarge,t.arcSweep);case window.SVGPathSeg.PATHSEG_ARC_ABS:return t={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()},new window.SVGPathSegArcAbs(n,t.x,t.y,t.x1,t.y1,t.arcAngle,t.arcLarge,t.arcSweep);default:throw"Unknown path seg type."}};var s=new e,r=new i(t);if(!r.initialCommandIsMoveTo())return[];for(;r.hasMoreData();){var o=r.parseSegment();if(!o)return[];s.appendSegment(o)}return s.pathSegList}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0==n)return!1;var s,r,o=0|e,a=Math.max(0<=o?o:n-Math.abs(o),0);for(;a<n;){if((s=i[a])===(r=t)||"number"==typeof s&&"number"==typeof r&&isNaN(s)&&isNaN(r))return!0;a++}return!1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],s=0;s<i;){var r=e[s];if(t.call(n,r,s,e))return r;s++}}}),Array.from||(Array.from=(n=Object.prototype.toString,s=Math.pow(2,53)-1,function(t,e,i){var n=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var s,r=1<arguments.length?e:void 0;if(void 0!==r){if(!c(r))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(s=i)}for(var o,a=u(n.length),l=c(this)?Object(new this(a)):new Array(a),h=0;h<a;)o=n[h],l[h]=r?void 0===s?r(o,h):r.call(s,o,h):o,h+=1;return l.length=a,l})),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],s=0;s<i;){var r=e[s];if(t.call(n,r,s,e))return s;s++}return-1}}),function(){var t=void 0!==e?e:this,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function l(t){this.message=t}(l.prototype=new Error).name="InvalidCharacterError",t.btoa||(t.btoa=function(t){for(var e,i,n=String(t),s=0,r=a,o="";n.charAt(0|s)||(r="=",s%1);o+=r.charAt(63&e>>8-s%1*8)){if(255<(i=n.charCodeAt(s+=.75)))throw new l("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");e=e<<8|i}return o}),t.atob||(t.atob=function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new l("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,n,s=0,r=0,o="";n=e.charAt(r++);~n&&(i=s%4?64*i+n:n,s++%4)&&(o+=String.fromCharCode(255&i>>(-2*s&6))))n=a.indexOf(n);return o})}(),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isNaN=Number.isNaN||function(t){return t!=t},String.prototype.includes||(String.prototype.includes=function(t,e){return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(e||0,t.length)===t}),"undefined"==typeof Uint8Array&&"undefined"!=typeof window&&(window.Uint8Array=t,window.Uint32Array=t,window.Int32Array=t),"undefined"!=typeof XMLHttpRequest&&("response"in XMLHttpRequest.prototype||"mozResponseArrayBuffer"in XMLHttpRequest.prototype||"mozResponse"in XMLHttpRequest.prototype||"responseArrayBuffer"in XMLHttpRequest.prototype||Object.defineProperty(XMLHttpRequest.prototype,"response",{get:function(){return new Uint8Array(new VBArray(this.responseBody).toArray())}}));var l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function h(t){this.ok=!1,this.alpha=1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var c={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=c[t]||t;for(var u=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseFloat(t[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],e=0;e<u.length;e++){var i=u[e].re,n=u[e].process,s=i.exec(t);if(s){var r=n(s);this.r=r[0],this.g=r[1],this.b=r[2],3<r.length&&(this.alpha=r[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:255<this.r?255:this.r,this.g=this.g<0||isNaN(this.g)?0:255<this.g?255:this.g,this.b=this.b<0||isNaN(this.b)?0:255<this.b?255:this.b,this.alpha=this.alpha<0?0:1<this.alpha||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),i=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==i.length&&(i="0"+i),"#"+t+e+i},this.getHelpXML=function(){for(var t=new Array,e=0;e<u.length;e++)for(var i=u[e].example,n=0;n<i.length;n++)t[t.length]=i[n];for(var s in c)t[t.length]=s;var r=document.createElement("ul");r.setAttribute("id","rgbcolor-examples");for(e=0;e<t.length;e++)try{var o=document.createElement("li"),a=new RGBColor(t[e]),l=document.createElement("div");l.style.cssText="margin: 3px; border: 1px solid black; background:"+a.toHex()+"; color:"+a.toHex(),l.appendChild(document.createTextNode("test"));var h=document.createTextNode(" "+t[e]+" -> "+a.toRGB()+" -> "+a.toHex());o.appendChild(l),o.appendChild(h),r.appendChild(o)}catch(t){}return r}}var R=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],Z=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function W(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function d(t,e,i,n){if(!(isNaN(n)||n<1)){var s,r,o,a,l,h,c,u,d,p,g,f,m,v,y,b,w,C,I,x,A,S,_,P,M=(n|=0)+n+1,k=e-1,T=i-1,N=n+1,D=N*(N+1)/2,E=new W,L=E;for(o=1;o<M;o++)if(L=L.next=new W,o==N)var z=L;L.next=E;var O=null,G=null;c=h=0;var B=R[n],j=Z[n];for(r=0;r<i;r++){for(b=w=C=I=u=d=p=g=0,f=N*(x=t[h]),m=N*(A=t[h+1]),v=N*(S=t[h+2]),y=N*(_=t[h+3]),u+=D*x,d+=D*A,p+=D*S,g+=D*_,L=E,o=0;o<N;o++)L.r=x,L.g=A,L.b=S,L.a=_,L=L.next;for(o=1;o<N;o++)a=h+((k<o?k:o)<<2),u+=(L.r=x=t[a])*(P=N-o),d+=(L.g=A=t[a+1])*P,p+=(L.b=S=t[a+2])*P,g+=(L.a=_=t[a+3])*P,b+=x,w+=A,C+=S,I+=_,L=L.next;for(O=E,G=z,s=0;s<e;s++)t[h+3]=_=g*B>>j,0!=_?(_=255/_,t[h]=(u*B>>j)*_,t[h+1]=(d*B>>j)*_,t[h+2]=(p*B>>j)*_):t[h]=t[h+1]=t[h+2]=0,u-=f,d-=m,p-=v,g-=y,f-=O.r,m-=O.g,v-=O.b,y-=O.a,a=c+((a=s+n+1)<k?a:k)<<2,u+=b+=O.r=t[a],d+=w+=O.g=t[a+1],p+=C+=O.b=t[a+2],g+=I+=O.a=t[a+3],O=O.next,f+=x=G.r,m+=A=G.g,v+=S=G.b,y+=_=G.a,b-=x,w-=A,C-=S,I-=_,G=G.next,h+=4;c+=e}for(s=0;s<e;s++){for(w=C=I=b=d=p=g=u=0,f=N*(x=t[h=s<<2]),m=N*(A=t[h+1]),v=N*(S=t[h+2]),y=N*(_=t[h+3]),u+=D*x,d+=D*A,p+=D*S,g+=D*_,L=E,o=0;o<N;o++)L.r=x,L.g=A,L.b=S,L.a=_,L=L.next;for(l=e,o=1;o<=n;o++)h=l+s<<2,u+=(L.r=x=t[h])*(P=N-o),d+=(L.g=A=t[h+1])*P,p+=(L.b=S=t[h+2])*P,g+=(L.a=_=t[h+3])*P,b+=x,w+=A,C+=S,I+=_,L=L.next,o<T&&(l+=e);for(h=s,O=E,G=z,r=0;r<i;r++)t[(a=h<<2)+3]=_=g*B>>j,0<_?(_=255/_,t[a]=(u*B>>j)*_,t[a+1]=(d*B>>j)*_,t[a+2]=(p*B>>j)*_):t[a]=t[a+1]=t[a+2]=0,u-=f,d-=m,p-=v,g-=y,f-=O.r,m-=O.g,v-=O.b,y-=O.a,a=s+((a=r+N)<T?a:T)*e<<2,u+=b+=O.r=t[a],d+=w+=O.g=t[a+1],p+=C+=O.b=t[a+2],g+=I+=O.a=t[a+3],O=O.next,f+=x=G.r,m+=A=G.g,v+=S=G.b,y+=_=G.a,b-=x,w-=A,C-=S,I-=_,G=G.next,h+=e}}}p=f={exports:{}},function(t,e){if(p.exports){var i=h,n=d;p.exports=e(i,n)}t.canvg=e(void 0!==i?i:t.RGBColor,"undefined"!=typeof statckblur?n:t.stackBlur)}("undefined"!=typeof window?window:l,function(c,u){if("undefined"!=typeof Element){var d,p=function(t,e,i){if(null!=t||null!=e||null!=i){"string"==typeof t&&(t=document.getElementById(t)),null!=t.svg&&t.svg.stop();var n=function(t){var D={opts:t,FRAMERATE:30,MAX_VIRTUAL_PIXELS:3e4,log:function(t){}};1==D.opts.log&&"undefined"!=typeof console&&(D.log=function(t){console.log(t)});D.init=function(t){var e=0;D.UniqueId=function(){return"canvg"+ ++e},D.Definitions={},D.Styles={},D.StylesSpecificity={},D.Animations=[],D.Images=[],D.ctx=t,D.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(t,e){this.viewPorts.push({width:t,height:e})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(t){return null!=t&&"number"==typeof t?t:"x"==t?this.width():"y"==t?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},D.init(),D.ImagesLoaded=function(){for(var t=0;t<D.Images.length;t++)if(!D.Images[t].loaded)return!1;return!0},D.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},D.compressSpaces=function(t){return t.replace(/[\s\r\t\n]+/gm," ")},D.ajax=function(t){var e;return(e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"))?(e.open("GET",t,!1),e.send(null),e.responseText):null},D.parseXml=function(e){if("undefined"!=typeof Windows&&void 0!==Windows.Data&&void 0!==Windows.Data.Xml){var t=new Windows.Data.Xml.Dom.XmlDocument,i=new Windows.Data.Xml.Dom.XmlLoadSettings;return i.prohibitDtd=!1,t.loadXml(e,i),t}if(!window.DOMParser)return e=e.replace(/<!DOCTYPE svg[^>]*>/,""),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e),t;try{var n=new DOMParser;return n.parseFromString(e,"image/svg+xml")}catch(t){return(n=new DOMParser).parseFromString(e,"text/xml")}},D.Property=function(t,e){this.name=t,this.value=e},D.Property.prototype.getValue=function(){return this.value},D.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},D.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var t=parseFloat(this.value);return(this.value+"").match(/%$/)&&(t/=100),t},D.Property.prototype.valueOrDefault=function(t){return this.hasValue()?this.value:t},D.Property.prototype.numValueOrDefault=function(t){return this.hasValue()?this.numValue():t},D.Property.prototype.addOpacity=function(t){var e=this.value;if(null!=t.value&&""!=t.value&&"string"==typeof this.value){var i=new c(this.value);i.ok&&(e="rgba("+i.r+", "+i.g+", "+i.b+", "+t.numValue()+")")}return new D.Property(this.name,e)},D.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);return t=(t=t&&t[1])||this.value,D.Definitions[t]},D.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},D.Property.prototype.getFillStyleDefinition=function(t,e){var i=this.getDefinition();if(null!=i&&i.createGradient)return i.createGradient(D.ctx,t,e);if(null!=i&&i.createPattern){if(i.getHrefAttribute().hasValue()){var n=i.attribute("patternTransform");i=i.getHrefAttribute().getDefinition(),n.hasValue()&&(i.attribute("patternTransform",!0).value=n.value)}return i.createPattern(D.ctx,t)}return null},D.Property.prototype.getDPI=function(t){return 96},D.Property.prototype.getEM=function(t){var e=12,i=new D.Property("fontSize",D.Font.Parse(D.ctx.font).fontSize);return i.hasValue()&&(e=i.toPixels(t)),e},D.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},D.Property.prototype.toPixels=function(t,e){if(!this.hasValue())return 0;var i=this.value+"";if(i.match(/em$/))return this.numValue()*this.getEM(t);if(i.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(i.match(/px$/))return this.numValue();if(i.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(i.match(/pc$/))return 15*this.numValue();if(i.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(i.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(i.match(/in$/))return this.numValue()*this.getDPI(t);if(i.match(/%$/))return this.numValue()*D.ViewPort.ComputeSize(t);var n=this.numValue();return e&&n<1?n*D.ViewPort.ComputeSize(t):n},D.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/s$/)?1e3*this.numValue():(t.match(/ms$/),this.numValue())},D.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/deg$/)?this.numValue()*(Math.PI/180):t.match(/grad$/)?this.numValue()*(Math.PI/200):t.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var e={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return D.Property.prototype.toTextBaseline=function(){return this.hasValue()?e[this.value]:null},D.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(t,e,i,n,s,r){var o=null!=r?this.Parse(r):this.CreateFont("","","","","",D.ctx.font);return{fontFamily:s||o.fontFamily,fontSize:n||o.fontSize,fontStyle:t||o.fontStyle,fontWeight:i||o.fontWeight,fontVariant:e||o.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var o=this;this.Parse=function(t){for(var e={},i=D.trim(D.compressSpaces(t||"")).split(" "),n={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},s="",r=0;r<i.length;r++)n.fontStyle||-1==o.Styles.indexOf(i[r])?n.fontVariant||-1==o.Variants.indexOf(i[r])?n.fontWeight||-1==o.Weights.indexOf(i[r])?n.fontSize?"inherit"!=i[r]&&(s+=i[r]):("inherit"!=i[r]&&(e.fontSize=i[r].split("/")[0]),n.fontStyle=n.fontVariant=n.fontWeight=n.fontSize=!0):("inherit"!=i[r]&&(e.fontWeight=i[r]),n.fontStyle=n.fontVariant=n.fontWeight=!0):("inherit"!=i[r]&&(e.fontVariant=i[r]),n.fontStyle=n.fontVariant=!0):("inherit"!=i[r]&&(e.fontStyle=i[r]),n.fontStyle=!0);return""!=s&&(e.fontFamily=s),e}},D.ToNumberArray=function(t){for(var e=D.trim(D.compressSpaces((t||"").replace(/,/g," "))).split(" "),i=0;i<e.length;i++)e[i]=parseFloat(e[i]);return e},D.Point=function(t,e){this.x=t,this.y=e},D.Point.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},D.Point.prototype.applyTransform=function(t){var e=this.x*t[0]+this.y*t[2]+t[4],i=this.x*t[1]+this.y*t[3]+t[5];this.x=e,this.y=i},D.CreatePoint=function(t){var e=D.ToNumberArray(t);return new D.Point(e[0],e[1])},D.CreatePath=function(t){for(var e=D.ToNumberArray(t),i=[],n=0;n<e.length;n+=2)i.push(new D.Point(e[n],e[n+1]));return i},D.BoundingBox=function(t,e,i,n){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(t,e){null!=t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),null!=e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},this.addX=function(t){this.addPoint(t,null)},this.addY=function(t){this.addPoint(null,t)},this.addBoundingBox=function(t){this.addPoint(t.x1,t.y1),this.addPoint(t.x2,t.y2)},this.addQuadraticCurve=function(t,e,i,n,s,r){var o=t+2/3*(i-t),a=e+2/3*(n-e),l=o+1/3*(s-t),h=a+1/3*(r-e);this.addBezierCurve(t,e,o,l,a,h,s,r)},this.addBezierCurve=function(t,e,i,n,s,r,o,a){var l=[t,e],h=[i,n],c=[s,r],u=[o,a];this.addPoint(l[0],l[1]),this.addPoint(u[0],u[1]);for(var d=0;d<=1;d++){var p=function(t){return Math.pow(1-t,3)*l[d]+3*Math.pow(1-t,2)*t*h[d]+3*(1-t)*Math.pow(t,2)*c[d]+Math.pow(t,3)*u[d]},g=6*l[d]-12*h[d]+6*c[d],f=-3*l[d]+9*h[d]-9*c[d]+3*u[d],m=3*h[d]-3*l[d];if(0!=f){var v=Math.pow(g,2)-4*m*f;if(!(v<0)){var y=(-g+Math.sqrt(v))/(2*f);0<y&&y<1&&(0==d&&this.addX(p(y)),1==d&&this.addY(p(y)));var b=(-g-Math.sqrt(v))/(2*f);0<b&&b<1&&(0==d&&this.addX(p(b)),1==d&&this.addY(p(b)))}}else{if(0==g)continue;var w=-m/g;0<w&&w<1&&(0==d&&this.addX(p(w)),1==d&&this.addY(p(w)))}}},this.isPointInBox=function(t,e){return this.x1<=t&&t<=this.x2&&this.y1<=e&&e<=this.y2},this.addPoint(t,e),this.addPoint(i,n)},D.Transform=function(t){var e=this;this.Type={},this.Type.translate=function(t){this.p=D.CreatePoint(t),this.apply=function(t){t.translate(this.p.x||0,this.p.y||0)},this.unapply=function(t){t.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(t){t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(t){var e=D.ToNumberArray(t);this.angle=new D.Property("angle",e[0]),this.cx=e[1]||0,this.cy=e[2]||0,this.apply=function(t){t.translate(this.cx,this.cy),t.rotate(this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.unapply=function(t){t.translate(this.cx,this.cy),t.rotate(-1*this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.applyToPoint=function(t){var e=this.angle.toRadians();t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),t.applyTransform([Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0]),t.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(t){this.p=D.CreatePoint(t),this.apply=function(t){t.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(t){t.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(t){t.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(t){this.m=D.ToNumberArray(t),this.apply=function(t){t.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(t){var e=this.m[0],i=this.m[2],n=this.m[4],s=this.m[1],r=this.m[3],o=this.m[5],a=1/(e*(1*r-0*o)-i*(1*s-0*o)+n*(0*s-0*r));t.transform(a*(1*r-0*o),a*(0*o-1*s),a*(0*n-1*i),a*(1*e-0*n),a*(i*o-n*r),a*(n*s-e*o))},this.applyToPoint=function(t){t.applyTransform(this.m)}},this.Type.SkewBase=function(t){this.base=e.Type.matrix,this.base(t),this.angle=new D.Property("angle",t)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(t)},this.unapply=function(t){for(var e=this.transforms.length-1;0<=e;e--)this.transforms[e].unapply(t)},this.applyToPoint=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].applyToPoint(t)};for(var i=D.trim(D.compressSpaces(t)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),n=0;n<i.length;n++){var s=D.trim(i[n].split("(")[0]),r=i[n].split("(")[1].replace(")",""),o=this.Type[s];if(void 0!==o){var a=new o(r);a.type=s,this.transforms.push(a)}}},D.AspectRatio=function(t,e,i,n,s,r,o,a,l,h){var c=(e=(e=D.compressSpaces(e)).replace(/^defer\s/,"")).split(" ")[0]||"xMidYMid",u=e.split(" ")[1]||"meet",d=i/n,p=s/r,g=Math.min(d,p),f=Math.max(d,p);"meet"==u&&(n*=g,r*=g),"slice"==u&&(n*=f,r*=f),l=new D.Property("refX",l),h=new D.Property("refY",h),l.hasValue()&&h.hasValue()?t.translate(-g*l.toPixels("x"),-g*h.toPixels("y")):(c.match(/^xMid/)&&("meet"==u&&g==p||"slice"==u&&f==p)&&t.translate(i/2-n/2,0),c.match(/YMid$/)&&("meet"==u&&g==d||"slice"==u&&f==d)&&t.translate(0,s/2-r/2),c.match(/^xMax/)&&("meet"==u&&g==p||"slice"==u&&f==p)&&t.translate(i-n,0),c.match(/YMax$/)&&("meet"==u&&g==d||"slice"==u&&f==d)&&t.translate(0,s-r)),"none"==c?t.scale(d,p):"meet"==u?t.scale(g,g):"slice"==u&&t.scale(f,f),t.translate(null==o?0:-o,null==a?0:-a)},D.Element={},D.EmptyProperty=new D.Property("EMPTY",""),D.Element.ElementBase=function(r){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(t,e){var i=this.attributes[t];return null!=i?i:(1==e&&(i=new D.Property(t,""),this.attributes[t]=i),i||D.EmptyProperty)},this.getHrefAttribute=function(){for(var t in this.attributes)if("href"==t||t.match(/:href$/))return this.attributes[t];return D.EmptyProperty},this.style=function(t,e,i){var n=this.styles[t];if(null!=n)return n;var s=this.attribute(t);if(null!=s&&s.hasValue())return this.styles[t]=s;if(1!=i){var r=this.parent;if(null!=r){var o=r.style(t);if(null!=o&&o.hasValue())return o}}return 1==e&&(n=new D.Property(t,""),this.styles[t]=n),n||D.EmptyProperty},this.render=function(t){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(t.save(),this.style("mask").hasValue()){var e=this.style("mask").getDefinition();null!=e&&e.apply(t,this)}else if(this.style("filter").hasValue()){var i=this.style("filter").getDefinition();null!=i&&i.apply(t,this)}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}},this.setContext=function(t){},this.clearContext=function(t){},this.renderChildren=function(t){for(var e=0;e<this.children.length;e++)this.children[e].render(t)},this.addChild=function(t,e){var i=t;e&&(i=D.CreateElement(t)),i.parent=this,"title"!=i.type&&this.children.push(i)},this.addStylesFromStyleDefinition=function(){for(var t in D.Styles)if("@"!=t[0]&&d(r,t)){var e=D.Styles[t],i=D.StylesSpecificity[t];if(null!=e)for(var n in e){var s=this.stylesSpecificity[n];void 0===s&&(s="000"),s<i&&(this.styles[n]=e[n],this.stylesSpecificity[n]=i)}}};var t,e=new RegExp("^[A-Z-]+$");if(null!=r&&1==r.nodeType){for(var i=0;i<r.attributes.length;i++){var n=r.attributes[i],s=(t=n.nodeName,e.test(t)?t.toLowerCase():t);this.attributes[s]=new D.Property(s,n.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue()){var o=this.attribute("style").value.split(";");for(i=0;i<o.length;i++)if(""!=D.trim(o[i])){var a=o[i].split(":"),l=D.trim(a[0]),h=D.trim(a[1]);this.styles[l]=new D.Property(l,h)}}this.attribute("id").hasValue()&&null==D.Definitions[this.attribute("id").value]&&(D.Definitions[this.attribute("id").value]=this);for(i=0;i<r.childNodes.length;i++){var c=r.childNodes[i];if(1==c.nodeType&&this.addChild(c,!0),this.captureTextNodes&&(3==c.nodeType||4==c.nodeType)){var u=c.value||c.text||c.textContent||"";""!=D.compressSpaces(u)&&this.addChild(new D.Element.tspan(c),!1)}}}},D.Element.RenderedElementBase=function(t){this.base=D.Element.ElementBase,this.base(t),this.setContext=function(t){var e;if(this.style("fill").isUrlDefinition())null!=(e=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity")))&&(t.fillStyle=e);else if(this.style("fill").hasValue()){var i;"currentColor"==(i=this.style("fill")).value&&(i.value=this.style("color").value),"inherit"!=i.value&&(t.fillStyle="none"==i.value?"rgba(0,0,0,0)":i.value)}this.style("fill-opacity").hasValue()&&(i=(i=new D.Property("fill",t.fillStyle)).addOpacity(this.style("fill-opacity")),t.fillStyle=i.value);if(this.style("stroke").isUrlDefinition())null!=(e=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity")))&&(t.strokeStyle=e);else if(this.style("stroke").hasValue()){var n;"currentColor"==(n=this.style("stroke")).value&&(n.value=this.style("color").value),"inherit"!=n.value&&(t.strokeStyle="none"==n.value?"rgba(0,0,0,0)":n.value)}this.style("stroke-opacity").hasValue()&&(n=(n=new D.Property("stroke",t.strokeStyle)).addOpacity(this.style("stroke-opacity")),t.strokeStyle=n.value);if(this.style("stroke-width").hasValue()){var s=this.style("stroke-width").toPixels();t.lineWidth=0==s?.001:s}if(this.style("stroke-linecap").hasValue()&&(t.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(t.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(t.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var r=D.ToNumberArray(this.style("stroke-dasharray").value);void 0!==t.setLineDash?t.setLineDash(r):void 0!==t.webkitLineDash?t.webkitLineDash=r:void 0===t.mozDash||1==r.length&&0==r[0]||(t.mozDash=r);var o=this.style("stroke-dashoffset").numValueOrDefault(1);void 0!==t.lineDashOffset?t.lineDashOffset=o:void 0!==t.webkitLineDashOffset?t.webkitLineDashOffset=o:void 0!==t.mozDashOffset&&(t.mozDashOffset=o)}void 0!==t.font&&(t.font=D.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.style("transform",!1,!0).hasValue()&&new D.Transform(this.style("transform",!1,!0).value).apply(t);if(this.style("clip-path",!1,!0).hasValue()){var a=this.style("clip-path",!1,!0).getDefinition();null!=a&&a.apply(t)}this.style("opacity").hasValue()&&(t.globalAlpha=this.style("opacity").numValue())}},D.Element.RenderedElementBase.prototype=new D.Element.ElementBase,D.Element.PathElementBase=function(t){this.base=D.Element.RenderedElementBase,this.base(t),this.path=function(t){return null!=t&&t.beginPath(),new D.BoundingBox},this.renderChildren=function(t){this.path(t),D.Mouse.checkPath(this,t),""!=t.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?t.fill(this.style("fill-rule").value):t.fill()),""!=t.strokeStyle&&t.stroke();var e=this.getMarkers();if(null!=e){if(this.style("marker-start").isUrlDefinition())(i=this.style("marker-start").getDefinition()).render(t,e[0][0],e[0][1]);if(this.style("marker-mid").isUrlDefinition())for(var i=this.style("marker-mid").getDefinition(),n=1;n<e.length-1;n++)i.render(t,e[n][0],e[n][1]);if(this.style("marker-end").isUrlDefinition())(i=this.style("marker-end").getDefinition()).render(t,e[e.length-1][0],e[e.length-1][1])}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},D.Element.PathElementBase.prototype=new D.Element.RenderedElementBase,D.Element.svg=function(t){this.base=D.Element.RenderedElementBase,this.base(t),this.baseClearContext=this.clearContext,this.clearContext=function(t){this.baseClearContext(t),D.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4,void 0!==t.font&&void 0!==window.getComputedStyle&&(t.font=window.getComputedStyle(t.canvas).getPropertyValue("font")),this.baseSetContext(t),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var e=D.ViewPort.width(),i=D.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root){e=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");var n=0,s=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(n=-this.attribute("refX").toPixels("x"),s=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(t.beginPath(),t.moveTo(n,s),t.lineTo(e,s),t.lineTo(e,i),t.lineTo(n,i),t.closePath(),t.clip())}if(D.ViewPort.SetCurrent(e,i),this.attribute("viewBox").hasValue()){var r=D.ToNumberArray(this.attribute("viewBox").value),o=r[0],a=r[1];e=r[2],i=r[3],D.AspectRatio(t,this.attribute("preserveAspectRatio").value,D.ViewPort.width(),e,D.ViewPort.height(),i,o,a,this.attribute("refX").value,this.attribute("refY").value),D.ViewPort.RemoveCurrent(),D.ViewPort.SetCurrent(r[2],r[3])}}},D.Element.svg.prototype=new D.Element.RenderedElementBase,D.Element.rect=function(t){this.base=D.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),n=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y"),r=this.attribute("rx").toPixels("x"),o=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(o=r),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(r=o),r=Math.min(r,n/2),o=Math.min(o,s/2),null!=t&&(t.beginPath(),t.moveTo(e+r,i),t.lineTo(e+n-r,i),t.quadraticCurveTo(e+n,i,e+n,i+o),t.lineTo(e+n,i+s-o),t.quadraticCurveTo(e+n,i+s,e+n-r,i+s),t.lineTo(e+r,i+s),t.quadraticCurveTo(e,i+s,e,i+s-o),t.lineTo(e,i+o),t.quadraticCurveTo(e,i,e+r,i),t.closePath()),new D.BoundingBox(e,i,e+n,i+s)}},D.Element.rect.prototype=new D.Element.PathElementBase,D.Element.circle=function(t){this.base=D.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("cx").toPixels("x"),i=this.attribute("cy").toPixels("y"),n=this.attribute("r").toPixels();return null!=t&&(t.beginPath(),t.arc(e,i,n,0,2*Math.PI,!0),t.closePath()),new D.BoundingBox(e-n,i-n,e+n,i+n)}},D.Element.circle.prototype=new D.Element.PathElementBase,D.Element.ellipse=function(t){this.base=D.Element.PathElementBase,this.base(t),this.path=function(t){var e=(Math.sqrt(2)-1)/3*4,i=this.attribute("rx").toPixels("x"),n=this.attribute("ry").toPixels("y"),s=this.attribute("cx").toPixels("x"),r=this.attribute("cy").toPixels("y");return null!=t&&(t.beginPath(),t.moveTo(s,r-n),t.bezierCurveTo(s+e*i,r-n,s+i,r-e*n,s+i,r),t.bezierCurveTo(s+i,r+e*n,s+e*i,r+n,s,r+n),t.bezierCurveTo(s-e*i,r+n,s-i,r+e*n,s-i,r),t.bezierCurveTo(s-i,r-e*n,s-e*i,r-n,s,r-n),t.closePath()),new D.BoundingBox(s-i,r-n,s+i,r+n)}},D.Element.ellipse.prototype=new D.Element.PathElementBase,D.Element.line=function(t){this.base=D.Element.PathElementBase,this.base(t),this.getPoints=function(){return[new D.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new D.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(t){var e=this.getPoints();return null!=t&&(t.beginPath(),t.moveTo(e[0].x,e[0].y),t.lineTo(e[1].x,e[1].y)),new D.BoundingBox(e[0].x,e[0].y,e[1].x,e[1].y)},this.getMarkers=function(){var t=this.getPoints(),e=t[0].angleTo(t[1]);return[[t[0],e],[t[1],e]]}},D.Element.line.prototype=new D.Element.PathElementBase,D.Element.polyline=function(t){this.base=D.Element.PathElementBase,this.base(t),this.points=D.CreatePath(this.attribute("points").value),this.path=function(t){var e=new D.BoundingBox(this.points[0].x,this.points[0].y);null!=t&&(t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y));for(var i=1;i<this.points.length;i++)e.addPoint(this.points[i].x,this.points[i].y),null!=t&&t.lineTo(this.points[i].x,this.points[i].y);return e},this.getMarkers=function(){for(var t=[],e=0;e<this.points.length-1;e++)t.push([this.points[e],this.points[e].angleTo(this.points[e+1])]);return 0<t.length&&t.push([this.points[this.points.length-1],t[t.length-1][1]]),t}},D.Element.polyline.prototype=new D.Element.PathElementBase,D.Element.polygon=function(t){this.base=D.Element.polyline,this.base(t),this.basePath=this.path,this.path=function(t){var e=this.basePath(t);return null!=t&&(t.lineTo(this.points[0].x,this.points[0].y),t.closePath()),e}},D.Element.polygon.prototype=new D.Element.polyline,D.Element.path=function(t){this.base=D.Element.PathElementBase,this.base(t);var e=this.attribute("d").value;e=e.replace(/,/gm," ");for(var i=0;i<2;i++)e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");e=(e=e.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2");for(i=0;i<2;i++)e=e.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");e=e.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),e=D.compressSpaces(e),e=D.trim(e),this.PathParser=new function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new D.Point(0,0),this.control=new D.Point(0,0),this.current=new D.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new D.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},this.getAsControlPoint=function(){var t=this.getPoint();return this.control=t},this.getAsCurrentPoint=function(){var t=this.getPoint();return this.current=t},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new D.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(t){return this.isRelativeCommand()&&(t.x+=this.current.x,t.y+=this.current.y),t},this.addMarker=function(t,e,i){null!=i&&0<this.angles.length&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(i)),this.addMarkerAngle(t,null==e?null:e.angleTo(t))},this.addMarkerAngle=function(t,e){this.points.push(t),this.angles.push(e)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var t=0;t<this.angles.length;t++)if(null==this.angles[t])for(var e=t+1;e<this.angles.length;e++)if(null!=this.angles[e]){this.angles[t]=this.angles[e];break}return this.angles}}(e),this.path=function(t){var e=this.PathParser;e.reset();var i=new D.BoundingBox;for(null!=t&&t.beginPath();!e.isEnd();)switch(e.nextCommand(),e.command){case"M":case"m":var n=e.getAsCurrentPoint();for(e.addMarker(n),i.addPoint(n.x,n.y),null!=t&&t.moveTo(n.x,n.y),e.start=e.current;!e.isCommandOrEnd();){n=e.getAsCurrentPoint();e.addMarker(n,e.start),i.addPoint(n.x,n.y),null!=t&&t.lineTo(n.x,n.y)}break;case"L":case"l":for(;!e.isCommandOrEnd();){var s=e.current;n=e.getAsCurrentPoint();e.addMarker(n,s),i.addPoint(n.x,n.y),null!=t&&t.lineTo(n.x,n.y)}break;case"H":case"h":for(;!e.isCommandOrEnd();){var r=new D.Point((e.isRelativeCommand()?e.current.x:0)+e.getScalar(),e.current.y);e.addMarker(r,e.current),e.current=r,i.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"V":case"v":for(;!e.isCommandOrEnd();){r=new D.Point(e.current.x,(e.isRelativeCommand()?e.current.y:0)+e.getScalar());e.addMarker(r,e.current),e.current=r,i.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"C":case"c":for(;!e.isCommandOrEnd();){var o=e.current,a=e.getPoint(),l=e.getAsControlPoint(),h=e.getAsCurrentPoint();e.addMarker(h,l,a),i.addBezierCurve(o.x,o.y,a.x,a.y,l.x,l.y,h.x,h.y),null!=t&&t.bezierCurveTo(a.x,a.y,l.x,l.y,h.x,h.y)}break;case"S":case"s":for(;!e.isCommandOrEnd();){o=e.current,a=e.getReflectedControlPoint(),l=e.getAsControlPoint(),h=e.getAsCurrentPoint();e.addMarker(h,l,a),i.addBezierCurve(o.x,o.y,a.x,a.y,l.x,l.y,h.x,h.y),null!=t&&t.bezierCurveTo(a.x,a.y,l.x,l.y,h.x,h.y)}break;case"Q":case"q":for(;!e.isCommandOrEnd();){o=e.current,l=e.getAsControlPoint(),h=e.getAsCurrentPoint();e.addMarker(h,l,l),i.addQuadraticCurve(o.x,o.y,l.x,l.y,h.x,h.y),null!=t&&t.quadraticCurveTo(l.x,l.y,h.x,h.y)}break;case"T":case"t":for(;!e.isCommandOrEnd();){o=e.current,l=e.getReflectedControlPoint();e.control=l;h=e.getAsCurrentPoint();e.addMarker(h,l,l),i.addQuadraticCurve(o.x,o.y,l.x,l.y,h.x,h.y),null!=t&&t.quadraticCurveTo(l.x,l.y,h.x,h.y)}break;case"A":case"a":for(;!e.isCommandOrEnd();){o=e.current;var c=e.getScalar(),u=e.getScalar(),d=e.getScalar()*(Math.PI/180),p=e.getScalar(),g=e.getScalar(),f=(h=e.getAsCurrentPoint(),new D.Point(Math.cos(d)*(o.x-h.x)/2+Math.sin(d)*(o.y-h.y)/2,-Math.sin(d)*(o.x-h.x)/2+Math.cos(d)*(o.y-h.y)/2)),m=Math.pow(f.x,2)/Math.pow(c,2)+Math.pow(f.y,2)/Math.pow(u,2);1<m&&(c*=Math.sqrt(m),u*=Math.sqrt(m));var v=(p==g?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(u,2)-Math.pow(c,2)*Math.pow(f.y,2)-Math.pow(u,2)*Math.pow(f.x,2))/(Math.pow(c,2)*Math.pow(f.y,2)+Math.pow(u,2)*Math.pow(f.x,2)));isNaN(v)&&(v=0);var y=new D.Point(v*c*f.y/u,v*-u*f.x/c),b=new D.Point((o.x+h.x)/2+Math.cos(d)*y.x-Math.sin(d)*y.y,(o.y+h.y)/2+Math.sin(d)*y.x+Math.cos(d)*y.y),w=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},C=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(w(t)*w(e))},I=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(C(t,e))},x=I([1,0],[(f.x-y.x)/c,(f.y-y.y)/u]),A=[(f.x-y.x)/c,(f.y-y.y)/u],S=[(-f.x-y.x)/c,(-f.y-y.y)/u],_=I(A,S);C(A,S)<=-1&&(_=Math.PI),1<=C(A,S)&&(_=0);var P=1-g?1:-1,M=x+_/2*P,k=new D.Point(b.x+c*Math.cos(M),b.y+u*Math.sin(M));if(e.addMarkerAngle(k,M-P*Math.PI/2),e.addMarkerAngle(h,M-P*Math.PI),i.addPoint(h.x,h.y),null!=t){C=u<c?c:u;var T=u<c?1:c/u,N=u<c?u/c:1;t.translate(b.x,b.y),t.rotate(d),t.scale(T,N),t.arc(0,0,C,x,x+_,1-g),t.scale(1/T,1/N),t.rotate(-d),t.translate(-b.x,-b.y)}}break;case"Z":case"z":null!=t&&t.closePath(),e.current=e.start}return i},this.getMarkers=function(){for(var t=this.PathParser.getMarkerPoints(),e=this.PathParser.getMarkerAngles(),i=[],n=0;n<t.length;n++)i.push([t[n],e[n]]);return i}},D.Element.path.prototype=new D.Element.PathElementBase,D.Element.pattern=function(t){this.base=D.Element.ElementBase,this.base(t),this.createPattern=function(t,e){var i=this.attribute("width").toPixels("x",!0),n=this.attribute("height").toPixels("y",!0),s=new D.Element.svg;s.attributes.viewBox=new D.Property("viewBox",this.attribute("viewBox").value),s.attributes.width=new D.Property("width",i+"px"),s.attributes.height=new D.Property("height",n+"px"),s.attributes.transform=new D.Property("transform",this.attribute("patternTransform").value),s.children=this.children;var r=document.createElement("canvas");r.width=i,r.height=n;var o=r.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&o.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var a=-1;a<=1;a++)for(var l=-1;l<=1;l++)o.save(),s.attributes.x=new D.Property("x",a*r.width),s.attributes.y=new D.Property("y",l*r.height),s.render(o),o.restore();return t.createPattern(r,"repeat")}},D.Element.pattern.prototype=new D.Element.ElementBase,D.Element.marker=function(t){this.base=D.Element.ElementBase,this.base(t),this.baseRender=this.render,this.render=function(t,e,i){t.translate(e.x,e.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(i),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(t.lineWidth,t.lineWidth),t.save();var n=new D.Element.svg;n.attributes.viewBox=new D.Property("viewBox",this.attribute("viewBox").value),n.attributes.refX=new D.Property("refX",this.attribute("refX").value),n.attributes.refY=new D.Property("refY",this.attribute("refY").value),n.attributes.width=new D.Property("width",this.attribute("markerWidth").value),n.attributes.height=new D.Property("height",this.attribute("markerHeight").value),n.attributes.fill=new D.Property("fill",this.attribute("fill").valueOrDefault("black")),n.attributes.stroke=new D.Property("stroke",this.attribute("stroke").valueOrDefault("none")),n.children=this.children,n.render(t),t.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(-i),t.translate(-e.x,-e.y)}},D.Element.marker.prototype=new D.Element.ElementBase,D.Element.defs=function(t){this.base=D.Element.ElementBase,this.base(t),this.render=function(t){}},D.Element.defs.prototype=new D.Element.ElementBase,D.Element.GradientBase=function(t){this.base=D.Element.ElementBase,this.base(t),this.stops=[];for(var e=0;e<this.children.length;e++){var i=this.children[e];"stop"==i.type&&this.stops.push(i)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(t){for(var e=0;e<this.attributesToInherit.length;e++){var i=this.attributesToInherit[e];!this.attribute(i).hasValue()&&t.attribute(i).hasValue()&&(this.attribute(i,!0).value=t.attribute(i).value)}},this.createGradient=function(t,e,i){var n=this;this.getHrefAttribute().hasValue()&&(n=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(n));function s(t){return i.hasValue()?new D.Property("color",t).addOpacity(i).value:t}var r=this.getGradient(t,e);if(null==r)return s(n.stops[n.stops.length-1].color);for(var o=0;o<n.stops.length;o++)r.addColorStop(n.stops[o].offset,s(n.stops[o].color));if(this.attribute("gradientTransform").hasValue()){var a=D.ViewPort.viewPorts[0],l=new D.Element.rect;l.attributes.x=new D.Property("x",-D.MAX_VIRTUAL_PIXELS/3),l.attributes.y=new D.Property("y",-D.MAX_VIRTUAL_PIXELS/3),l.attributes.width=new D.Property("width",D.MAX_VIRTUAL_PIXELS),l.attributes.height=new D.Property("height",D.MAX_VIRTUAL_PIXELS);var h=new D.Element.g;h.attributes.transform=new D.Property("transform",this.attribute("gradientTransform").value),h.children=[l];var c=new D.Element.svg;c.attributes.x=new D.Property("x",0),c.attributes.y=new D.Property("y",0),c.attributes.width=new D.Property("width",a.width),c.attributes.height=new D.Property("height",a.height),c.children=[h];var u=document.createElement("canvas");u.width=a.width,u.height=a.height;var d=u.getContext("2d");return d.fillStyle=r,c.render(d),d.createPattern(u,"no-repeat")}return r}},D.Element.GradientBase.prototype=new D.Element.ElementBase,D.Element.linearGradient=function(t){this.base=D.Element.GradientBase,this.base(t),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(t,e){var i="objectBoundingBox"==this.gradientUnits()?e.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var n="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),s="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),r="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),o="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return n==r&&s==o?null:t.createLinearGradient(n,s,r,o)}},D.Element.linearGradient.prototype=new D.Element.GradientBase,D.Element.radialGradient=function(t){this.base=D.Element.GradientBase,this.base(t),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(t,e){var i=e.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var n="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),s="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),r=n,o=s;this.attribute("fx").hasValue()&&(r="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(o="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var a="objectBoundingBox"==this.gradientUnits()?(i.width()+i.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return t.createRadialGradient(r,o,0,n,s,a)}},D.Element.radialGradient.prototype=new D.Element.GradientBase,D.Element.stop=function(t){this.base=D.Element.ElementBase,this.base(t),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),1<this.offset&&(this.offset=1);var e=this.style("stop-color",!0);""===e.value&&(e.value="#000"),this.style("stop-opacity").hasValue()&&(e=e.addOpacity(this.style("stop-opacity"))),this.color=e.value},D.Element.stop.prototype=new D.Element.ElementBase,D.Element.AnimateBase=function(t){this.base=D.Element.ElementBase,this.base(t),D.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var t=this.attribute("attributeType").value,e=this.attribute("attributeName").value;return"CSS"==t?this.parent.style(e,!0):this.parent.attribute(e,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(t){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+t;var e=!1;if(this.begin<this.duration){var i=this.calcValue();if(this.attribute("type").hasValue())i=this.attribute("type").value+"("+i+")";this.getProperty().value=i,e=!0}return e},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var e=t.progress*(this.values.value.length-1),i=Math.floor(e),n=Math.ceil(e);t.from=new D.Property("from",parseFloat(this.values.value[i])),t.to=new D.Property("to",parseFloat(this.values.value[n])),t.progress=(e-i)/(n-i)}else t.from=this.from,t.to=this.to;return t}},D.Element.AnimateBase.prototype=new D.Element.ElementBase,D.Element.animate=function(t){this.base=D.Element.AnimateBase,this.base(t),this.calcValue=function(){var t=this.progress();return t.from.numValue()+(t.to.numValue()-t.from.numValue())*t.progress+this.initialUnits}},D.Element.animate.prototype=new D.Element.AnimateBase,D.Element.animateColor=function(t){this.base=D.Element.AnimateBase,this.base(t),this.calcValue=function(){var t=this.progress(),e=new c(t.from.value),i=new c(t.to.value);if(e.ok&&i.ok){var n=e.r+(i.r-e.r)*t.progress,s=e.g+(i.g-e.g)*t.progress,r=e.b+(i.b-e.b)*t.progress;return"rgb("+parseInt(n,10)+","+parseInt(s,10)+","+parseInt(r,10)+")"}return this.attribute("from").value}},D.Element.animateColor.prototype=new D.Element.AnimateBase,D.Element.animateTransform=function(t){this.base=D.Element.AnimateBase,this.base(t),this.calcValue=function(){for(var t=this.progress(),e=D.ToNumberArray(t.from.value),i=D.ToNumberArray(t.to.value),n="",s=0;s<e.length;s++)n+=e[s]+(i[s]-e[s])*t.progress+" ";return n}},D.Element.animateTransform.prototype=new D.Element.animate,D.Element.font=function(t){this.base=D.Element.ElementBase,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var e=0;e<this.children.length;e++){var i=this.children[e];"font-face"==i.type?(this.fontFace=i).style("font-family").hasValue()&&(D.Definitions[i.style("font-family").value]=this):"missing-glyph"==i.type?this.missingGlyph=i:"glyph"==i.type&&(""!=i.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[i.unicode]&&(this.glyphs[i.unicode]=[]),this.glyphs[i.unicode][i.arabicForm]=i):this.glyphs[i.unicode]=i)}},D.Element.font.prototype=new D.Element.ElementBase,D.Element.fontface=function(t){this.base=D.Element.ElementBase,this.base(t),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},D.Element.fontface.prototype=new D.Element.ElementBase,D.Element.missingglyph=function(t){this.base=D.Element.path,this.base(t),this.horizAdvX=0},D.Element.missingglyph.prototype=new D.Element.path,D.Element.glyph=function(t){this.base=D.Element.path,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},D.Element.glyph.prototype=new D.Element.path,D.Element.text=function(t){this.captureTextNodes=!0,this.base=D.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t);var e=this.style("dominant-baseline").toTextBaseline();null==e&&(e=this.style("alignment-baseline").toTextBaseline()),null!=e&&(t.textBaseline=e)},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),i=this.parent.style("font-size").numValueOrDefault(D.Font.Parse(D.ctx.font).fontSize);return new D.BoundingBox(t,e-i,t+Math.floor(2*i/3)*this.children[0].getText().length,e)},this.renderChildren=function(t){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(t,this,0);for(var e=0;e<this.children.length;e++)this.renderChild(t,this,this,e)},this.getAnchorDelta=function(t,e,i){var n=this.style("text-anchor").valueOrDefault("start");if("start"==n)return 0;for(var s=0,r=i;r<e.children.length;r++){var o=e.children[r];if(i<r&&o.attribute("x").hasValue())break;s+=o.measureTextRecursive(t)}return-1*("end"==n?s:s/2)},this.renderChild=function(t,e,i,n){var s=i.children[n];s.attribute("x").hasValue()?(s.x=s.attribute("x").toPixels("x")+e.getAnchorDelta(t,i,n),s.attribute("dx").hasValue()&&(s.x+=s.attribute("dx").toPixels("x"))):(s.attribute("dx").hasValue()&&(e.x+=s.attribute("dx").toPixels("x")),s.x=e.x),e.x=s.x+s.measureText(t),s.attribute("y").hasValue()?(s.y=s.attribute("y").toPixels("y"),s.attribute("dy").hasValue()&&(s.y+=s.attribute("dy").toPixels("y"))):(s.attribute("dy").hasValue()&&(e.y+=s.attribute("dy").toPixels("y")),s.y=e.y),e.y=s.y,s.render(t);for(n=0;n<s.children.length;n++)e.renderChild(t,e,s,n)}},D.Element.text.prototype=new D.Element.RenderedElementBase,D.Element.TextElementBase=function(t){this.base=D.Element.RenderedElementBase,this.base(t),this.getGlyph=function(t,e,i){var n=e[i],s=null;if(t.isArabic){var r="isolated";(0==i||" "==e[i-1])&&i<e.length-2&&" "!=e[i+1]&&(r="terminal"),0<i&&" "!=e[i-1]&&i<e.length-2&&" "!=e[i+1]&&(r="medial"),0<i&&" "!=e[i-1]&&(i==e.length-1||" "==e[i+1])&&(r="initial"),void 0!==t.glyphs[n]&&null==(s=t.glyphs[n][r])&&"glyph"==t.glyphs[n].type&&(s=t.glyphs[n])}else s=t.glyphs[n];return null==s&&(s=t.missingGlyph),s},this.renderChildren=function(t){var e=this.parent.style("font-family").getDefinition();if(null==e)""!=t.fillStyle&&t.fillText(D.compressSpaces(this.getText()),this.x,this.y),""!=t.strokeStyle&&t.strokeText(D.compressSpaces(this.getText()),this.x,this.y);else{var i=this.parent.style("font-size").numValueOrDefault(D.Font.Parse(D.ctx.font).fontSize),n=this.parent.style("font-style").valueOrDefault(D.Font.Parse(D.ctx.font).fontStyle),s=this.getText();e.isRTL&&(s=s.split("").reverse().join(""));for(var r=D.ToNumberArray(this.parent.attribute("dx").value),o=0;o<s.length;o++){var a=this.getGlyph(e,s,o),l=i/e.fontFace.unitsPerEm;t.translate(this.x,this.y),t.scale(l,-l);var h=t.lineWidth;t.lineWidth=t.lineWidth*e.fontFace.unitsPerEm/i,"italic"==n&&t.transform(1,0,.4,1,0,0),a.render(t),"italic"==n&&t.transform(1,0,-.4,1,0,0),t.lineWidth=h,t.scale(1/l,-1/l),t.translate(-this.x,-this.y),this.x+=i*(a.horizAdvX||e.horizAdvX)/e.fontFace.unitsPerEm,void 0===r[o]||isNaN(r[o])||(this.x+=r[o])}}},this.getText=function(){},this.measureTextRecursive=function(t){for(var e=this.measureText(t),i=0;i<this.children.length;i++)e+=this.children[i].measureTextRecursive(t);return e},this.measureText=function(t){var e=this.parent.style("font-family").getDefinition();if(null!=e){var i=this.parent.style("font-size").numValueOrDefault(D.Font.Parse(D.ctx.font).fontSize),n=0,s=this.getText();e.isRTL&&(s=s.split("").reverse().join(""));for(var r=D.ToNumberArray(this.parent.attribute("dx").value),o=0;o<s.length;o++){n+=(this.getGlyph(e,s,o).horizAdvX||e.horizAdvX)*i/e.fontFace.unitsPerEm,void 0===r[o]||isNaN(r[o])||(n+=r[o])}return n}var a=D.compressSpaces(this.getText());if(!t.measureText)return 10*a.length;t.save(),this.setContext(t);var l=t.measureText(a).width;return t.restore(),l}},D.Element.TextElementBase.prototype=new D.Element.RenderedElementBase,D.Element.tspan=function(t){this.captureTextNodes=!0,this.base=D.Element.TextElementBase,this.base(t),this.text=D.compressSpaces(t.value||t.text||t.textContent||""),this.getText=function(){return 0<this.children.length?"":this.text}},D.Element.tspan.prototype=new D.Element.TextElementBase,D.Element.tref=function(t){this.base=D.Element.TextElementBase,this.base(t),this.getText=function(){var t=this.getHrefAttribute().getDefinition();if(null!=t)return t.children[0].getText()}},D.Element.tref.prototype=new D.Element.TextElementBase,D.Element.a=function(t){this.base=D.Element.TextElementBase,this.base(t),this.hasText=0<t.childNodes.length;for(var e=0;e<t.childNodes.length;e++)3!=t.childNodes[e].nodeType&&(this.hasText=!1);this.text=this.hasText?t.childNodes[0].value:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var e=new D.Property("fontSize",D.Font.Parse(D.ctx.font).fontSize);D.Mouse.checkBoundingBox(this,new D.BoundingBox(this.x,this.y-e.toPixels("y"),this.x+this.measureText(t),this.y))}else if(0<this.children.length){var i=new D.Element.g;i.children=this.children,i.parent=this,i.render(t)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){D.ctx.canvas.style.cursor="pointer"}},D.Element.a.prototype=new D.Element.TextElementBase,D.Element.image=function(t){this.base=D.Element.RenderedElementBase,this.base(t);var e=this.getHrefAttribute().value;if(""!=e){var r=e.match(/\.svg$/);if(D.Images.push(this),this.loaded=!1,r)this.img=D.ajax(e),this.loaded=!0;else{this.img=document.createElement("img"),1==D.opts.useCORS&&(this.img.crossOrigin="Anonymous");var i=this;this.img.onload=function(){i.loaded=!0},this.img.onerror=function(){D.log('ERROR: image "'+e+'" not found'),i.loaded=!0},this.img.src=e}this.renderChildren=function(t){var e=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),n=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y");0!=n&&0!=s&&(t.save(),r?t.drawSvg(this.img,e,i,n,s):(t.translate(e,i),D.AspectRatio(t,this.attribute("preserveAspectRatio").value,n,this.img.width,s,this.img.height,0,0),t.drawImage(this.img,0,0)),t.restore())},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),n=this.attribute("height").toPixels("y");return new D.BoundingBox(t,e,t+i,e+n)}}},D.Element.image.prototype=new D.Element.RenderedElementBase,D.Element.g=function(t){this.base=D.Element.RenderedElementBase,this.base(t),this.getBoundingBox=function(){for(var t=new D.BoundingBox,e=0;e<this.children.length;e++)t.addBoundingBox(this.children[e].getBoundingBox());return t}},D.Element.g.prototype=new D.Element.RenderedElementBase,D.Element.symbol=function(t){this.base=D.Element.RenderedElementBase,this.base(t),this.render=function(t){}},D.Element.symbol.prototype=new D.Element.RenderedElementBase,D.Element.style=function(t){this.base=D.Element.ElementBase,this.base(t);for(var e="",i=0;i<t.childNodes.length;i++)e+=t.childNodes[i].data;e=e.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");var n=(e=D.compressSpaces(e)).split("}");for(i=0;i<n.length;i++)if(""!=D.trim(n[i]))for(var s=n[i].split("{"),r=s[0].split(","),o=s[1].split(";"),a=0;a<r.length;a++){var l=D.trim(r[a]);if(""!=l){for(var h=D.Styles[l]||{},c=0;c<o.length;c++){var u=o[c].indexOf(":"),d=o[c].substr(0,u),p=o[c].substr(u+1,o[c].length-u);null!=d&&null!=p&&(h[D.trim(d)]=new D.Property(D.trim(d),D.trim(p)))}if(D.Styles[l]=h,D.StylesSpecificity[l]=x(l),"@font-face"==l)for(var g=h["font-family"].value.replace(/"/g,""),f=h.src.value.split(","),m=0;m<f.length;m++)if(0<f[m].indexOf('format("svg")'))for(var v=f[m].indexOf("url"),y=f[m].indexOf(")",v),b=f[m].substr(v+5,y-v-6),w=D.parseXml(D.ajax(b)).getElementsByTagName("font"),C=0;C<w.length;C++){var I=D.CreateElement(w[C]);D.Definitions[g]=I}}}},D.Element.style.prototype=new D.Element.ElementBase,D.Element.use=function(t){this.base=D.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t),this.attribute("x").hasValue()&&t.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&t.translate(0,this.attribute("y").toPixels("y"))};var n=this.getHrefAttribute().getDefinition();this.path=function(t){null!=n&&n.path(t)},this.getBoundingBox=function(){if(null!=n)return n.getBoundingBox()},this.renderChildren=function(t){if(null!=n){var e=n;"symbol"==n.type&&((e=new D.Element.svg).type="svg",e.attributes.viewBox=new D.Property("viewBox",n.attribute("viewBox").value),e.attributes.preserveAspectRatio=new D.Property("preserveAspectRatio",n.attribute("preserveAspectRatio").value),e.attributes.overflow=new D.Property("overflow",n.attribute("overflow").value),e.children=n.children),"svg"==e.type&&(this.attribute("width").hasValue()&&(e.attributes.width=new D.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(e.attributes.height=new D.Property("height",this.attribute("height").value)));var i=e.parent;e.parent=null,e.render(t),e.parent=i}}},D.Element.use.prototype=new D.Element.RenderedElementBase,D.Element.mask=function(t){this.base=D.Element.ElementBase,this.base(t),this.apply=function(t,e){var i=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");if(0==s&&0==r){for(var o=new D.BoundingBox,a=0;a<this.children.length;a++)o.addBoundingBox(this.children[a].getBoundingBox());i=Math.floor(o.x1),n=Math.floor(o.y1),s=Math.floor(o.width()),r=Math.floor(o.height())}var l=e.attribute("mask").value;e.attribute("mask").value="";var h=document.createElement("canvas");h.width=i+s,h.height=n+r;var c=h.getContext("2d");this.renderChildren(c);var u=document.createElement("canvas");u.width=i+s,u.height=n+r;var d=u.getContext("2d");e.render(d),d.globalCompositeOperation="destination-in",d.fillStyle=c.createPattern(h,"no-repeat"),d.fillRect(0,0,i+s,n+r),t.fillStyle=d.createPattern(u,"no-repeat"),t.fillRect(0,0,i+s,n+r),e.attribute("mask").value=l},this.render=function(t){}},D.Element.mask.prototype=new D.Element.ElementBase,D.Element.clipPath=function(t){this.base=D.Element.ElementBase,this.base(t),this.apply=function(t){var e=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var i=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){},e.call(t);for(var n=0;n<this.children.length;n++){var s=this.children[n];if(void 0!==s.path){var r=null;s.style("transform",!1,!0).hasValue()&&(r=new D.Transform(s.style("transform",!1,!0).value)).apply(t),s.path(t),CanvasRenderingContext2D.prototype.closePath=i,r&&r.unapply(t)}}i.call(t),t.clip(),CanvasRenderingContext2D.prototype.beginPath=e,CanvasRenderingContext2D.prototype.closePath=i},this.render=function(t){}},D.Element.clipPath.prototype=new D.Element.ElementBase,D.Element.filter=function(t){this.base=D.Element.ElementBase,this.base(t),this.apply=function(t,e){var i=e.getBoundingBox(),n=Math.floor(i.x1),s=Math.floor(i.y1),r=Math.floor(i.width()),o=Math.floor(i.height()),a=e.style("filter").value;e.style("filter").value="";for(var l=0,h=0,c=0;c<this.children.length;c++){var u=this.children[c].extraFilterDistance||0;l=Math.max(l,u),h=Math.max(h,u)}var d=document.createElement("canvas");d.width=r+2*l,d.height=o+2*h;var p=d.getContext("2d");p.translate(-n+l,-s+h),e.render(p);for(c=0;c<this.children.length;c++)"function"==typeof this.children[c].apply&&this.children[c].apply(p,0,0,r+2*l,o+2*h);t.drawImage(d,0,0,r+2*l,o+2*h,n-l,s-h,r+2*l,o+2*h),e.style("filter",!0).value=a},this.render=function(t){}},D.Element.filter.prototype=new D.Element.ElementBase,D.Element.feDropShadow=function(t){this.base=D.Element.ElementBase,this.base(t),this.addStylesFromStyleDefinition(),this.apply=function(t,e,i,n,s){}},D.Element.feDropShadow.prototype=new D.Element.ElementBase,D.Element.feMorphology=function(t){this.base=D.Element.ElementBase,this.base(t),this.apply=function(t,e,i,n,s){}},D.Element.feMorphology.prototype=new D.Element.ElementBase,D.Element.feComposite=function(t){this.base=D.Element.ElementBase,this.base(t),this.apply=function(t,e,i,n,s){}},D.Element.feComposite.prototype=new D.Element.ElementBase,D.Element.feColorMatrix=function(t){this.base=D.Element.ElementBase,this.base(t);var n=D.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var e=n[0];n=[.213+.787*e,.715-.715*e,.072-.072*e,0,0,.213-.213*e,.715+.285*e,.072-.072*e,0,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var s=n[0]*Math.PI/180,i=function(t,e,i){return t+Math.cos(s)*e+Math.sin(s)*i};n=[i(.213,.787,-.213),i(.715,-.715,-.715),i(.072,-.072,.928),0,0,i(.213,-.213,.143),i(.715,.285,.14),i(.072,-.072,-.283),0,0,i(.213,-.213,-.787),i(.715,-.715,.715),i(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}function c(t,e,i,n,s,r){return t[i*n*4+4*e+r]}function u(t,e,i,n,s,r,o){t[i*n*4+4*e+r]=o}function d(t,e){var i=n[t];return i*(i<0?e-255:e)}this.apply=function(t,e,i,n,s){var r=t.getImageData(0,0,n,s);for(i=0;i<s;i++)for(e=0;e<n;e++){var o=c(r.data,e,i,n,0,0),a=c(r.data,e,i,n,0,1),l=c(r.data,e,i,n,0,2),h=c(r.data,e,i,n,0,3);u(r.data,e,i,n,0,0,d(0,o)+d(1,a)+d(2,l)+d(3,h)+d(4,1)),u(r.data,e,i,n,0,1,d(5,o)+d(6,a)+d(7,l)+d(8,h)+d(9,1)),u(r.data,e,i,n,0,2,d(10,o)+d(11,a)+d(12,l)+d(13,h)+d(14,1)),u(r.data,e,i,n,0,3,d(15,o)+d(16,a)+d(17,l)+d(18,h)+d(19,1))}t.clearRect(0,0,n,s),t.putImageData(r,0,0)}},D.Element.feColorMatrix.prototype=new D.Element.ElementBase,D.Element.feGaussianBlur=function(t){this.base=D.Element.ElementBase,this.base(t),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(t,e,i,n,s){void 0!==u.canvasRGBA?(t.canvas.id=D.UniqueId(),t.canvas.style.display="none",document.body.appendChild(t.canvas),u.canvasRGBA(t.canvas.id,e,i,n,s,this.blurRadius),document.body.removeChild(t.canvas)):D.log("ERROR: StackBlur.js must be included for blur to work")}},D.Element.feGaussianBlur.prototype=new D.Element.ElementBase,D.Element.title=function(t){},D.Element.title.prototype=new D.Element.ElementBase,D.Element.desc=function(t){},D.Element.desc.prototype=new D.Element.ElementBase,D.Element.MISSING=function(t){D.log("ERROR: Element '"+t.nodeName+"' not yet implemented.")},D.Element.MISSING.prototype=new D.Element.ElementBase,D.CreateElement=function(t){var e=t.nodeName.replace(/^[^:]+:/,"");e=e.replace(/\-/g,"");var i=null;return(i=void 0!==D.Element[e]?new D.Element[e](t):new D.Element.MISSING(t)).type=t.nodeName,i},D.load=function(t,e){D.loadXml(t,D.ajax(e))},D.loadXml=function(t,e){D.loadXmlDoc(t,D.parseXml(e))},D.loadXmlDoc=function(r,o){D.init(r);function i(t){for(var e=r.canvas;e;)t.x-=e.offsetLeft,t.y-=e.offsetTop,e=e.offsetParent;return window.scrollX&&(t.x+=window.scrollX),window.scrollY&&(t.y+=window.scrollY),t}1!=D.opts.ignoreMouse&&(r.canvas.onclick=function(t){var e=i(new D.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));D.Mouse.onclick(e.x,e.y)},r.canvas.onmousemove=function(t){var e=i(new D.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));D.Mouse.onmousemove(e.x,e.y)});var a=D.CreateElement(o.documentElement);a.root=!0,a.addStylesFromStyleDefinition();function n(){D.ViewPort.Clear(),r.canvas.parentNode&&D.ViewPort.SetCurrent(r.canvas.parentNode.clientWidth,r.canvas.parentNode.clientHeight),1!=D.opts.ignoreDimensions&&(a.style("width").hasValue()&&(r.canvas.width=a.style("width").toPixels("x"),r.canvas.style.width=r.canvas.width+"px"),a.style("height").hasValue()&&(r.canvas.height=a.style("height").toPixels("y"),r.canvas.style.height=r.canvas.height+"px"));var t=r.canvas.clientWidth||r.canvas.width,e=r.canvas.clientHeight||r.canvas.height;if(1==D.opts.ignoreDimensions&&a.style("width").hasValue()&&a.style("height").hasValue()&&(t=a.style("width").toPixels("x"),e=a.style("height").toPixels("y")),D.ViewPort.SetCurrent(t,e),null!=D.opts.offsetX&&(a.attribute("x",!0).value=D.opts.offsetX),null!=D.opts.offsetY&&(a.attribute("y",!0).value=D.opts.offsetY),null!=D.opts.scaleWidth||null!=D.opts.scaleHeight){var i=null,n=null,s=D.ToNumberArray(a.attribute("viewBox").value);null!=D.opts.scaleWidth&&(a.attribute("width").hasValue()?i=a.attribute("width").toPixels("x")/D.opts.scaleWidth:isNaN(s[2])||(i=s[2]/D.opts.scaleWidth)),null!=D.opts.scaleHeight&&(a.attribute("height").hasValue()?n=a.attribute("height").toPixels("y")/D.opts.scaleHeight:isNaN(s[3])||(n=s[3]/D.opts.scaleHeight)),null==i&&(i=n),null==n&&(n=i),a.attribute("width",!0).value=D.opts.scaleWidth,a.attribute("height",!0).value=D.opts.scaleHeight,a.style("transform",!0,!0).value+=" scale("+1/i+","+1/n+")"}1!=D.opts.ignoreClear&&r.clearRect(0,0,t,e),a.render(r),l&&(l=!1,"function"==typeof D.opts.renderCallback&&D.opts.renderCallback(o))}var l=!0,s=!0;D.ImagesLoaded()&&(s=!1,n()),D.intervalID=setInterval(function(){var t=!1;if(s&&D.ImagesLoaded()&&(t=!(s=!1)),1!=D.opts.ignoreMouse&&(t|=D.Mouse.hasEvents()),1!=D.opts.ignoreAnimation)for(var e=0;e<D.Animations.length;e++)t|=D.Animations[e].update(1e3/D.FRAMERATE);"function"==typeof D.opts.forceRedraw&&1==D.opts.forceRedraw()&&(t=!0),t&&(n(),D.Mouse.runEvents())},1e3/D.FRAMERATE)},D.stop=function(){D.intervalID&&clearInterval(D.intervalID)},D.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(t,e){this.events.push({type:"onclick",x:t,y:e,run:function(t){t.onclick&&t.onclick()}})},this.onmousemove=function(t,e){this.events.push({type:"onmousemove",x:t,y:e,run:function(t){t.onmousemove&&t.onmousemove()}})},this.eventElements=[],this.checkPath=function(t,e){for(var i=0;i<this.events.length;i++){var n=this.events[i];e.isPointInPath&&e.isPointInPath(n.x,n.y)&&(this.eventElements[i]=t)}},this.checkBoundingBox=function(t,e){for(var i=0;i<this.events.length;i++){var n=this.events[i];e.isPointInBox(n.x,n.y)&&(this.eventElements[i]=t)}},this.runEvents=function(){D.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++)for(var e=this.events[t],i=this.eventElements[t];i;)e.run(i),i=i.parent;this.events=[],this.eventElements=[]}},D}(i||{});1==t.childNodes.length&&"OBJECT"==t.childNodes[0].nodeName||(t.svg=n);var s=t.getContext("2d");void 0!==e.documentElement?n.loadXmlDoc(s,e):"<"==e.substr(0,1)?n.loadXml(s,e):n.load(s,e)}else for(var r=document.querySelectorAll("svg"),o=0;o<r.length;o++){var a=r[o],l=document.createElement("canvas");l.width=a.clientWidth,l.height=a.clientHeight,a.parentNode.insertBefore(l,a),a.parentNode.removeChild(a);var h=document.createElement("div");h.appendChild(a),p(l,h.innerHTML)}};void 0!==Element.prototype.matches?d=function(t,e){return t.matches(e)}:void 0!==Element.prototype.webkitMatchesSelector?d=function(t,e){return t.webkitMatchesSelector(e)}:void 0!==Element.prototype.mozMatchesSelector?d=function(t,e){return t.mozMatchesSelector(e)}:void 0!==Element.prototype.msMatchesSelector?d=function(t,e){return t.msMatchesSelector(e)}:void 0!==Element.prototype.oMatchesSelector?d=function(t,e){return t.oMatchesSelector(e)}:("function"!=typeof jQuery&&"function"!=typeof Zepto||(d=function(t,e){return $(t).is(e)}),void 0===d&&(d=Sizzle.matchesSelector));var e=/(\[[^\]]+\])/g,i=/(#[^\s\+>~\.\[:]+)/g,r=/(\.[^\s\+>~\.\[:]+)/g,o=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,a=/(:[\w-]+\([^\)]*\))/gi,l=/(:[^\s\+>~\.\[:]+)/g,h=/([^\s\+>~\.\[:]+)/g;return"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(t,e,i,n,s,r){var o={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:e,offsetY:i,scaleWidth:n,scaleHeight:s};for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a]);p(this.canvas,t,o)}),p}function x(n){function t(t,e){var i=n.match(t);null!=i&&(s[e]+=i.length,n=n.replace(t," "))}var s=[0,0,0];return n=(n=n.replace(/:not\(([^\)]*)\)/g,"     $1 ")).replace(/{[\s\S]*/gm," "),t(e,1),t(i,0),t(r,1),t(o,2),t(a,1),t(l,1),n=(n=n.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),t(h,2),s.join("")}});var p;var f,m=Math,E=m.abs,v=m.cos,y=m.sin,L=m.sqrt,z=m.min,O=m.max,b=m.atan2,w=m.round,C=m.floor,I=m.PI,M=m.pow,x={curveThroughPoints:function(t){return console.warn("deprecated"),new B(A.throughPoints(t)).serialize()},getCurveControlPoints:function(t){console.warn("deprecated");var e,i=[],n=[],s=t.length-1;if(1==s)return i[0]=new j((2*t[0].x+t[1].x)/3,(2*t[0].y+t[1].y)/3),n[0]=new j(2*i[0].x-t[0].x,2*i[0].y-t[0].y),[i,n];var r=[];for(e=1;e<s-1;e++)r[e]=4*t[e].x+2*t[e+1].x;r[0]=t[0].x+2*t[1].x,r[s-1]=(8*t[s-1].x+t[s].x)/2;var o=this.getFirstControlPoints(r);for(e=1;e<s-1;++e)r[e]=4*t[e].y+2*t[e+1].y;r[0]=t[0].y+2*t[1].y,r[s-1]=(8*t[s-1].y+t[s].y)/2;var a=this.getFirstControlPoints(r);for(e=0;e<s;e++)i.push(new j(o[e],a[e])),e<s-1?n.push(new j(2*t[e+1].x-o[e+1],2*t[e+1].y-a[e+1])):n.push(new j((t[s].x+o[s-1])/2,(t[s].y+a[s-1])/2));return[i,n]},getCurveDivider:function(t,e,i,n){console.warn("deprecated");var s=new A(t,e,i,n);return function(t){var e=s.divide(t);return[{p0:e[0].start,p1:e[0].controlPoint1,p2:e[0].controlPoint2,p3:e[0].end},{p0:e[1].start,p1:e[1].controlPoint1,p2:e[1].controlPoint2,p3:e[1].end}]}},getFirstControlPoints:function(t){console.warn("deprecated");var e=t.length,i=[],n=[],s=2;i[0]=t[0]/s;for(var r=1;r<e;r++)n[r]=1/s,s=(r<e-1?4:3.5)-n[r],i[r]=(t[r]-i[r-1])/s;for(r=1;r<e;r++)i[e-r-1]-=n[e-r]*i[e-r];return i},getInversionSolver:function(t,e,i,n){console.warn("deprecated");var s=new A(t,e,i,n);return function(t){return s.closestPointT(t)}}},A=function(t,e,i,n){return this instanceof A?t instanceof A?new A(t.start,t.controlPoint1,t.controlPoint2,t.end):(this.start=new j(t),this.controlPoint1=new j(e),this.controlPoint2=new j(i),void(this.end=new j(n))):new A(t,e,i,n)};function S(t){var e=t.length,i=[],n=[],s=2;i[0]=t[0]/s;for(var r=1;r<e;r++)n[r]=1/s,s=(r<e-1?4:3.5)-n[r],i[r]=(t[r]-i[r-1])/s;for(r=1;r<e;r++)i[e-r-1]-=n[e-r]*i[e-r];return i}A.throughPoints=function(t){if(!t||Array.isArray(t)&&t.length<2)throw new Error("At least 2 points are required");for(var e=function(t){var e,i=[],n=[],s=t.length-1;if(1==s)return i[0]=new j((2*t[0].x+t[1].x)/3,(2*t[0].y+t[1].y)/3),n[0]=new j(2*i[0].x-t[0].x,2*i[0].y-t[0].y),[i,n];var r=[];for(e=1;e<s-1;e++)r[e]=4*t[e].x+2*t[e+1].x;r[0]=t[0].x+2*t[1].x,r[s-1]=(8*t[s-1].x+t[s].x)/2;var o=S(r);for(e=1;e<s-1;++e)r[e]=4*t[e].y+2*t[e+1].y;r[0]=t[0].y+2*t[1].y,r[s-1]=(8*t[s-1].y+t[s].y)/2;var a=S(r);for(e=0;e<s;e++)i.push(new j(o[e],a[e])),e<s-1?n.push(new j(2*t[e+1].x-o[e+1],2*t[e+1].y-a[e+1])):n.push(new j((t[s].x+o[s-1])/2,(t[s].y+a[s-1])/2));return[i,n]}(t),i=[],n=e[0].length,s=0;s<n;s++){var r=new j(e[0][s].x,e[0][s].y),o=new j(e[1][s].x,e[1][s].y);i.push(new A(t[s],r,o,t[s+1]))}return i},A.prototype={bbox:function(){for(var t,e,i,n,s,r,o,a,l=this.start,h=this.controlPoint1,c=this.controlPoint2,u=this.end,d=l.x,p=l.y,g=h.x,f=h.y,m=c.x,v=c.y,y=u.x,b=u.y,w=new Array,C=new Array,I=[new Array,new Array],x=0;x<2;++x)if(i=0===x?(e=6*d-12*g+6*m,t=-3*d+9*g-9*m+3*y,3*g-3*d):(e=6*p-12*f+6*v,t=-3*p+9*f-9*v+3*b,3*f-3*p),E(t)<1e-12){if(E(e)<1e-12)continue;0<(n=-i/e)&&n<1&&C.push(n)}else a=L(o=e*e-4*i*t),o<0||(0<(s=(-e+a)/(2*t))&&s<1&&C.push(s),0<(r=(-e-a)/(2*t))&&r<1&&C.push(r));for(var A,S,_,P=C.length,M=P;P--;)S=(A=1-(n=C[P]))*A*A*d+3*A*A*n*g+3*A*n*n*m+n*n*n*y,I[0][P]=S,_=A*A*A*p+3*A*A*n*f+3*A*n*n*v+n*n*n*b,I[1][P]=_,w[P]={X:S,Y:_};C[M]=0,C[M+1]=1,w[M]={X:d,Y:p},w[M+1]={X:y,Y:b},I[0][M]=d,I[1][M]=p,I[0][M+1]=y,I[1][M+1]=b,C.length=M+2,I[0].length=M+2,I[1].length=M+2,w.length=M+2;var k=z.apply(null,I[0]),T=z.apply(null,I[1]),N=O.apply(null,I[0]),D=O.apply(null,I[1]);return new Q(k,T,N-k,D-T)},clone:function(){return new A(this.start,this.controlPoint1,this.controlPoint2,this.end)},closestPoint:function(t,e){return this.pointAtT(this.closestPointT(t,e))},closestPointLength:function(t,e){var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision,n={precision:i,subdivisions:void 0===e.subdivisions?this.getSubdivisions({precision:i}):e.subdivisions};return this.lengthAtT(this.closestPointT(t,n),n)},closestPointNormalizedLength:function(t,e){var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision,n={precision:i,subdivisions:void 0===e.subdivisions?this.getSubdivisions({precision:i}):e.subdivisions},s=this.closestPointLength(t,n);if(!s)return 0;var r=this.length(n);return 0===r?0:s/r},closestPointT:function(t,e){for(var i,n,s,r,o,a,l,h=void 0===(e=e||{}).precision?this.PRECISION:e.precision,c=void 0===e.subdivisions?this.getSubdivisions({precision:h}):e.subdivisions,u=c.length,d=u?1/u:0,p=0;p<u;p++){var g=c[p],f=g.start.distance(t),m=g.end.distance(t),v=f+m;(!l||v<l)&&(n=p*d,s=(p+1)*d,r=f,o=m,a=(i=g).start.distance(g.end),l=v)}for(var y=M(10,-h);;){var b=r?E(r-o)/r:0,w=o?E(r-o)/o:0;if(b<y||w<y||(!r||r<a*y||(!o||o<a*y)))return r<=o?n:s;var C=i.divide(.5);d/=2;var I=C[0].start.distance(t),x=C[0].end.distance(t),A=I+x,S=C[1].start.distance(t),_=C[1].end.distance(t);o=A<=S+_?(i=C[0],s-=d,r=I,x):(i=C[1],n+=d,r=S,_)}},closestPointTangent:function(t,e){return this.tangentAtT(this.closestPointT(t,e))},containsPoint:function(t,e){return this.toPolyline(e).containsPoint(t)},divideAt:function(t,e){if(t<=0)return this.divideAtT(0);if(1<=t)return this.divideAtT(1);var i=this.tAt(t,e);return this.divideAtT(i)},divideAtLength:function(t,e){var i=this.tAtLength(t,e);return this.divideAtT(i)},divideAtT:function(t){var e=this.start,i=this.controlPoint1,n=this.controlPoint2,s=this.end;if(t<=0)return[new A(e,e,e,e),new A(e,i,n,s)];if(1<=t)return[new A(e,i,n,s),new A(s,s,s,s)];var r=this.getSkeletonPoints(t),o=r.startControlPoint1,a=r.startControlPoint2,l=r.divider,h=r.dividerControlPoint1,c=r.dividerControlPoint2;return[new A(e,o,a,l),new A(l,h,c,s)]},endpointDistance:function(){return this.start.distance(this.end)},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.controlPoint1.x===t.controlPoint1.x&&this.controlPoint1.y===t.controlPoint1.y&&this.controlPoint2.x===t.controlPoint2.x&&this.controlPoint2.y===t.controlPoint2.y&&this.end.x===t.end.x&&this.end.y===t.end.y},getSkeletonPoints:function(t){var e=this.start,i=this.controlPoint1,n=this.controlPoint2,s=this.end;if(t<=0)return{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:i.clone(),dividerControlPoint2:n.clone()};if(1<=t)return{startControlPoint1:i.clone(),startControlPoint2:n.clone(),divider:s.clone(),dividerControlPoint1:s.clone(),dividerControlPoint2:s.clone()};var r=new G(e,i).pointAt(t),o=new G(i,n).pointAt(t),a=new G(n,s).pointAt(t),l=new G(r,o).pointAt(t),h=new G(o,a).pointAt(t);return{startControlPoint1:r,startControlPoint2:l,divider:new G(l,h).pointAt(t),dividerControlPoint1:h,dividerControlPoint2:a}},getSubdivisions:function(t){var e=void 0===(t=t||{}).precision?this.PRECISION:t.precision,i=[new A(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(0===e)return i;for(var n=this.endpointDistance(),s=M(10,-e),r=0;;){r+=1;for(var o=[],a=i.length,l=0;l<a;l++){var h=i[l].divide(.5);o.push(h[0],h[1])}for(var c=0,u=o.length,d=0;d<u;d++){c+=o[d].endpointDistance()}if(1<r&&(0!==c?(c-n)/c:0)<s)return o;i=o,n=c}},isDifferentiable:function(){var t=this.start,e=this.controlPoint1,i=this.controlPoint2,n=this.end;return!(t.equals(e)&&e.equals(i)&&i.equals(n))},length:function(t){for(var e=void 0===(t=t||{}).precision?this.PRECISION:t.precision,i=void 0===t.subdivisions?this.getSubdivisions({precision:e}):t.subdivisions,n=0,s=i.length,r=0;r<s;r++){n+=i[r].endpointDistance()}return n},lengthAtT:function(t,e){if(t<=0)return 0;var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision;return this.divide(t)[0].length({precision:i})},pointAt:function(t,e){if(t<=0)return this.start.clone();if(1<=t)return this.end.clone();var i=this.tAt(t,e);return this.pointAtT(i)},pointAtLength:function(t,e){var i=this.tAtLength(t,e);return this.pointAtT(i)},pointAtT:function(t){return t<=0?this.start.clone():1<=t?this.end.clone():this.getSkeletonPoints(t).divider},PRECISION:3,scale:function(t,e,i){return this.start.scale(t,e,i),this.controlPoint1.scale(t,e,i),this.controlPoint2.scale(t,e,i),this.end.scale(t,e,i),this},tangentAt:function(t,e){if(!this.isDifferentiable())return null;t<0?t=0:1<t&&(t=1);var i=this.tAt(t,e);return this.tangentAtT(i)},tangentAtLength:function(t,e){if(!this.isDifferentiable())return null;var i=this.tAtLength(t,e);return this.tangentAtT(i)},tangentAtT:function(t){if(!this.isDifferentiable())return null;t<0?t=0:1<t&&(t=1);var e=this.getSkeletonPoints(t),i=e.startControlPoint2,n=e.dividerControlPoint1,s=e.divider,r=new G(i,n);return r.translate(s.x-i.x,s.y-i.y),r},tAt:function(t,e){if(t<=0)return 0;if(1<=t)return 1;var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision,n={precision:i,subdivisions:void 0===e.subdivisions?this.getSubdivisions({precision:i}):e.subdivisions},s=this.length(n)*t;return this.tAtLength(s,n)},tAtLength:function(t,e){var i=!0;t<0&&(i=!1,t=-t);for(var n,s,r,o,a,l=void 0===(e=e||{}).precision?this.PRECISION:e.precision,h=void 0===e.subdivisions?this.getSubdivisions({precision:l}):e.subdivisions,c={precision:l,subdivisions:h},u=0,d=h.length,p=1/d,g=0;g<d;g++){var f=i?g:d-1-g,m=h[g],v=m.endpointDistance();if(t<=u+v){n=m,s=f*p,r=(f+1)*p,o=i?t-u:v+u-t,a=i?v+u-t:t-u;break}u+=v}if(!n)return i?1:0;for(var y=this.length(c),b=M(10,-l);;){var w,C;if((0!==y?o/y:0)<b)return s;if((0!==y?a/y:0)<b)return r;var I=n.divide(.5);p/=2;var x=I[0].endpointDistance(),A=I[1].endpointDistance();C=o<=x?(n=I[0],r-=p,x-(w=o)):(n=I[1],s+=p,A-(w=o-x)),o=w,a=C}},toPoints:function(t){for(var e=void 0===(t=t||{}).precision?this.PRECISION:t.precision,i=void 0===t.subdivisions?this.getSubdivisions({precision:e}):t.subdivisions,n=[i[0].start.clone()],s=i.length,r=0;r<s;r++){var o=i[r];n.push(o.end.clone())}return n},toPolyline:function(t){return new K(this.toPoints(t))},toString:function(){return this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.start.translate(t,e),this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}},A.prototype.divide=A.prototype.divideAtT;var _=function(t,e,i){return this instanceof _?t instanceof _?new _(new j(t.x,t.y),t.a,t.b):(t=new j(t),this.x=t.x,this.y=t.y,this.a=e,void(this.b=i)):new _(t,e,i)};_.fromRect=function(t){return t=new Q(t),new _(t.center(),t.width/2,t.height/2)},_.prototype={bbox:function(){return new Q(this.x-this.a,this.y-this.b,2*this.a,2*this.b)},center:function(){return new j(this.x,this.y)},clone:function(){return new _(this)},containsPoint:function(t){return this.normalizedDistance(t)<=1},equals:function(t){return!!t&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b},inflate:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.a+=2*t,this.b+=2*e,this},intersectionWithLine:function(t){var e=[],i=t.start,n=t.end,s=this.a,r=this.b,o=t.vector(),a=i.difference(new j(this)),l=new j(o.x/(s*s),o.y/(r*r)),h=new j(a.x/(s*s),a.y/(r*r)),c=o.dot(l),u=o.dot(h),d=u*u-c*(a.dot(h)-1);if(d<0)return null;if(0<d){var p=L(d),g=(-u-p)/c,f=(-u+p)/c;if((g<0||1<g)&&(f<0||1<f))return null;0<=g&&g<=1&&e.push(i.lerp(n,g)),0<=f&&f<=1&&e.push(i.lerp(n,f))}else{var m=-u/c;if(!(0<=m&&m<=1))return null;e.push(i.lerp(n,m))}return e},intersectionWithLineFromCenterToPoint:function(t,e){t=new j(t),e&&t.rotate(new j(this.x,this.y),e);var i,n=t.x-this.x,s=t.y-this.y;if(0==n)return i=this.bbox().pointNearestToPoint(t),e?i.rotate(new j(this.x,this.y),-e):i;var r=s/n,o=r*r,a=this.a*this.a,l=this.b*this.b,h=L(1/(1/a+o/l)),c=r*(h=n<0?-h:h);return i=new j(this.x+h,this.y+c),e?i.rotate(new j(this.x,this.y),-e):i},normalizedDistance:function(t){var e=t.x,i=t.y,n=this.a,s=this.b,r=this.x,o=this.y;return(e-r)*(e-r)/(n*n)+(i-o)*(i-o)/(s*s)},tangentTheta:function(t){var e,i,n=t.x,s=t.y,r=this.a,o=this.b,a=this.bbox().center(),l=a.x,h=a.y,c=n>a.x+r/2,u=n<a.x-r/2;return c||u?i=r*r/(n-l)-r*r*(s-h)*((e=n>a.x?s-30:s+30)-h)/(o*o*(n-l))+l:e=o*o/(s-h)-o*o*(n-l)*((i=s>a.y?n+30:n-30)-l)/(r*r*(s-h))+h,new j(i,e).theta(t)},toString:function(){return new j(this.x,this.y).toString()+" "+this.a+" "+this.b}};var G=function(t,e){return this instanceof G?t instanceof G?new G(t.start,t.end):(this.start=new j(t),void(this.end=new j(e))):new G(t,e)};G.prototype={angle:function(){var t=new j(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,t)},bbox:function(){var t=z(this.start.x,this.end.x),e=z(this.start.y,this.end.y),i=O(this.start.x,this.end.x),n=O(this.start.y,this.end.y);return new Q(t,e,i-t,n-e)},bearing:function(){var t=T(this.start.y),e=T(this.end.y),i=this.start.x,n=this.end.x,s=T(n-i),r=y(s)*v(e),o=v(t)*y(e)-y(t)*v(e)*v(s),a=tt(b(r,o))-22.5;return a<0&&(a+=360),["NE","E","SE","S","SW","W","NW","N"][a=parseInt(a/45)]},clone:function(){return new G(this.start,this.end)},closestPoint:function(t){return this.pointAt(this.closestPointNormalizedLength(t))},closestPointLength:function(t){return this.closestPointNormalizedLength(t)*this.length()},closestPointNormalizedLength:function(t){var e=this.vector().dot(new G(this.start,t).vector()),i=z(1,O(0,e/this.squaredLength()));return i!=i?0:i},closestPointTangent:function(t){return this.tangentAt(this.closestPointNormalizedLength(t))},containsPoint:function(t){var e=this.start,i=this.end;if(0!==e.cross(t,i))return!1;var n=this.length();return!(new G(e,t).length()>n)&&!(new G(t,i).length()>n)},divideAt:function(t){var e=this.pointAt(t);return[new G(this.start,e),new G(e,this.end)]},divideAtLength:function(t){var e=this.pointAtLength(t);return[new G(this.start,e),new G(e,this.end)]},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y},intersect:function(t,e){if(t instanceof G||t instanceof Q||t instanceof K||t instanceof _||t instanceof B){var i=t.intersectionWithLine(this,e);return i&&t instanceof G&&(i=i[0]),i}return null},intersectionWithLine:function(t){var e=new j(this.end.x-this.start.x,this.end.y-this.start.y),i=new j(t.end.x-t.start.x,t.end.y-t.start.y),n=e.x*i.y-e.y*i.x,s=new j(t.start.x-this.start.x,t.start.y-this.start.y),r=s.x*i.y-s.y*i.x,o=s.x*e.y-s.y*e.x;if(0==n||r*n<0||o*n<0)return null;if(0<n){if(n<r||n<o)return null}else if(r<n||o<n)return null;return[new j(this.start.x+r*e.x/n,this.start.y+r*e.y/n)]},isDifferentiable:function(){return!this.start.equals(this.end)},length:function(){return L(this.squaredLength())},midpoint:function(){return new j((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)},pointAt:function(t){var e=this.start,i=this.end;return t<=0?e.clone():1<=t?i.clone():e.lerp(i,t)},pointAtLength:function(t){var e=this.start,i=this.end,n=!0;t<0&&(n=!1,t=-t);var s=this.length();return s<=t?n?i.clone():e.clone():this.pointAt((n?t:s-t)/s)},pointOffset:function(t){t=new j(t);var e=this.start,i=this.end;return((i.x-e.x)*(t.y-e.y)-(i.y-e.y)*(t.x-e.x))/this.length()},rotate:function(t,e){return this.start.rotate(t,e),this.end.rotate(t,e),this},round:function(t){var e=M(10,t||0);return this.start.x=w(this.start.x*e)/e,this.start.y=w(this.start.y*e)/e,this.end.x=w(this.end.x*e)/e,this.end.y=w(this.end.y*e)/e,this},scale:function(t,e,i){return this.start.scale(t,e,i),this.end.scale(t,e,i),this},setLength:function(t){var e=this.length();if(!e)return this;var i=t/e;return this.scale(i,i,this.start)},squaredLength:function(){var t=this.start.x,e=this.start.y;return(t-=this.end.x)*t+(e-=this.end.y)*e},tangentAt:function(t){if(!this.isDifferentiable())return null;var e=this.start,i=this.end,n=this.pointAt(t),s=new G(e,i);return s.translate(n.x-e.x,n.y-e.y),s},tangentAtLength:function(t){if(!this.isDifferentiable())return null;var e=this.start,i=this.end,n=this.pointAtLength(t),s=new G(e,i);return s.translate(n.x-e.x,n.y-e.y),s},toString:function(){return this.start.toString()+" "+this.end.toString()},translate:function(t,e){return this.start.translate(t,e),this.end.translate(t,e),this},vector:function(){return new j(this.end.x-this.start.x,this.end.y-this.start.y)}},G.prototype.intersection=G.prototype.intersect;var B=function(t){if(!(this instanceof B))return new B(t);if("string"==typeof t)return new B.parse(t);var e,i;if(this.segments=[],t)if(Array.isArray(t)&&0!==t.length)if(i=(t=t.reduce(function(t,e){return t.concat(e)},[])).length,t[0].isSegment)for(e=0;e<i;e++){var n=t[e];this.appendSegment(n)}else{var s=null;for(e=0;e<i;e++){var r=t[e];if(!(r instanceof G||r instanceof A))throw new Error("Cannot construct a path segment from the provided object.");0===e&&this.appendSegment(B.createSegment("M",r.start)),s&&!s.end.equals(r.start)&&this.appendSegment(B.createSegment("M",r.start)),r instanceof G?this.appendSegment(B.createSegment("L",r.end)):r instanceof A&&this.appendSegment(B.createSegment("C",r.controlPoint1,r.controlPoint2,r.end)),s=r}}else if(t.isSegment)this.appendSegment(t);else if(t instanceof G)this.appendSegment(B.createSegment("M",t.start)),this.appendSegment(B.createSegment("L",t.end));else if(t instanceof A)this.appendSegment(B.createSegment("M",t.start)),this.appendSegment(B.createSegment("C",t.controlPoint1,t.controlPoint2,t.end));else{if(!(t instanceof K))throw new Error("Cannot construct a path from the provided object.");if(!t.points||0===t.points.length)return;for(i=t.points.length,e=0;e<i;e++){var o=t.points[e];0===e?this.appendSegment(B.createSegment("M",o)):this.appendSegment(B.createSegment("L",o))}}else;};B.parse=function(t){if(!t)return new B;for(var e=new B,i=t.match(/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g),n=i.length,s=0;s<n;s++){var r=i[s].match(/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g),o=B.createSegment.apply(this,r);e.appendSegment(o)}return e},B.createSegment=function(t){var e=arguments;if(!t)throw new Error("Type must be provided.");var i=B.segmentTypes[t];if(!i)throw new Error(t+" is not a recognized path segment type.");for(var n=[],s=arguments.length,r=1;r<s;r++)n.push(e[r]);return U(i,n)},B.prototype={appendSegment:function(t){var e,i=this.segments,n=i.length,s=0!==n?i[n-1]:null;if(Array.isArray(t)){if(!(t=t.reduce(function(t,e){return t.concat(e)},[]))[0].isSegment)throw new Error("Segments required.");for(var r=t.length,o=0;o<r;o++){var a=t[o];e=this.prepareSegment(a,s,null),i.push(e),s=e}}else{if(!t||!t.isSegment)throw new Error("Segment required.");e=this.prepareSegment(t,s,null),i.push(e)}},bbox:function(){var t,e=this.segments,i=e.length;if(0===i)return null;for(var n=0;n<i;n++){var s=e[n];if(s.isVisible){var r=s.bbox();t=t?t.union(r):r}}if(t)return t;var o=e[i-1];return new Q(o.end.x,o.end.y,0,0)},clone:function(){for(var t=this.segments,e=t.length,i=new B,n=0;n<e;n++){var s=t[n].clone();i.appendSegment(s)}return i},closestPoint:function(t,e){var i=this.closestPointT(t,e);return i?this.pointAtT(i):null},closestPointLength:function(t,e){var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision,n={precision:i,segmentSubdivisions:void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:i}):e.segmentSubdivisions},s=this.closestPointT(t,n);return s?this.lengthAtT(s,n):0},closestPointNormalizedLength:function(t,e){var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision,n={precision:i,segmentSubdivisions:void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:i}):e.segmentSubdivisions},s=this.closestPointLength(t,n);if(0===s)return 0;var r=this.length(n);return 0===r?0:s/r},closestPointT:function(t,e){var i=this.segments,n=i.length;if(0===n)return null;for(var s,r=void 0===(e=e||{}).precision?this.PRECISION:e.precision,o=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,a=1/0,l=0;l<n;l++){var h=i[l],c=o[l];if(h.isVisible){var u=h.closestPointT(t,{precision:r,subdivisions:c}),d=h.pointAtT(u),p=new G(d,t).squaredLength();p<a&&(s={segmentIndex:l,value:u},a=p)}}return s||{segmentIndex:n-1,value:1}},closestPointTangent:function(t,e){var i=this.segments,n=i.length;if(0===n)return null;for(var s,r=void 0===(e=e||{}).precision?this.PRECISION:e.precision,o=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,a=1/0,l=0;l<n;l++){var h=i[l],c=o[l];if(h.isDifferentiable()){var u=h.closestPointT(t,{precision:r,subdivisions:c}),d=h.pointAtT(u),p=new G(d,t).squaredLength();p<a&&(s=h.tangentAtT(u),a=p)}}return s||null},containsPoint:function(t,e){var i=this.toPolylines(e);if(!i)return!1;for(var n=i.length,s=0,r=0;r<n;r++){i[r].containsPoint(t)&&s++}return s%2==1},divideAt:function(t,e){if(0===this.segments.length)return null;t<0&&(t=0),1<t&&(t=1);var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision,n={precision:i,segmentSubdivisions:void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:i}):e.segmentSubdivisions},s=this.length(n)*t;return this.divideAtLength(s,n)},divideAtLength:function(t,e){var i=this.segments.length;if(0===i)return null;var n=!0;t<0&&(n=!1,t=-t);var s,r,o,a,l,h,c,u=void 0===(e=e||{}).precision?this.PRECISION:e.precision,d=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:u}):e.segmentSubdivisions,p=0;for(s=0;s<i;s++){var g=n?s:i-1-s;r=this.getSegment(g);var f=d[g],m=r.length({precision:u,subdivisions:f});if(r.isDifferentiable()&&(l=r,h=g,t<=p+m)){a=g,o=r.divideAtLength((n?1:-1)*(t-p),{precision:u,subdivisions:f});break}p+=m}if(!l)return null;o||(a=h,c=n?1:0,o=l.divideAtT(c));var v=this.clone();v.replaceSegment(a,o);var y=a,b=a+1,w=a+2;o[0].isDifferentiable()||(v.removeSegment(y),--b,--w);var C=v.getSegment(b).start;v.insertSegment(b,B.createSegment("M",C)),w+=1,o[1].isDifferentiable()||(v.removeSegment(w-1),--w);var I=w-y-1;for(s=w;s<v.segments.length;s++){var x=this.getSegment(s-I);if("Z"===(r=v.getSegment(s)).type&&!x.subpathStartSegment.end.equals(r.subpathStartSegment.end)){var A=B.createSegment("L",x.end);v.replaceSegment(s,A)}}return[new B(v.segments.slice(0,b)),new B(v.segments.slice(b))]},equals:function(t){if(!t)return!1;var e=this.segments,i=t.segments,n=e.length;if(i.length!==n)return!1;for(var s=0;s<n;s++){var r=e[s],o=i[s];if(r.type!==o.type||!r.equals(o))return!1}return!0},getSegment:function(t){var e=this.segments,i=e.length;if(0===i)throw new Error("Path has no segments.");if(t<0&&(t=i+t),i<=t||t<0)throw new Error("Index out of range.");return e[t]},getSegmentSubdivisions:function(t){for(var e=this.segments,i=e.length,n=void 0===(t=t||{}).precision?this.PRECISION:t.precision,s=[],r=0;r<i;r++){var o=e[r].getSubdivisions({precision:n});s.push(o)}return s},insertSegment:function(t,e){var i,n=this.segments,s=n.length;if(t<0&&(t=s+t+1),s<t||t<0)throw new Error("Index out of range.");var r=null,o=null;if(0!==s&&(o=1<=t?(r=n[t-1]).nextSegment:n[0]),Array.isArray(e)){if(!(e=e.reduce(function(t,e){return t.concat(e)},[]))[0].isSegment)throw new Error("Segments required.");for(var a=e.length,l=0;l<a;l++){var h=e[l];i=this.prepareSegment(h,r,o),n.splice(t+l,0,i),r=i}}else{if(!e||!e.isSegment)throw new Error("Segment required.");i=this.prepareSegment(e,r,o),n.splice(t,0,i)}},intersectionWithLine:function(t,e){var i=null,n=this.toPolylines(e);if(!n)return null;for(var s=0,r=n.length;s<r;s++){var o=n[s],a=t.intersect(o);a&&(i=i||[],Array.isArray(a)?Array.prototype.push.apply(i,a):i.push(a))}return i},isDifferentiable:function(){for(var t=this.segments,e=t.length,i=0;i<e;i++){if(t[i].isDifferentiable())return!0}return!1},isValid:function(){var t=this.segments;return 0===t.length||"M"===t[0].type},length:function(t){var e=this.segments,i=e.length;if(0===i)return 0;for(var n=void 0===(t=t||{}).precision?this.PRECISION:t.precision,s=void 0===t.segmentSubdivisions?this.getSegmentSubdivisions({precision:n}):t.segmentSubdivisions,r=0,o=0;o<i;o++){var a=e[o],l=s[o];r+=a.length({subdivisions:l})}return r},lengthAtT:function(t,e){var i=this.segments,n=i.length;if(0===n)return 0;var s=t.segmentIndex;if(s<0)return 0;var r=t.value;n<=s?(s=n-1,r=1):r<0?r=0:1<r&&(r=1);for(var o,a=void 0===(e=e||{}).precision?this.PRECISION:e.precision,l=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:a}):e.segmentSubdivisions,h=0,c=0;c<s;c++){var u=i[c];o=l[c],h+=u.length({precisison:a,subdivisions:o})}return u=i[s],o=l[s],h+=u.lengthAtT(r,{precisison:a,subdivisions:o})},pointAt:function(t,e){if(0===this.segments.length)return null;if(t<=0)return this.start.clone();if(1<=t)return this.end.clone();var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision,n={precision:i,segmentSubdivisions:void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:i}):e.segmentSubdivisions},s=this.length(n)*t;return this.pointAtLength(s,n)},pointAtLength:function(t,e){var i=this.segments,n=i.length;if(0===n)return null;if(0===t)return this.start.clone();var s=!0;t<0&&(s=!1,t=-t);for(var r,o=void 0===(e=e||{}).precision?this.PRECISION:e.precision,a=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,l=0,h=0;h<n;h++){var c=s?h:n-1-h,u=i[c],d=a[c],p=u.length({precision:o,subdivisions:d});if(u.isVisible){if(t<=l+p)return u.pointAtLength((s?1:-1)*(t-l),{precision:o,subdivisions:d});r=u}l+=p}return r?s?r.end:r.start:i[n-1].end.clone()},pointAtT:function(t){var e=this.segments,i=e.length;if(0===i)return null;var n=t.segmentIndex;if(n<0)return e[0].pointAtT(0);if(i<=n)return e[i-1].pointAtT(1);var s=t.value;return s<0?s=0:1<s&&(s=1),e[n].pointAtT(s)},PRECISION:3,prepareSegment:function(t,e,i){t.previousSegment=e,t.nextSegment=i,e&&(e.nextSegment=t),i&&(i.previousSegment=t);var n=t;return t.isSubpathStart&&(t.subpathStartSegment=t,n=i),n&&this.updateSubpathStartSegment(n),t},removeSegment:function(t){var e=this.segments,i=e.length;if(0===i)throw new Error("Path has no segments.");if(t<0&&(t=i+t),i<=t||t<0)throw new Error("Index out of range.");var n=e.splice(t,1)[0],s=n.previousSegment,r=n.nextSegment;s&&(s.nextSegment=r),r&&(r.previousSegment=s),n.isSubpathStart&&r&&this.updateSubpathStartSegment(r)},replaceSegment:function(t,e){var i,n=this.segments,s=n.length;if(0===s)throw new Error("Path has no segments.");if(t<0&&(t=s+t),s<=t||t<0)throw new Error("Index out of range.");var r=n[t],o=r.previousSegment,a=r.nextSegment,l=r.isSubpathStart;if(Array.isArray(e)){if(!(e=e.reduce(function(t,e){return t.concat(e)},[]))[0].isSegment)throw new Error("Segments required.");n.splice(t,1);for(var h=e.length,c=0;c<h;c++){var u=e[c];i=this.prepareSegment(u,o,a),n.splice(t+c,0,i),o=i,l&&i.isSubpathStart&&(l=!1)}}else{if(!e||!e.isSegment)throw new Error("Segment required.");i=this.prepareSegment(e,o,a),n.splice(t,1,i),l&&i.isSubpathStart&&(l=!1)}l&&a&&this.updateSubpathStartSegment(a)},scale:function(t,e,i){for(var n=this.segments,s=n.length,r=0;r<s;r++){n[r].scale(t,e,i)}return this},segmentAt:function(t,e){var i=this.segmentIndexAt(t,e);return i?this.getSegment(i):null},segmentAtLength:function(t,e){var i=this.segmentIndexAtLength(t,e);return i?this.getSegment(i):null},segmentIndexAt:function(t,e){if(0===this.segments.length)return null;t<0&&(t=0),1<t&&(t=1);var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision,n={precision:i,segmentSubdivisions:void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:i}):e.segmentSubdivisions},s=this.length(n)*t;return this.segmentIndexAtLength(s,n)},segmentIndexAtLength:function(t,e){var i=this.segments,n=i.length;if(0===n)return null;var s=!0;t<0&&(s=!1,t=-t);for(var r=void 0===(e=e||{}).precision?this.PRECISION:e.precision,o=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,a=null,l=0,h=0;h<n;h++){var c=s?h:n-1-h,u=i[c],d=o[c],p=u.length({precision:r,subdivisions:d});if(u.isVisible){if(t<=l+p)return c;a=c}l+=p}return a},serialize:function(){if(!this.isValid())throw new Error("Invalid path segments.");return this.toString()},tangentAt:function(t,e){if(0===this.segments.length)return null;t<0&&(t=0),1<t&&(t=1);var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision,n={precision:i,segmentSubdivisions:void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:i}):e.segmentSubdivisions},s=this.length(n)*t;return this.tangentAtLength(s,n)},tangentAtLength:function(t,e){var i=this.segments,n=i.length;if(0===n)return null;var s=!0;t<0&&(s=!1,t=-t);for(var r,o=void 0===(e=e||{}).precision?this.PRECISION:e.precision,a=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,l=0,h=0;h<n;h++){var c=s?h:n-1-h,u=i[c],d=a[c],p=u.length({precision:o,subdivisions:d});if(u.isDifferentiable()){if(t<=l+p)return u.tangentAtLength((s?1:-1)*(t-l),{precision:o,subdivisions:d});r=u}l+=p}if(r){var g=s?1:0;return r.tangentAtT(g)}return null},tangentAtT:function(t){var e=this.segments,i=e.length;if(0===i)return null;var n=t.segmentIndex;if(n<0)return e[0].tangentAtT(0);if(i<=n)return e[i-1].tangentAtT(1);var s=t.value;return s<0?s=0:1<s&&(s=1),e[n].tangentAtT(s)},toPoints:function(t){var e=this.segments,i=e.length;if(0===i)return null;for(var n=void 0===(t=t||{}).precision?this.PRECISION:t.precision,s=void 0===t.segmentSubdivisions?this.getSegmentSubdivisions({precision:n}):t.segmentSubdivisions,r=[],o=[],a=0;a<i;a++){var l=e[a];if(l.isVisible){var h=s[a];if(0<h.length){var c=h.map(function(t){return t.start});Array.prototype.push.apply(o,c)}else o.push(l.start)}else 0<o.length&&(o.push(e[a-1].end),r.push(o),o=[])}return 0<o.length&&(o.push(this.end),r.push(o)),r},toPolylines:function(t){var e=[],i=this.toPoints(t);if(!i)return null;for(var n=0,s=i.length;n<s;n++)e.push(new K(i[n]));return e},toString:function(){for(var t=this.segments,e=t.length,i="",n=0;n<e;n++){i+=t[n].serialize()+" "}return i.trim()},translate:function(t,e){for(var i=this.segments,n=i.length,s=0;s<n;s++){i[s].translate(t,e)}return this},updateSubpathStartSegment:function(t){for(var e=t.previousSegment;t&&!t.isSubpathStart;)t.subpathStartSegment=e?e.subpathStartSegment:null,t=(e=t).nextSegment}},Object.defineProperty(B.prototype,"start",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(0===e)return null;for(var i=0;i<e;i++){var n=t[i];if(n.isVisible)return n.start}return t[e-1].end}}),Object.defineProperty(B.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(0===e)return null;for(var i=e-1;0<=i;i--){var n=t[i];if(n.isVisible)return n.end}return t[e-1].end}});var j=function(t,e){if(!(this instanceof j))return new j(t,e);if("string"==typeof t){var i=t.split(-1===t.indexOf("@")?" ":"@");t=parseFloat(i[0]),e=parseFloat(i[1])}else Object(t)===t&&(e=t.y,t=t.x);this.x=void 0===t?0:t,this.y=void 0===e?0:e};j.fromPolar=function(t,e,i){i=i&&new j(i)||new j(0,0);var n=E(t*v(e)),s=E(t*y(e)),r=q(tt(e));return r<90?s=-s:r<180?(n=-n,s=-s):r<270&&(n=-n),new j(i.x+n,i.y+s)},j.random=function(t,e,i,n){return new j(N(t,e),N(i,n))},j.prototype={chooseClosest:function(t){var e=t.length;if(1===e)return new j(t[0]);for(var i=null,n=1/0,s=0;s<e;s++){var r=new j(t[s]),o=this.squaredDistance(r);o<n&&(i=r,n=o)}return i},adhereToRect:function(t){return t.containsPoint(this)||(this.x=z(O(this.x,t.x),t.x+t.width),this.y=z(O(this.y,t.y),t.y+t.height)),this},angleBetween:function(t,e){var i=this.equals(t)||this.equals(e)?NaN:this.theta(e)-this.theta(t);return i<0&&(i+=360),i},bearing:function(t){return new G(this,t).bearing()},changeInAngle:function(t,e,i){return this.clone().offset(-t,-e).theta(i)-this.theta(i)},clone:function(){return new j(this)},cross:function(t,e){return t&&e?(e.x-this.x)*(t.y-this.y)-(e.y-this.y)*(t.x-this.x):NaN},difference:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),new j(this.x-(t||0),this.y-(e||0))},distance:function(t){return new G(this,t).length()},dot:function(t){return t?this.x*t.x+this.y*t.y:NaN},equals:function(t){return!!t&&this.x===t.x&&this.y===t.y},lerp:function(t,e){var i=this.x,n=this.y;return new j((1-e)*i+e*t.x,(1-e)*n+e*t.y)},magnitude:function(){return L(this.x*this.x+this.y*this.y)||.01},manhattanDistance:function(t){return E(t.x-this.x)+E(t.y-this.y)},move:function(t,e){var i=T(new j(t).theta(this));return this.offset(v(i)*e,-y(i)*e)},normalize:function(t){var e=(t||1)/this.magnitude();return this.scale(e,e)},offset:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),this.x+=t||0,this.y+=e||0,this},reflection:function(t){return new j(t).move(this,this.distance(t))},rotate:function(t,e){t=t||new j(0,0),e=T(q(-e));var i=v(e),n=y(e),s=i*(this.x-t.x)-n*(this.y-t.y)+t.x,r=n*(this.x-t.x)+i*(this.y-t.y)+t.y;return this.x=s,this.y=r,this},round:function(t){var e=M(10,t||0);return this.x=w(this.x*e)/e,this.y=w(this.y*e)/e,this},scale:function(t,e,i){return i=i&&new j(i)||new j(0,0),this.x=i.x+t*(this.x-i.x),this.y=i.y+e*(this.y-i.y),this},snapToGrid:function(t,e){return this.x=k(this.x,t),this.y=k(this.y,e||t),this},squaredDistance:function(t){return new G(this,t).squaredLength()},theta:function(t){var e=-((t=new j(t)).y-this.y),i=t.x-this.x,n=b(e,i);return n<0&&(n=2*I+n),180*n/I},toJSON:function(){return{x:this.x,y:this.y}},toPolar:function(t){t=t&&new j(t)||new j(0,0);var e=this.x,i=this.y;return this.x=L((e-t.x)*(e-t.x)+(i-t.y)*(i-t.y)),this.y=T(t.theta(new j(e,i))),this},toString:function(){return this.x+"@"+this.y},update:function(t,e){return this.x=t||0,this.y=e||0,this},vectorAngle:function(t){return new j(0,0).angleBetween(this,t)}},j.prototype.translate=j.prototype.offset;var K=function(t){return this instanceof K?"string"==typeof t?new K.parse(t):void(this.points=Array.isArray(t)?t.map(j):[]):new K(t)};K.parse=function(t){if(""===(t=t.trim()))return new K;for(var e=[],i=t.split(/\s*,\s*|\s+/),n=i.length,s=0;s<n;s+=2)e.push({x:+i[s],y:+i[s+1]});return new K(e)},K.prototype={bbox:function(){var t=1/0,e=-1/0,i=1/0,n=-1/0,s=this.points,r=s.length;if(0===r)return null;for(var o=0;o<r;o++){var a=s[o],l=a.x,h=a.y;l<t&&(t=l),e<l&&(e=l),h<i&&(i=h),n<h&&(n=h)}return new Q(t,i,e-t,n-i)},clone:function(){var t=this.points,e=t.length;if(0===e)return new K;for(var i=[],n=0;n<e;n++){var s=t[n].clone();i.push(s)}return new K(i)},closestPoint:function(t){var e=this.closestPointLength(t);return this.pointAtLength(e)},closestPointLength:function(t){var e,i=this.points,n=i.length;if(0===n)return 0;if(1===n)return 0;for(var s=1/0,r=0,o=n-1,a=0;a<o;a++){var l=new G(i[a],i[a+1]),h=l.length(),c=l.closestPointNormalizedLength(t),u=l.pointAt(c).squaredDistance(t);u<s&&(s=u,e=r+c*h),r+=h}return e},closestPointNormalizedLength:function(t){var e=this.closestPointLength(t);if(0===e)return 0;var i=this.length();return 0===i?0:e/i},closestPointTangent:function(t){var e=this.closestPointLength(t);return this.tangentAtLength(e)},containsPoint:function(t){var e=this.points,i=e.length;if(0===i)return!1;for(var n=t.x,s=t.y,r=i-1,o=0,a=0;o<i;o++){var l=e[r],h=e[o];if(t.equals(l))return!0;var c=new G(l,h);if(c.containsPoint(t))return!0;if(s<=l.y&&s>h.y||s>l.y&&s<=h.y){var u=l.x-n>h.x-n?l.x-n:h.x-n;if(0<=u){var d=new j(n+u,s),p=new G(t,d);c.intersect(p)&&a++}}r=o}return a%2==1},convexHull:function(){var t,e,i,n=this.points,s=n.length;if(0===s)return new K;for(t=0;t<s;t++)void 0===i?i=n[t]:n[t].y<i.y?i=n[t]:n[t].y===i.y&&n[t].x>i.x&&(i=n[t]);var r=[];for(t=0;t<s;t++){var o=i.theta(n[t]);0===o&&(o=360);var a=[n[t],t,o];r.push(a)}if(r.sort(function(t,e){var i=t[2]-e[2];return 0===i&&(i=e[1]-t[1]),i}),2<r.length){var l=r[r.length-1];r.unshift(l)}for(var h,c,u,d,p,g,f,m={},v=[];0!==r.length;)if(c=(h=r.pop())[0],!m.hasOwnProperty(h[0]+"@@"+h[1]))for(var y=!1;!y;)if(v.length<2)v.push(h),y=!0;else{d=(u=v.pop())[0];var b=(g=(p=v.pop())[0]).cross(d,c);if(b<0)v.push(p),v.push(u),v.push(h),y=!0;else if(0===b){var w=d.angleBetween(g,c);E(w-180)<1e-10?(m[u[0]+"@@"+u[1]]=d,v.push(p)):d.equals(c)||g.equals(d)?(m[u[0]+"@@"+u[1]]=d,v.push(p)):E((w+1)%360-1)<1e-10&&(v.push(p),r.push(u))}else m[u[0]+"@@"+u[1]]=d,v.push(p)}2<v.length&&v.pop();var C=-1;for(e=v.length,t=0;t<e;t++){var I=v[t][1];(void 0===f||I<f)&&(f=I,C=t)}var x=[];if(0<C){var A=v.slice(C),S=v.slice(0,C);x=A.concat(S)}else x=v;var _=[];for(e=x.length,t=0;t<e;t++)_.push(x[t][0]);return new K(_)},equals:function(t){if(!t)return!1;var e=this.points,i=t.points,n=e.length;if(i.length!==n)return!1;for(var s=0;s<n;s++){var r=e[s],o=t.points[s];if(!r.equals(o))return!1}return!0},intersectionWithLine:function(t){for(var e=new G(t),i=[],n=this.points,s=0,r=n.length-1;s<r;s++){var o=n[s],a=n[s+1],l=new G(o,a),h=e.intersectionWithLine(l);h&&i.push(h[0])}return 0<i.length?i:null},isDifferentiable:function(){var t=this.points,e=t.length;if(0===e)return!1;for(var i=e-1,n=0;n<i;n++){var s=t[n],r=t[n+1];if(new G(s,r).isDifferentiable())return!0}return!1},length:function(){var t=this.points,e=t.length;if(0===e)return 0;for(var i=0,n=e-1,s=0;s<n;s++)i+=t[s].distance(t[s+1]);return i},pointAt:function(t){var e=this.points,i=e.length;if(0===i)return null;if(1===i)return e[0].clone();if(t<=0)return e[0].clone();if(1<=t)return e[i-1].clone();var n=this.length()*t;return this.pointAtLength(n)},pointAtLength:function(t){var e=this.points,i=e.length;if(0===i)return null;if(1===i)return e[0].clone();var n=!0;t<0&&(n=!1,t=-t);for(var s=0,r=i-1,o=0;o<r;o++){var a=n?o:r-1-o,l=e[a],h=e[a+1],c=new G(l,h),u=l.distance(h);if(t<=s+u)return c.pointAtLength((n?1:-1)*(t-s));s+=u}return(n?e[i-1]:e[0]).clone()},scale:function(t,e,i){var n=this.points,s=n.length;if(0===s)return this;for(var r=0;r<s;r++)n[r].scale(t,e,i);return this},tangentAt:function(t){var e=this.points.length;if(0===e)return null;if(1===e)return null;t<0&&(t=0),1<t&&(t=1);var i=this.length()*t;return this.tangentAtLength(i)},tangentAtLength:function(t){var e=this.points,i=e.length;if(0===i)return null;if(1===i)return null;var n,s=!0;t<0&&(s=!1,t=-t);for(var r=0,o=i-1,a=0;a<o;a++){var l=s?a:o-1-a,h=e[l],c=e[l+1],u=new G(h,c),d=h.distance(c);if(u.isDifferentiable()){if(t<=r+d)return u.tangentAtLength((s?1:-1)*(t-r));n=u}r+=d}if(n){var p=s?1:0;return n.tangentAt(p)}return null},toString:function(){return this.points+""},translate:function(t,e){var i=this.points,n=i.length;if(0===n)return this;for(var s=0;s<n;s++)i[s].translate(t,e);return this},serialize:function(){var t=this.points,e=t.length;if(0===e)return"";for(var i="",n=0;n<e;n++){var s=t[n];i+=s.x+","+s.y+" "}return i.trim()}},Object.defineProperty(K.prototype,"start",{configurable:!0,enumerable:!0,get:function(){return 0===this.points.length?null:this.points[0]}}),Object.defineProperty(K.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.points.length;return 0===t?null:this.points[t-1]}});var Q=function(t,e,i,n){if(!(this instanceof Q))return new Q(t,e,i,n);Object(t)===t&&(e=t.y,i=t.width,n=t.height,t=t.x),this.x=void 0===t?0:t,this.y=void 0===e?0:e,this.width=void 0===i?0:i,this.height=void 0===n?0:n};Q.fromEllipse=function(t){return t=new _(t),new Q(t.x-t.a,t.y-t.b,2*t.a,2*t.b)},Q.prototype={bbox:function(t){if(!t)return this.clone();var e=T(t),i=E(y(e)),n=E(v(e)),s=this.width*n+this.height*i,r=this.width*i+this.height*n;return new Q(this.x+(this.width-s)/2,this.y+(this.height-r)/2,s,r)},bottomLeft:function(){return new j(this.x,this.y+this.height)},bottomLine:function(){return new G(this.bottomLeft(),this.bottomRight())},bottomMiddle:function(){return new j(this.x+this.width/2,this.y+this.height)},center:function(){return new j(this.x+this.width/2,this.y+this.height/2)},clone:function(){return new Q(this)},containsPoint:function(t){return(t=new j(t)).x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height},containsRect:function(t){var e=new Q(this).normalize(),i=new Q(t).normalize(),n=e.width,s=e.height,r=i.width,o=i.height;if(!(n&&s&&r&&o))return!1;var a=e.x,l=e.y,h=i.x,c=i.y;return r+=h,n+=a,o+=c,s+=l,a<=h&&r<=n&&l<=c&&o<=s},corner:function(){return new j(this.x+this.width,this.y+this.height)},equals:function(t){var e=new Q(this).normalize(),i=new Q(t).normalize();return e.x===i.x&&e.y===i.y&&e.width===i.width&&e.height===i.height},inflate:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},intersect:function(t){var e=this.origin(),i=this.corner(),n=t.origin(),s=t.corner();if(s.x<=e.x||s.y<=e.y||n.x>=i.x||n.y>=i.y)return null;var r=O(e.x,n.x),o=O(e.y,n.y);return new Q(r,o,z(i.x,s.x)-r,z(i.y,s.y)-o)},intersectionWithLine:function(t){var e,i,n=[this.topLine(),this.rightLine(),this.bottomLine(),this.leftLine()],s=[],r=[],o=n.length;for(i=0;i<o;i++)null!==(e=t.intersect(n[i]))&&r.indexOf(e.toString())<0&&(s.push(e),r.push(e.toString()));return 0<s.length?s:null},intersectionWithLineFromCenterToPoint:function(t,e){t=new j(t);var i,n=new j(this.x+this.width/2,this.y+this.height/2);e&&t.rotate(n,e);for(var s=[this.topLine(),this.rightLine(),this.bottomLine(),this.leftLine()],r=new G(n,t),o=s.length-1;0<=o;--o){var a=s[o].intersection(r);if(null!==a){i=a;break}}return i&&e&&i.rotate(n,-e),i},leftLine:function(){return new G(this.topLeft(),this.bottomLeft())},leftMiddle:function(){return new j(this.x,this.y+this.height/2)},maxRectScaleToFit:function(t,e){var i,n,s,r,o,a,l,h;t=new Q(t);var c=(e=e||t.center()).x,u=e.y;i=n=s=r=o=a=l=h=1/0;var d=t.topLeft();d.x<c&&(i=(this.x-c)/(d.x-c)),d.y<u&&(o=(this.y-u)/(d.y-u));var p=t.bottomRight();p.x>c&&(n=(this.x+this.width-c)/(p.x-c)),p.y>u&&(a=(this.y+this.height-u)/(p.y-u));var g=t.topRight();g.x>c&&(s=(this.x+this.width-c)/(g.x-c)),g.y<u&&(l=(this.y-u)/(g.y-u));var f=t.bottomLeft();return f.x<c&&(r=(this.x-c)/(f.x-c)),f.y>u&&(h=(this.y+this.height-u)/(f.y-u)),{sx:z(i,n,s,r),sy:z(o,a,l,h)}},maxRectUniformScaleToFit:function(t,e){var i=this.maxRectScaleToFit(t,e);return z(i.sx,i.sy)},moveAndExpand:function(t){return this.x+=t.x||0,this.y+=t.y||0,this.width+=t.width||0,this.height+=t.height||0,this},normalize:function(){var t=this.x,e=this.y,i=this.width,n=this.height;return this.width<0&&(t=this.x+this.width,i=-this.width),this.height<0&&(e=this.y+this.height,n=-this.height),this.x=t,this.y=e,this.width=i,this.height=n,this},offset:function(t,e){return j.prototype.offset.call(this,t,e)},origin:function(){return new j(this.x,this.y)},pointNearestToPoint:function(t){if(t=new j(t),this.containsPoint(t))switch(this.sideNearestToPoint(t)){case"right":return new j(this.x+this.width,t.y);case"left":return new j(this.x,t.y);case"bottom":return new j(t.x,this.y+this.height);case"top":return new j(t.x,this.y)}return t.adhereToRect(this)},rightLine:function(){return new G(this.topRight(),this.bottomRight())},rightMiddle:function(){return new j(this.x+this.width,this.y+this.height/2)},round:function(t){var e=M(10,t||0);return this.x=w(this.x*e)/e,this.y=w(this.y*e)/e,this.width=w(this.width*e)/e,this.height=w(this.height*e)/e,this},scale:function(t,e,i){return i=this.origin().scale(t,e,i),this.x=i.x,this.y=i.y,this.width*=t,this.height*=e,this},sideNearestToPoint:function(t){var e=(t=new j(t)).x-this.x,i=this.x+this.width-t.x,n=t.y-this.y,s=e,r="left";return i<s&&(s=i,r="right"),n<s&&(s=n,r="top"),this.y+this.height-t.y<s&&(r="bottom"),r},snapToGrid:function(t,e){var i=this.origin().snapToGrid(t,e),n=this.corner().snapToGrid(t,e);return this.x=i.x,this.y=i.y,this.width=n.x-i.x,this.height=n.y-i.y,this},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},topLine:function(){return new G(this.topLeft(),this.topRight())},topMiddle:function(){return new j(this.x+this.width/2,this.y)},topRight:function(){return new j(this.x+this.width,this.y)},toString:function(){return this.origin().toString()+" "+this.corner().toString()},union:function(t){t=new Q(t);var e=this.origin(),i=this.corner(),n=t.origin(),s=t.corner(),r=z(e.x,n.x),o=z(e.y,n.y),a=O(i.x,s.x),l=O(i.y,s.y);return new Q(r,o,a-r,l-o)}},Q.prototype.bottomRight=Q.prototype.corner,Q.prototype.topLeft=Q.prototype.origin,Q.prototype.translate=Q.prototype.offset;var q=function(t){return t%360+(t<0?360:0)},k=function(t,e){return e*w(t/e)},tt=function(t){return 180*t/I%360},T=function(t,e){return(t=(e=e||!1)?t:t%360)*I/180},N=function(t,e){if(void 0===e)e=void 0===t?1:t,t=0;else if(e<t){var i=t;t=e,e=i}return C(m.random()*(e-t+1)+t)},D=_,Y=G,H=j,F=Q;function U(t,e){return e.unshift(null),new(Function.prototype.bind.apply(t,e))}function X(t){var e,i,n=arguments,s=[];for(i=arguments.length,e=1;e<i;e++)s.push(n[e]);if(!t)throw new Error("Missing a parent object.");var r=Object.create(t);for(i=s.length,e=0;e<i;e++){var o,a,l=s[e];for(a in l)l.hasOwnProperty(a)&&(delete r[a],o=Object.getOwnPropertyDescriptor(l,a),Object.defineProperty(r,a,o))}return r}var J={bbox:function(){throw new Error("Declaration missing for virtual function.")},clone:function(){throw new Error("Declaration missing for virtual function.")},closestPoint:function(){throw new Error("Declaration missing for virtual function.")},closestPointLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointNormalizedLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointT:function(t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither closestPointT() nor closestPointNormalizedLength() function is implemented.")},closestPointTangent:function(){throw new Error("Declaration missing for virtual function.")},divideAt:function(){throw new Error("Declaration missing for virtual function.")},divideAtLength:function(){throw new Error("Declaration missing for virtual function.")},divideAtT:function(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither divideAtT() nor divideAt() function is implemented.")},equals:function(){throw new Error("Declaration missing for virtual function.")},getSubdivisions:function(){throw new Error("Declaration missing for virtual function.")},isDifferentiable:function(){throw new Error("Declaration missing for virtual function.")},isSegment:!0,isSubpathStart:!1,isVisible:!0,length:function(){throw new Error("Declaration missing for virtual function.")},lengthAtT:function(t){if(t<=0)return 0;var e=this.length();return 1<=t?e:e*t},nextSegment:null,pointAt:function(){throw new Error("Declaration missing for virtual function.")},pointAtLength:function(){throw new Error("Declaration missing for virtual function.")},pointAtT:function(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither pointAtT() nor pointAt() function is implemented.")},previousSegment:null,subpathStartSegment:null,scale:function(){throw new Error("Declaration missing for virtual function.")},serialize:function(){throw new Error("Declaration missing for virtual function.")},tangentAt:function(){throw new Error("Declaration missing for virtual function.")},tangentAtLength:function(){throw new Error("Declaration missing for virtual function.")},tangentAtT:function(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither tangentAtT() nor tangentAt() function is implemented.")},toString:function(){throw new Error("Declaration missing for virtual function.")},translate:function(){throw new Error("Declaration missing for virtual function.")}};Object.defineProperty(J,"end",{configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(J,"start",{configurable:!0,enumerable:!0,get:function(){if(!this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path; OR segment has not yet been added to a path.)");return this.previousSegment.end}}),Object.defineProperty(J,"type",{configurable:!0,enumerable:!0,get:function(){throw new Error("Bad segment declaration. No type specified.")}});var et=function(){for(var t,e,i=arguments,n=[],s=arguments.length,r=0;r<s;r++)n.push(i[r]);if(!(this instanceof et))return U(et,n);if(0===s)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates (none provided).");if(n[0]instanceof G){if(1===s)return this.end=n[0].end.clone(),this;throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+s+" lines provided).")}if("string"==typeof n[0]||"number"==typeof n[0]){if(2===s)return this.end=new j(+n[0],+n[1]),this;if(s<2)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+s+" coordinates provided).");var o;for(t=[],r=0;r<s;r+=2)o=n.slice(r,r+2),t.push(U(et,o));return t}if(1===s)return this.end=new j(n[0]),this;for(t=[],r=0;r<s;r+=1)e=n[r],t.push(new et(e));return t},it={clone:function(){return new et(this.end)},divideAt:function(t){var e=new G(this.start,this.end).divideAt(t);return[new et(e[0]),new et(e[1])]},divideAtLength:function(t){var e=new G(this.start,this.end).divideAtLength(t);return[new et(e[0]),new et(e[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return!!this.previousSegment&&!this.start.equals(this.end)},scale:function(t,e,i){return this.end.scale(t,e,i),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}};Object.defineProperty(it,"type",{configurable:!0,enumerable:!0,value:"L"}),et.prototype=X(J,G.prototype,it);var nt=function(){for(var t,e,i=arguments,n=[],s=arguments.length,r=0;r<s;r++)n.push(i[r]);if(!(this instanceof nt))return U(nt,n);if(0===s)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates (none provided).");if(n[0]instanceof A){if(1===s)return this.controlPoint1=n[0].controlPoint1.clone(),this.controlPoint2=n[0].controlPoint2.clone(),this.end=n[0].end.clone(),this;throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+s+" curves provided).")}if("string"==typeof n[0]||"number"==typeof n[0]){if(6===s)return this.controlPoint1=new j(+n[0],+n[1]),this.controlPoint2=new j(+n[2],+n[3]),this.end=new j(+n[4],+n[5]),this;if(s<6)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+s+" coordinates provided).");var o;for(t=[],r=0;r<s;r+=6)o=n.slice(r,r+6),t.push(U(nt,o));return t}if(3===s)return this.controlPoint1=new j(n[0]),this.controlPoint2=new j(n[1]),this.end=new j(n[2]),this;if(s<3)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+s+" points provided).");for(t=[],r=0;r<s;r+=3)e=n.slice(r,r+3),t.push(U(nt,e));return t},st={clone:function(){return new nt(this.controlPoint1,this.controlPoint2,this.end)},divideAt:function(t,e){var i=new A(this.start,this.controlPoint1,this.controlPoint2,this.end).divideAt(t,e);return[new nt(i[0]),new nt(i[1])]},divideAtLength:function(t,e){var i=new A(this.start,this.controlPoint1,this.controlPoint2,this.end).divideAtLength(t,e);return[new nt(i[0]),new nt(i[1])]},divideAtT:function(t){var e=new A(this.start,this.controlPoint1,this.controlPoint2,this.end).divideAtT(t);return[new nt(e[0]),new nt(e[1])]},isDifferentiable:function(){if(!this.previousSegment)return!1;var t=this.start,e=this.controlPoint1,i=this.controlPoint2,n=this.end;return!(t.equals(e)&&e.equals(i)&&i.equals(n))},scale:function(t,e,i){return this.controlPoint1.scale(t,e,i),this.controlPoint2.scale(t,e,i),this.end.scale(t,e,i),this},serialize:function(){var t=this.controlPoint1,e=this.controlPoint2,i=this.end;return this.type+" "+t.x+" "+t.y+" "+e.x+" "+e.y+" "+i.x+" "+i.y},toString:function(){return this.type+" "+this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}};Object.defineProperty(st,"type",{configurable:!0,enumerable:!0,value:"C"}),nt.prototype=X(J,A.prototype,st);var rt=function(){for(var t,e,i=arguments,n=[],s=arguments.length,r=0;r<s;r++)n.push(i[r]);if(!(this instanceof rt))return U(rt,n);if(0===s)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates (none provided).");if(n[0]instanceof G){if(1===s)return this.end=n[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+s+" lines provided).")}if(n[0]instanceof A){if(1===s)return this.end=n[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+s+" curves provided).")}if("string"==typeof n[0]||"number"==typeof n[0]){if(2===s)return this.end=new j(+n[0],+n[1]),this;if(s<2)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+s+" coordinates provided).");var o;for(t=[],r=0;r<s;r+=2)o=n.slice(r,r+2),0===r?t.push(U(rt,o)):t.push(U(et,o));return t}if(1===s)return this.end=new j(n[0]),this;for(t=[],r=0;r<s;r+=1)e=n[r],0===r?t.push(new rt(e)):t.push(new et(e));return t},ot={bbox:function(){return null},clone:function(){return new rt(this.end)},closestPoint:function(){return this.end.clone()},closestPointNormalizedLength:function(){return 0},closestPointLength:function(){return 0},closestPointT:function(){return 1},closestPointTangent:function(){return null},divideAt:function(){return[this.clone(),this.clone()]},divideAtLength:function(){return[this.clone(),this.clone()]},equals:function(t){return this.end.equals(t.end)},getSubdivisions:function(){return[]},isDifferentiable:function(){return!1},isSubpathStart:!0,isVisible:!1,length:function(){return 0},lengthAtT:function(){return 0},pointAt:function(){return this.end.clone()},pointAtLength:function(){return this.end.clone()},pointAtT:function(){return this.end.clone()},scale:function(t,e,i){return this.end.scale(t,e,i),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},tangentAt:function(){return null},tangentAtLength:function(){return null},tangentAtT:function(){return null},toString:function(){return this.type+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}};Object.defineProperty(ot,"start",{configurable:!0,enumerable:!0,get:function(){throw new Error("Illegal access. Moveto segments should not need a start property.")}}),Object.defineProperty(ot,"type",{configurable:!0,enumerable:!0,value:"M"}),rt.prototype=X(J,ot);var at=function(){for(var t=arguments,e=[],i=arguments.length,n=0;n<i;n++)e.push(t[n]);if(!(this instanceof at))return U(at,e);if(0<i)throw new Error("Closepath constructor expects no arguments.");return this},lt={clone:function(){return new at},divideAt:function(t){var e=new G(this.start,this.end).divideAt(t);return[e[1].isDifferentiable()?new et(e[0]):this.clone(),new et(e[1])]},divideAtLength:function(t){var e=new G(this.start,this.end).divideAtLength(t);return[e[1].isDifferentiable()?new et(e[0]):this.clone(),new et(e[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return!(!this.previousSegment||!this.subpathStartSegment)&&!this.start.equals(this.end)},scale:function(){return this},serialize:function(){return this.type},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(){return this}};Object.defineProperty(lt,"end",{configurable:!0,enumerable:!0,get:function(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. Moveto); OR segment has not yet been added to a path.)");return this.subpathStartSegment.end}}),Object.defineProperty(lt,"type",{configurable:!0,enumerable:!0,value:"Z"}),at.prototype=X(J,G.prototype,lt);var ht=B.segmentTypes={L:et,C:nt,M:rt,Z:at,z:at};B.regexSupportedData=new RegExp("^[\\s\\d"+Object.keys(ht).join("")+",.]*$"),B.isDataSupported=function(t){return"string"==typeof t&&this.regexSupportedData.test(t)};function ct(t){return t?t.toString().split(" ").map(function(t){return t.substr(0,Gt.length)!==Gt&&(t=Gt+t),t}).join(" "):t}function ut(t){return t?t.toString().split(" ").map(function(t){return t.substr(0,Gt.length)===Gt&&(t=t.substr(Gt.length)),t}).join(" "):t}function dt(t,e){for(var i={},n={},s=Ot.namespace.svg,r=e||s,o=document.createDocumentFragment(),a=[t,o,r];0<a.length;){r=a.pop();for(var l=a.pop(),h=a.pop(),c=0,u=h.length;c<u;c++){var d=h[c];if(!d.hasOwnProperty("tagName"))throw new Error("json-dom-parser: missing tagName");var p=d.tagName;d.hasOwnProperty("namespaceURI")&&(r=d.namespaceURI);var g=document.createElementNS(r,p),f=r===s,m=f?Ot:P,v=d.attributes;v&&m(g).attr(v);var y=d.style;if(y&&P(g).css(y),d.hasOwnProperty("className")){var b=d.className;f?g.className.baseVal=b:g.className=b}if(d.hasOwnProperty("textContent")&&(g.textContent=d.textContent),d.hasOwnProperty("selector")){var w=d.selector;if(i[w])throw new Error("json-dom-parser: selector must be unique");m(i[w]=g).attr("joint-selector",w)}if(d.hasOwnProperty("groupSelector")){var C=d.groupSelector;Array.isArray(C)||(C=[C]);for(var I=0,x=C.length;I<x;I++){var A=C[I],S=n[A];(S=S||(n[A]=[])).push(g)}}l.appendChild(g);var _=d.children;Array.isArray(_)&&a.push(_,g,r)}}return{fragment:o,selectors:i,groupSelectors:n}}function pt(t){var e=0;if(0===t.length)return e;for(var i=0;i<t.length;i++){e=(e<<5)-e+t.charCodeAt(i),e&=e}return e}function gt(t,e,i){for(var n,s=Array.isArray(e)?e.slice():e.split(i||"/");s.length;){if(n=s.shift(),!(Object(t)===t&&n in t))return;t=t[n]}return t}function ft(t,e,i,n){for(var s=Array.isArray(e)?e:e.split(n||"/"),r=t,o=0,a=s.length;o<a-1;o++)r=r[s[o]]||(r[s[o]]={});return r[s[a-1]]=i,t}function mt(t,e,i){i=i||"/";var n=Array.isArray(e)?e.slice():e.split(i),s=n.pop();if(0<n.length){var r=gt(t,n,i);r&&delete r[s]}else delete t[s];return t}function vt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}function yt(t){return t.replace(/[A-Z]/g,"-$&").toLowerCase()}function bt(t){var e=t,i=t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0];if(i){for(var n in t)void 0===i[n]&&(i[n]=t[n]);e=i}var s=e.target;if(s){var r=s.correspondingUseElement;r&&(e.target=r)}return e}function wt(t,e){var i=parseFloat(t);if(Number.isNaN(i))return null;var n,s={};if(s.value=i,null==e)n="[A-Za-z]*";else if(Array.isArray(e)){if(0===e.length)return null;n=e.join("|")}else Ne(e)&&(n=e);var r,o=(r=new RegExp("(?:\\d+(?:\\.\\d+)*)("+n+")$").exec(t))?r[1]:null;return null===o?null:(s.unit=o,s)}function Ct(t,e,i,n){n=n||{},i=i||{};var s=e.width,r=e.height,o=n.svgDocument||Ot("svg").node,a=Ot("tspan").node,l=Ot("text").attr(i).append(a).node,h=document.createTextNode("");l.style.opacity=0,l.style.display="block",a.style.display="block",a.appendChild(h),o.appendChild(l),n.svgDocument||document.body.appendChild(o);for(var c,u,d,p=n.separator||" ",g=String(p)===String(/(\s+)/),f=n.eol||"\n",m=n.hyphen?new RegExp(n.hyphen):/[^\w\d]/,v=t.split(p),y=[],b=[],w=0,C=0,I=v.length;w<I;w++){var x=v[w];if(x)if(f&&0<=x.indexOf(f))if(1<x.length){for(var A=x.split(f),S=0,_=A.length-1;S<_;S++)A.splice(2*S+1,0,f);Array.prototype.splice.apply(v,[w,1].concat(A)),w--,I+=A.length-1}else C++;else{if(h.data=g?b[C]?b[C]+x:x:b[C]?b[C]+" "+x:x,a.getComputedTextLength()<=s)b[C]=h.data,(c||u)&&(y[C++]=!0,u=c=0);else{if(!b[C]||c){var P=!!c;if(c=x.length-1,P||!c){if(!c){if(!b[C]){b=[];break}v.splice(w,2,x+v[w+1]),I--,y[C++]=!0,w--;continue}v[w]=x.substring(0,c),v[w+1]=x.substring(c)+v[w+1]}else{if(u)v.splice(w,2,v[w]+v[w+1]),u=0;else{var M=x.search(m);-1<M&&M!==x.length-1&&0!==M&&(u=M+1,c=0),v.splice(w,1,x.substring(0,u||c),x.substring(u||c)),I++}C&&!y[C-1]&&C--}w--;continue}C++,w--}if(void 0!==r){var k;if(void 0===d)d=(k="auto"===i.lineHeight?{value:1.5,unit:"em"}:wt(i.lineHeight,["em"])||{value:1,unit:"em"}).value,"em"===k.unit&&(d*=l.getBBox().height);if(d*b.length>r){var T=Math.floor(r/d)-1;b.splice(1+T);var N=n.ellipsis;if(!N||T<0)break;"string"!=typeof N&&(N="\u2026");var D,E,L=b[T],z=L.length;do{if(E=L[z],D=L.substring(0,z),E?E.match(p)&&(D+=E):D+="string"==typeof p?p:" ",D+=N,h.data=D,a.getComputedTextLength()<=s){b[T]=D;break}z--}while(0<=z);break}}}}return n.svgDocument?o.removeChild(l):document.body.removeChild(o),b.join(f)}function It(t){var e=P(P.parseHTML("<div>"+t+"</div>",null,!1));return e.find("*").each(function(){var i=this;P.each(i.attributes,function(){var t=this.name,e=this.value;0!==t.indexOf("on")&&0!==e.indexOf("javascript:")||P(i).removeAttr(t)})}),e.html()}function xt(t,e){if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(t,e);else{var i=window.URL.createObjectURL(t),n=document.createElement("a");n.href=i,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(i)}}function At(t,e){var i=Yt(t);xt(i,e)}function St(s,t){if(!s||"data:"===s.substr(0,"data:".length))return setTimeout(function(){t(null,s)},0);var e=new XMLHttpRequest;e.open("GET",s,!0),e.addEventListener("error",function(){t(new Error("Failed to load image "+s))}),e.responseType=window.FileReader?"blob":"arraybuffer",e.addEventListener("load",function(){window.FileReader?function(t,i){if(200===t.status){var e=new FileReader;e.onload=function(t){var e=t.target.result;i(null,e)},e.onerror=function(){i(new Error("Failed to load image "+s))},e.readAsDataURL(t.response)}else i(new Error("Failed to load image "+s))}(e,t):function(t,e){if(200===t.status){var i=new Uint8Array(t.response),n=s.split(".").pop()||"png";e(null,"data:image/"+({svg:"svg+xml"}[n]||n)+";base64,"+btoa(function(t){for(var e=[],i=0;i<t.length;i+=32768)e.push(String.fromCharCode.apply(null,t.subarray(i,i+32768)));return e.join("")}(i)))}else e(new Error("Failed to load image "+s))}(e,t)}),e.send()}function _t(t){var e=P(t);if(0===e.length)throw new Error("Element not found");var i=e[0],n=i.ownerDocument,s=i.getBoundingClientRect(),r=0,o=0;if(i.ownerSVGElement){var a=Ot(i),l=a.getBBox({target:a.svg()});r=s.width-l.width,o=s.height-l.height}return{x:s.left+window.pageXOffset-n.documentElement.offsetLeft+r/2,y:s.top+window.pageYOffset-n.documentElement.offsetTop+o/2,width:s.width-r,height:s.height-o}}function Pt(t,e){var i=P(t),n=i.map(function(){var t=this.parentNode,e=t.insertBefore(document.createTextNode(""),this.nextSibling);return function(){if(t===this)throw new Error("You can't sort elements if any one is a descendant of another.");t.insertBefore(this,e),t.removeChild(e)}});return Array.prototype.sort.call(i,e).each(function(t){n[t].call(this)})}function Mt(t,e){var n=P(t);Pe(e,function(t,e){var i=n.find(e).addBack().filter(e);Ie(t,"class")&&(i.addClass(t.class),t=Ae(t,"class")),i.attr(t)})}function kt(t){var e=window.top.document;function i(t,e){for(var i=["webkit","moz","ms","o",""],n=0;n<i.length;n++){var s=i[n],r=s?s+e:e.substr(0,1).toLowerCase()+e.substr(1);if(void 0!==t[r])return ue(t[r])?t[r]():t[r]}}t=t||e.body,i(e,"FullscreenElement")||i(e,"FullScreenElement")?i(e,"ExitFullscreen")||i(e,"CancelFullScreen"):i(t,"RequestFullscreen")||i(t,"RequestFullScreen")}function Tt(){if(i.mergeWith){var t=Array.from(arguments),e=t[t.length-1],n=ue(e)?e:De;return t.push(function(t,e){var i=n(t,e);return void 0!==i?i:Array.isArray(t)&&!Array.isArray(e)?e:void 0}),i.mergeWith.apply(this,t)}return i.merge.apply(this,arguments)}function Nt(t){var e=Object.prototype.toString;return!0===t||!1===t||!!t&&"object"==typeof t&&"[object Boolean]"===e.call(t)}function Dt(t){var e=Object.prototype.toString;return"number"==typeof t||!!t&&"object"==typeof t&&"[object Number]"===e.call(t)}var Et,Lt,zt={bezier:x,Curve:A,Ellipse:_,Line:G,Path:B,Point:j,Polyline:K,Rect:Q,scale:{linear:function(t,e,i){var n=t[1]-t[0],s=e[1]-e[0];return(i-t[0])/n*s+e[0]||0}},normalizeAngle:q,snapToGrid:k,toDeg:tt,toRad:T,random:N,ellipse:D,line:Y,point:H,rect:F},Ot=function(){if(!("object"==typeof window&&!(!window.SVGAngle&&!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"))))return function(){throw new Error("SVG is required to use Vectorizer.")};var k={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},t=Math,f=t.PI,r=t.atan2,o=t.sqrt,u=t.min,d=t.max,m=t.cos,v=t.sin,T=function(t,e,i){if(!(this instanceof T))return T.apply(Object.create(T.prototype),arguments);if(t){if(T.isV(t)&&(t=t.node),e=e||{},T.isString(t)){if("svg"===t.toLowerCase())t=T.createSvgDocument();else if("<"===t[0]){var n=T.createSvgDocument(t);if(1<n.childNodes.length){var s,r,o=[];for(s=0,r=n.childNodes.length;s<r;s++){var a=n.childNodes[s];o.push(new T(document.importNode(a,!0)))}return o}t=document.importNode(n.firstChild,!0)}else t=document.createElementNS(k.svg,t);T.ensureId(t)}return this.node=t,this.setAttributes(e),i&&this.append(i),this}},e=T.prototype;function N(t,e,i){for(var n=(i=i||{}).includeAnnotationIndices,s=i.eol,r=i.lineHeight,o=i.baseSize,a=0,l={},h=e.length-1,c=0;c<=h;c++){var u=e[c],d=null;if(T.isObject(u)){var p=u.attrs,g=T("tspan",p),f=g.node,m=u.t;s&&c===h&&(m+=s),f.textContent=m;var v=p.class;v&&g.addClass(v),n&&g.attr("annotations",u.annotations),void 0===(d=parseFloat(p["font-size"]))&&(d=o),d&&a<d&&(a=d)}else s&&c===h&&(u+=s),f=document.createTextNode(u||" "),o&&a<o&&(a=o);t.appendChild(f)}return a&&(l.maxFontSize=a),r?l.lineHeight=r:a&&(l.lineHeight=1.2*a),l}Object.defineProperty(e,"id",{enumerable:!0,get:function(){return this.node.id},set:function(t){this.node.id=t}}),e.getTransformToElement=function(t){var e=this.node;if(T.isSVGGraphicsElement(t)&&T.isSVGGraphicsElement(e)){var i=T.toNode(t).getScreenCTM(),n=e.getScreenCTM();if(i&&n)return i.inverse().multiply(n)}return T.createSVGMatrix()},e.transform=function(t,e){var i=this.node;if(T.isUndefined(t))return T.transformStringToMatrix(this.attr("transform"));if(e&&e.absolute)return this.attr("transform",T.matrixToTransformString(t));var n=T.createSVGTransform(t);return i.transform.baseVal.appendItem(n),this},e.translate=function(t,e,i){i=i||{},e=e||0;var n=this.attr("transform")||"",s=T.parseTransformString(n);if(n=s.value,T.isUndefined(t))return s.translate;n=n.replace(/translate\([^)]*\)/g,"").trim();var r="translate("+(i.absolute?t:s.translate.tx+t)+","+(i.absolute?e:s.translate.ty+e)+")";return this.attr("transform",(r+" "+n).trim()),this},e.rotate=function(t,e,i,n){n=n||{};var s=this.attr("transform")||"",r=T.parseTransformString(s);if(s=r.value,T.isUndefined(t))return r.rotate;s=s.replace(/rotate\([^)]*\)/g,"").trim(),t%=360;var o="rotate("+(n.absolute?t:r.rotate.angle+t)+(void 0!==e&&void 0!==i?","+e+","+i:"")+")";return this.attr("transform",(s+" "+o).trim()),this},e.scale=function(t,e){e=T.isUndefined(e)?t:e;var i=this.attr("transform")||"",n=T.parseTransformString(i);if(i=n.value,T.isUndefined(t))return n.scale;i=i.replace(/scale\([^)]*\)/g,"").trim();var s="scale("+t+","+e+")";return this.attr("transform",(i+" "+s).trim()),this},e.bbox=function(t,e){var i,n=this.node,s=n.ownerSVGElement;if(!s)return new Q(0,0,0,0);try{i=n.getBBox()}catch(t){i={x:n.clientLeft,y:n.clientTop,width:n.clientWidth,height:n.clientHeight}}if(t)return new Q(i);var r=this.getTransformToElement(e||s);return T.transformRect(i,r)},e.getBBox=function(t){var e,i={},n=this.node;if(!n.ownerSVGElement||!T.isSVGGraphicsElement(n))return new Q(0,0,0,0);if(t&&(t.target&&(i.target=T.toNode(t.target)),t.recursive&&(i.recursive=t.recursive)),i.recursive){var s=this.children(),r=s.length;if(0===r)return this.getBBox({target:i.target,recursive:!1});i.target||(i.target=this);for(var o=0;o<r;o++){var a,l=s[o];a=0===l.children().length?l.getBBox({target:i.target,recursive:!1}):l.getBBox({target:i.target,recursive:!0}),e=e?e.union(a):a}return e}try{e=n.getBBox()}catch(t){e={x:n.clientLeft,y:n.clientTop,width:n.clientWidth,height:n.clientHeight}}if(i.target){var h=this.getTransformToElement(i.target);return T.transformRect(e,h)}return new Q(e)};var D=/em$/;function E(t,e){var i=parseFloat(t);return D.test(t)?i*e:i}e.text=function(t,e){if(t&&"string"!=typeof t)throw new Error("Vectorizer: text() expects the first argument to be a string.");t=T.sanitizeText(t);var i=(e=e||{}).eol,n=e.textPath,s=e.textVerticalAnchor,r="middle"===s||"bottom"===s||"top"===s,o=e.x;void 0===o&&(o=this.attr("x")||0);var a=e.includeAnnotationIndices,l=e.annotations;l&&!T.isArray(l)&&(l=[l]);var h=e.lineHeight,c="auto"===h,u=c?"1.5em":h||"1em";this.empty(),this.attr({"xml:space":"preserve",display:t?null:"none"});var d=parseFloat(this.attr("font-size"));d||(d=16,(r||l)&&this.attr("font-size",d));var p,g=document;p=n?("string"==typeof n&&(n={d:n}),function(t,e){t=t||{};var i=T("textPath"),n=t.d;if(n&&void 0===t["xlink:href"]){var s=T("path").attr("d",n).appendTo(e.defs());i.attr("xlink:href","#"+s.id)}return T.isObject(t)&&i.attr(t),i.node}(n,this)):g.createDocumentFragment();for(var f,m=0,v=t.split("\n"),y=[],b=0,w=v.length-1;b<=w;b++){var C,I=u,x="v-line",A=g.createElementNS(k.svg,"tspan"),S=v[b];if(S)if(l){var _=(C=N(A,T.annotateString(S,l,{offset:-m,includeAnnotationIndices:a}),{includeAnnotationIndices:a,eol:b!==w&&i,lineHeight:c?null:u,baseSize:d})).lineHeight;_&&c&&0!==b&&(I=_),0===b&&(f=.8*C.maxFontSize)}else i&&b!==w&&(S+=i),A.textContent=S;else{A.textContent="-",x+=" v-empty-line";var P=A.style;P.fillOpacity=0,P.strokeOpacity=0,l&&(C={})}C&&y.push(C),0<b&&A.setAttribute("dy",I),(0<b||n)&&A.setAttribute("x",o),A.className.baseVal=x,p.appendChild(A),m+=S.length+1}if(r)if(l)I=function(t,e,i,n){if(!Array.isArray(e))return 0;var s=e.length;if(!s)return 0;for(var r=e[0],o=E(r.maxFontSize,i)||i,a=0,l=E(n,i),h=1;h<s;h++){a+=E((r=e[h]).lineHeight,i)||l}var c,u=E(r.maxFontSize,i)||i;switch(t){case"middle":c=o/2-.15*u-a/2;break;case"bottom":c=-.25*u-a;break;default:c=.8*o}return c}(s,y,d,u);else if("top"===s)I="0.8em";else{var M;switch(0<w?(M=parseFloat(u)||1,M*=w,D.test(u)||(M/=d)):M=0,s){case"middle":I=.3-M/2+"em";break;case"bottom":I=-M-.3+"em"}}else 0===s?I="0em":s?I=s:(I=0,null===this.attr("y")&&this.attr("y",f||"0.8em"));return p.firstChild.setAttribute("dy",I),this.append(p),this},e.removeAttr=function(t){var e=T.qualifyAttr(t),i=this.node;return e.ns?i.hasAttributeNS(e.ns,e.local)&&i.removeAttributeNS(e.ns,e.local):i.hasAttribute(t)&&i.removeAttribute(t),this},e.attr=function(t,e){if(T.isUndefined(t)){for(var i=this.node.attributes,n={},s=0;s<i.length;s++)n[i[s].name]=i[s].value;return n}if(T.isString(t)&&T.isUndefined(e))return this.node.getAttribute(t);if("object"==typeof t)for(var r in t)t.hasOwnProperty(r)&&this.setAttribute(r,t[r]);else this.setAttribute(t,e);return this},e.normalizePath=function(){return"PATH"===this.tagName()&&this.attr("d",T.normalizePathData(this.attr("d"))),this},e.remove=function(){return this.node.parentNode&&this.node.parentNode.removeChild(this.node),this},e.empty=function(){for(;this.node.firstChild;)this.node.removeChild(this.node.firstChild);return this},e.setAttributes=function(t){for(var e in t)t.hasOwnProperty(e)&&this.setAttribute(e,t[e]);return this},e.append=function(t){T.isArray(t)||(t=[t]);for(var e=0,i=t.length;e<i;e++)this.node.appendChild(T.toNode(t[e]));return this},e.prepend=function(t){var e=this.node.firstChild;return e?T(e).before(t):this.append(t)},e.before=function(t){var e=this.node,i=e.parentNode;if(i){T.isArray(t)||(t=[t]);for(var n=0,s=t.length;n<s;n++)i.insertBefore(T.toNode(t[n]),e)}return this},e.appendTo=function(t){return T.toNode(t).appendChild(this.node),this},e.svg=function(){return this.node instanceof window.SVGSVGElement?this:T(this.node.ownerSVGElement)},e.tagName=function(){return this.node.tagName.toUpperCase()},e.defs=function(){var t=this.svg()||this,e=t.node.getElementsByTagName("defs")[0];return e?T(e):T("defs").appendTo(t)},e.clone=function(){var t=T(this.node.cloneNode(!0));return t.node.id=T.uniqueId(),t},e.findOne=function(t){var e=this.node.querySelector(t);return e?T(e):void 0},e.find=function(t){var e=[],i=this.node.querySelectorAll(t);if(i)for(var n=0;n<i.length;n++)e.push(T(i[n]));return e},e.children=function(){for(var t=this.node.childNodes,e=[],i=0;i<t.length;i++){1===t[i].nodeType&&e.push(T(t[i]))}return e},e.index=function(){for(var t=0,e=this.node.previousSibling;e;)1===e.nodeType&&t++,e=e.previousSibling;return t},e.findParentByClass=function(t,e){for(var i=this.node.ownerSVGElement,n=this.node.parentNode;n&&n!==e&&n!==i;){var s=T(n);if(s.hasClass(t))return s;n=n.parentNode}return null},e.contains=function(t){var e=this.node,i=T.toNode(t),n=i&&i.parentNode;return e===n||!!(n&&1===n.nodeType&&16&e.compareDocumentPosition(n))},e.toLocalPoint=function(t,e){var i=this.svg().node,n=i.createSVGPoint();n.x=t,n.y=e;try{var s=n.matrixTransform(i.getScreenCTM().inverse()),r=this.getTransformToElement(i).inverse()}catch(t){return n}return s.matrixTransform(r)},e.translateCenterToPoint=function(t){var e=this.getBBox({target:this.svg()}).center();return this.translate(t.x-e.x,t.y-e.y),this},e.translateAndAutoOrient=function(t,e,i){t=new j(t),e=new j(e),i=i||this.svg();var n=this.scale();this.attr("transform","");var s=this.getBBox({target:i}).scale(n.sx,n.sy),r=T.createSVGTransform();r.setTranslate(-s.x-s.width/2,-s.y-s.height/2);var o=T.createSVGTransform(),a=t.angleBetween(e,t.clone().offset(1,0));a&&o.setRotate(a,0,0);var l=T.createSVGTransform(),h=t.clone().move(e,s.width/2);l.setTranslate(2*t.x-h.x,2*t.y-h.y);var c=this.getTransformToElement(i),u=T.createSVGTransform();return u.setMatrix(l.matrix.multiply(o.matrix.multiply(r.matrix.multiply(c.scale(n.sx,n.sy))))),this.attr("transform",T.matrixToTransformString(u.matrix)),this},e.animateAlongPath=function(t,e){e=T.toNode(e);var i=T.ensureId(e),n=T("animateMotion",t),s=T("mpath",{"xlink:href":"#"+i});n.append(s),this.append(n);try{n.node.beginElement()}catch(t){if("fake"===document.documentElement.getAttribute("smiling")){var r=n.node;r.animators=[];var o=r.getAttribute("id");o&&(id2anim[o]=r);for(var a=getTargets(r),l=0,h=a.length;l<h;l++){var c=a[l],u=new Animator(r,c,l);animators.push(u),(r.animators[l]=u).register()}}}return this},e.hasClass=function(t){return new RegExp("(\\s|^)"+t+"(\\s|$)").test(this.node.getAttribute("class"))},e.addClass=function(t){if(t&&!this.hasClass(t)){var e=this.node.getAttribute("class")||"";this.node.setAttribute("class",(e+" "+t).trim())}return this},e.removeClass=function(t){if(t&&this.hasClass(t)){var e=this.node.getAttribute("class").replace(new RegExp("(\\s|^)"+t+"(\\s|$)","g"),"$2");this.node.setAttribute("class",e)}return this},e.toggleClass=function(t,e){return(T.isUndefined(e)?this.hasClass(t):!e)?this.removeClass(t):this.addClass(t),this},e.sample=function(t){t=t||1;for(var e,i=this.node,n=i.getTotalLength(),s=[],r=0;r<n;)e=i.getPointAtLength(r),s.push({x:e.x,y:e.y,distance:r}),r+=t;return s},e.convertToPath=function(){var t=T("path");t.attr(this.attr());var e=this.convertToPathData();return e&&t.attr("d",e),t},e.convertToPathData=function(){var t=this.tagName();switch(t){case"PATH":return this.attr("d");case"LINE":return T.convertLineToPathData(this.node);case"POLYGON":return T.convertPolygonToPathData(this.node);case"POLYLINE":return T.convertPolylineToPathData(this.node);case"ELLIPSE":return T.convertEllipseToPathData(this.node);case"CIRCLE":return T.convertCircleToPathData(this.node);case"RECT":return T.convertRectToPathData(this.node)}throw new Error(t+" cannot be converted to PATH.")},T.prototype.toGeometryShape=function(){var t,e,i,n,s,r,o,a,l,h,c,u,d,p,g;switch(this.tagName()){case"RECT":return t=parseFloat(this.attr("x"))||0,e=parseFloat(this.attr("y"))||0,i=parseFloat(this.attr("width"))||0,n=parseFloat(this.attr("height"))||0,new Q(t,e,i,n);case"CIRCLE":return s=parseFloat(this.attr("cx"))||0,r=parseFloat(this.attr("cy"))||0,o=parseFloat(this.attr("r"))||0,new _({x:s,y:r},o,o);case"ELLIPSE":return s=parseFloat(this.attr("cx"))||0,r=parseFloat(this.attr("cy"))||0,a=parseFloat(this.attr("rx"))||0,l=parseFloat(this.attr("ry"))||0,new _({x:s,y:r},a,l);case"POLYLINE":return h=T.getPointsFromSvgNode(this),new K(h);case"POLYGON":return 1<(h=T.getPointsFromSvgNode(this)).length&&h.push(h[0]),new K(h);case"PATH":return c=this.attr("d"),B.isDataSupported(c)||(c=T.normalizePathData(c)),new B(c);case"LINE":return u=parseFloat(this.attr("x1"))||0,p=parseFloat(this.attr("y1"))||0,d=parseFloat(this.attr("x2"))||0,g=parseFloat(this.attr("y2"))||0,new G({x:u,y:p},{x:d,y:g})}return this.getBBox()},e.findIntersection=function(t,e){var i=this.svg().node;e=e||i;var n=this.getBBox({target:e}),s=n.center();if(n.intersectionWithLineFromCenterToPoint(t)){var r,o=this.tagName();if("RECT"===o){var a=new Q(parseFloat(this.attr("x")||0),parseFloat(this.attr("y")||0),parseFloat(this.attr("width")),parseFloat(this.attr("height"))),l=this.getTransformToElement(e),h=T.decomposeMatrix(l),c=i.createSVGTransform();c.setRotate(-h.rotation,s.x,s.y);var u=T.transformRect(a,c.matrix.multiply(l));r=new Q(u).intersectionWithLineFromCenterToPoint(t,h.rotation)}else if("PATH"===o||"POLYGON"===o||"POLYLINE"===o||"CIRCLE"===o||"ELLIPSE"===o){var d,p,g,f,m,v=("PATH"===o?this:this.convertToPath()).sample(),y=1/0,b=[];for(d=0;d<v.length;d++)p=v[d],g=(g=T.createSVGPoint(p.x,p.y)).matrixTransform(this.getTransformToElement(e)),(m=(p=new j(g)).distance(s)+(f=1.1*p.distance(t)))<y?(y=m,b=[{sample:p,refDistance:f}]):m<y+1&&b.push({sample:p,refDistance:f});b.sort(function(t,e){return t.refDistance-e.refDistance}),b[0]&&(r=b[0].sample)}return r}},e.setAttribute=function(t,e){var i=this.node;if(null===e)return this.removeAttr(t),this;var n=T.qualifyAttr(t);return n.ns?i.setAttributeNS(n.ns,t,e):"id"===t?i.id=e:i.setAttribute(t,e),this},T.createSvgDocument=function(t){if(t){var e='<svg xmlns="'+k.svg+'" xmlns:xlink="'+k.xlink+'" version="1.1">'+t+"</svg>";return T.parseXML(e,{async:!1}).documentElement}var i=document.createElementNS(k.svg,"svg");return i.setAttributeNS(k.xmlns,"xmlns:xlink",k.xlink),i.setAttribute("version","1.1"),i},T.idCounter=0,T.uniqueId=function(){return"v-"+ ++T.idCounter},T.toNode=function(t){return T.isV(t)?t.node:t.nodeName&&t||t[0]},T.ensureId=function(t){return(t=T.toNode(t)).id||(t.id=T.uniqueId())},T.sanitizeText=function(t){return(t||"").replace(/ /g,"\xa0")},T.isUndefined=function(t){return void 0===t},T.isString=function(t){return"string"==typeof t},T.isObject=function(t){return t&&"object"==typeof t},T.isArray=Array.isArray,T.parseXML=function(t,e){var i;e=e||{};try{var n=new DOMParser;T.isUndefined(e.async)||(n.async=e.async),i=n.parseFromString(t,"text/xml")}catch(t){i=void 0}if(!i||i.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+t);return i},T.qualifyAttr=function(t){if(-1===t.indexOf(":"))return{ns:null,local:t};var e=t.split(":");return{ns:k[e[0]],local:e[1]}},T.transformRegex=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,T.transformSeparatorRegex=/[ ,]+/,T.transformationListRegex=/^(\w+)\((.*)\)/,T.transformStringToMatrix=function(t){var e=T.createSVGMatrix(),i=t&&t.match(T.transformRegex);if(!i)return e;for(var n=0,s=i.length;n<s;n++){var r=i[n].match(T.transformationListRegex);if(r){var o,a,l,h,c,u=T.createSVGMatrix(),d=r[2].split(T.transformSeparatorRegex);switch(r[1].toLowerCase()){case"scale":o=parseFloat(d[0]),a=void 0===d[1]?o:parseFloat(d[1]),u=u.scaleNonUniform(o,a);break;case"translate":l=parseFloat(d[0]),h=parseFloat(d[1]),u=u.translate(l,h);break;case"rotate":c=parseFloat(d[0]),l=parseFloat(d[1])||0,h=parseFloat(d[2])||0,u=0!==l||0!==h?u.translate(l,h).rotate(c).translate(-l,-h):u.rotate(c);break;case"skewx":c=parseFloat(d[0]),u=u.skewX(c);break;case"skewy":c=parseFloat(d[0]),u=u.skewY(c);break;case"matrix":u.a=parseFloat(d[0]),u.b=parseFloat(d[1]),u.c=parseFloat(d[2]),u.d=parseFloat(d[3]),u.e=parseFloat(d[4]),u.f=parseFloat(d[5]);break;default:continue}e=e.multiply(u)}}return e},T.matrixToTransformString=function(t){return"matrix("+(void 0!==(t=t||!0).a?t.a:1)+","+(void 0!==t.b?t.b:0)+","+(void 0!==t.c?t.c:0)+","+(void 0!==t.d?t.d:1)+","+(void 0!==t.e?t.e:0)+","+(void 0!==t.f?t.f:0)+")"},T.parseTransformString=function(t){var e,i,n;if(t){var s=T.transformSeparatorRegex;if(0<=t.trim().indexOf("matrix")){var r=T.transformStringToMatrix(t),o=T.decomposeMatrix(r);e=[o.translateX,o.translateY],n=[o.scaleX,o.scaleY],i=[o.rotation];var a=[];0===e[0]&&0===e[1]||a.push("translate("+e+")"),1===n[0]&&1===n[1]||a.push("scale("+n+")"),0!==i[0]&&a.push("rotate("+i+")"),t=a.join(" ")}else{var l=t.match(/translate\((.*?)\)/);l&&(e=l[1].split(s));var h=t.match(/rotate\((.*?)\)/);h&&(i=h[1].split(s));var c=t.match(/scale\((.*?)\)/);c&&(n=c[1].split(s))}}var u=n&&n[0]?parseFloat(n[0]):1;return{value:t,translate:{tx:e&&e[0]?parseInt(e[0],10):0,ty:e&&e[1]?parseInt(e[1],10):0},rotate:{angle:i&&i[0]?parseInt(i[0],10):0,cx:i&&i[1]?parseInt(i[1],10):void 0,cy:i&&i[2]?parseInt(i[2],10):void 0},scale:{sx:u,sy:n&&n[1]?parseFloat(n[1]):u}}},T.deltaTransformPoint=function(t,e){return{x:e.x*t.a+e.y*t.c+0,y:e.x*t.b+e.y*t.d+0}},T.decomposeMatrix=function(t){var e=T.deltaTransformPoint(t,{x:0,y:1}),i=T.deltaTransformPoint(t,{x:1,y:0}),n=180/f*r(e.y,e.x)-90,s=180/f*r(i.y,i.x);return{translateX:t.e,translateY:t.f,scaleX:o(t.a*t.a+t.b*t.b),scaleY:o(t.c*t.c+t.d*t.d),skewX:n,skewY:s,rotation:n}},T.matrixToScale=function(t){var e,i,n,s;return t?(e=T.isUndefined(t.a)?1:t.a,s=T.isUndefined(t.d)?1:t.d,i=t.b,n=t.c):e=s=1,{sx:i?o(e*e+i*i):e,sy:n?o(n*n+s*s):s}},T.matrixToRotate=function(t){var e={x:0,y:1};return t&&(e=T.deltaTransformPoint(t,e)),{angle:q(tt(r(e.y,e.x))-90)}},T.matrixToTranslate=function(t){return{tx:t&&t.e||0,ty:t&&t.f||0}},T.isV=function(t){return t instanceof T},T.isVElement=T.isV,T.isSVGGraphicsElement=function(t){return!!t&&((t=T.toNode(t))instanceof SVGElement&&"function"==typeof t.getScreenCTM)};var i,y,b,n,W,Y,H,F,U,X,J,p=T("svg").node;function g(t,e,i,n,s,r){return[1/3*t+2/3*i,1/3*e+2/3*n,1/3*s+2/3*i,1/3*r+2/3*n,s,r]}function $(t,e,i,n,s,r,o,a,l,h){function c(t,e,i){return{x:t*H(i)-e*Y(i),y:t*Y(i)+e*H(i)}}var u,d=120*W/180,p=W/180*(+s||0),g=[];if(h)x=h[0],A=h[1],C=h[2],I=h[3];else{t=(u=c(t,e,-p)).x,e=u.y;var f=(t-(a=(u=c(a,l,-p)).x))/2,m=(e-(l=u.y))/2,v=f*f/(i*i)+m*m/(n*n);1<v&&(i*=v=X(v),n*=v);var y=i*i,b=n*n,w=(r==o?-1:1)*X(J((y*b-y*m*m-b*f*f)/(y*m*m+b*f*f))),C=w*i*m/n+(t+a)/2,I=w*-n*f/i+(e+l)/2,x=U(((e-I)/n).toFixed(9)),A=U(((l-I)/n).toFixed(9));(x=t<C?W-x:x)<0&&(x=2*W+x),(A=a<C?W-A:A)<0&&(A=2*W+A),A<(o&&x)&&(x-=2*W),x<(!o&&A)&&(A-=2*W)}var S=A-x;if(J(S)>d){var _=A,P=a,M=l;g=$(a=C+i*H(A=x+d*(x<(o&&A)?1:-1)),l=I+n*Y(A),i,n,s,0,o,P,M,[A,_,C,I])}S=A-x;var k=H(x),T=Y(x),N=H(A),D=Y(A),E=F(S/4),L=4/3*(i*E),z=4/3*(n*E),O=[t,e],G=[t+L*T,e-z*k],B=[a+L*D,l-z*N],j=[a,l];if(G[0]=2*O[0]-G[0],G[1]=2*O[1]-G[1],h)return[G,B,j].concat(g);for(var R=[],V=(g=[G,B,j].concat(g).join().split(",")).length,Z=0;Z<V;Z++)R[Z]=Z%2?c(g[Z-1],g[Z],p).y:c(g[Z],g[Z+1],p).x;return R}function w(t){if(Array.isArray(t)&&Array.isArray(t&&t[0])||(t=function(t){if(!t)return null;var r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=[];return String(t).replace(y,function(t,e,i){var n=[],s=e.toLowerCase();for(i.replace(b,function(t,e){e&&n.push(+e)}),"m"===s&&2<n.length&&(o.push([e].concat(n.splice(0,2))),s="l",e="m"===e?"l":"L");n.length>=r[s]&&(o.push([e].concat(n.splice(0,r[s]))),r[s]););}),o}(t)),!t||!t.length)return[["M",0,0]];for(var e,i=[],n=0,s=0,r=0,o=0,a=t.length,l=0;l<a;l++){var h=[];i.push(h);var c,u,d=t[l];if((e=d[0])!=e.toUpperCase())switch(h[0]=e.toUpperCase(),h[0]){case"A":h[1]=d[1],h[2]=d[2],h[3]=d[3],h[4]=d[4],h[5]=d[5],h[6]=+d[6]+n,h[7]=+d[7]+s;break;case"V":h[1]=+d[1]+s;break;case"H":h[1]=+d[1]+n;break;case"M":for(r=+d[1]+n,o=+d[2]+s,c=d.length,u=1;u<c;u++)h[u]=+d[u]+(u%2?n:s);break;default:for(c=d.length,u=1;u<c;u++)h[u]=+d[u]+(u%2?n:s)}else for(var p=d.length,g=0;g<p;g++)h[g]=d[g];switch(h[0]){case"Z":n=+r,s=+o;break;case"H":n=h[1];break;case"V":s=h[1];break;case"M":r=h[h.length-2],o=h[h.length-1],n=h[h.length-2],s=h[h.length-1];break;default:n=h[h.length-2],s=h[h.length-1]}}return i}return T.createSVGMatrix=function(t){var e=p.createSVGMatrix();for(var i in t)e[i]=t[i];return e},T.createSVGTransform=function(t){return T.isUndefined(t)?p.createSVGTransform():(t instanceof SVGMatrix||(t=T.createSVGMatrix(t)),p.createSVGTransformFromMatrix(t))},T.createSVGPoint=function(t,e){var i=p.createSVGPoint();return i.x=t,i.y=e,i},T.transformRect=function(t,e){var i=p.createSVGPoint();i.x=t.x,i.y=t.y;var n=i.matrixTransform(e);i.x=t.x+t.width,i.y=t.y;var s=i.matrixTransform(e);i.x=t.x+t.width,i.y=t.y+t.height;var r=i.matrixTransform(e);i.x=t.x,i.y=t.y+t.height;var o=i.matrixTransform(e),a=u(n.x,s.x,r.x,o.x),l=d(n.x,s.x,r.x,o.x),h=u(n.y,s.y,r.y,o.y),c=d(n.y,s.y,r.y,o.y);return new Q(a,h,l-a,c-h)},T.transformPoint=function(t,e){return new j(T.createSVGPoint(t.x,t.y).matrixTransform(e))},T.transformLine=function(t,e){return new G(T.transformPoint(t.start,e),T.transformPoint(t.end,e))},T.transformPolyline=function(t,e){var i=t instanceof K?t.points:t;T.isArray(i)||(i=[]);for(var n=[],s=0,r=i.length;s<r;s++)n[s]=T.transformPoint(i[s],e);return new K(n)},T.styleToObject=function(t){for(var e={},i=t.split(";"),n=0;n<i.length;n++){var s=i[n].split("=");e[s[0].trim()]=s[1].trim()}return e},T.createSlicePathData=function(t,e,i,n){var s=2*f-1e-6,r=t,o=e,a=i,l=n,h=(l<a&&(h=a,a=l,l=h),l-a),c=h<f?"0":"1",u=m(a),d=v(a),p=m(l),g=v(l);return s<=h?r?"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"M0,"+r+"A"+r+","+r+" 0 1,0 0,"+-r+"A"+r+","+r+" 0 1,0 0,"+r+"Z":"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"Z":r?"M"+o*u+","+o*d+"A"+o+","+o+" 0 "+c+",1 "+o*p+","+o*g+"L"+r*p+","+r*g+"A"+r+","+r+" 0 "+c+",0 "+r*u+","+r*d+"Z":"M"+o*u+","+o*d+"A"+o+","+o+" 0 "+c+",1 "+o*p+","+o*g+"L0,0Z"},T.mergeAttrs=function(t,e){for(var i in e)"class"===i?t[i]=t[i]?t[i]+" "+e[i]:e[i]:"style"===i?T.isObject(t[i])&&T.isObject(e[i])?t[i]=T.mergeAttrs(t[i],e[i]):T.isObject(t[i])?t[i]=T.mergeAttrs(t[i],T.styleToObject(e[i])):T.isObject(e[i])?t[i]=T.mergeAttrs(T.styleToObject(t[i]),e[i]):t[i]=T.mergeAttrs(T.styleToObject(t[i]),T.styleToObject(e[i])):t[i]=e[i];return t},T.annotateString=function(t,e,i){e=e||[];for(var n,s,r,o=(i=i||{}).offset||0,a=[],l=[],h=0;h<t.length;h++){s=l[h]=t[h];for(var c=0;c<e.length;c++){var u=e[c],d=u.start+o,p=u.end+o;d<=h&&h<p&&(T.isObject(s)?s.attrs=T.mergeAttrs(T.mergeAttrs({},s.attrs),u.attrs):s=l[h]={t:t[h],attrs:u.attrs},i.includeAnnotationIndices&&(s.annotations||(s.annotations=[])).push(c))}(r=l[h-1])?T.isObject(s)&&T.isObject(r)?JSON.stringify(s.attrs)===JSON.stringify(r.attrs)?n.t+=s.t:(a.push(n),n=s):n=T.isObject(s)?(a.push(n),s):T.isObject(r)?(a.push(n),s):(n||"")+s:n=s}return n&&a.push(n),a},T.findAnnotationsAtIndex=function(t,e){var i=[];return t&&t.forEach(function(t){t.start<e&&e<=t.end&&i.push(t)}),i},T.findAnnotationsBetweenIndexes=function(t,e,i){var n=[];return t&&t.forEach(function(t){(e>=t.start&&e<t.end||i>t.start&&i<=t.end||t.start>=e&&t.end<i)&&n.push(t)}),n},T.shiftAnnotations=function(t,e,i){return t&&t.forEach(function(t){t.start<e&&t.end>=e?t.end+=i:t.start>=e&&(t.start+=i,t.end+=i)}),t},T.convertLineToPathData=function(t){return["M",(t=T(t)).attr("x1"),t.attr("y1"),"L",t.attr("x2"),t.attr("y2")].join(" ")},T.convertPolygonToPathData=function(t){var e=T.getPointsFromSvgNode(t);return 0===e.length?null:T.svgPointsToPath(e)+" Z"},T.convertPolylineToPathData=function(t){var e=T.getPointsFromSvgNode(t);return 0===e.length?null:T.svgPointsToPath(e)},T.svgPointsToPath=function(t){for(var e=0,i=t.length;e<i;e++)t[e]=t[e].x+" "+t[e].y;return"M "+t.join(" L")},T.getPointsFromSvgNode=function(t){var e=[],i=(t=T.toNode(t)).points;if(i)for(var n=0,s=i.numberOfItems;n<s;n++)e.push(i.getItem(n));return e},T.KAPPA=.551784,T.convertCircleToPathData=function(t){t=T(t);var e=parseFloat(t.attr("cx"))||0,i=parseFloat(t.attr("cy"))||0,n=parseFloat(t.attr("r")),s=n*T.KAPPA;return["M",e,i-n,"C",e+s,i-n,e+n,i-s,e+n,i,"C",e+n,i+s,e+s,i+n,e,i+n,"C",e-s,i+n,e-n,i+s,e-n,i,"C",e-n,i-s,e-s,i-n,e,i-n,"Z"].join(" ")},T.convertEllipseToPathData=function(t){t=T(t);var e=parseFloat(t.attr("cx"))||0,i=parseFloat(t.attr("cy"))||0,n=parseFloat(t.attr("rx")),s=parseFloat(t.attr("ry"))||n,r=n*T.KAPPA,o=s*T.KAPPA;return["M",e,i-s,"C",e+r,i-s,e+n,i-o,e+n,i,"C",e+n,i+o,e+r,i+s,e,i+s,"C",e-r,i+s,e-n,i+o,e-n,i,"C",e-n,i-o,e-r,i-s,e,i-s,"Z"].join(" ")},T.convertRectToPathData=function(t){return t=T(t),T.rectToPath({x:parseFloat(t.attr("x"))||0,y:parseFloat(t.attr("y"))||0,width:parseFloat(t.attr("width"))||0,height:parseFloat(t.attr("height"))||0,rx:parseFloat(t.attr("rx"))||0,ry:parseFloat(t.attr("ry"))||0})},T.rectToPath=function(t){var e=t.x,i=t.y,n=t.width,s=t.height,r=u(t.rx||t["top-rx"]||0,n/2),o=u(t.rx||t["bottom-rx"]||0,n/2),a=u(t.ry||t["top-ry"]||0,s/2),l=u(t.ry||t["bottom-ry"]||0,s/2);return(r||o||a||l?["M",e,i+a,"v",s-a-l,"a",o,l,0,0,0,o,l,"h",n-2*o,"a",o,l,0,0,0,o,-l,"v",-(s-l-a),"a",r,a,0,0,0,-r,-a,"h",-(n-2*r),"a",r,a,0,0,0,-r,a,"Z"]:["M",e,i,"H",e+n,"V",i+s,"H",e,"V",i,"Z"]).join(" ")},T.normalizePathData=(i="\t\n\v\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029",y=new RegExp("([a-z])["+i+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+i+"]*,?["+i+"]*)+)","ig"),b=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+i+"]*,?["+i+"]*","ig"),n=Math,W=n.PI,Y=n.sin,H=n.cos,F=n.tan,U=n.asin,X=n.sqrt,J=n.abs,function(t){return function(t){var n=w(t),e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function i(t,e,i){var n,s;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(t[0]in{T:1,Q:1}||(e.qx=null,e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=0===parseFloat(t[1])||0===parseFloat(t[2])?["L",t[6],t[7]]:["C"].concat($.apply(0,[e.x,e.y].concat(t.slice(1))));break;case"S":s="C"===i||"S"===i?(n=2*e.x-e.bx,2*e.y-e.by):(n=e.x,e.y),t=["C",n,s].concat(t.slice(1));break;case"T":"Q"===i||"T"===i?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"].concat(g(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"].concat(g(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"H":t=["L"].concat(t[1],e.y);break;case"V":t=["L"].concat(e.x,t[1])}return t}function s(t,e){if(7<t[e].length){t[e].shift();for(var i=t[e];i.length;)r[e]="A",t.splice(e++,0,["C"].concat(i.splice(0,6)));t.splice(e,1),l=n.length}}for(var r=[],o="",a="",l=n.length,h=0;h<l;h++){n[h]&&(o=n[h][0]),"C"!==o&&(r[h]=o,0<h&&(a=r[h-1])),n[h]=i(n[h],e,a),"A"!==r[h]&&"C"===o&&(r[h]="C"),s(n,h);var c=n[h],u=c.length;e.x=c[u-2],e.y=c[u-1],e.bx=parseFloat(c[u-4])||e.x,e.by=parseFloat(c[u-3])||e.y}return n[0][0]&&"M"===n[0][0]||n.unshift(["M",0,0]),n}(t).join(",").split(",").join(" ")}),T.namespace=k,T.g=zt,T}(),Gt="joint-",Bt={classNamePrefix:Gt,defaultTheme:"default"},jt=function(t,e,i){e=e||"/";var n={};for(var s in t)if(t.hasOwnProperty(s)){var r="object"==typeof t[s];if(r&&i&&i(t[s])&&(r=!1),r){var o=jt(t[s],e,i);for(var a in o)o.hasOwnProperty(a)&&(n[s+e+a]=o[a])}else n[s]=t[s]}return n},Rt=function(t){return Rt.id=Rt.id||1,t.id=void 0===t.id?"j_"+Rt.id++:t.id,t.id},Vt=function(){var s;if("undefined"!=typeof window&&(s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame),!s){var r=0;s=function(t){var e=(new Date).getTime(),i=Math.max(0,16-(e-r)),n=setTimeout(function(){t(e+i)},i);return r=e+i,n}}return function(t,e){for(var i=[],n=arguments.length-2;0<n--;)i[n]=arguments[n+2];return s(void 0!==e?t.bind.apply(t,[e].concat(i)):t)}}(),Zt=((Lt="undefined"!=typeof window)&&(Et=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame),Et=Et||clearTimeout,Lt?Et.bind(window):Et),Wt=function(t){return Ne(t)&&"%"===t.slice(-1)},Yt=function(t){t=t.replace(/\s/g,"");var e,i=(t=decodeURIComponent(t)).indexOf(","),n=t.slice(0,i),s=n.split(":")[1].split(";")[0],r=t.slice(i+1);e=0<=n.indexOf("base64")?atob(r):unescape(encodeURIComponent(r));for(var o=new Uint8Array(e.length),a=0;a<e.length;a++)o[a]=e.charCodeAt(a);return new Blob([o],{type:s})},Ht=function(t){if(Object(t)===t)return e=i=n=s=0,isFinite(t.vertical)&&(e=n=+t.vertical),isFinite(t.horizontal)&&(i=s=+t.horizontal),isFinite(t.top)&&(e=+t.top),isFinite(t.right)&&(i=+t.right),isFinite(t.bottom)&&(n=+t.bottom),isFinite(t.left)&&(s=+t.left),{top:e,right:i,bottom:n,left:s};var e,i,n,s,r=0;return isFinite(t)&&(r=+t),{top:r,right:r,bottom:r,left:r}},Ft={linear:function(t){return t},quad:function(t){return t*t},cubic:function(t){return t*t*t},inout:function(t){if(t<=0)return 0;if(1<=t)return 1;var e=t*t,i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)},exponential:function(t){return Math.pow(2,10*(t-1))},bounce:function(t){for(var e=0,i=1;;e+=i,i/=2)if((7-4*e)/11<=t){var n=(11-6*e-11*t)/4;return-n*n+i*i}},reverse:function(e){return function(t){return 1-e(1-t)}},reflect:function(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}},clamp:function(i,n,s){return n=n||0,s=s||1,function(t){var e=i(t);return e<n?n:s<e?s:e}},back:function(e){return e=e||1.70158,function(t){return t*t*((e+1)*t-e)}},elastic:function(e){return e=e||1.5,function(t){return Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*e/3*t)}}},Ut={number:function(e,t){var i=t-e;return function(t){return e+i*t}},object:function(s,r){var o=Object.keys(s);return function(t){var e,i,n={};for(e=o.length-1;-1!=e;e--)n[i=o[e]]=s[i]+(r[i]-s[i])*t;return n}},hexColor:function(t,e){var i=parseInt(t.slice(1),16),n=parseInt(e.slice(1),16),s=255&i,r=(255&n)-s,o=65280&i,a=(65280&n)-o,l=16711680&i,h=(16711680&n)-l;return function(t){return"#"+(1<<24|s+r*t&255|o+a*t&65280|l+h*t&16711680).toString(16).slice(1)}},unit:function(e,t){var i=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,n=i.exec(e),s=i.exec(t),r=s[1].indexOf("."),o=0<r?s[1].length-r-1:0;e=+n[1];var a=s[1]-e,l=n[2];return function(t){return(e+a*t).toFixed(o)+l}}},Xt={outline:function(t){var e=Number.isFinite(t.margin)?t.margin:2,i=Number.isFinite(t.width)?t.width:1;return $t('<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${outerRadius}" /><feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${innerRadius}" /><feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/><feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/><feMerge><feMergeNode in="outline"/><feMergeNode in="SourceGraphic"/></feMerge></filter>')({color:t.color||"blue",opacity:Number.isFinite(t.opacity)?t.opacity:1,outerRadius:e+i,innerRadius:e})},highlight:function(t){return $t('<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${width}"/><feComposite result="composed" in="colored" in2="morphed" operator="in"/><feGaussianBlur result="blured" in="composed" stdDeviation="${blur}"/><feBlend in="SourceGraphic" in2="blured" mode="normal"/></filter>')({color:t.color||"red",width:Number.isFinite(t.width)?t.width:1,blur:Number.isFinite(t.blur)?t.blur:0,opacity:Number.isFinite(t.opacity)?t.opacity:1})},blur:function(t){var e=Number.isFinite(t.x)?t.x:2;return $t('<filter><feGaussianBlur stdDeviation="${stdDeviation}"/></filter>')({stdDeviation:Number.isFinite(t.y)?[e,t.y]:e})},dropShadow:function(t){var e="SVGFEDropShadowElement"in window?'<filter><feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}"/></filter>':'<filter><feGaussianBlur in="SourceAlpha" stdDeviation="${blur}"/><feOffset dx="${dx}" dy="${dy}" result="offsetblur"/><feFlood flood-color="${color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="${opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';return $t(e)({dx:t.dx||0,dy:t.dy||0,opacity:Number.isFinite(t.opacity)?t.opacity:1,color:t.color||"black",blur:Number.isFinite(t.blur)?t.blur:4})},grayscale:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return $t('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0"/></filter>')({a:.2126+.7874*(1-e),b:.7152-.7152*(1-e),c:.0722-.0722*(1-e),d:.2126-.2126*(1-e),e:.7152+.2848*(1-e),f:.0722-.0722*(1-e),g:.2126-.2126*(1-e),h:.0722+.9278*(1-e)})},sepia:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return $t('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0"/></filter>')({a:.393+.607*(1-e),b:.769-.769*(1-e),c:.189-.189*(1-e),d:.349-.349*(1-e),e:.686+.314*(1-e),f:.168-.168*(1-e),g:.272-.272*(1-e),h:.534-.534*(1-e),i:.131+.869*(1-e)})},saturate:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return $t('<filter><feColorMatrix type="saturate" values="${amount}"/></filter>')({amount:1-e})},hueRotate:function(t){return $t('<filter><feColorMatrix type="hueRotate" values="${angle}"/></filter>')({angle:t.angle||0})},invert:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return $t('<filter><feComponentTransfer><feFuncR type="table" tableValues="${amount} ${amount2}"/><feFuncG type="table" tableValues="${amount} ${amount2}"/><feFuncB type="table" tableValues="${amount} ${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:1-e})},brightness:function(t){return $t('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}"/><feFuncG type="linear" slope="${amount}"/><feFuncB type="linear" slope="${amount}"/></feComponentTransfer></filter>')({amount:Number.isFinite(t.amount)?t.amount:1})},contrast:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return $t('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}" intercept="${amount2}"/><feFuncG type="linear" slope="${amount}" intercept="${amount2}"/><feFuncB type="linear" slope="${amount}" intercept="${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:.5-e/2})}},Jt={number:function(t,e,r){r=r||{currency:["$",""],decimal:".",thousands:",",grouping:[3]};var i=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i.exec(t),n=i[1]||" ",s=i[2]||">",o=i[3]||"",a=i[4]||"",l=i[5],h=+i[6],c=i[7],u=i[8],d=i[9],p=1,g="",f="",m=!1;switch(u=u&&+u.substring(1),(l||"0"===n&&"="===s)&&(l=n="0",s="=",c&&(h-=Math.floor((h-1)/4))),d){case"n":c=!0,d="g";break;case"%":p=100,f="%",d="f";break;case"p":p=100,f="%",d="r";break;case"b":case"o":case"x":case"X":"#"===a&&(g="0"+d.toLowerCase());break;case"c":case"d":m=!0,u=0;break;case"s":p=-1,d="r"}"$"===a&&(g=r.currency[0],f=r.currency[1]),"r"!=d||u||(d="g"),null!=u&&("g"==d?u=Math.max(1,Math.min(21,u)):"e"!=d&&"f"!=d||(u=Math.max(0,Math.min(20,u))));var v=l&&c;if(m&&e%1)return"";var y=e<0||0===e&&1/e<0?(e=-e,"-"):o,b=f;if(p<0){var w=this.prefix(e,u);e=w.scale(e),b=w.symbol+f}else e*=p;var C=(e=this.convert(d,e,u)).lastIndexOf("."),I=C<0?e:e.substring(0,C),x=C<0?"":r.decimal+e.substring(C+1);function A(t){for(var e=t.length,i=[],n=0,s=r.grouping[0];0<e&&0<s;)i.push(t.substring(e-=s,e+s)),s=r.grouping[n=(n+1)%r.grouping.length];return i.reverse().join(r.thousands)}!l&&c&&r.grouping&&(I=A(I));var S=g.length+I.length+x.length+(v?0:y.length),_=S<h?new Array(S=h-S+1).join(n):"";return v&&(I=A(_+I)),y+=g,e=I+x,("<"===s?y+e+_:">"===s?_+y+e:"^"===s?_.substring(0,S>>=1)+y+e+_.substring(S):y+(v?e:_+e))+b},string:function(t,e){for(var i,n="{",s=!1,r=[];-1!==(i=t.indexOf(n));){var o,a,l;if(o=t.slice(0,i),s){l=(a=o.split(":")).shift().split("."),o=e;for(var h=0;h<l.length;h++)o=o[l[h]];a.length&&(o=this.number(a,o))}r.push(o),t=t.slice(i+1),n=(s=!s)?"}":"{"}return r.push(t),r.join("")},convert:function(t,e,i){switch(t){case"b":return e.toString(2);case"c":return String.fromCharCode(e);case"o":return e.toString(8);case"x":return e.toString(16);case"X":return e.toString(16).toUpperCase();case"g":return e.toPrecision(i);case"e":return e.toExponential(i);case"f":return e.toFixed(i);case"r":return(e=this.round(e,this.precision(e,i))).toFixed(Math.max(0,Math.min(20,this.precision(e*(1+1e-15),i))));default:return e+""}},round:function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},precision:function(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)},prefix:function(t,e){var i=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(function(t,e){var i=Math.pow(10,3*Math.abs(8-e));return{scale:8<e?function(t){return t/i}:function(t){return t*i},symbol:t}}),n=0;return t&&(t<0&&(t*=-1),e&&(t=this.round(t,this.precision(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n<=0?n+1:n-1)/3)))),i[8+n/3]}},$t=function(t){var e=/<%= ([^ ]+) %>|\$\{ ?([^{} ]+) ?\}|\{\{([^{} ]+)\}\}/g;return function(n){return n=n||{},t.replace(e,function(t){for(var e=Array.from(arguments).slice(1,4).find(function(t){return!!t}).split("."),i=n[e.shift()];void 0!==i&&e.length;)i=i[e.shift()];return void 0!==i?i:""})}},Kt=i.assign,Qt=i.defaults,qt=Kt,te=i.defaultsDeep,ee=i.assign,ie=i.defaults,ne=i.defaultsDeep,se=i.invokeMap||i.invoke,re=i.sortedIndexBy||i.sortedIndex,oe=i.uniqBy||i.uniq,ae=i.clone,le=i.cloneDeep,he=i.isEmpty,ce=i.isEqual,ue=i.isFunction,de=i.isPlainObject,pe=i.toArray,ge=i.debounce,fe=i.groupBy,me=i.sortBy,ve=i.flattenDeep,ye=i.without,be=i.difference,we=i.intersection,Ce=i.union,Ie=i.has,xe=i.result,Ae=i.omit,Se=i.pick,_e=i.bindAll,Pe=i.forIn,Me=i.camelCase,ke=i.uniqueId,Te=function(t){return!!t&&("object"==typeof t||"function"==typeof t)},Ne=function(t){var e=Object.prototype.toString;return"string"==typeof t||!!t&&"object"==typeof t&&"[object String]"===e.call(t)},De=function(){};function Ee(t){t=oe(t);var o=pe(t).reduce(function(t,e){return t[e.id]=e.clone(),t},{});return pe(t).forEach(function(t){var e=o[t.id];if(e.isLink()){var i=e.source(),n=e.target();i.id&&o[i.id]&&e.prop("source/id",o[i.id].id),n.id&&o[n.id]&&e.prop("target/id",o[n.id].id)}var s=t.get("parent");s&&o[s]&&e.set("parent",o[s].id);var r=pe(t.get("embeds")).reduce(function(t,e){return o[e]&&t.push(o[e].id),t},[]);he(r)||e.set("embeds",r)}),o}function Le(r,o){return function(t,e){var i=Wt(t);t=parseFloat(t),i&&(t/=100);var n={};if(isFinite(t)){var s=i||0<=t&&t<=1?t*e[o]:Math.max(t+e[o],0);n[r]=s}return n}}function ze(o,a,l){return function(t,e){var i,n=Wt(t);if(t=parseFloat(t),n&&(t/=100),isFinite(t)){var s=e[l]();i=n||0<t&&t<1?s[o]+e[a]*t:s[o]+t}var r=j();return r[o]=i||0,r}}function Oe(s,r,o){return function(t,e){var i;i="middle"===t?e[r]/2:t===o?e[r]:isFinite(t)?-1<t&&t<1?-e[r]*t:-t:Wt(t)?e[r]*parseFloat(t)/100:0;var n=j();return n[s]=-(e[s]+i),n}}function Ge(p,t){var g="joint-shape",f=t&&t.resetOffset;return function(t,e,i){var n=P(i),s=n.data(g);if(!s||s.value!==t){var r=p(t);s={value:t,shape:r,shapeBBox:r.bbox()},n.data(g,s)}var o=s.shape.clone(),a=s.shapeBBox.clone(),l=a.origin(),h=e.origin();a.x=h.x,a.y=h.y;var c=e.maxRectScaleToFit(a,h),u=0===a.width||0===e.width?1:c.sx,d=0===a.height||0===e.height?1:c.sy;return o.scale(u,d,l),f&&o.translate(-l.x,-l.y),o}}function Be(t){var n=Ge(function(t){return new B(Ot.normalizePathData(t))},t);return function(t,e,i){return{d:n(t,e,i).serialize()}}}function je(t){var n=Ge(K,t);return function(t,e,i){return{points:n(t,e,i).serialize()}}}function Re(s,r){var o=new j(1,0);return function(t){var e,i,n=this[s](t);return n?(i=r.rotate?n.vector().vectorAngle(o):0,e=n.start):(e=this.path.start,i=0),0===i?{transform:"translate("+e.x+","+e.y+")"}:{transform:"translate("+e.x+","+e.y+") rotate("+i+")"}}}function Ve(t,e,i){return void 0!==i.text}function Ze(){return this.model.isLink()}function We(t){var e={},i=t.stroke;"string"==typeof i&&(e.stroke=i,e.fill=i);var n=t.strokeOpacity;return void 0===n&&(n=t["stroke-opacity"]),void 0===n&&(n=t.opacity),void 0!==n&&(e["stroke-opacity"]=n,e["fill-opacity"]=n),e}var Ye,He,Fe={xlinkHref:{set:"xlink:href"},xlinkShow:{set:"xlink:show"},xlinkRole:{set:"xlink:role"},xlinkType:{set:"xlink:type"},xlinkArcrole:{set:"xlink:arcrole"},xlinkTitle:{set:"xlink:title"},xlinkActuate:{set:"xlink:actuate"},xmlSpace:{set:"xml:space"},xmlBase:{set:"xml:base"},xmlLang:{set:"xml:lang"},preserveAspectRatio:{set:"preserveAspectRatio"},requiredExtension:{set:"requiredExtension"},requiredFeatures:{set:"requiredFeatures"},systemLanguage:{set:"systemLanguage"},externalResourcesRequired:{set:"externalResourceRequired"},filter:{qualify:de,set:function(t){return"url(#"+this.paper.defineFilter(t)+")"}},fill:{qualify:de,set:function(t){return"url(#"+this.paper.defineGradient(t)+")"}},stroke:{qualify:de,set:function(t){return"url(#"+this.paper.defineGradient(t)+")"}},sourceMarker:{qualify:de,set:function(t,e,i,n){return t=ee(We(n),t),{"marker-start":"url(#"+this.paper.defineMarker(t)+")"}}},targetMarker:{qualify:de,set:function(t,e,i,n){return t=ee(We(n),{transform:"rotate(180)"},t),{"marker-end":"url(#"+this.paper.defineMarker(t)+")"}}},vertexMarker:{qualify:de,set:function(t,e,i,n){return t=ee(We(n),t),{"marker-mid":"url(#"+this.paper.defineMarker(t)+")"}}},text:{qualify:function(t,e,i){return!i.textWrap||!de(i.textWrap)},set:function(t,e,i,n){var s=P(i),r="joint-text",o=s.data(r),a=Se(n,"lineHeight","annotations","textPath","x","textVerticalAnchor","eol"),l=a.fontSize=n["font-size"]||n.fontSize,h=JSON.stringify([t,a]);if(void 0===o||o!==h){l&&i.setAttribute("font-size",l);var c=a.textPath;if(Te(c)){var u=c.selector;if("string"==typeof u){var d=this.findBySelector(u)[0];d instanceof SVGPathElement&&(a.textPath=ee({"xlink:href":"#"+d.id},c))}}Ot(i).text(""+t,a),s.data(r,h)}}},textWrap:{qualify:de,set:function(t,e,i,n){var s=t.width||0;Wt(s)?e.width*=parseFloat(s)/100:s<=0?e.width+=s:e.width=s;var r,o=t.height||0;Wt(o)?e.height*=parseFloat(o)/100:o<=0?e.height+=o:e.height=o;var a=t.text,l=this.model;if(void 0===a&&(a=n.text),void 0!==a){var h,c=a.split("\n"),u=c.length;for(h=0;h<u;h++)c[h]=Ct(""+c[h],{width:e.width},{"font-weight":n["font-weight"]||n.fontWeight||l.prop("binding/fontWeight"),"font-size":n["font-size"]||n.fontSize||l.prop("binding/fontSize"),"font-family":n["font-family"]||n.fontFamily||l.prop("binding/fontType"),lineHeight:n.lineHeight},{svgDocument:this.paper.svg,ellipsis:t.ellipsis,hyphen:t.hyphen,separator:t.separator});r=c.join("\n")}else r="";var d=l.prop("binding");"Label"==d.type&&(d.beforeWrapText=a),Fe.text.set.call(this,r,e,i,n)}},title:{qualify:function(t,e){return e instanceof SVGElement},set:function(t,e,i){var n=P(i),s="joint-title",r=n.data(s);if(void 0===r||r!==t){n.data(s,t);var o=i.firstChild;if(o&&"TITLE"===o.tagName.toUpperCase())o.textContent=t;else{var a=document.createElementNS(i.namespaceURI,"title");a.textContent=t,i.insertBefore(a,o)}}}},lineHeight:{qualify:Ve},textVerticalAnchor:{qualify:Ve},textPath:{qualify:Ve},annotations:{qualify:Ve},port:{set:function(t){return null===t||void 0===t.id?t:t.id}},style:{qualify:de,set:function(t,e,i){P(i).css(t)}},html:{set:function(t,e,i){P(i).html(t+"")}},ref:{},refX:{position:ze("x","width","origin")},refY:{position:ze("y","height","origin")},refDx:{position:ze("x","width","corner")},refDy:{position:ze("y","height","corner")},refWidth:{set:Le("width","width")},refHeight:{set:Le("height","height")},refRx:{set:Le("rx","width")},refRy:{set:Le("ry","height")},refRInscribed:{set:(Ye=Le("r","width"),He=Le("r","height"),function(t,e){return(e.height>e.width?Ye:He)(t,e)})},refRCircumscribed:{set:function(t,e){var i=Wt(t);t=parseFloat(t),i&&(t/=100);var n,s=Math.sqrt(e.height*e.height+e.width*e.width);return isFinite(t)&&(n=i||0<=t&&t<=1?t*s:Math.max(t+s,0)),{r:n}}},refCx:{set:Le("cx","width")},refCy:{set:Le("cy","height")},xAlignment:{offset:Oe("x","width","right")},yAlignment:{offset:Oe("y","height","bottom")},resetOffset:{offset:function(t,e){return t?{x:-e.x,y:-e.y}:{x:0,y:0}}},refDResetOffset:{set:Be({resetOffset:!0})},refDKeepOffset:{set:Be({resetOffset:!1})},refPointsResetOffset:{set:je({resetOffset:!0})},refPointsKeepOffset:{set:je({resetOffset:!1})},connection:{qualify:Ze,set:function(){return{d:this.getSerializedConnection()}}},atConnectionLengthKeepGradient:{qualify:Ze,set:Re("getTangentAtLength",{rotate:!0})},atConnectionLengthIgnoreGradient:{qualify:Ze,set:Re("getTangentAtLength",{rotate:!1})},atConnectionRatioKeepGradient:{qualify:Ze,set:Re("getTangentAtRatio",{rotate:!0})},atConnectionRatioIgnoreGradient:{qualify:Ze,set:Re("getTangentAtRatio",{rotate:!1})}};Fe.refR=Fe.refRInscribed,Fe.refD=Fe.refDResetOffset,Fe.refPoints=Fe.refPointsResetOffset,Fe.atConnectionLength=Fe.atConnectionLengthKeepGradient,Fe.atConnectionRatio=Fe.atConnectionRatioKeepGradient,Fe.refX2=Fe.refX,Fe.refY2=Fe.refY,Fe.refWidth2=Fe.refWidth,Fe.refHeight2=Fe.refHeight,Fe["ref-x"]=Fe.refX,Fe["ref-y"]=Fe.refY,Fe["ref-dy"]=Fe.refDy,Fe["ref-dx"]=Fe.refDx,Fe["ref-width"]=Fe.refWidth,Fe["ref-height"]=Fe.refHeight,Fe["x-alignment"]=Fe.xAlignment,Fe["y-alignment"]=Fe.yAlignment;function Ue(e,t,i){if(Ne(i)){if(!$e[i])throw new Error('Unknown wrapper: "'+i+'"');i=$e[i]}if(!ue(i))throw new Error("Wrapper must be a function.");pe(t).forEach(function(t){e[t]=i(e[t])})}var Xe=Fe,Je=o.Model.extend({constructor:function(t,e){var i,n=t||{};this.cid=ke("c"),this.attributes={},e&&e.collection&&(this.collection=e.collection),e&&e.parse&&(n=this.parse(n,e)||{}),(i=xe(this,"defaults"))&&(n=Tt({},i,n)),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)},translate:function(t,e,i){throw new Error("Must define a translate() method.")},toJSON:function(){var e=this.constructor.prototype.defaults.attrs||{},t=this.attributes.attrs,r={};Pe(t,function(t,n){var s=e[n];Pe(t,function(t,i){Te(t)&&!Array.isArray(t)?Pe(t,function(t,e){s&&s[i]&&ce(s[i][e],t)||(r[n]=r[n]||{},(r[n][i]||(r[n][i]={}))[e]=t)}):s&&ce(s[i],t)||(r[n]=r[n]||{},r[n][i]=t)})});var i=le(Ae(this.attributes,"attrs"));return i.attrs=r,i},initialize:function(t){t&&t.id||this.set("id",this.generateId(),{silent:!0}),this._transitionIds={},this.processPorts(),this.on("change:attrs",this.processPorts,this)},generateId:function(){return vt()},processPorts:function(){var t=this.ports,i={};Pe(this.get("attrs"),function(t,e){t&&t.port&&(void 0!==t.port.id?i[t.port.id]=t.port:i[t.port]={id:t.port})});var n={};Pe(t,function(t,e){i[e]||(n[e]=!0)}),this.graph&&!he(n)&&(this.graph.getConnectedLinks(this,{inbound:!0}).forEach(function(t){n[t.get("target").port]&&t.remove()}),this.graph.getConnectedLinks(this,{outbound:!0}).forEach(function(t){n[t.get("source").port]&&t.remove()}));this.ports=i},remove:function(t){t=t||{};var e=this.graph;if(!e)return this.collection&&this.collection.remove(this,t),this;e.startBatch("remove");var i=this.getParentCell();i&&i.unembed(this);for(var n=this.getEmbeddedCells(),s=0,r=n.length;s<r;s++){var o=n[s];o&&o.remove(t)}return this.trigger("remove",this,e.attributes.cells,t),e.stopBatch("remove"),this},toFront:function(i){var t=this.graph;if(t){i=i||{};var e,n=t.maxZIndex();i.deep?(e=this.getEmbeddedCells({deep:!0,breadthFirst:!0})).unshift(this):e=[this],n=n-e.length+1;var s=t.get("cells"),r=s.indexOf(this)!==s.length-e.length;(r=r||e.some(function(t,e){return t.get("z")!==n+e}))&&(this.startBatch("to-front"),n+=e.length,e.forEach(function(t,e){t.set("z",n+e,i)}),this.stopBatch("to-front"))}return this},toBack:function(i){var t=this.graph;if(t){i=i||{};var e,n=t.minZIndex();i.deep?(e=this.getEmbeddedCells({deep:!0,breadthFirst:!0})).unshift(this):e=[this];var s=0!==t.get("cells").indexOf(this);(s=s||e.some(function(t,e){return t.get("z")!==n+e}))&&(this.startBatch("to-back"),n-=e.length,e.forEach(function(t,e){t.set("z",n+e,i)}),this.stopBatch("to-back"))}return this},parent:function(t,e){return void 0===t?this.get("parent"):this.set("parent",t,e)},embed:function(t,e){if(this===t||this.isEmbeddedIn(t))throw new Error("Recursive embedding not allowed.");this.startBatch("embed");var i=ee([],this.get("embeds"));return i[t.isLink()?"unshift":"push"](t.id),t.parent(this.id,e),this.set("embeds",oe(i),e),this.stopBatch("embed"),this},unembed:function(t,e){return this.startBatch("unembed"),t.unset("parent",e),this.set("embeds",ye(this.get("embeds"),t.id),e),this.stopBatch("unembed"),this},getParentCell:function(){var t=this.parent(),e=this.graph;return t&&e&&e.getCell(t)||null},getAncestors:function(){var t=[];if(!this.graph)return t;for(var e=this.getParentCell();e;)t.push(e),e=e.getParentCell();return t},getEmbeddedCells:function(e){if(e=e||{},this.graph){var i;if(e.deep)if(e.breadthFirst){i=[];for(var t=this.getEmbeddedCells();0<t.length;){var n=t.shift();i.push(n),t.push.apply(t,n.getEmbeddedCells())}}else(i=this.getEmbeddedCells()).forEach(function(t){i.push.apply(i,t.getEmbeddedCells(e))});else i=pe(this.get("embeds")).map(this.graph.getCell,this.graph);return i}return[]},isEmbeddedIn:function(t,e){var i=Ne(t)?t:t.id,n=this.parent();if(e=ie({deep:!0},e),this.graph&&e.deep){for(;n;){if(n===i)return!0;n=this.graph.getCell(n).parent()}return!1}return n===i},isEmbedded:function(){return!!this.parent()},clone:function(t){if((t=t||{}).deep)return pe(Ee([this].concat(this.getEmbeddedCells({deep:!0}))));var e=o.Model.prototype.clone.apply(this,arguments);return e.set("id",this.generateId()),e.unset("embeds"),e.unset("parent"),e},prop:function(t,e,i){var n=Ne(t);if(n||Array.isArray(t)){if(1<arguments.length){var s,r,o=(r=n?(s=t).split("/"):(s=t.join("/"),t.slice()))[0],a=r.length;if((i=i||{}).propertyPath=s,i.propertyValue=e,i.propertyPathArray=r,1===a)return this.set(o,e,i);for(var l={},h=l,c=o,u=1;u<a;u++){var d=r[u],p=Number.isFinite(n?Number(d):d);h=h[c]=p?[]:{},c=d}l=ft(l,r,e,"/");var g=Tt({},this.attributes);i.rewrite&&mt(g,s,"/");var f=Tt(g,l);return this.set(o,f[o],i)}return gt(this.attributes,t,"/")}return this.set(Tt({},this.attributes,t),e)},removeProp:function(t,e){e=e||{};var i=Array.isArray(t)?t:t.split("/"),n=i[0];if("attrs"===n&&(e.dirty=!0),1===i.length)return this.unset(t,e);var s=i.slice(1),r=le(this.get(n));return mt(r,s,"/"),this.set(n,r,e)},attr:function(t,e,i){var n=Array.from(arguments);return 0===n.length?this.get("attrs"):(Array.isArray(t)?n[0]=["attrs"].concat(t):Ne(t)?n[0]="attrs/"+t:n[0]={attrs:t},this.prop.apply(this,n))},removeAttr:function(t,e){return Array.isArray(t)?this.removeProp(["attrs"].concat(t)):this.removeProp("attrs/"+t,e)},transition:function(s,e,r,i){i=i||"/",r=ee({duration:100,delay:10,timingFunction:Ft.linear,valueFunction:Ut.number},r);var o,a=0,l=function(t){var e,i,n;(i=(t-=a=a||t)/r.duration)<1?this._transitionIds[s]=e=Vt(l):(i=1,delete this._transitionIds[s]),n=o(r.timingFunction(i)),r.transitionId=e,this.prop(s,n,r),e||this.trigger("transition:end",this,s)}.bind(this),t=function(t){this.stopTransitions(s),o=r.valueFunction(gt(this.attributes,s,i),e),this._transitionIds[s]=Vt(t),this.trigger("transition:start",this,s)}.bind(this);return setTimeout(t,r.delay,l)},getTransitions:function(){return Object.keys(this._transitionIds)},stopTransitions:function(t,e){e=e||"/";var i=t&&t.split(e);return Object.keys(this._transitionIds).filter(i&&function(t){return ce(i,t.split(e).slice(0,i.length))}).forEach(function(t){Zt(this._transitionIds[t]),delete this._transitionIds[t],this.trigger("transition:end",this,t)},this),this},addTo:function(t,e){return t.addCell(this,e),this},findView:function(t){return t.findViewByModel(this)},isElement:function(){return!1},isLink:function(){return!1},startBatch:function(t,e){return this.graph&&this.graph.startBatch(t,ee({},e,{cell:this})),this},stopBatch:function(t,e){return this.graph&&this.graph.stopBatch(t,ee({},e,{cell:this})),this},getChangeFlag:function(t){var e=0;if(!t)return e;for(var i in t)t.hasOwnProperty(i)&&this.hasChanged(i)&&(e|=t[i]);return e},angle:function(){return 0},position:function(){return new g.Point(0,0)},getPointFromConnectedLink:function(){return new g.Point},getBBox:function(){return new g.Rect(0,0,0,0)}},{getAttributeDefinition:function(t){var e=this.attributes,i=Xe;return e&&e[t]||i[t]},define:function(t,e,i,n){i=ee({defaults:ne({type:t},e,this.prototype.defaults)},i);var s=this.extend(i,n);return"undefined"!=typeof joint&&Ie(joint,"shapes")&&ft(joint.shapes,t,s,"."),s}}),$e={cells:function(s){return function(){var t=Array.from(arguments),e=t.length,i=0<e&&t[0]||[],n=1<e&&t[e-1]||{};return Array.isArray(i)||(n instanceof Je?i=t:i instanceof Je&&(1<t.length&&t.pop(),i=t)),n instanceof Je&&(n={}),s.call(this,i,n)}}},Ke={wrapWith:Ue,wrappers:$e,addClassNamePrefix:ct,removeClassNamePrefix:ut,parseDOMJSON:dt,hashCode:pt,getByPath:gt,setByPath:ft,unsetByPath:mt,flattenObject:jt,uuid:vt,guid:Rt,toKebabCase:yt,normalizeEvent:bt,nextFrame:Vt,cancelFrame:Zt,shapePerimeterConnectionPoint:function(t,e,i,n){var s,r;if(!i){var o=e.$(".scalable")[0],a=e.$(".rotatable")[0];o&&o.firstChild?i=o.firstChild:a&&a.firstChild&&(i=a.firstChild)}return i?(r=Ot(i).findIntersection(n,t.paper.cells))||(s=Ot(i).getBBox({target:t.paper.cells})):r=(s=e.model.getBBox()).intersectionWithLineFromCenterToPoint(n),r||s.center()},isPercentage:Wt,parseCssNumeric:wt,breakText:Ct,sanitizeHTML:It,downloadBlob:xt,downloadDataUri:At,dataUriToBlob:Yt,imageToDataUri:St,getElementBBox:_t,sortElements:Pt,setAttributesBySelector:Mt,normalizeSides:Ht,timing:Ft,interpolate:Ut,filter:Xt,format:Jt,template:$t,toggleFullScreen:kt,mixin:Kt,supplement:Qt,deepMixin:qt,deepSupplement:te,assign:ee,defaults:ie,defaultsDeep:ne,invoke:se,sortedIndex:re,uniq:oe,clone:ae,cloneDeep:le,isEmpty:he,isEqual:ce,isFunction:ue,isPlainObject:de,toArray:pe,debounce:ge,groupBy:fe,sortBy:me,flattenDeep:ve,without:ye,difference:be,intersection:we,union:Ce,has:Ie,result:xe,omit:Ae,pick:Se,bindAll:_e,forIn:Pe,camelCase:Me,uniqueId:ke,merge:Tt,isBoolean:Nt,isObject:Te,isNumber:Dt,isString:Ne,noop:De,cloneCells:Ee};function Qe(t,e,i){var n=t.toJSON();return n.angle=e||0,ie({},i,n)}function qe(t,e,i){return t.map(function(t,e,i){var n=this.pointAt((e+.5)/i.length);return(t.dx||t.dy)&&n.offset(t.dx||0,t.dy||0),Qe(n.round(),0,t)},Y(e,i))}function ti(t,e,o,a){var l=e.center(),h=e.width/e.height,c=e.topMiddle(),u=_.fromRect(e);return t.map(function(t,e,i){var n=o+a(e,i.length),s=c.clone().rotate(l,-n).scale(h,1,l),r=t.compensateRotation?-u.tangentTheta(s):0;return(t.dx||t.dy)&&s.offset(t.dx||0,t.dy||0),t.dr&&s.move(l,t.dr),Qe(s.round(),r,t)})}function ei(t,e){var i=e.x;Ne(i)&&(i=parseFloat(i)/100*t.width);var n=e.y;return Ne(n)&&(n=parseFloat(n)/100*t.height),H(i||0,n||0)}var ii={absolute:function(t,e,i){return t.map(ei.bind(null,e))},fn:function(t,e,i){return i.fn(t,e,i)},line:function(t,e,i){return qe(t,ei(e,i.start||e.origin()),ei(e,i.end||e.corner()))},left:function(t,e,i){return qe(t,e.origin(),e.bottomLeft())},right:function(t,e,i){return qe(t,e.topRight(),e.corner())},top:function(t,e,i){return qe(t,e.origin(),e.topRight())},bottom:function(t,e,i){return qe(t,e.bottomLeft(),e.corner())},ellipseSpread:function(t,e,i){var n=i.startAngle||0,s=i.step||360/t.length;return ti(t,e,n,function(t){return t*s})},ellipse:function(t,e,i){var n=i.startAngle||0,s=i.step||20;return ti(t,e,n,function(t,e){return(t+.5-e/2)*s})}};function ni(t,e){return ne({},t,e,{x:0,y:0,angle:0,attrs:{".":{y:"0","text-anchor":"start"}}})}function si(t,e,i,n){n=ie({},n,{offset:15});var s,r,o,a,l=e.center().theta(t),h=ri(e),c=n.offset,u=0;a=l<h[1]||l>h[2]?(o=".3em",s=c,r=0,"start"):l<h[0]?(o="0",s=0,r=-c,i?(u=-90,"start"):"middle"):l<h[3]?(o=".3em",s=-c,r=0,"end"):(o=".6em",s=0,r=c,i?(u=90,"start"):"middle");var d=Math.round;return ni({x:d(s),y:d(r),angle:u,attrs:{".":{y:o,"text-anchor":a}}})}function ri(t){var e=t.center(),i=e.theta(t.origin()),n=e.theta(t.bottomLeft()),s=e.theta(t.corner());return[i,e.theta(t.topRight()),s,n]}function oi(t,e,i,n){var s,r,o,a,l=e.center().theta(t),h=(n=ie({},n,{offset:15})).offset,c=0,u=ri(e);a=l<u[1]||l>u[2]?(o=".3em",s=-h,r=0,"end"):l<u[0]?(o=".6em",s=0,r=h,i?(c=90,"start"):"middle"):l<u[3]?(o=".3em",s=h,r=0,"start"):(o="0em",s=0,r=-h,i?(c=-90,"start"):"middle");var d=Math.round;return ni({x:d(s),y:d(r),angle:c,attrs:{".":{y:o,"text-anchor":a}}})}function ai(t,e,i){i=ie({},i,{offset:20});var n,s=H(0,0),r=-t.theta(s),o=r,a=t.clone().move(s,i.offset).difference(t).round(),l=".3em";(90+r)%180==0?(n=e?"end":"middle",e||-270!=r||(l="0em")):-270<r&&r<-90?(n="start",o=r-180):n="end";var h=Math.round;return ni({x:h(a.x),y:h(a.y),angle:e?o:0,attrs:{".":{y:l,"text-anchor":n}}})}function li(t){var e=le(t)||{};this.ports=[],this.groups={},this.portLayoutNamespace=ii,this.portLabelLayoutNamespace=hi,this._init(e)}var hi={manual:function(t,e,i){return ni(i,e)},left:function(t,e,i){return ni(i,{x:-15,attrs:{".":{y:".3em","text-anchor":"end"}}})},right:function(t,e,i){return ni(i,{x:15,attrs:{".":{y:".3em","text-anchor":"start"}}})},top:function(t,e,i){return ni(i,{y:-15,attrs:{".":{"text-anchor":"middle"}}})},bottom:function(t,e,i){return ni(i,{y:15,attrs:{".":{y:".6em","text-anchor":"middle"}}})},outsideOriented:function(t,e,i){return si(t,e,!0,i)},outside:function(t,e,i){return si(t,e,!1,i)},insideOriented:function(t,e,i){return oi(t,e,!0,i)},inside:function(t,e,i){return oi(t,e,!1,i)},radial:function(t,e,i){return ai(t.difference(e.center()),!1,i)},radialOriented:function(t,e,i){return ai(t.difference(e.center()),!0,i)}};li.prototype={getPorts:function(){return this.ports},getGroup:function(t){return this.groups[t]||{}},getPortsByGroup:function(e){return this.ports.filter(function(t){return t.group===e})},getGroupPortsMetrics:function(t,s){var e=this.getGroup(t),i=this.getPortsByGroup(t),n=e.position||{},r=n.name,o=this.portLayoutNamespace;o[r]||(r="left");var a=n.args||{},l=i.map(function(t){return t&&t.position&&t.position.args}),h=o[r](l,s,a),c={ports:i,result:[]};return pe(h).reduce(function(t,e,i){var n=t.ports[i];return t.result.push({portId:n.id,portTransformation:e,labelTransformation:this._getPortLabelLayout(n,j(e),s),portAttrs:n.attrs,portSize:n.size,labelSize:n.label.size}),t}.bind(this),c),c.result},_getPortLabelLayout:function(t,e,i){var n=this.portLabelLayoutNamespace,s=t.label.position.name||"left";return n[s]?n[s](e,i,t.label.position.args):null},_init:function(t){if(Te(t.groups))for(var e=Object.keys(t.groups),i=0,n=e.length;i<n;i++){var s=e[i];this.groups[s]=this._evaluateGroup(t.groups[s])}for(var r=pe(t.items),o=0,a=r.length;o<a;o++)this.ports.push(this._evaluatePort(r[o]))},_evaluateGroup:function(t){return Tt(t,{position:this._getPosition(t.position,!0),label:this._getLabel(t,!0)})},_evaluatePort:function(t){var e=ee({},t),i=this.getGroup(t.group);return e.markup=e.markup||i.markup,e.attrs=Tt({},i.attrs,e.attrs),e.position=this._createPositionNode(i,e),e.label=Tt({},i.label,this._getLabel(e)),e.z=this._getZIndex(i,e),e.size=ee({},i.size,e.size),e},_getZIndex:function(t,e){return Dt(e.z)?e.z:Dt(t.z)||"auto"===t.z?t.z:"auto"},_createPositionNode:function(t,e){return Tt({name:"left",args:{}},t.position,{args:e.args})},_getPosition:function(t,e){var i,n={};ue(t)?(i="fn",n.fn=t):Ne(t)?i=t:void 0===t?i=e?"left":null:Array.isArray(t)?(i="absolute",n.x=t[0],n.y=t[1]):Te(t)&&(i=t.name,ee(n,t.args));var s={args:n};return i&&(s.name=i),s},_getLabel:function(t,e){var i=t.label||{},n=i;return n.position=this._getPosition(i.position,e),n}};var ci={_initializePorts:function(){this._createPortData(),this.on("change:ports",function(){this._processRemovedPort(),this._createPortData()},this)},_processRemovedPort:function(){var t=this.get("ports")||{},e={};pe(t.items).forEach(function(t){e[t.id]=!0});var i=this.previous("ports")||{},n={};pe(i.items).forEach(function(t){e[t.id]||(n[t.id]=!0)});var s=this.graph;s&&!he(n)&&(s.getConnectedLinks(this,{inbound:!0}).forEach(function(t){n[t.get("target").port]&&t.remove()}),s.getConnectedLinks(this,{outbound:!0}).forEach(function(t){n[t.get("source").port]&&t.remove()}))},hasPorts:function(){var t=this.prop("ports/items");return Array.isArray(t)&&0<t.length},hasPort:function(t){return-1!==this.getPortIndex(t)},getPorts:function(){return le(this.prop("ports/items"))||[]},getPort:function(e){return le(pe(this.prop("ports/items")).find(function(t){return t.id&&t.id===e}))},getPortsPositions:function(t){return this._portSettingsData.getGroupPortsMetrics(t,Q(this.size())).reduce(function(t,e){var i=e.portTransformation;return t[e.portId]={x:i.x,y:i.y,angle:i.angle},t},{})},getPortIndex:function(t){var e=Te(t)?t.id:t;return this._isValidPortId(e)?pe(this.prop("ports/items")).findIndex(function(t){return t.id===e}):-1},addPort:function(t,e){if(!Te(t)||Array.isArray(t))throw new Error("Element: addPort requires an object.");var i=ee([],this.prop("ports/items"));return i.push(t),this.prop("ports/items",i,e),this},portProp:function(t,e,i,n){var s=this.getPortIndex(t);if(-1===s)throw new Error("Element: unable to find port with id "+t);var r=Array.prototype.slice.call(arguments,1);return Array.isArray(e)?r[0]=["ports","items",s].concat(e):Ne(e)?r[0]=["ports/items/",s,"/",e].join(""):(r=["ports/items/"+s],de(e)&&(r.push(e),r.push(i))),this.prop.apply(this,r)},_validatePorts:function(){var t=this.get("ports")||{},e=[],i=pe((t=t||{}).items);return i.forEach(function(t){"object"!=typeof t&&e.push("Element: invalid port ",t),this._isValidPortId(t.id)||(t.id=this.generatePortId())},this),oe(i,"id").length!==i.length&&e.push("Element: found id duplicities in ports."),e},generatePortId:function(){return this.generateId()},_isValidPortId:function(t){return null!=t&&!Te(t)},addPorts:function(t,e){return t.length&&this.prop("ports/items",ee([],this.prop("ports/items")).concat(t),e),this},removePort:function(t,e){var i=e||{},n=ee([],this.prop("ports/items")),s=this.getPortIndex(t);return-1!==s&&(n.splice(s,1),i.rewrite=!0,this.prop("ports/items",n,i)),this},removePorts:function(t,e){var i;if(Array.isArray(t)){if(i=e||{},t.length){i.rewrite=!0;var n=ee([],this.prop("ports/items")).filter(function(i){return!t.some(function(t){var e=Te(t)?t.id:t;return i.id===e})});this.prop("ports/items",n,i)}}else(i=t||{}).rewrite=!0,this.prop("ports/items",[],i);return this},_createPortData:function(){var t,e=this._validatePorts();if(0<e.length)throw this.set("ports",this.previous("ports")),new Error(e.join(" "));this._portSettingsData&&(t=this._portSettingsData.getPorts()),this._portSettingsData=new li(this.get("ports"));var i=this._portSettingsData.getPorts();if(t){var n=i.filter(function(e){if(!t.find(function(t){return t.id===e.id}))return e}),s=t.filter(function(e){if(!i.find(function(t){return t.id===e.id}))return e});0<s.length&&this.trigger("ports:remove",this,s),0<n.length&&this.trigger("ports:add",this,n)}}},ui={portContainerMarkup:"g",portMarkup:[{tagName:"circle",selector:"circle",attributes:{r:10,fill:"#FFFFFF",stroke:"#000000"}}],portLabelMarkup:[{tagName:"text",selector:"text",attributes:{fill:"#000000"}}],_portElementsCache:null,_initializePorts:function(){this._portElementsCache={}},_refreshPorts:function(){this._removePorts(),this._portElementsCache={},this._renderPorts()},_renderPorts:function(){for(var i=[],n=this._getContainerElement(),t=0,e=n.node.childNodes.length;t<e;t++)i.push(n.node.childNodes[t]);var s=fe(this.model._portSettingsData.getPorts(),"z");pe(s.auto).forEach(function(t){var e=this._getPortElement(t);n.append(e),i.push(e)},this);for(var r=Object.keys(s),o=0;o<r.length;o++){var a=r[o];if("auto"!==a){var l=parseInt(a,10);this._appendPorts(s[a],l,i)}}this._updatePorts()},_getContainerElement:function(){return this.rotatableNode||this.vel},_appendPorts:function(t,e,i){var n=this._getContainerElement(),s=pe(t).map(this._getPortElement,this);i[e]||e<0?Ot(i[Math.max(e,0)]).before(s):n.append(s)},_getPortElement:function(t){return this._portElementsCache[t.id]?this._portElementsCache[t.id].portElement:this._createPortElement(t)},findPortNode:function(t,e){var i=this._portElementsCache[t];if(!i)return null;var n=i.portContentElement.node,s=i.portContentSelectors;return this.findBySelector(e,n,s)[0]},_updatePorts:function(){this._updatePortGroup(void 0),Object.keys(this.model._portSettingsData.groups).forEach(this._updatePortGroup,this)},_removePorts:function(){se(this._portElementsCache,"portElement.remove")},_createPortElement:function(t){var e,i,n,s=Ot(this.portContainerMarkup).addClass("joint-port"),r=this._getPortMarkup(t);if(Array.isArray(r)){var o=this.parseDOMJSON(r,s.node),a=o.fragment;e=1<a.childNodes.length?Ot("g").append(a):Ot(a.firstChild),n=o.selectors}else e=Ot(r),Array.isArray(e)&&(e=Ot("g").append(e));if(!e)throw new Error("ElementView: Invalid port markup.");e.attr({port:t.id,"port-group":t.group});var l,h,c=this._getPortLabelMarkup(t.label);if(Array.isArray(c)){var u=this.parseDOMJSON(c,s.node),d=u.fragment;i=1<d.childNodes.length?Ot("g").append(d):Ot(d.firstChild),l=u.selectors}else i=Ot(c),Array.isArray(i)&&(i=Ot("g").append(i));if(!i)throw new Error("ElementView: Invalid port label markup.");if(n&&l){for(var p in l)if(n[p]&&p!==this.selector)throw new Error("ElementView: selectors within port must be unique.");h=ee({},n,l)}else h=n||l;return s.append([e.addClass("joint-port-body"),i.addClass("joint-port-label")]),this._portElementsCache[t.id]={portElement:s,portLabelElement:i,portSelectors:h,portLabelSelectors:l,portContentElement:e,portContentSelectors:n},s},_updatePortGroup:function(t){for(var e=Q(this.model.size()),i=this.model._portSettingsData.getGroupPortsMetrics(t,e),n=0,s=i.length;n<s;n++){var r=i[n],o=r.portId,a=this._portElementsCache[o]||{},l=r.portTransformation;this.applyPortTransform(a.portElement,l),this.updateDOMSubtreeAttributes(a.portElement.node,r.portAttrs,{rootBBox:new Q(r.portSize),selectors:a.portSelectors});var h=r.labelTransformation;h&&(this.applyPortTransform(a.portLabelElement,h,-l.angle||0),this.updateDOMSubtreeAttributes(a.portLabelElement.node,h.attrs,{rootBBox:new Q(r.labelSize),selectors:a.portLabelSelectors}))}},applyPortTransform:function(t,e,i){var n=Ot.createSVGMatrix().rotate(i||0).translate(e.x||0,e.y||0).rotate(e.angle||0);t.transform(n,{absolute:!0})},_getPortMarkup:function(t){return t.markup||this.model.get("portMarkup")||this.model.portMarkup||this.portMarkup},_getPortLabelMarkup:function(t){return t.markup||this.model.get("portLabelMarkup")||this.model.portLabelMarkup||this.portLabelMarkup}},di=Je.extend({defaults:{position:{x:0,y:0},size:{width:1,height:1},angle:0},initialize:function(){this._initializePorts(),Je.prototype.initialize.apply(this,arguments)},_initializePorts:function(){},_refreshPorts:function(){},isElement:function(){return!0},position:function(t,e,i){var n=Dt(e);if((i=(n?i:t)||{}).parentRelative){if(!this.graph)throw new Error("Element must be part of a graph.");var s=this.getParentCell(),r=s&&!s.isLink()?s.get("position"):{x:0,y:0}}if(n){if(i.parentRelative&&(t+=r.x,e+=r.y),i.deep){var o=this.get("position");this.translate(t-o.x,e-o.y,i)}else this.set("position",{x:t,y:e},i);return this}var a=j(this.get("position"));return i.parentRelative?a.difference(r):a},translate:function(t,e,i){if(e=e||0,0===(t=t||0)&&0===e)return this;(i=i||{}).translateBy=i.translateBy||this.id;var n=this.get("position")||{x:0,y:0};if(i.restrictedArea&&i.translateBy===this.id){var s=this.getBBox({deep:!0}),r=i.restrictedArea,o=n.x-s.x,a=n.y-s.y,l=Math.max(r.x+o,Math.min(r.x+r.width+o-s.width,n.x+t)),h=Math.max(r.y+a,Math.min(r.y+r.height+a-s.height,n.y+e));t=l-n.x,e=h-n.y}var c={x:n.x+t,y:n.y+e};return i.tx=t,i.ty=e,i.transition?(Te(i.transition)||(i.transition={}),this.transition("position",c,ee({},i.transition,{valueFunction:Ut.object})),se(this.getEmbeddedCells(),"translate",t,e,i)):(this.startBatch("translate",i),this.set("position",c,i),se(this.getEmbeddedCells(),"translate",t,e,i),this.stopBatch("translate",i)),this},size:function(t,e,i){var n=this.get("size");return void 0===t?{width:n.width,height:n.height}:(Te(t)&&(i=e,e=Dt(t.height)?t.height:n.height,t=Dt(t.width)?t.width:n.width),this.resize(t,e,i))},resize:function(t,e,i){if(i=i||{},this.startBatch("resize",i),i.direction){var n=this.get("size");switch(i.direction){case"left":case"right":e=n.height;break;case"top":case"bottom":t=n.width}var s=q(this.get("angle")||0),r={"top-right":0,right:0,"top-left":1,top:1,"bottom-left":2,left:2,"bottom-right":3,bottom:3}[i.direction];i.absolute&&(r+=Math.floor((s+45)/90),r%=4);var o=this.getBBox(),a=o[["bottomLeft","corner","topRight","origin"][r]](),l=j(a).rotate(o.center(),-s),h=Math.sqrt(t*t+e*e)/2,c=r*Math.PI/2;c+=Math.atan(r%2==0?e/t:t/e),c-=T(s);var u=j.fromPolar(h,c,l),d=j(u).offset(t/-2,e/-2);this.set("size",{width:t,height:e},i),this.position(d.x,d.y,i)}else this.set("size",{width:t,height:e},i);return this.stopBatch("resize",i),this},scale:function(t,e,i,n){var s=this.getBBox().scale(t,e,i);return this.startBatch("scale",n),this.position(s.x,s.y,n),this.resize(s.width,s.height,n),this.stopBatch("scale"),this},fitEmbeds:function(t){if(t=t||{},!this.graph)throw new Error("Element must be part of a graph.");var e=this.getEmbeddedCells();if(0<e.length){this.startBatch("fit-embeds",t),t.deep&&se(e,"fitEmbeds",t);var i=this.graph.getCellsBBox(e),n=Ht(t.padding);i.moveAndExpand({x:-n.left,y:-n.top,width:n.right+n.left,height:n.bottom+n.top}),this.set({position:{x:i.x,y:i.y},size:{width:i.width,height:i.height}},t),this.stopBatch("fit-embeds")}return this},rotate:function(t,e,i,n){if(i){var s=this.getBBox().center(),r=this.get("size"),o=this.get("position");s.rotate(i,this.get("angle")-t);var a=s.x-r.width/2-o.x,l=s.y-r.height/2-o.y;this.startBatch("rotate",{angle:t,absolute:e,origin:i}),this.position(o.x+a,o.y+l,n),this.rotate(t,e,null,n),this.stopBatch("rotate")}else this.set("angle",e?t:(this.get("angle")+t)%360,n);return this},angle:function(){return q(this.get("angle")||0)},getBBox:function(t){if((t=t||{}).deep&&this.graph){var e=this.getEmbeddedCells({deep:!0,breadthFirst:!0});return e.push(this),this.graph.getCellsBBox(e)}var i=this.get("position"),n=this.get("size");return new Q(i.x,i.y,n.width,n.height)},getPointFromConnectedLink:function(t,e){var i=this.getBBox(),n=i.center(),s=t.get(e);if(!s)return n;var r=s.port;if(!r)return n;var o=this.portProp(r,["group"]),a=this.getPortsPositions(o),l=new j(a[r]).offset(i.origin()),h=this.angle();return h&&l.rotate(n,-h),l}});ee(di.prototype,ci);var pi={},gi=o.View.extend({options:{},theme:null,themeClassNamePrefix:ct("theme-"),requireSetThemeOverride:!1,defaultTheme:"default",children:null,childNodes:null,UPDATE_PRIORITY:2,constructor:function(t){this.requireSetThemeOverride=t&&!!t.theme,this.options=ee({},this.options,t),o.View.call(this,t)},initialize:function(){(pi[this.cid]=this).setTheme(this.options.theme||this.defaultTheme),this.init()},unmount:function(){this.svgElement?this.vel.remove():this.$el.remove()},renderChildren:function(t){if(t=t||xe(this,"children")){var e=this.svgElement,i=Ot.namespace[e?"svg":"xhtml"],n=dt(t,i);(e?this.vel:this.$el).empty().append(n.fragment),this.childNodes=n.selectors}return this},findAttribute:function(t,e){for(var i=e;i&&1===i.nodeType;){var n=i.getAttribute(t);if(n)return n;if(i===this.el)return null;i=i.parentNode}return null},_ensureElement:function(){if(this.el)this.setElement(xe(this,"el"));else{var t=xe(this,"tagName"),e=ee({},xe(this,"attributes")),i=ee({},xe(this,"style"));this.id&&(e.id=xe(this,"id")),this.setElement(this._createElement(t)),this._setAttributes(e),this._setStyle(i)}this._ensureElClassName()},_setAttributes:function(t){this.svgElement?this.vel.attr(t):this.$el.attr(t)},_setStyle:function(t){this.$el.css(t)},_createElement:function(t){return this.svgElement?document.createElementNS(Ot.namespace.svg,t):document.createElement(t)},_setElement:function(t){this.$el=t instanceof o.$?t:o.$(t),this.el=this.$el[0],this.svgElement&&(this.vel=Ot(this.el))},_ensureElClassName:function(){var t=xe(this,"className");if(t){var e=ct(t);this.svgElement?this.vel.removeClass(t).addClass(e):this.$el.removeClass(t).addClass(e)}},init:function(){},onRender:function(){},confirmUpdate:function(){return 0},setTheme:function(t,e){return e=e||{},this.theme&&this.requireSetThemeOverride&&!e.override||(this.removeThemeClassName(),this.addThemeClassName(t),this.onSetTheme(this.theme,t),this.theme=t),this},addThemeClassName:function(t){t=t||this.theme;var e=this.themeClassNamePrefix+t;return this.svgElement?this.vel.addClass(e):this.$el.addClass(e),this},removeThemeClassName:function(t){t=t||this.theme;var e=this.themeClassNamePrefix+t;return this.svgElement?this.vel.removeClass(e):this.$el.removeClass(e),this},onSetTheme:function(t,e){},remove:function(){return this.onRemove(),this.undelegateDocumentEvents(),pi[this.cid]=null,o.View.prototype.remove.apply(this,arguments),this},onRemove:function(){},getEventNamespace:function(){return".joint-event-ns-"+this.cid},delegateElementEvents:function(t,e,i){if(!e)return this;i=i||{};var n=this.getEventNamespace();for(var s in e){var r=e[s];"function"!=typeof r&&(r=this[r]),r&&P(t).on(s+n,i,r.bind(this))}return this},undelegateElementEvents:function(t){return P(t).off(this.getEventNamespace()),this},delegateDocumentEvents:function(t,e){return t=t||xe(this,"documentEvents"),this.delegateElementEvents(document,t,e)},undelegateDocumentEvents:function(){return this.undelegateElementEvents(document)},eventData:function(t,e){if(!t)throw new Error("eventData(): event object required.");var i=t.data,n="__"+this.cid+"__";return void 0===e?i&&i[n]||{}:((i=i||(t.data={}))[n]||(i[n]={}),ee(i[n],e),this)},stopPropagation:function(t){return this.eventData(t,{propagationStopped:!0}),this},isPropagationStopped:function(t){return!!this.eventData(t).propagationStopped}},{extend:function(){var t=Array.from(arguments),e=t[0]&&ee({},t[0])||{},i=t[1]&&ee({},t[1])||{},n=e.render||this.prototype&&this.prototype.render||null;return e.render=function(){return"function"==typeof n&&n.apply(this,arguments),this.render.__render__===n&&this.onRender(),this},e.render.__render__=n,o.View.extend.call(this,e,i)}}),fi={views:pi,View:gi},mi=gi.extend({tagName:"g",svgElement:!0,selector:"root",metrics:null,className:function(){var n=["cell"],t=this.model.get("type");return t&&t.toLowerCase().split(".").forEach(function(t,e,i){n.push("type-"+i.slice(0,e+1).join("-"))}),n.join(" ")},_presentationAttributes:null,_flags:null,setFlags:function(){var t,e,i,n={},s={},r=0,o=this.presentationAttributes;for(var a in o)if(o.hasOwnProperty(a)){var l=o[a];for(Array.isArray(l)||(l=[l]),t=0,e=l.length;t<e;t++){var h=n[i=l[t]];h=h||(n[i]=1<<r++),s[a]|=h}}var c=this.initFlag;for(Array.isArray(c)||(c=[c]),t=0,e=c.length;t<e;t++)n[i=c[t]]||(n[i]=1<<r++);if(25<r)throw new Error("dia.CellView: Maximum number of flags exceeded.");this._flags=n,this._presentationAttributes=s},hasFlag:function(t,e){return t&this.getFlag(e)},removeFlag:function(t,e){return t^t&this.getFlag(e)},getFlag:function(t){var e=this._flags;if(!e)return 0;var i=0;if(Array.isArray(t))for(var n=0,s=t.length;n<s;n++)i|=e[t[n]];else i|=e[t];return i},attributes:function(){var t=this.model;return{"model-id":t.id,"data-type":t.attributes.type}},constructor:function(t){t.id=t.id||Rt(this),gi.call(this,t)},initialize:function(){this.setFlags(),gi.prototype.initialize.apply(this,arguments),this.cleanNodesCache(),this.$el.data("view",this),this.startListening()},startListening:function(){this.listenTo(this.model,"change",this.onAttributesChange)},onAttributesChange:function(t,e){var i=t.getChangeFlag(this._presentationAttributes);if(!e.updateHandled&&i){e.dirty&&this.hasFlag(i,"UPDATE")&&(i|=this.getFlag("RENDER")),e.tool&&(e.async=!1);var n=this.paper;n&&n.requestViewUpdate(this,i,this.UPDATE_PRIORITY,e)}},parseDOMJSON:function(t,e){var i=dt(t),n=i.selectors,s=i.groupSelectors;for(var r in s){if(n[r])throw new Error("dia.CellView: ambiguous group selector");n[r]=s[r]}if(e){var o=this.selector;if(n[o])throw new Error("dia.CellView: ambiguous root selector.");n[o]=e}return{fragment:i.fragment,selectors:n}},can:function(t){var e=ue(this.options.interactive)?this.options.interactive(this):this.options.interactive;return Te(e)&&!1!==e[t]||Nt(e)&&!1!==e},findBySelector:function(t,e,i){if(e=e||this.el,i=i||this.selectors,!t||"."===t)return[e];if(i){var n=i[t];if(n)return Array.isArray(n)?n:[n]}return P(e).find(t).toArray()},notify:function(t){if(this.paper){var e=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t].concat(e)),this.paper.trigger.apply(this.paper,[t,this].concat(e))}},getBBox:function(t){var e;if(t&&t.useModelGeometry){var i=this.model;e=i.getBBox().bbox(i.angle())}else e=this.getNodeBBox(this.el);return this.paper.localToPaperRect(e)},getNodeBBox:function(t){var e=this.getNodeBoundingRect(t),i=this.getNodeMatrix(t),n=this.getRootTranslateMatrix(),s=this.getRootRotateMatrix();return Ot.transformRect(e,n.multiply(s).multiply(i))},getNodeUnrotatedBBox:function(t){var e=this.getNodeBoundingRect(t),i=this.getNodeMatrix(t),n=this.getRootTranslateMatrix();return Ot.transformRect(e,n.multiply(i))},getRootTranslateMatrix:function(){var t=this.model.position();return Ot.createSVGMatrix().translate(t.x,t.y)},getRootRotateMatrix:function(){var t=Ot.createSVGMatrix(),e=this.model,i=e.angle();if(i){var n=e.getBBox(),s=n.width/2,r=n.height/2;t=t.translate(s,r).rotate(i).translate(-s,-r)}return t},highlight:function(t,e){return t=t&&this.$(t)[0]||this.el,(e=e||{}).partial=t!==this.el,this.notify("cell:highlight",t,e),this},unhighlight:function(t,e){return t=t&&this.$(t)[0]||this.el,(e=e||{}).partial=t!=this.el,this.notify("cell:unhighlight",t,e),this},findMagnet:function(t){var e=this.$(t),i=this.$el;0===e.length&&(e=i);do{var n=e.attr("magnet");if((n||e.is(i))&&"false"!==n)return e[0];e=e.parent()}while(0<e.length)},getSelector:function(t,e){var i;if(t===this.el)return"string"==typeof e&&(i="> "+e),i;if(t){var n=Ot(t).index()+1;i=t.tagName+":nth-child("+n+")",e&&(i+=" > "+e),i=this.getSelector(t.parentNode,i)}return i},getLinkEnd:function(t,e,i,n,s){var r=this.model,o=r.id,a=this.findAttribute("port",t),l=t.getAttribute("joint-selector"),h={id:o};null!=l&&(h.magnet=l),null!=a?(h.port=a,r.hasPort(a)||l||(h.selector=this.getSelector(t))):null==l&&this.el!==t&&(h.selector=this.getSelector(t));var c=this.paper,u=c.options.connectionStrategy;if("function"==typeof u){var d=u.call(c,h,this,t,new j(e,i),n,s,c);d&&(h=d)}return h},getMagnetFromLinkEnd:function(t){var e=this.el,i=t.port,n=t.magnet,s=this.model;return null!=i&&s.isElement()&&s.hasPort(i)?this.findPortNode(i,n)||e:((n=n||t.selector)||null==i||(n='[port="'+i+'"]'),this.findBySelector(n,e,this.selectors)[0])},getAttributeDefinition:function(t){return this.model.constructor.getAttributeDefinition(t)},setNodeAttributes:function(t,e){he(e)||(t instanceof SVGElement?Ot(t).attr(e):P(t).attr(e))},processNodeAttributes:function(t,e){var i,n,s,r,o,a,l,h,c,u=[];for(i in e)e.hasOwnProperty(i)&&(n=e[i],!(s=this.getAttributeDefinition(i))||ue(s.qualify)&&!s.qualify.call(this,n,t,e)?(a=a||{})[yt(i)]=n:(Ne(s.set)&&((a=a||{})[s.set]=n),null!==n&&u.push(i,s)));for(r=0,o=u.length;r<o;r+=2)i=u[r],s=u[r+1],n=e[i],ue(s.set)&&((l=l||{})[i]=n),ue(s.position)&&((h=h||{})[i]=n),ue(s.offset)&&((c=c||{})[i]=n);return{raw:e,normal:a,set:l,position:h,offset:c}},updateRelativeAttributes:function(t,e,i,n){var s,r;n=n||{};var o=e.raw||{},a=e.normal||{},l=e.set,h=e.position,c=e.offset;for(s in l){r=l[s];var u=this.getAttributeDefinition(s).set.call(this,r,i.clone(),t,o);Te(u)?ee(a,u):void 0!==u&&(a[s]=u)}if(t instanceof HTMLElement)this.setNodeAttributes(t,a);else{var d,p,g,f=a.transform,m=Ot.transformStringToMatrix(f),v=j(m.e,m.f);if(f&&(a=Ae(a,"transform"),m.e=m.f=0),h||c){var y=this.getNodeScale(t,n.scalableNode);d=y.sx,p=y.sy}var b=!1;for(s in h)r=h[s],(g=this.getAttributeDefinition(s).position.call(this,r,i.clone(),t,o))&&(v.offset(j(g).scale(d,p)),b=b||!0);this.setNodeAttributes(t,a);var w=!1;if(c){var C=this.getNodeBoundingRect(t);if(0<C.width&&0<C.height){var I=Ot.transformRect(C,m).scale(1/d,1/p);for(s in c)r=c[s],(g=this.getAttributeDefinition(s).offset.call(this,r,I,t,o))&&(v.offset(j(g).scale(d,p)),w=w||!0)}}(void 0!==f||b||w)&&(v.round(1),m.e=v.x,m.f=v.y,t.setAttribute("transform",Ot.matrixToTransformString(m)))}},getNodeScale:function(t,e){var i,n;if(e&&e.contains(t)){var s=e.scale();i=1/s.sx,n=1/s.sy}else n=i=1;return{sx:i,sy:n}},cleanNodesCache:function(){this.metrics={}},nodeCache:function(t){var e=this.metrics;if(!e)return{};var i=Ot.ensureId(t),n=e[i];return n=n||(e[i]={})},getNodeData:function(t){var e=this.nodeCache(t);return e.data||(e.data={}),e.data},getNodeBoundingRect:function(t){var e=this.nodeCache(t);return void 0===e.boundingRect&&(e.boundingRect=Ot(t).getBBox()),new Q(e.boundingRect)},getNodeMatrix:function(t){var e=this.nodeCache(t);if(void 0===e.magnetMatrix){var i=this.rotatableNode||this.el;e.magnetMatrix=Ot(t).getTransformToElement(i)}return Ot.createSVGMatrix(e.magnetMatrix)},getNodeShape:function(t){var e=this.nodeCache(t);return void 0===e.geometryShape&&(e.geometryShape=Ot(t).toGeometryShape()),e.geometryShape.clone()},isNodeConnection:function(t){return this.model.isLink()&&(!t||t===this.el)},findNodesAttributes:function(t,e,i,n){var s,r,o,a,l={},h=[];for(var c in t)if(t.hasOwnProperty(c)){var u=i[c]=this.findBySelector(c,e,n);for(s=0,r=u.length;s<r;s++){var d=u[s];a=Ot.ensureId(d),o=t[c];var p=n&&n[c]===d,g=l[a];if(g){g.array||(h.push(a),g.array=!0,g.attributes=[g.attributes],g.selectedLength=[g.selectedLength]);var f=g.attributes,m=g.selectedLength;if(p)f.unshift(o),m.unshift(-1);else{var v=re(m,r);f.splice(v,0,o),m.splice(v,0,r)}}else l[a]={attributes:o,selectedLength:p?-1:r,node:d,array:!1}}}for(s=0,r=h.length;s<r;s++)(o=l[a=h[s]]).attributes=Tt.apply(void 0,[{}].concat(o.attributes.reverse()));return l},getEventTarget:function(t,e){void 0===e&&(e={});var i=t.target,n=t.type,s=t.clientX;void 0===s&&(s=0);var r=t.clientY;return void 0===r&&(r=0),e.fromPoint||"touchmove"===n||"touchend"===n?document.elementFromPoint(s,r):i},updateDOMSubtreeAttributes:function(t,e,i){(i=i||{}).rootBBox||(i.rootBBox=Q()),i.selectors||(i.selectors=this.selectors);var n,s,r,o,a,l,h={},c={},u=[],d=i.roAttributes,p=this.findNodesAttributes(d||e,t,h,i.selectors),g=d?this.findNodesAttributes(e,t,h,i.selectors):p;for(var f in p)if(r=(o=p[f]).attributes,s=o.node,(a=this.processNodeAttributes(s,r)).set||a.position||a.offset){var m,v=g[f]&&g[f].attributes,y=v&&void 0===r.ref?v.ref:r.ref;if(y){if(!(m=(h[y]||this.findBySelector(y,t,i.selectors))[0]))throw new Error('dia.ElementView: "'+y+'" reference does not exist.')}else m=null;n={node:s,refNode:m,processedAttributes:a,allAttributes:v};var b=u.findIndex(function(t){return t.refNode===s});-1<b?u.splice(b,0,n):u.push(n)}else this.setNodeAttributes(s,a.normal);for(var w=0,C=u.length;w<C;w++){n=u[w],s=n.node,m=n.refNode;var I=Ot(i.rotatableNode),x=m?Ot.ensureId(m):"",A=!!I&&!!m&&I.contains(m),S=c[x];if(!S){var _=A?I:t;S=c[x]=m?Ot(m).getBBox({target:_}):i.rootBBox}d?(a=this.processNodeAttributes(s,n.allAttributes),this.mergeProcessedAttributes(a,n.processedAttributes)):a=n.processedAttributes;var P=S;A&&!I.contains(s)&&(l=l||Ot.transformStringToMatrix(I.attr("transform")),P=Ot.transformRect(S,l)),this.updateRelativeAttributes(s,a,P,i)}},mergeProcessedAttributes:function(t,e){t.set||(t.set={}),t.position||(t.position={}),t.offset||(t.offset={}),ee(t.set,e.set),ee(t.position,e.position),ee(t.offset,e.offset);var i=t.normal&&t.normal.transform;void 0!==i&&e.normal&&(e.normal.transform=i),t.normal=e.normal},onRemove:function(){this.removeTools()},_toolsView:null,hasTools:function(t){var e=this._toolsView;return!!e&&(!t||e.getName()===t)},addTools:function(t){return this.removeTools(),t&&((this._toolsView=t).configure({relatedView:this}),t.listenTo(this.paper,"tools:event",this.onToolEvent.bind(this)),t.mount()),this},updateTools:function(t){var e=this._toolsView;return e&&e.update(t),this},removeTools:function(){var t=this._toolsView;return t&&(t.remove(),this._toolsView=null),this},hideTools:function(){var t=this._toolsView;return t&&t.hide(),this},showTools:function(){var t=this._toolsView;return t&&t.show(),this},onToolEvent:function(t){switch(t){case"remove":this.removeTools();break;case"hide":this.hideTools();break;case"show":this.showTools()}},pointerdblclick:function(t,e,i){this.notify("cell:pointerdblclick",t,e,i)},pointerclick:function(t,e,i){this.notify("cell:pointerclick",t,e,i)},contextmenu:function(t,e,i){this.notify("cell:contextmenu",t,e,i)},pointerdown:function(t,e,i){this.model.graph&&(this.model.startBatch("pointer"),this._graph=this.model.graph),this.notify("cell:pointerdown",t,e,i)},pointermove:function(t,e,i){this.notify("cell:pointermove",t,e,i)},pointerup:function(t,e,i){this.notify("cell:pointerup",t,e,i),this._graph&&(this._graph.stopBatch("pointer",{cell:this.model}),delete this._graph)},mouseover:function(t){this.notify("cell:mouseover",t)},mouseout:function(t){this.notify("cell:mouseout",t)},mouseenter:function(t){this.notify("cell:mouseenter",t)},mouseleave:function(t){this.notify("cell:mouseleave",t)},mousewheel:function(t,e,i,n){this.notify("cell:mousewheel",t,e,i,n)},onevent:function(t,e,i,n){this.notify(e,t,i,n)},onmagnet:function(){},magnetpointerdblclick:function(){},magnetcontextmenu:function(){},checkMouseleave:function(t){var e=this.getEventTarget(t,{fromPoint:!0}),i=this.paper.findView(e);i!==this&&(this.mouseleave(t),i&&i.mouseenter(t))},setInteractivity:function(t){this.options.interactive=t}},{addPresentationAttributes:function(t){return Tt({},this.prototype.presentationAttributes,t,function(t,e){if(t&&e)return"string"==typeof t&&(t=[t]),"string"==typeof e&&(e=[e]),Array.isArray(t)&&Array.isArray(e)?oe(t.concat(e)):void 0})}}),vi=mi.extend({_removePorts:function(){},_renderPorts:function(){},className:function(){var t=mi.prototype.className.apply(this).split(" ");return t.push("element"),t.join(" ")},initialize:function(){mi.prototype.initialize.apply(this,arguments),this._initializePorts()},presentationAttributes:{attrs:["UPDATE"],position:["TRANSLATE"],size:["RESIZE","PORTS"],angle:["ROTATE"],markup:["RENDER"],ports:["PORTS"]},initFlag:["RENDER"],UPDATE_PRIORITY:0,confirmUpdate:function(t,e){return this.hasFlag(t,"RENDER")?(this.render(),t=this.removeFlag(t,["RENDER","UPDATE","RESIZE","TRANSLATE","ROTATE","PORTS"])):(this.hasFlag(t,"RESIZE")&&(this.resize(e),t=this.removeFlag(t,["RESIZE","UPDATE"])),this.hasFlag(t,"UPDATE")&&(this.update(this.model,null,e),t=this.removeFlag(t,"UPDATE")),this.hasFlag(t,"TRANSLATE")&&(this.translate(),t=this.removeFlag(t,"TRANSLATE")),this.hasFlag(t,"ROTATE")&&(this.rotate(),t=this.removeFlag(t,"ROTATE")),this.hasFlag(t,"PORTS")&&(this._refreshPorts(),t=this.removeFlag(t,"PORTS")),t)},_initializePorts:function(){},update:function(t,e){this.cleanNodesCache();var i=this.model,n=i.attr();this.updateDOMSubtreeAttributes(this.el,n,{rootBBox:new Q(i.size()),selectors:this.selectors,scalableNode:this.scalableNode,rotatableNode:this.rotatableNode,roAttributes:e===n?null:e})},rotatableSelector:"rotatable",scalableSelector:"scalable",scalableNode:null,rotatableNode:null,renderMarkup:function(){var t=this.model,e=t.get("markup")||t.markup;if(!e)throw new Error("dia.ElementView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if("string"==typeof e)return this.renderStringMarkup(e);throw new Error("dia.ElementView: invalid markup")},renderJSONMarkup:function(t){var e=this.parseDOMJSON(t,this.el),i=this.selectors=e.selectors;this.rotatableNode=Ot(i[this.rotatableSelector])||null,this.scalableNode=Ot(i[this.scalableSelector])||null,this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=this.vel;e.append(Ot(t)),this.rotatableNode=e.findOne(".rotatable"),this.scalableNode=e.findOne(".scalable"),(this.selectors={})[this.selector]=this.el},render:function(){return this.vel.empty(),this.renderMarkup(),this.scalableNode&&this.update(),this.resize(),this.rotatableNode?(this.rotate(),this.translate()):this.updateTransformation(),this._refreshPorts(),this},resize:function(t){if(this.scalableNode)return this.sgResize(t);this.model.attributes.angle&&this.rotate(),this.update()},translate:function(){if(this.rotatableNode)return this.rgTranslate();this.updateTransformation()},rotate:function(){if(this.rotatableNode)return this.rgRotate(),void this.update();this.updateTransformation()},updateTransformation:function(){var t=this.getTranslateString(),e=this.getRotateString();e&&(t+=" "+e),this.vel.attr("transform",t)},getTranslateString:function(){var t=this.model.attributes.position;return"translate("+t.x+","+t.y+")"},getRotateString:function(){var t=this.model.attributes,e=t.angle;if(!e)return null;var i=t.size;return"rotate("+e+","+i.width/2+","+i.height/2+")"},rgRotate:function(){this.rotatableNode.attr("transform",this.getRotateString())},rgTranslate:function(){this.vel.attr("transform",this.getTranslateString())},sgResize:function(t){var e=this.model,i=e.angle(),n=e.size(),s=this.scalableNode,r=!1;0<s.node.getElementsByTagName("path").length&&(r=!0);var o=s.getBBox({recursive:r}),a=n.width/(o.width||1),l=n.height/(o.height||1);s.attr("transform","scale("+a+","+l+")");var h=this.rotatableNode,c=h&&h.attr("transform");if(c){h.attr("transform",c+" rotate("+-i+","+n.width/2+","+n.height/2+")");var u=s.getBBox({target:this.paper.cells});e.set("position",{x:u.x,y:u.y},ee({updateHandled:!0},t)),this.translate(),this.rotate()}this.update()},prepareEmbedding:function(t){var e=(t=t||{}).model||this.model,i=(t.paper||this.paper).model;e.startBatch("to-front"),e.toFront({deep:!0,ui:!0});var n=i.getElements().reduce(function(t,e){return Math.max(t,e.attributes.z||0)},0);i.getConnectedLinks(e,{deep:!0,includeEnclosed:!0}).forEach(function(t){t.attributes.z<=n&&t.set("z",n+1,{ui:!0})}),e.stopBatch("to-front");var s=e.parent();s&&i.getCell(s).unembed(e,{ui:!0})},processEmbedding:function(t){var e=(t=t||{}).model||this.model,i=t.paper||this.paper,n=i.options,s=[];ue(n.findParentBy)?s=pe(n.findParentBy.call(i.model,this)).filter(function(t){return t instanceof Je&&this.model.id!==t.id&&!t.isEmbeddedIn(this.model)}.bind(this)):s=i.model.findModelsUnderElement(e,{searchBy:n.findParentBy});n.frontParentOnly&&(s=s.slice(-1));for(var r=null,o=t.candidateEmbedView,a=s.length-1;0<=a;a--){var l=s[a];if(o&&o.model.id==l.id){r=o;break}var h=l.findView(i);if(n.validateEmbedding.call(i,this,h)){r=h;break}}r&&r!=o&&(this.clearEmbedding(t),t.candidateEmbedView=r.highlight(null,{embedding:!0})),!r&&o&&this.clearEmbedding(t)},clearEmbedding:function(t){var e=(t=t||{}).candidateEmbedView;e&&(e.unhighlight(null,{embedding:!0}),t.candidateEmbedView=null)},finalizeEmbedding:function(t){var e=(t=t||{}).candidateEmbedView,i=t.model||this.model,n=t.paper||this.paper;e&&(e.model.embed(i,{ui:!0}),e.unhighlight(null,{embedding:!0}),t.candidateEmbedView=null),se(n.model.getConnectedLinks(i,{deep:!0}),"reparent",{ui:!0})},getDelegatedView:function(){for(var t=this,e=t.model,i=t.paper;t&&!e.isLink();){if(!e.isEmbedded()||t.can("stopDelegation"))return t;e=e.getParentCell(),t=i.findViewByModel(e)}return null},notifyPointerdown:function(t,e,i){mi.prototype.pointerdown.call(this,t,e,i),this.notify("element:pointerdown",t,e,i)},notifyPointermove:function(t,e,i){mi.prototype.pointermove.call(this,t,e,i),this.notify("element:pointermove",t,e,i)},notifyPointerup:function(t,e,i){this.notify("element:pointerup",t,e,i),mi.prototype.pointerup.call(this,t,e,i)},pointerdblclick:function(t,e,i){mi.prototype.pointerdblclick.apply(this,arguments),this.notify("element:pointerdblclick",t,e,i)},pointerclick:function(t,e,i){mi.prototype.pointerclick.apply(this,arguments),this.notify("element:pointerclick",t,e,i)},contextmenu:function(t,e,i){mi.prototype.contextmenu.apply(this,arguments),this.notify("element:contextmenu",t,e,i)},pointerdown:function(t,e,i){this.isPropagationStopped(t)||(this.notifyPointerdown(t,e,i),this.dragStart(t,e,i))},pointermove:function(t,e,i){var n=this.eventData(t);switch(n.action){case"magnet":this.dragMagnet(t,e,i);break;case"move":(n.delegatedView||this).drag(t,e,i);default:this.notifyPointermove(t,e,i)}this.eventData(t,n)},pointerup:function(t,e,i){var n=this.eventData(t);switch(n.action){case"magnet":this.dragMagnetEnd(t,e,i);break;case"move":(n.delegatedView||this).dragEnd(t,e,i);default:this.notifyPointerup(t,e,i)}var s=n.targetMagnet;s&&this.magnetpointerclick(t,s,e,i),this.checkMouseleave(t)},mouseover:function(t){mi.prototype.mouseover.apply(this,arguments),this.notify("element:mouseover",t)},mouseout:function(t){mi.prototype.mouseout.apply(this,arguments),this.notify("element:mouseout",t)},mouseenter:function(t){mi.prototype.mouseenter.apply(this,arguments),this.notify("element:mouseenter",t)},mouseleave:function(t){mi.prototype.mouseleave.apply(this,arguments),this.notify("element:mouseleave",t)},mousewheel:function(t,e,i,n){mi.prototype.mousewheel.apply(this,arguments),this.notify("element:mousewheel",t,e,i,n)},onmagnet:function(t,e,i){this.dragMagnetStart(t,e,i)},magnetpointerdblclick:function(t,e,i,n){this.notify("element:magnet:pointerdblclick",t,e,i,n)},magnetcontextmenu:function(t,e,i,n){this.notify("element:magnet:contextmenu",t,e,i,n)},dragStart:function(t,e,i){var n=this.getDelegatedView();n&&n.can("elementMove")&&(this.eventData(t,{action:"move",delegatedView:n}),n.eventData(t,{pointerOffset:n.model.position().difference(e,i),restrictedArea:this.paper.getRestrictedArea(n)}))},dragMagnetStart:function(t,e,i){if(this.can("addLinkFromMagnet")){var n=t.currentTarget,s=this.paper;this.eventData(t,{targetMagnet:n}),t.stopPropagation(),s.options.validateMagnet(this,n)?(s.options.magnetThreshold<=0&&this.dragLinkStart(t,n,e,i),this.eventData(t,{action:"magnet"}),this.stopPropagation(t)):this.pointerdown(t,e,i),s.delegateDragEvents(this,t.data)}},dragLinkStart:function(t,e,i,n){this.model.startBatch("add-link");var s=this.addLinkFromMagnet(e,i,n);s.notifyPointerdown(t,i,n),s.eventData(t,s.startArrowheadMove("target",{whenNotAllowed:"remove"})),this.eventData(t,{linkView:s})},addLinkFromMagnet:function(t,e,i){var n=this.paper,s=n.model,r=n.getDefaultLink(this,t);return r.set({source:this.getLinkEnd(t,e,i,r,"source"),target:{x:e,y:i}}).addTo(s,{async:!1,ui:!0}),r.findView(n)},drag:function(t,e,i){var n=this.paper,s=n.options.gridSize,r=this.model,o=this.eventData(t),a=o.pointerOffset,l=o.restrictedArea,h=o.embedding,c=k(e+a.x,s),u=k(i+a.y,s);r.position(c,u,{restrictedArea:l,deep:!0,ui:!0}),n.options.embeddingMode&&(h||(this.prepareEmbedding(o),h=!0),this.processEmbedding(o)),this.eventData(t,{embedding:h})},dragMagnet:function(t,e,i){var n=this.eventData(t),s=n.linkView;if(s)s.pointermove(t,e,i);else{var r=this.paper,o=r.options.magnetThreshold,a=this.getEventTarget(t),l=n.targetMagnet;if("onleave"===o){if(l===a||Ot(l).contains(a))return}else if(r.eventData(t).mousemoved<=o)return;this.dragLinkStart(t,l,e,i)}},dragEnd:function(t,e,i){var n=this.eventData(t);n.embedding&&this.finalizeEmbedding(n)},dragMagnetEnd:function(t,e,i){var n=this.eventData(t).linkView;n&&(n.pointerup(t,e,i),this.model.stopBatch("add-link"))},magnetpointerclick:function(t,e,i,n){var s=this.paper;s.eventData(t).mousemoved>s.options.clickThreshold||this.notify("element:magnet:pointerclick",t,e,i,n)}});ee(vi.prototype,ui);var yi={_results:{},_tests:{svgforeignobject:function(){return!!document.createElementNS&&/SVGForeignObject/.test({}.toString.call(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")))}},addTest:function(t,e){return this._tests[t]=e},test:function(t){var e=this._tests[t];if(!e)throw new Error('Test not defined ("'+t+'"). Use `joint.env.addTest(name, fn) to add a new test.`');var i=this._results[t];if(void 0!==i)return i;try{i=e()}catch(t){i=!1}return this._results[t]=i}},bi=di.define("basic.Generic",{attrs:{".":{fill:"#ffffff",stroke:"none"}}}),wi=bi.define("basic.Rect",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:100,height:60},text:{fill:"#000000",text:"","font-size":14,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><rect/></g><text/></g>'}),Ci=vi.extend({presentationAttributes:vi.addPresentationAttributes({attrs:["SCALE"]}),confirmUpdate:function(){var t=vi.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"SCALE")&&(this.resize(),t=this.removeFlag(t,"SCALE")),t}}),Ii=bi.define("basic.Text",{attrs:{text:{"font-size":18,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><text/></g></g>'}),xi=bi.define("basic.Circle",{size:{width:60,height:60},attrs:{circle:{fill:"#ffffff",stroke:"#000000",r:30,cx:30,cy:30},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><circle/></g><text/></g>'}),Ai=bi.define("basic.Ellipse",{size:{width:60,height:40},attrs:{ellipse:{fill:"#ffffff",stroke:"#000000",rx:30,ry:20,cx:30,cy:20},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><ellipse/></g><text/></g>'}),Si=bi.define("basic.Polygon",{size:{width:60,height:40},attrs:{polygon:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>'}),_i=bi.define("basic.Polyline",{size:{width:60,height:40},attrs:{polyline:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polyline/></g><text/></g>'}),Pi=bi.define("basic.Image",{attrs:{text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><image/></g><text/></g>'}),Mi=bi.define("basic.Path",{size:{width:60,height:60},attrs:{path:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle",ref:"path","ref-x":.5,"ref-dy":10,fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><path/></g><text/></g>'}),ki=Mi.define("basic.Rhombus",{attrs:{path:{d:"M 30 0 L 60 30 30 60 0 30 z"},text:{"ref-y":.5,"ref-dy":null,"y-alignment":"middle"}}}),Ti=yi.test("svgforeignobject"),Ni=bi.define("basic.TextBlock",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000","font-size":14,"font-family":"Arial, helvetica, sans-serif"},".content":{text:"","ref-x":.5,"ref-y":.5,"y-alignment":"middle","x-alignment":"middle"}},content:""},{markup:['<g class="rotatable">','<g class="scalable"><rect/></g>',Ti?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>',"</g>"].join(""),initialize:function(){this.listenTo(this,"change:size",this.updateSize),this.listenTo(this,"change:content",this.updateContent),this.updateSize(this,this.get("size")),this.updateContent(this,this.get("content")),bi.prototype.initialize.apply(this,arguments)},updateSize:function(t,e){this.attr({".fobj":ee({},e),div:{style:ee({},e)}})},updateContent:function(t,e){Ti?this.attr({".content":{html:It(e)}}):this.attr({".content":{text:e}})},setForeignObjectSize:function(){this.updateSize.apply(this,arguments)},setDivContent:function(){this.updateContent.apply(this,arguments)}}),Di=vi.extend({presentationAttributes:Ti?vi.prototype.presentationAttributes:vi.addPresentationAttributes({content:["CONTENT"],size:["CONTENT"]}),initFlag:["RENDER","CONTENT"],confirmUpdate:function(){var t=vi.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"CONTENT")&&(this.updateContent(this.model),t=this.removeFlag(t,"CONTENT")),t},update:function(t,e){var i=this.model;if(Ti)vi.prototype.update.call(this,i,e);else{var n=Ae(e||i.get("attrs"),".content");vi.prototype.update.call(this,i,n),e&&!Ie(e,".content")||this.updateContent(i,e)}},updateContent:function(t,e){var i=Tt({},(e||t.get("attrs"))[".content"]);i=Ae(i,"text");var n=Ct(t.get("content"),t.get("size"),i,{svgDocument:this.paper.svg}),s=ft({},".content",i,"/");s[".content"].text=n,vi.prototype.update.call(this,t,s)}}),Ei={Generic:bi,Rect:wi,TextView:Ci,Text:Ii,Circle:xi,Ellipse:Ai,Polygon:Si,Polyline:_i,Image:Pi,Path:Mi,Rhombus:ki,TextBlock:Ni,TextBlockView:Di},Li=Je.extend({markup:['<path class="connection" stroke="black" d="M 0 0 0 0"/>','<path class="marker-source" fill="black" stroke="black" d="M 0 0 0 0"/>','<path class="marker-target" fill="black" stroke="black" d="M 0 0 0 0"/>','<path class="connection-wrap" d="M 0 0 0 0"/>','<g class="labels"/>','<g class="marker-vertices"/>','<g class="marker-arrowheads"/>','<g class="link-tools"/>'].join(""),toolMarkup:['<g class="link-tool">','<g class="tool-remove" event="remove">','<circle r="11" />','<path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z" />',"<title>Remove link.</title>","</g>",'<g class="tool-options" event="link:options">','<circle r="11" transform="translate(25)"/>','<path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>',"<title>Link options.</title>","</g>","</g>"].join(""),doubleToolMarkup:void 0,vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>"].join(""),arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<path class="marker-arrowhead" end="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />',"</g>"].join(""),defaultLabel:void 0,labelMarkup:void 0,_builtins:{defaultLabel:{markup:[{tagName:"rect",selector:"rect"},{tagName:"text",selector:"text"}],attrs:{text:{fill:"#000000",fontSize:14,textAnchor:"middle",yAlignment:"middle",pointerEvents:"none"},rect:{ref:"text",fill:"#ffffff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}}},defaults:{type:"link",source:{},target:{}},isLink:function(){return!0},disconnect:function(t){return this.set({source:{x:0,y:0},target:{x:0,y:0}},t)},source:function(t,e,i){return void 0===t?ae(this.get("source")):(s=t instanceof Je?((n=ae(e)||{}).id=t.id,i):de(t)?(n=t,e):((n=ae(e)||{}).x=t.x,n.y=t.y,i),this.set("source",n,s));var n,s},target:function(t,e,i){return void 0===t?ae(this.get("target")):(s=t instanceof Je?((n=ae(e)||{}).id=t.id,i):de(t)?(n=t,e):((n=ae(e)||{}).x=t.x,n.y=t.y,i),this.set("target",n,s));var n,s},router:function(t,e,i){if(void 0===t){var n=this.get("router");return n?"object"==typeof n?ae(n):n:this.get("manhattan")?{name:"orthogonal"}:null}var s="object"==typeof t||"function"==typeof t,r=s?t:{name:t,args:e},o=s?e:i;return this.set("router",r,o)},connector:function(t,e,i){if(void 0===t){var n=this.get("connector");return n?"object"==typeof n?ae(n):n:this.get("smooth")?{name:"smooth"}:null}var s="object"==typeof t||"function"==typeof t,r=s?t:{name:t,args:e},o=s?e:i;return this.set("connector",r,o)},label:function(t,e,i){var n=this.labels();return(t=isFinite(t)&&null!==t?0|t:0)<0&&(t=n.length+t),arguments.length<=1?this.prop(["labels",t]):this.prop(["labels",t],e,i)},labels:function(t,e){return 0===arguments.length?(t=this.get("labels"),Array.isArray(t)?t.slice():[]):(Array.isArray(t)||(t=[]),this.set("labels",t,e))},insertLabel:function(t,e,i){if(!e)throw new Error("dia.Link: no label provided");var n=this.labels(),s=n.length;return(t=isFinite(t)&&null!==t?0|t:s)<0&&(t=s+t+1),n.splice(t,0,e),this.labels(n,i)},appendLabel:function(t,e){return this.insertLabel(-1,t,e)},removeLabel:function(t,e){var i=this.labels();return t=isFinite(t)&&null!==t?0|t:-1,i.splice(t,1),this.labels(i,e)},vertex:function(t,e,i){var n=this.vertices();if((t=isFinite(t)&&null!==t?0|t:0)<0&&(t=n.length+t),arguments.length<=1)return this.prop(["vertices",t]);var s=this._normalizeVertex(e);return this.prop(["vertices",t],s,i)},vertices:function(t,e){if(0===arguments.length)return t=this.get("vertices"),Array.isArray(t)?t.slice():[];Array.isArray(t)||(t=[]);for(var i=[],n=0;n<t.length;n++){var s=t[n],r=this._normalizeVertex(s);i.push(r)}return this.set("vertices",i,e)},insertVertex:function(t,e,i){if(!e)throw new Error("dia.Link: no vertex provided");var n=this.vertices(),s=n.length;(t=isFinite(t)&&null!==t?0|t:s)<0&&(t=s+t+1);var r=this._normalizeVertex(e);return n.splice(t,0,r),this.vertices(n,i)},removeVertex:function(t,e){var i=this.vertices();return t=isFinite(t)&&null!==t?0|t:-1,i.splice(t,1),this.vertices(i,e)},_normalizeVertex:function(t){return!de(t)?{x:t.x,y:t.y}:t},translate:function(e,i,t){return(t=t||{}).translateBy=t.translateBy||this.id,t.tx=e,t.ty=i,this.applyToPoints(function(t){return{x:(t.x||0)+e,y:(t.y||0)+i}},t)},scale:function(e,i,n,t){return this.applyToPoints(function(t){return j(t).scale(e,i,n).toJSON()},t)},applyToPoints:function(t,e){if(!ue(t))throw new TypeError("dia.Link: applyToPoints expects its first parameter to be a function.");var i={},n=this.source();n.id||(i.source=t(n));var s=this.target();s.id||(i.target=t(s));var r=this.vertices();return 0<r.length&&(i.vertices=r.map(t)),this.set(i,e)},getSourcePoint:function(){var t=this.getSourceCell();return t?t.getPointFromConnectedLink(this,"source"):new j(this.source())},getTargetPoint:function(){var t=this.getTargetCell();return t?t.getPointFromConnectedLink(this,"target"):new j(this.target())},getPointFromConnectedLink:function(){return this.getPolyline().pointAt(.5)},getPolyline:function(){var t=[this.getSourcePoint(),this.getTargetPoint()],e=this.vertices();return 0<e.length&&Array.prototype.push.apply(t,e.map(j)),new K(t)},getBBox:function(){return this.getPolyline().bbox()},reparent:function(t){var e;if(this.graph){var i=this.getSourceElement(),n=this.getTargetElement(),s=this.getParentCell();i&&n&&(e=i===n||i.isEmbeddedIn(n)?n:n.isEmbeddedIn(i)?i:this.graph.getCommonAncestor(i,n)),!s||e&&e.id===s.id||s.unembed(this,t),e&&e.embed(this,t)}return e},hasLoop:function(t){t=t||{};var e=this.source().id,i=this.target().id;if(!e||!i)return!1;var n=e===i;if(!n&&t.deep&&this.graph){var s=this.getSourceCell(),r=this.getTargetCell();n=s.isEmbeddedIn(r)||r.isEmbeddedIn(s)}return n},getSourceCell:function(){var t=this.source(),e=this.graph;return t&&t.id&&e&&e.getCell(t.id)||null},getSourceElement:function(){var t=this,e={};do{if(e[t.id])return null;e[t.id]=!0,t=t.getSourceCell()}while(t&&t.isLink());return t},getTargetCell:function(){var t=this.target(),e=this.graph;return t&&t.id&&e&&e.getCell(t.id)||null},getTargetElement:function(){var t=this,e={};do{if(e[t.id])return null;e[t.id]=!0,t=t.getTargetCell()}while(t&&t.isLink());return t},getRelationshipAncestor:function(){var t;if(this.graph){var e=[this,this.getSourceElement(),this.getTargetElement()].filter(function(t){return!!t});t=this.graph.getCommonAncestor.apply(this.graph,e)}return t||null},isRelationshipEmbeddedIn:function(t){var e=Ne(t)||Dt(t)?t:t.id,i=this.getRelationshipAncestor();return!!i&&(i.id===e||i.isEmbeddedIn(e))},_getDefaultLabel:function(){var t=this.get("defaultLabel")||this.defaultLabel||{},e={};return e.markup=t.markup||this.get("labelMarkup")||this.labelMarkup,e.position=t.position,e.attrs=t.attrs,e.size=t.size,e}},{endsEqual:function(t,e){var i=t.port===e.port||!t.port&&!e.port;return t.id===e.id&&i}}),zi=di.define("standard.Rectangle",{attrs:{body:{refWidth:"100%",refHeight:"100%",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}]}),Oi=di.define("standard.Circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}]}),Gi=di.define("standard.Ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"body"},{tagName:"text",selector:"label"}]}),Bi=di.define("standard.Path",{attrs:{body:{refD:"M 0 0 L 10 0 10 10 0 10 Z",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}]}),ji=di.define("standard.Polygon",{attrs:{body:{refPoints:"0 0 10 0 10 10 0 10",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"}]}),Ri=di.define("standard.Polyline",{attrs:{body:{refPoints:"0 0 10 0 10 10 0 10 0 0",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polyline",selector:"body"},{tagName:"text",selector:"label"}]}),Vi=di.define("standard.Image",{attrs:{image:{refWidth:"100%",refHeight:"100%"},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),Zi=di.define("standard.BorderedImage",{attrs:{border:{refWidth:"100%",refHeight:"100%",stroke:"#333333",strokeWidth:2},background:{refWidth:-1,refHeight:-1,x:.5,y:.5,fill:"#FFFFFF"},image:{refWidth:-1,refHeight:-1,x:.5,y:.5},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"background",attributes:{stroke:"none"}},{tagName:"image",selector:"image"},{tagName:"rect",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),Wi=di.define("standard.EmbeddedImage",{attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#FFFFFF",strokeWidth:2},image:{refWidth:"30%",refHeight:-20,x:10,y:10,preserveAspectRatio:"xMidYMin"},label:{textVerticalAnchor:"top",textAnchor:"left",refX:"30%",refX2:20,refY:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),Yi=di.define("standard.InscribedImage",{attrs:{border:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",stroke:"#333333",strokeWidth:2},background:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",fill:"#FFFFFF"},image:{refWidth:"68%",refHeight:"68%",refX:"16%",refY:"16%",preserveAspectRatio:"xMidYMid"},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"image"},{tagName:"ellipse",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),Hi=di.define("standard.HeaderedRectangle",{attrs:{body:{refWidth:"100%",refHeight:"100%",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},header:{refWidth:"100%",height:30,strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},headerText:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:15,fontSize:16,fill:"#333333"},bodyText:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",refY2:15,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerText"},{tagName:"text",selector:"bodyText"}]}),Fi=di.define("standard.Cylinder",{attrs:{body:{lateralArea:10,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},top:{refCx:"50%",cy:10,refRx:"50%",ry:10,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"100%",refY2:15,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],topRy:function(t,e){if(void 0===t)return this.attr("body/lateralArea");var i={lateralArea:t},n=Wt(t)?{refCy:t,refRy:t,cy:null,ry:null}:{refCy:null,refRy:null,cy:t,ry:t};return this.attr({body:i,top:n},e)}},{attributes:{lateralArea:{set:function(t,e){var i=Wt(t);i&&(t=parseFloat(t)/100);var n=e.x,s=e.y,r=e.width,o=e.height,a=r/2,l=i?o*t:t,h=Ot.KAPPA,c=h*a,u=h*(i?o*t:t),d=n+r/2,p=n+r,g=s+l,f=g-l,m=s+o-l,v=s+o;return{d:["M",n,g,"L",n,m,"C",n,m+u,d-c,v,d,v,"C",d+c,v,p,m+u,p,m,"L",p,g,"C",p,g-u,d+c,f,d,f,"C",d-c,f,n,g-u,n,g,"Z"].join(" ")}}}}}),Ui=yi.test("svgforeignobject")?{tagName:"foreignObject",selector:"foreignObject",attributes:{overflow:"hidden"},children:[{tagName:"div",namespaceURI:"http://www.w3.org/1999/xhtml",selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attributes:{"text-anchor":"middle"}},Xi={Rectangle:zi,Circle:Oi,Ellipse:Gi,Path:Bi,Polygon:ji,Polyline:Ri,Image:Vi,BorderedImage:Zi,EmbeddedImage:Wi,InscribedImage:Yi,HeaderedRectangle:Hi,Cylinder:Fi,TextBlock:di.define("standard.TextBlock",{attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#ffffff",strokeWidth:2},foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}}},{markup:[{tagName:"rect",selector:"body"},Ui]},{attributes:{text:{set:function(t,e,i,n){if(!(i instanceof HTMLElement)){var s=n.style||{},r={text:t,width:-5,height:"100%"},o=ee({textVerticalAnchor:"middle"},s);return Xe.textWrap.set.call(this,r,e,i,o),{fill:s.color||null}}i.textContent=t},position:function(t,e,i){if(i instanceof SVGElement)return e.center()}}}}),Link:Li.define("standard.Link",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 10 -5 0 0 10 5 z"}},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),DoubleLink:Li.define("standard.DoubleLink",{attrs:{line:{connection:!0,stroke:"#DDDDDD",strokeWidth:4,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"#000000",d:"M 10 -3 10 -10 -2 0 10 10 10 3"}},outline:{connection:!0,stroke:"#000000",strokeWidth:6,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"outline",attributes:{fill:"none"}},{tagName:"path",selector:"line",attributes:{fill:"none"}}]}),ShadowLink:Li.define("standard.ShadowLink",{attrs:{line:{connection:!0,stroke:"#FF0000",strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"none",d:"M 0 -10 -10 0 0 10 z"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}},shadow:{connection:!0,refX:3,refY:6,stroke:"#000000",strokeOpacity:.2,strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 0 -10 -10 0 0 10 z",stroke:"none"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}}}},{markup:[{tagName:"path",selector:"shadow",attributes:{fill:"none"}},{tagName:"path",selector:"line",attributes:{fill:"none"}}]})},Ji=bi.define("devs.Model",{inPorts:[],outPorts:[],size:{width:80,height:80},attrs:{".":{magnet:!1},".label":{text:"Model","ref-x":.5,"ref-y":10,"font-size":18,"text-anchor":"middle",fill:"#000"},".body":{"ref-width":"100%","ref-height":"100%",stroke:"#000"}},ports:{groups:{in:{position:{name:"left"},attrs:{".port-label":{fill:"#000"},".port-body":{fill:"#fff",stroke:"#000",r:10,magnet:!0}},label:{position:{name:"left",args:{y:10}}}},out:{position:{name:"right"},attrs:{".port-label":{fill:"#000"},".port-body":{fill:"#fff",stroke:"#000",r:10,magnet:!0}},label:{position:{name:"right",args:{y:10}}}}}}},{markup:'<g class="rotatable"><rect class="body"/><text class="label"/></g>',portMarkup:'<circle class="port-body"/>',portLabelMarkup:'<text class="port-label"/>',initialize:function(){bi.prototype.initialize.apply(this,arguments),this.on("change:inPorts change:outPorts",this.updatePortItems,this),this.updatePortItems()},updatePortItems:function(t,e,i){var n=oe(this.get("inPorts")),s=be(oe(this.get("outPorts")),n),r=this.createPortItems("in",n),o=this.createPortItems("out",s);this.prop("ports/items",r.concat(o),ee({rewrite:!0},i))},createPortItem:function(t,e){return{id:e,group:t,attrs:{".port-label":{text:e}}}},createPortItems:function(t,e){return pe(e).map(this.createPortItem.bind(this,t))},_addGroupPort:function(t,e,i){var n=this.get(e);return this.set(e,Array.isArray(n)?n.concat(t):[t],i)},addOutPort:function(t,e){return this._addGroupPort(t,"outPorts",e)},addInPort:function(t,e){return this._addGroupPort(t,"inPorts",e)},_removeGroupPort:function(t,e,i){return this.set(e,ye(this.get(e),t),i)},removeOutPort:function(t,e){return this._removeGroupPort(t,"outPorts",e)},removeInPort:function(t,e){return this._removeGroupPort(t,"inPorts",e)},_changeGroup:function(t,e,i){return this.prop("ports/groups/"+t,Te(e)?e:{},i)},changeInGroup:function(t,e){return this._changeGroup("in",t,e)},changeOutGroup:function(t,e){return this._changeGroup("out",t,e)}}),$i=Ji.define("devs.Atomic",{size:{width:80,height:80},attrs:{".label":{text:"Atomic"}}}),Ki=Ji.define("devs.Coupled",{size:{width:200,height:300},attrs:{".label":{text:"Coupled"}}}),Qi={Model:Ji,Atomic:$i,Coupled:Ki,Link:Li.define("devs.Link",{attrs:{".connection":{"stroke-width":2}}})},qi=bi.define("logic.Gate",{size:{width:80,height:40},attrs:{".":{magnet:!1},".body":{width:100,height:50},circle:{r:7,stroke:"black",fill:"transparent","stroke-width":2}}},{operation:function(){return!0}}),tn=qi.define("logic.IO",{size:{width:60,height:30},attrs:{".body":{fill:"white",stroke:"black","stroke-width":2},".wire":{ref:".body","ref-y":.5,stroke:"black"},text:{fill:"black",ref:".body","ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle","font-weight":"bold","font-variant":"small-caps","text-transform":"capitalize","font-size":"14px"}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="body"/></g><path class="wire"/><circle/><text/></g>'}),en=tn.define("logic.Input",{attrs:{".wire":{"ref-dx":0,d:"M 0 0 L 23 0"},circle:{ref:".body","ref-dx":30,"ref-y":.5,magnet:!0,class:"output",port:"out"},text:{text:"input"}}}),nn=tn.define("logic.Output",{attrs:{".wire":{"ref-x":0,d:"M 0 0 L -23 0"},circle:{ref:".body","ref-x":-30,"ref-y":.5,magnet:"passive",class:"input",port:"in"},text:{text:"output"}}}),sn=qi.define("logic.Gate11",{attrs:{".input":{ref:".body","ref-x":-2,"ref-y":.5,magnet:"passive",port:"in"},".output":{ref:".body","ref-dx":2,"ref-y":.5,magnet:!0,port:"out"}}},{markup:'<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input"/><circle class="output"/></g>'}),rn=qi.define("logic.Gate21",{attrs:{".input1":{ref:".body","ref-x":-2,"ref-y":.3,magnet:"passive",port:"in1"},".input2":{ref:".body","ref-x":-2,"ref-y":.7,magnet:"passive",port:"in2"},".output":{ref:".body","ref-dx":2,"ref-y":.5,magnet:!0,port:"out"}}},{markup:'<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input input1"/><circle  class="input input2"/><circle class="output"/></g>'}),on=sn.define("logic.Repeater",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzIuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICA8L2c+Cjwvc3ZnPgo="}}},{operation:function(t){return t}}),an=sn.define("logic.Not",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzkuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDI2NzEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzYiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA4MCwyNSBBIDQsNCAwIDEgMSA3MiwyNSBBIDQsNCAwIDEgMSA4MCwyNSB6IgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEsMCkiIC8+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t){return!t}}),ln=rn.define("logic.Or",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik9SIEFOU0kuc3ZnIgogICBpbmtzY2FwZTpvdXRwdXRfZXh0ZW5zaW9uPSJvcmcuaW5rc2NhcGUub3V0cHV0LnN2Zy5pbmtzY2FwZSI+CiAgPGRlZnMKICAgICBpZD0iZGVmczQiPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTAgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjcxNCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iMSA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMC41IDogMC4zMzMzMzMzMyA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODA2IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODE5IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjM3Mi4wNDcyNCA6IDM1MC43ODczOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzc3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49Ijc1IDogNDAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTUwIDogNjAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDYwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTMyNzUiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNTAgOiAzMy4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTAwIDogNTAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTU1MzMiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzIgOiAyMS4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNjQgOiAzMiA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMzIgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjU1NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDE2LjY2NjY2NyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDI1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAyNSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iNCIKICAgICBpbmtzY2FwZTpjeD0iMTEzLjAwMDM5IgogICAgIGlua3NjYXBlOmN5PSIxMi44OTM3MzEiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9InB4IgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImcyNTYwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTpncmlkLWJib3g9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1wb2ludHM9InRydWUiCiAgICAgZ3JpZHRvbGVyYW5jZT0iMTAwMDAiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxMzk5IgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9Ijg3NCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMzciCiAgICAgaW5rc2NhcGU6d2luZG93LXk9Ii00IgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gNzAsMjUgYyAyMCwwIDI1LDAgMjUsMCIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMSwxNSA1LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzIsMzUgNSwzNSIKICAgICAgIGlkPSJwYXRoMzk0NCIgLz4KICAgIDxnCiAgICAgICBpZD0iZzI1NjAiCiAgICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2LjUsLTM5LjUpIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICA8L2c+Cjwvc3ZnPgo="}}},{operation:function(t,e){return t||e}}),hn=rn.define("logic.And",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IkFORCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI4IgogICAgIGlua3NjYXBlOmN4PSI1Ni42OTgzNDgiCiAgICAgaW5rc2NhcGU6Y3k9IjI1LjMyNjg5OSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTptZWRpdW07Zm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDt0ZXh0LWluZGVudDowO3RleHQtYWxpZ246c3RhcnQ7dGV4dC1kZWNvcmF0aW9uOm5vbmU7bGluZS1oZWlnaHQ6bm9ybWFsO2xldHRlci1zcGFjaW5nOm5vcm1hbDt3b3JkLXNwYWNpbmc6bm9ybWFsO3RleHQtdHJhbnNmb3JtOm5vbmU7ZGlyZWN0aW9uOmx0cjtibG9jay1wcm9ncmVzc2lvbjp0Yjt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6c3RhcnQ7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDozO21hcmtlcjpub25lO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGU7Zm9udC1mYW1pbHk6Qml0c3RyZWFtIFZlcmEgU2FuczstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOkJpdHN0cmVhbSBWZXJhIFNhbnMiCiAgICAgICBkPSJNIDMwLDUgTCAzMCw2LjQyODU3MTQgTCAzMCw0My41NzE0MjkgTCAzMCw0NSBMIDMxLjQyODU3MSw0NSBMIDUwLjQ3NjE5LDQ1IEMgNjEuNzQ0MDk4LDQ1IDcwLjQ3NjE5LDM1Ljk5OTk1NSA3MC40NzYxOSwyNSBDIDcwLjQ3NjE5LDE0LjAwMDA0NSA2MS43NDQwOTksNS4wMDAwMDAyIDUwLjQ3NjE5LDUgQyA1MC40NzYxOSw1IDUwLjQ3NjE5LDUgMzEuNDI4NTcxLDUgTCAzMCw1IHogTSAzMi44NTcxNDMsNy44NTcxNDI5IEMgNDAuODM0MjY0LDcuODU3MTQyOSA0NS45MTgzNjgsNy44NTcxNDI5IDQ4LjA5NTIzOCw3Ljg1NzE0MjkgQyA0OS4yODU3MTQsNy44NTcxNDI5IDQ5Ljg4MDk1Miw3Ljg1NzE0MjkgNTAuMTc4NTcxLDcuODU3MTQyOSBDIDUwLjMyNzM4MSw3Ljg1NzE0MjkgNTAuNDA5MjI3LDcuODU3MTQyOSA1MC40NDY0MjksNy44NTcxNDI5IEMgNTAuNDY1MDI5LDcuODU3MTQyOSA1MC40NzE1NDMsNy44NTcxNDI5IDUwLjQ3NjE5LDcuODU3MTQyOSBDIDYwLjIzNjg1Myw3Ljg1NzE0MyA2Ny4xNDI4NTcsMTUuNDk3MDk4IDY3LjE0Mjg1NywyNSBDIDY3LjE0Mjg1NywzNC41MDI5MDIgNTkuNzYwNjYyLDQyLjE0Mjg1NyA1MCw0Mi4xNDI4NTcgTCAzMi44NTcxNDMsNDIuMTQyODU3IEwgMzIuODU3MTQzLDcuODU3MTQyOSB6IgogICAgICAgaWQ9InBhdGgyODg0IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2NjY2NzY2NjY3Nzc3NzY2NjIiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return t&&e}}),cn=rn.define("logic.Nor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjEiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjY3NzY0NCIKICAgICBpbmtzY2FwZTpjeT0iMjIuMTAyMzQ0IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjM3IgogICAgIGlua3NjYXBlOndpbmRvdy15PSItNCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc5LDI1IEMgOTksMjUgOTUsMjUgOTUsMjUiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHNvZGlwb2RpOnR5cGU9ImFyYyIKICAgICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgICBpZD0icGF0aDI2MDQiCiAgICAgICAgIHNvZGlwb2RpOmN4PSI3NSIKICAgICAgICAgc29kaXBvZGk6Y3k9IjI1IgogICAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgICAgc29kaXBvZGk6cnk9IjQiCiAgICAgICAgIGQ9Ik0gNzksMjUgQSA0LDQgMCAxIDEgNzEsMjUgQSA0LDQgMCAxIDEgNzksMjUgeiIKICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI2LjUsMzkuNSkiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t,e){return!(t||e)}}),un=rn.define("logic.Nand",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5BTkQgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iMTYiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjI4MzMwNyIKICAgICBpbmtzY2FwZTpjeT0iMTYuNDQyODQzIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzksMjUgQyA5MS44LDI1IDk1LDI1IDk1LDI1IgogICAgICAgaWQ9InBhdGgzMDU5IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMxLDE1IDUsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMiwzNSA1LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmb250LXNpemU6bWVkaXVtO2ZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7dGV4dC1pbmRlbnQ6MDt0ZXh0LWFsaWduOnN0YXJ0O3RleHQtZGVjb3JhdGlvbjpub25lO2xpbmUtaGVpZ2h0Om5vcm1hbDtsZXR0ZXItc3BhY2luZzpub3JtYWw7d29yZC1zcGFjaW5nOm5vcm1hbDt0ZXh0LXRyYW5zZm9ybTpub25lO2RpcmVjdGlvbjpsdHI7YmxvY2stcHJvZ3Jlc3Npb246dGI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOnN0YXJ0O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MzttYXJrZXI6bm9uZTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlO2ZvbnQtZmFtaWx5OkJpdHN0cmVhbSBWZXJhIFNhbnM7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpCaXRzdHJlYW0gVmVyYSBTYW5zIgogICAgICAgZD0iTSAzMCw1IEwgMzAsNi40Mjg1NzE0IEwgMzAsNDMuNTcxNDI5IEwgMzAsNDUgTCAzMS40Mjg1NzEsNDUgTCA1MC40NzYxOSw0NSBDIDYxLjc0NDA5OCw0NSA3MC40NzYxOSwzNS45OTk5NTUgNzAuNDc2MTksMjUgQyA3MC40NzYxOSwxNC4wMDAwNDUgNjEuNzQ0MDk5LDUuMDAwMDAwMiA1MC40NzYxOSw1IEMgNTAuNDc2MTksNSA1MC40NzYxOSw1IDMxLjQyODU3MSw1IEwgMzAsNSB6IE0gMzIuODU3MTQzLDcuODU3MTQyOSBDIDQwLjgzNDI2NCw3Ljg1NzE0MjkgNDUuOTE4MzY4LDcuODU3MTQyOSA0OC4wOTUyMzgsNy44NTcxNDI5IEMgNDkuMjg1NzE0LDcuODU3MTQyOSA0OS44ODA5NTIsNy44NTcxNDI5IDUwLjE3ODU3MSw3Ljg1NzE0MjkgQyA1MC4zMjczODEsNy44NTcxNDI5IDUwLjQwOTIyNyw3Ljg1NzE0MjkgNTAuNDQ2NDI5LDcuODU3MTQyOSBDIDUwLjQ2NTAyOSw3Ljg1NzE0MjkgNTAuNDcxNTQzLDcuODU3MTQyOSA1MC40NzYxOSw3Ljg1NzE0MjkgQyA2MC4yMzY4NTMsNy44NTcxNDMgNjcuMTQyODU3LDE1LjQ5NzA5OCA2Ny4xNDI4NTcsMjUgQyA2Ny4xNDI4NTcsMzQuNTAyOTAyIDU5Ljc2MDY2Miw0Mi4xNDI4NTcgNTAsNDIuMTQyODU3IEwgMzIuODU3MTQzLDQyLjE0Mjg1NyBMIDMyLjg1NzE0Myw3Ljg1NzE0MjkgeiIKICAgICAgIGlkPSJwYXRoMjg4NCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2Njc2NjY2Nzc3Nzc2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDQwMDgiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return!(t&&e)}}),dn=rn.define("logic.Xor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhPUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjUuNjU2ODU0MiIKICAgICBpbmtzY2FwZTpjeD0iMjUuOTM4MTE2IgogICAgIGlua3NjYXBlOmN5PSIxNy4yMzAwNSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzAuMzg1NzE3LDE1IEwgNC45OTk5OTk4LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5NzY7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEuMzYyMDkxLDM1IEwgNC45OTk5OTk4LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPGcKICAgICAgIGlkPSJnMjU2MCIKICAgICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAxIgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjYuNSwtMzkuNSkiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDM1MTYiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi4yNSw4MS41MDAwMDUgQyAtMy44NDczNzQsODQuMTQ0NDA1IC00LjUsODQuNTAwMDA1IC00LjUsODQuNTAwMDA1IEwgLTguMTU2MjUsODQuNTAwMDA1IEwgLTYuMTU2MjUsODIuMDYyNTA1IEMgLTYuMTU2MjUsODIuMDYyNTA1IC0wLjUsNzUuMDYyNDUxIC0wLjUsNjQuNSBDIC0wLjUsNTMuOTM3NTQ5IC02LjE1NjI1LDQ2LjkzNzUgLTYuMTU2MjUsNDYuOTM3NSBMIC04LjE1NjI1LDQ0LjUgTCAtNC41LDQ0LjUgQyAtMy43MTg3NSw0NS40Mzc1IC0zLjA3ODEyNSw0Ni4xNTYyNSAtMi4yODEyNSw0Ny41IEMgLTAuNDA4NTMxLDUwLjU5OTgxNSAyLjUsNTYuNTI2NjQ2IDIuNSw2NC41IEMgMi41LDcyLjQ1MDY1IC0wLjM5NjY5Nyw3OC4zNzk0MjUgLTIuMjUsODEuNTAwMDA1IHoiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY3NjY2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t,e){return(!t||e)&&(t||!e)}}),pn=rn.define("logic.Xnor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhOT1IgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNTU3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTYuNjY2NjY3IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDI1IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI0IgogICAgIGlua3NjYXBlOmN4PSI5NS43MjM2NiIKICAgICBpbmtzY2FwZTpjeT0iLTI2Ljc3NTAyMyIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyLjAwMDAwMDI0O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc4LjMzMzMzMiwyNSBDIDkxLjY2NjY2NiwyNSA5NSwyNSA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMC4zODU3MTcsMTUgTCA0Ljk5OTk5OTgsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk3NjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMS4zNjIwOTEsMzUgTCA0Ljk5OTk5OTgsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMzUxNiIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjI1LDgxLjUwMDAwNSBDIC0zLjg0NzM3NCw4NC4xNDQ0MDUgLTQuNSw4NC41MDAwMDUgLTQuNSw4NC41MDAwMDUgTCAtOC4xNTYyNSw4NC41MDAwMDUgTCAtNi4xNTYyNSw4Mi4wNjI1MDUgQyAtNi4xNTYyNSw4Mi4wNjI1MDUgLTAuNSw3NS4wNjI0NTEgLTAuNSw2NC41IEMgLTAuNSw1My45Mzc1NDkgLTYuMTU2MjUsNDYuOTM3NSAtNi4xNTYyNSw0Ni45Mzc1IEwgLTguMTU2MjUsNDQuNSBMIC00LjUsNDQuNSBDIC0zLjcxODc1LDQ1LjQzNzUgLTMuMDc4MTI1LDQ2LjE1NjI1IC0yLjI4MTI1LDQ3LjUgQyAtMC40MDg1MzEsNTAuNTk5ODE1IDIuNSw1Ni41MjY2NDYgMi41LDY0LjUgQyAyLjUsNzIuNDUwNjUgLTAuMzk2Njk3LDc4LjM3OTQyNSAtMi4yNSw4MS41MDAwMDUgeiIKICAgICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2Njc2NjY2NzYyIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDM1NTEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return(!t||!e)&&(t||e)}}),gn={Gate:qi,IO:tn,Input:en,Output:nn,Gate11:sn,Gate21:rn,Repeater:on,Not:an,Or:ln,And:hn,Nor:cn,Nand:un,Xor:dn,Xnor:pn,Wire:Li.define("logic.Wire",{attrs:{".connection":{"stroke-width":2},".marker-vertex":{r:7}},router:{name:"orthogonal"},connector:{name:"rounded",args:{radius:10}}},{arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<circle class="marker-arrowhead" end="<%= end %>" r="7"/>',"</g>"].join(""),vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<g class="marker-vertex-remove-group">','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>","</g>"].join("")})},fn={KingWhite:bi.define("chess.KingWhite",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;"><path      d="M 22.5,11.63 L 22.5,6"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 20,8 L 25,8"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"      style="fill:#ffffff; stroke:#000000; stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 11.5,30 C 17,27 27,27 32.5,30"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,37 C 17,34 27,34 32.5,37"      style="fill:none; stroke:#000000;" />  </g></g></g>'}),KingBlack:bi.define("chess.KingBlack",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path       d="M 22.5,11.63 L 22.5,6"       style="fill:none; stroke:#000000; stroke-linejoin:miter;"       id="path6570" />    <path       d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"       style="fill:#000000;fill-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;" />    <path       d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "       style="fill:#000000; stroke:#000000;" />    <path       d="M 20,8 L 25,8"       style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path       d="M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.51,26.6 L 22.5,24.5 C 20,18 9.906,14 6.997,19.85 C 4.5,25.5 11.85,28.85 11.85,28.85"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,30 C 17,27 27,27 32.5,30 M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5 M 11.5,37 C 17,34 27,34 32.5,37"       style="fill:none; stroke:#ffffff;" />  </g></g></g>'}),QueenWhite:bi.define("chess.QueenWhite",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(-1,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(15.5,-5.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(32,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(7,-4.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(24,-4)" />    <path      d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38,14 L 31,25 L 31,11 L 25.5,24.5 L 22.5,9.5 L 19.5,24.5 L 14,10.5 L 14,25 L 7,14 L 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 11.5,30 C 15,29 30,29 33.5,30"      style="fill:none;" />    <path      d="M 12,33.5 C 18,32.5 27,32.5 33,33.5"      style="fill:none;" />  </g></g></g>'}),QueenBlack:bi.define("chess.QueenBlack",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:none;">      <circle cx="6"    cy="12" r="2.75" />      <circle cx="14"   cy="9"  r="2.75" />      <circle cx="22.5" cy="8"  r="2.75" />      <circle cx="31"   cy="9"  r="2.75" />      <circle cx="39"   cy="12" r="2.75" />    </g>    <path       d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"       style="stroke-linecap:butt; stroke:#000000;" />    <path       d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"       style="stroke-linecap:butt;" />    <path       d="M 11,38.5 A 35,35 1 0 0 34,38.5"       style="fill:none; stroke:#000000; stroke-linecap:butt;" />    <path       d="M 11,29 A 35,35 1 0 1 34,29"       style="fill:none; stroke:#ffffff;" />    <path       d="M 12.5,31.5 L 32.5,31.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"       style="fill:none; stroke:#ffffff;" />  </g></g></g>'}),RookWhite:bi.define("chess.RookWhite",{size:{width:32,height:34}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14"      style="stroke-linecap:butt;" />    <path      d="M 34,14 L 31,17 L 14,17 L 11,14" />    <path      d="M 31,17 L 31,29.5 L 14,29.5 L 14,17"      style="stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>'}),RookBlack:bi.define("chess.RookBlack",{size:{width:32,height:34}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z "      style="stroke-linecap:butt;stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z "      style="stroke-linecap:butt;" />    <path      d="M 12,35.5 L 33,35.5 L 33,35.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 13,31.5 L 32,31.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,29.5 L 31,29.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 31,16.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />  </g></g></g>'}),BishopWhite:bi.define("chess.BishopWhite",{size:{width:38,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#ffffff; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path      d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>'}),BishopBlack:bi.define("chess.BishopBlack",{size:{width:38,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path       d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"       style="fill:none; stroke:#ffffff; stroke-linejoin:miter;" />  </g></g></g>'}),KnightWhite:bi.define("chess.KnightWhite",{size:{width:38,height:37}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#000000; stroke:#000000;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#000000; stroke:#000000;" />  </g></g></g>'}),KnightBlack:bi.define("chess.KnightBlack",{size:{width:38,height:37}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#000000; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#000000; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z "      style="fill:#ffffff; stroke:none;" />  </g></g></g>'}),PawnWhite:bi.define("chess.PawnWhite",{size:{width:28,height:33}},{markup:'<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>'}),PawnBlack:bi.define("chess.PawnBlack",{size:{width:28,height:33}},{markup:'<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>'})},mn=di.define("erd.Entity",{size:{width:150,height:60},attrs:{".outer":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"100,0 100,60 0,60 0,0"},".inner":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"95,5 95,55 5,55 5,5",display:"none"},text:{text:"Entity","font-family":"Arial","font-size":14,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>'}),vn=mn.define("erd.WeakEntity",{attrs:{".inner":{display:"auto"},text:{text:"Weak Entity"}}}),yn=di.define("erd.Relationship",{size:{width:80,height:80},attrs:{".outer":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,0 80,40 40,80 0,40"},".inner":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,5 75,40 40,75 5,40",display:"none"},text:{text:"Relationship","font-family":"Arial","font-size":12,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>'}),bn=yn.define("erd.IdentifyingRelationship",{attrs:{".inner":{display:"auto"},text:{text:"Identifying"}}}),wn=di.define("erd.Attribute",{size:{width:100,height:50},attrs:{ellipse:{transform:"translate(50, 25)"},".outer":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:50,ry:25,fill:"#E67E22"},".inner":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:45,ry:20,fill:"#E67E22",display:"none"},text:{"font-family":"Arial","font-size":14,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><ellipse class="outer"/><ellipse class="inner"/></g><text/></g>'}),Cn=wn.define("erd.Multivalued",{attrs:{".inner":{display:"block"},text:{text:"multivalued"}}}),In=wn.define("erd.Derived",{attrs:{".outer":{"stroke-dasharray":"3,5"},text:{text:"derived"}}}),xn=wn.define("erd.Key",{attrs:{ellipse:{"stroke-width":4},text:{text:"key","font-weight":"800","text-decoration":"underline"}}}),An=wn.define("erd.Normal",{attrs:{text:{text:"Normal"}}}),Sn={Entity:mn,WeakEntity:vn,Relationship:yn,IdentifyingRelationship:bn,Attribute:wn,Multivalued:Cn,Derived:In,Key:xn,Normal:An,ISA:di.define("erd.ISA",{type:"erd.ISA",size:{width:100,height:50},attrs:{polygon:{points:"0,0 50,50 100,0",fill:"#F1C40F",stroke:"#F39C12","stroke-width":2},text:{text:"ISA","font-size":18,"ref-x":.5,"ref-y":.3,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>'}),Line:Li.define("erd.Line",{},{cardinality:function(t){this.set("labels",[{position:-20,attrs:{text:{dy:-8,text:t}}}])}})},_n={State:xi.define("fsa.State",{attrs:{circle:{"stroke-width":3},text:{"font-weight":"800"}}}),StartState:di.define("fsa.StartState",{size:{width:20,height:20},attrs:{circle:{transform:"translate(10, 10)",r:10,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle/></g></g>'}),EndState:di.define("fsa.EndState",{size:{width:20,height:20},attrs:{".outer":{transform:"translate(10, 10)",r:10,fill:"#ffffff",stroke:"#000000"},".inner":{transform:"translate(10, 10)",r:6,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>'}),Arrow:Li.define("fsa.Arrow",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z"}},smooth:!0})},Pn={Member:di.define("org.Member",{size:{width:180,height:70},attrs:{rect:{width:170,height:60},".card":{fill:"#FFFFFF",stroke:"#000000","stroke-width":2,"pointer-events":"visiblePainted",rx:10,ry:10},image:{width:48,height:48,ref:".card","ref-x":10,"ref-y":5},".rank":{"text-decoration":"underline",ref:".card","ref-x":.9,"ref-y":.2,"font-family":"Courier New","font-size":14,"text-anchor":"end"},".name":{"font-weight":"800",ref:".card","ref-x":.9,"ref-y":.6,"font-family":"Courier New","font-size":14,"text-anchor":"end"}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="card"/><image/></g><text class="rank"/><text class="name"/></g>'}),Arrow:Li.define("org.Arrow",{source:{selector:".card"},target:{selector:".card"},attrs:{".connection":{stroke:"#585858","stroke-width":3}},z:-1})},Mn={Place:bi.define("pn.Place",{size:{width:50,height:50},attrs:{".root":{r:25,fill:"#ffffff",stroke:"#000000",transform:"translate(25, 25)"},".label":{"text-anchor":"middle","ref-x":.5,"ref-y":-20,ref:".root",fill:"#000000","font-size":12},".tokens > circle":{fill:"#000000",r:5},".tokens.one > circle":{transform:"translate(25, 25)"},".tokens.two > circle:nth-child(1)":{transform:"translate(19, 25)"},".tokens.two > circle:nth-child(2)":{transform:"translate(31, 25)"},".tokens.three > circle:nth-child(1)":{transform:"translate(18, 29)"},".tokens.three > circle:nth-child(2)":{transform:"translate(25, 19)"},".tokens.three > circle:nth-child(3)":{transform:"translate(32, 29)"},".tokens.alot > text":{transform:"translate(25, 18)","text-anchor":"middle",fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="root"/><g class="tokens" /></g><text class="label"/></g>'}),PlaceView:vi.extend({presentationAttributes:vi.addPresentationAttributes({tokens:["TOKENS"]}),initFlag:vi.prototype.initFlag.concat(["TOKENS"]),confirmUpdate:function(){for(var t,e=[],i=arguments.length;i--;)e[i]=arguments[i];var n=(t=vi.prototype.confirmUpdate).call.apply(t,[this].concat(e));return this.hasFlag(n,"TOKENS")&&(this.renderTokens(),this.update(),n=this.removeFlag(n,"TOKENS")),n},renderTokens:function(){var e=this.vel.findOne(".tokens").empty();["one","two","three","alot"].forEach(function(t){e.removeClass(t)});var t=this.model.get("tokens");if(t)switch(t){case 1:e.addClass("one"),e.append(Ot("circle"));break;case 2:e.addClass("two"),e.append([Ot("circle"),Ot("circle")]);break;case 3:e.addClass("three"),e.append([Ot("circle"),Ot("circle"),Ot("circle")]);break;default:e.addClass("alot"),e.append(Ot("text").text(t+""))}}}),Transition:bi.define("pn.Transition",{size:{width:12,height:50},attrs:{rect:{width:12,height:50,fill:"#000000",stroke:"#000000"},".label":{"text-anchor":"middle","ref-x":.5,"ref-y":-20,ref:"rect",fill:"#000000","font-size":12}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="root"/></g></g><text class="label"/>'}),Link:Li.define("pn.Link",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z"}}})},kn=bi.define("uml.Class",{attrs:{rect:{width:200},".uml-class-name-rect":{stroke:"black","stroke-width":2,fill:"#3498db"},".uml-class-attrs-rect":{stroke:"black","stroke-width":2,fill:"#2980b9"},".uml-class-methods-rect":{stroke:"black","stroke-width":2,fill:"#2980b9"},".uml-class-name-text":{ref:".uml-class-name-rect","ref-y":.5,"ref-x":.5,"text-anchor":"middle","y-alignment":"middle","font-weight":"bold",fill:"black","font-size":12,"font-family":"Times New Roman"},".uml-class-attrs-text":{ref:".uml-class-attrs-rect","ref-y":5,"ref-x":5,fill:"black","font-size":12,"font-family":"Times New Roman"},".uml-class-methods-text":{ref:".uml-class-methods-rect","ref-y":5,"ref-x":5,fill:"black","font-size":12,"font-family":"Times New Roman"}},name:[],attributes:[],methods:[]},{markup:['<g class="rotatable">','<g class="scalable">','<rect class="uml-class-name-rect"/><rect class="uml-class-attrs-rect"/><rect class="uml-class-methods-rect"/>',"</g>",'<text class="uml-class-name-text"/><text class="uml-class-attrs-text"/><text class="uml-class-methods-text"/>',"</g>"].join(""),initialize:function(){this.on("change:name change:attributes change:methods",function(){this.updateRectangles(),this.trigger("uml-update")},this),this.updateRectangles(),bi.prototype.initialize.apply(this,arguments)},getClassName:function(){return this.get("name")},updateRectangles:function(){var n=this.get("attrs"),t=[{type:"name",text:this.getClassName()},{type:"attrs",text:this.get("attributes")},{type:"methods",text:this.get("methods")}],s=0;t.forEach(function(t){var e=Array.isArray(t.text)?t.text:[t.text],i=20*e.length+20;n[".uml-class-"+t.type+"-text"].text=e.join("\n"),n[".uml-class-"+t.type+"-rect"].height=i,n[".uml-class-"+t.type+"-rect"].transform="translate(0,"+s+")",s+=i})}}),Tn=vi.extend({initialize:function(){vi.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"uml-update",function(){this.update(),this.resize()})}}),Nn=kn.define("uml.Abstract",{attrs:{".uml-class-name-rect":{fill:"#e74c3c"},".uml-class-attrs-rect":{fill:"#c0392b"},".uml-class-methods-rect":{fill:"#c0392b"}}},{getClassName:function(){return["<<Abstract>>",this.get("name")]}}),Dn=Tn,En=kn.define("uml.Interface",{attrs:{".uml-class-name-rect":{fill:"#f1c40f"},".uml-class-attrs-rect":{fill:"#f39c12"},".uml-class-methods-rect":{fill:"#f39c12"}}},{getClassName:function(){return["<<Interface>>",this.get("name")]}}),Ln={Class:kn,ClassView:Tn,Abstract:Nn,AbstractView:Dn,Interface:En,InterfaceView:Tn,Generalization:Li.define("uml.Generalization",{attrs:{".marker-target":{d:"M 20 0 L 0 10 L 20 20 z",fill:"white"}}}),Implementation:Li.define("uml.Implementation",{attrs:{".marker-target":{d:"M 20 0 L 0 10 L 20 20 z",fill:"white"},".connection":{"stroke-dasharray":"3,3"}}}),Aggregation:Li.define("uml.Aggregation",{attrs:{".marker-target":{d:"M 40 10 L 20 20 L 0 10 L 20 0 z",fill:"white"}}}),Composition:Li.define("uml.Composition",{attrs:{".marker-target":{d:"M 40 10 L 20 20 L 0 10 L 20 0 z",fill:"black"}}}),Association:Li.define("uml.Association"),State:bi.define("uml.State",{attrs:{".uml-state-body":{width:200,height:200,rx:10,ry:10,fill:"#ecf0f1",stroke:"#bdc3c7","stroke-width":3},".uml-state-separator":{stroke:"#bdc3c7","stroke-width":2},".uml-state-name":{ref:".uml-state-body","ref-x":.5,"ref-y":5,"text-anchor":"middle",fill:"#000000","font-family":"Courier New","font-size":14},".uml-state-events":{ref:".uml-state-separator","ref-x":5,"ref-y":5,fill:"#000000","font-family":"Courier New","font-size":14}},name:"State",events:[]},{markup:['<g class="rotatable">','<g class="scalable">','<rect class="uml-state-body"/>',"</g>",'<path class="uml-state-separator"/>','<text class="uml-state-name"/>','<text class="uml-state-events"/>',"</g>"].join(""),initialize:function(){this.on({"change:name":this.updateName,"change:events":this.updateEvents,"change:size":this.updatePath},this),this.updateName(),this.updateEvents(),this.updatePath(),bi.prototype.initialize.apply(this,arguments)},updateName:function(){this.attr(".uml-state-name/text",this.get("name"))},updateEvents:function(){this.attr(".uml-state-events/text",this.get("events").join("\n"))},updatePath:function(){var t="M 0 20 L "+this.get("size").width+" 20";this.attr(".uml-state-separator/d",t,{silent:!0})}}),StartState:xi.define("uml.StartState",{type:"uml.StartState",attrs:{circle:{fill:"#34495e",stroke:"#2c3e50","stroke-width":2,rx:1}}}),EndState:bi.define("uml.EndState",{size:{width:20,height:20},attrs:{"circle.outer":{transform:"translate(10, 10)",r:10,fill:"#ffffff",stroke:"#2c3e50"},"circle.inner":{transform:"translate(10, 10)",r:6,fill:"#34495e"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>'}),Transition:Li.define("uml.Transition",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z",fill:"#34495e",stroke:"#2c3e50"},".connection":{stroke:"#2c3e50"}}})},zn=["arc","gap","cubic"],On=["smooth"];function Gn(t,e,i){var s=[].concat(t,i,e);return s.reduce(function(t,e,i){var n=s[i+1];return null!=n&&(t[i]=Y(e,n)),t},[])}function Bn(){for(var t=this._jumpOverUpdateList,e=0;e<t.length;e++)t[e].update()}function jn(t,e){return Y(t,e).squaredLength()}function Rn(t,d,p){var g,f=new B;return g=B.createSegment("M",t[0].start),f.appendSegment(g),pe(t).forEach(function(t,e){var i,n,s,r;if(t.isJump){if("arc"===p){i=-90,n=t.start.difference(t.end);var o=Number(n.x<0||0===n.x&&n.y<0);o&&(i+=180);var a,l=t.midpoint(),h=new G(l,t.end).rotate(l,i);s=(a=new G(t.start,l)).pointAt(2/3).rotate(t.start,i),r=h.pointAt(1/3).rotate(h.end,-i),g=B.createSegment("C",s,r,h.end),f.appendSegment(g),a=new G(l,t.end),s=h.pointAt(1/3).rotate(h.end,i),r=a.pointAt(1/3).rotate(t.end,-i),g=B.createSegment("C",s,r,t.end),f.appendSegment(g)}else if("gap"===p)g=B.createSegment("M",t.end),f.appendSegment(g);else if("cubic"===p){i=t.start.theta(t.end);var c=.6*d,u=1.35*d;n=t.start.difference(t.end),(o=Number(n.x<0||0===n.x&&n.y<0))&&(u*=-1),s=j(t.start.x+c,t.start.y+u).rotate(t.start,i),r=j(t.end.x-c,t.end.y+u).rotate(t.end,i),g=B.createSegment("C",s,r,t.end),f.appendSegment(g)}}else g=B.createSegment("L",t.end),f.appendSegment(g)}),f}function Vn(t,e,i,n){var s,r=(n=n||{}).radius||10,o=n.raw,a=new B;s=B.createSegment("M",t),a.appendSegment(s);for(var l,h,c,u,d,p,g,f,m,v,y,b=0,w=i.length;b<w;b++)l=new j(i[b]),h=i[b-1]||t,c=i[b+1]||e,u=d||l.distance(h)/2,d=l.distance(c)/2,p=-Math.min(r,u),g=-Math.min(r,d),f=l.clone().move(h,p).round(),m=l.clone().move(c,g).round(),v=new j(1/3*f.x+2/3*l.x,2/3*l.y+1/3*f.y),y=new j(1/3*m.x+2/3*l.x,2/3*l.y+1/3*m.y),s=B.createSegment("L",f),a.appendSegment(s),s=B.createSegment("C",v,y,m),a.appendSegment(s);return s=B.createSegment("L",e),a.appendSegment(s),o?a:a.serialize()}var Zn={jumpover:function(t,e,i,n){var s,r;null==(r=(s=this).paper._jumpOverUpdateList)&&(r=s.paper._jumpOverUpdateList=[],s.paper.on("cell:pointerup",Bn),s.paper.model.on("reset",function(){r=s.paper._jumpOverUpdateList=[]})),r.indexOf(s)<0&&(r.push(s),s.listenToOnce(s.model,"change:connector remove",function(){r.splice(r.indexOf(s),1)}));var o=n.raw,a=n.size||5,l=n.jump&&(""+n.jump).toLowerCase(),h=n.ignoreConnectors||On;-1===zn.indexOf(l)&&(l=zn[0]);var c=this.paper,u=c.model.getLinks();if(1===u.length)return Rn(Gn(t,e,i),a,l);var d=this.model,p=u.indexOf(d),g=c.options.defaultConnector||{},f=u.filter(function(t,e){var i=t.get("connector")||g;return!pe(h).includes(i.name)&&(!(p<e)||"jumpover"!==i.name)}),m=f.map(function(t){return c.findViewByModel(t)}),v=Gn(t,e,i),y=m.map(function(t){return null==t?[]:t===this?v:Gn(t.sourcePoint,t.targetPoint,t.route)},this),b=Rn(v.reduce(function(t,o){var h,c,u,e=f.reduce(function(t,e,i){if(e!==d){var n=(s=o,r=y[i],pe(r).reduce(function(t,e){var i=s.intersection(e);return i&&t.push(i),t},[]));t.push.apply(t,n)}var s,r;return t},[]).sort(function(t,e){return jn(o.start,t)-jn(o.start,e)});return 0<e.length?t.push.apply(t,(h=o,u=a,(c=e).reduce(function(t,e,i){if(!0===e.skip)return t;var n=t.pop()||h,s=H(e).move(n.start,-u),r=H(e).move(n.start,+u),o=c[i+1];if(null!=o){var a=r.distance(o);a<=u&&(r=o.move(n.start,a),o.skip=!0)}else if(s.distance(n.end)<2*u+1)return t.push(n),t;if(r.distance(n.start)<2*u+1)return t.push(n),t;var l=Y(s,r);return l.isJump=!0,t.push(Y(n.start,s),l,Y(r,n.end)),t},[]))):t.push(o),t},[]),a,l);return o?b:b.serialize()},normal:function(t,e,i,n){var s=n&&n.raw,r=[t].concat(i).concat([e]),o=new K(r),a=new B(o);return s?a:a.serialize()},rounded:Vn,smooth:function(t,e,i,n){var s,r=n&&n.raw;if(i&&0!==i.length){var o=[t].concat(i).concat([e]),a=A.throughPoints(o);s=new B(a)}else{var l;if(s=new B,l=B.createSegment("M",t),s.appendSegment(l),Math.abs(t.x-e.x)>=Math.abs(t.y-e.y)){var h=(t.x+e.x)/2;l=B.createSegment("C",h,t.y,h,e.y,e.x,e.y),s.appendSegment(l)}else{var c=(t.y+e.y)/2;l=B.createSegment("C",t.x,c,e.x,c,e.x,e.y),s.appendSegment(l)}}return r?s:s.serialize()}},Wn={stroke:{defaultOptions:{padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},_views:{},getHighlighterId:function(t,e){return t.id+JSON.stringify(e)},removeHighlighter:function(t){this._views[t]&&(this._views[t].remove(),this._views[t]=null)},highlight:function(t,e,i){var n=this.getHighlighterId(e,i);if(!this._views[n]){var s,r=ie(i||{},this.defaultOptions),o=Ot(e);try{var a=o.convertToPathData()}catch(t){s=o.bbox(!0),a=Ot.rectToPath(ee({},r,s))}var l=Ot("path").attr({d:a,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"}).attr(r.attrs);if(t.isNodeConnection(e))l.attr("d",t.getSerializedConnection());else{var h=o.getTransformToElement(t.el),c=r.padding;if(c){var u=(s=s||o.bbox(!0)).x+s.width/2,d=s.y+s.height/2;s=Ot.transformRect(s,h);var p=Math.max(s.width,1),g=Math.max(s.height,1),f=(p+c)/p,m=(g+c)/g,v=Ot.createSVGMatrix({a:f,b:0,c:0,d:m,e:u-f*u,f:d-m*d});h=h.multiply(v)}l.transform(h)}var y=this._views[n]=new gi({svgElement:!0,className:"highlight-stroke",el:l.node}),b=this.removeHighlighter.bind(this,n),w=t.model;y.listenTo(w,"remove",b),y.listenTo(w.graph,"reset",b),t.vel.append(l)}},unhighlight:function(t,e,i){this.removeHighlighter(this.getHighlighterId(e,i))}},opacity:{highlight:function(t,e){Ot(e).addClass(ct("highlight-opacity"))},unhighlight:function(t,e){Ot(e).removeClass(ct("highlight-opacity"))}},addClass:{className:ct("highlighted"),highlight:function(t,e,i){var n=(i||{}).className||this.className;Ot(e).addClass(n)},unhighlight:function(t,e,i){var n=(i||{}).className||this.className;Ot(e).removeClass(n)}}};function Yn(t,e,i){if(!isFinite(i))return t;var n=t.distance(e);return 0===i&&0<n?t:t.move(e,-Math.min(i,n-1))}function Hn(t){var e=t.getAttribute("stroke-width");return null===e?0:parseFloat(e)||0}function Fn(t,e,i,n){var s=e.getNodeBBox(i);n.stroke&&s.inflate(Hn(i)/2);var r=t.intersect(s);return Yn(r?t.start.chooseClosest(r):t.end,t.start,n.offset)}var Un="segmentSubdivisons",Xn="shapeBBox";var Jn={anchor:function(t,e,i,n){return Yn(t.end,t.start,n.offset)},bbox:Fn,rectangle:function(t,e,i,n){var s=e.model.angle();if(0===s)return Fn(t,e,i,n);var r=e.getNodeUnrotatedBBox(i);n.stroke&&r.inflate(Hn(i)/2);var o=r.center(),a=t.clone().rotate(o,s),l=a.setLength(1e6).intersect(r);return Yn(l?a.start.chooseClosest(l).rotate(o,-s):t.end,t.start,n.offset)},boundary:function(t,e,i,n){var s,r,o=n.selector,a=t.end;if(s="string"==typeof o?e.findBySelector(o)[0]:Array.isArray(o)?gt(i,o):function(t){if(!t)return null;var e=t;do{var i=e.tagName;if("string"!=typeof i)return null;if("G"===(i=i.toUpperCase()))e=e.firstElementChild;else{if("TITLE"!==i)break;e=e.nextElementSibling}}while(e);return e}(i),!Ot.isSVGGraphicsElement(s)){if(s===i||!Ot.isSVGGraphicsElement(i))return a;s=i}var l,h=e.getNodeShape(s),c=e.getNodeMatrix(s),u=e.getRootTranslateMatrix(),d=e.getRootRotateMatrix(),p=u.multiply(d).multiply(c),g=p.inverse(),f=Ot.transformLine(t,g),m=f.start.clone(),v=e.getNodeData(s);if(!1===n.insideout&&(v[Xn]||(v[Xn]=h.bbox()),v[Xn].containsPoint(m)))return a;if(h instanceof B){var y=n.precision||2;v[Un]||(v[Un]=h.getSegmentSubdivisions({precision:y})),l={precision:y,segmentSubdivisions:v[Un]}}!0===n.extrapolate&&f.setLength(1e6),(r=f.intersect(h,l))?Ot.isArray(r)&&(r=m.chooseClosest(r)):!0===n.sticky&&(r=h instanceof Q?h.pointNearestToPoint(m):h instanceof _?h.intersectionWithLineFromCenterToPoint(m):h.closestPoint(m,l));var b=r?Ot.transformPoint(r,p):a,w=n.offset||0;return n.stroke&&(w+=Hn(s)/2),Yn(b,t.start,w)}};function $n(t,e){return 0===e?"0%":Math.round(t/e*100)+"%"}function Kn(s){return function(t,e,i,n){return(e.isNodeConnection(i)?qn:Qn)(s,t,e,i,n)}}function Qn(t,e,i,n,s){var r=i.model.angle(),o=i.getNodeUnrotatedBBox(n),a=i.model.getBBox().center();s.rotate(a,r);var l=s.x-o.x,h=s.y-o.y;return t&&(l=$n(l,o.width),h=$n(h,o.height)),e.anchor={name:"topLeft",args:{dx:l,dy:h,rotate:!0}},e}function qn(t,e,i,n,s){var r=i.getConnection();if(!r)return e;var o=r.closestPointLength(s);if(t){var a=r.length();e.anchor={name:"connectionRatio",args:{ratio:o/a}}}else e.anchor={name:"connectionLength",args:{length:o}};return e}var ts=De,es=Kn(!1),is=Kn(!0),ns={useDefaults:ts,pinAbsolute:es,pinRelative:is},ss={N:"S",S:"N",E:"W",W:"E"},rs={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function os(t,e,i){var n=new j(t.x,e.y);return i.containsPoint(n)&&(n=new j(e.x,t.y)),n}function as(t,e){return t["W"===e||"E"===e?"width":"height"]}function ls(t,e){return t.x===e.x?t.y>e.y?"N":"S":t.y===e.y?t.x>e.x?"W":"E":null}function hs(t){return new Q(t.x,t.y,0,0)}function cs(t){var e=Ht(t.padding||t.elementPadding||20);return{x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}function us(t,e){return t.sourceBBox.clone().moveAndExpand(cs(e))}function ds(t,e){return t.targetBBox.clone().moveAndExpand(cs(e))}function ps(t,e,i){var n=new j(t.x,e.y),s=new j(e.x,t.y),r=ls(t,n),o=ls(t,s),a=ss[i],l=r===i||r!==a&&(o===a||o!==i)?n:s;return{points:[l],direction:ls(l,e)}}function gs(t,e,i){var n=os(t,e,i);return{points:[n],direction:ls(n,e)}}function fs(e,t,i,n){var s,r={},o=[new j(e.x,t.y),new j(t.x,e.y)],a=o.filter(function(t){return!i.containsPoint(t)}),l=a.filter(function(t){return ls(t,e)!==n});if(0<l.length)s=(s=l.filter(function(t){return ls(e,t)===n}).pop())||l[0],r.points=[s],r.direction=ls(s,t);else{s=be(o,a)[0];var h=new j(t).move(s,-as(i,n)/2),c=os(h,e,i);r.points=[c,h],r.direction=ls(h,t)}return r}function ms(t,e,i,n){var s=gs(e,t,n),r=s.points[0];if(i.containsPoint(r)){var o=(s=gs(t,e,i)).points[0];if(n.containsPoint(o)){var a=new j(t).move(o,-as(i,ls(t,o))/2),l=new j(e).move(r,-as(n,ls(e,r))/2),h=new G(a,l).midpoint(),c=gs(t,h,i),u=ps(h,e,c.direction);s.points=[c.points[0],u.points[0]],s.direction=u.direction}}return s}function vs(t,e,i,n,s){var r,o,a,l={},h=i.union(n).inflate(1),c=h.center().distance(e)>h.center().distance(t),u=c?e:t,d=c?t:e;return o=os(r=s?(r=j.fromPolar(h.width+h.height,rs[s],u),h.pointNearestToPoint(r).move(r,-1)):h.pointNearestToPoint(u).move(u,1),d,h),r.round().equals(o.round())?(o=j.fromPolar(h.width+h.height,T(r.theta(u))+Math.PI/2,d),a=os(r,o=h.pointNearestToPoint(o).move(d,1).round(),h),l.points=c?[o,a,r]:[r,a,o]):l.points=c?[o,r]:[r,o],l.direction=ls(c?r:o,e),l}function ys(t,e,i){var n,s,r,o,a,l=us(i,e),h=ds(i,e),c=(s=e,(n=i).sourceAnchor?n.sourceAnchor:us(n,s).center()),u=(o=e,(r=i).targetAnchor?r.targetAnchor:ds(r,o).center());l=l.union(hs(c)),h=h.union(hs(u)),(t=pe(t).map(j)).unshift(c),t.push(u);for(var d=[],p=0,g=t.length-1;p<g;p++){var f=null,m=t[p],v=t[p+1],y=!!ls(m,v);if(0===p)p+1===g?l.intersect(h.clone().inflate(1))?f=vs(m,v,l,h):y||(f=ms(m,v,l,h)):l.containsPoint(v)?f=vs(m,v,l,hs(v).moveAndExpand(cs(e))):y||(f=gs(m,v,l));else if(p+1===g){var b=y&&ls(v,m)===a;h.containsPoint(m)||b?f=vs(m,v,hs(m).moveAndExpand(cs(e)),h,a):y||(f=fs(m,v,h,a))}else y||(f=ps(m,v,a));a=f?(Array.prototype.push.apply(d,f.points),f.direction):ls(m,v),p+1<g&&d.push(v)}return d}var bs={step:10,maximumLoops:2e3,precision:1,maxAllowedDirectionChange:90,perpendicular:!0,excludeEnds:[],excludeTypes:["basic.Text"],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost:function(){return this.step},directions:function(){var t=this.step,e=this.cost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:0,offsetY:t,cost:e},{offsetX:-t,offsetY:0,cost:e},{offsetX:0,offsetY:-t,cost:e}]},penalties:function(){return{0:0,45:this.step/2,90:this.step/2}},paddingBox:function(){var t=this.step;return{x:-t,y:-t,width:2*t,height:2*t}},fallbackRouter:function(t,e,i){if(!ue(ys))throw new Error("Manhattan requires the orthogonal router as default fallback.");return ys(t,ee({},bs,e),i)},fallbackRoute:function(t,e,i){return null},draggingRoute:null};function ws(t){this.map={},this.options=t,this.mapGridSize=100}function Cs(){this.items=[],this.hash={},this.values={},this.OPEN=1,this.CLOSE=2}function Is(t,e){return e&&e.paddingBox?t.sourceBBox.clone().moveAndExpand(e.paddingBox):t.sourceBBox.clone()}function xs(t,e){return e&&e.paddingBox?t.targetBBox.clone().moveAndExpand(e.paddingBox):t.targetBBox.clone()}function As(t,e){return t.sourceAnchor?t.sourceAnchor:Is(t,e).center()}function Ss(t,e,i,n,s){var r,o,a,l,h,c,u,d,p,g,f=360/i,m=t.theta((r=t,o=e,a=n,l=s.step,h=o.x-r.x,c=o.y-r.y,u=h/a.x,d=c/a.y,p=u*l,g=d*l,new j(r.x+p,r.y+g))),v=q(m+f/2);return f*Math.floor(v/f)}function _s(t,e){var i=Math.abs(t-e);return 180<i?360-i:i}function Ps(t,e){if(!t)return e;var i=Math.abs(t),n=Math.round(i/e);return n?e+(i-n*e)/n:i}function Ms(t,e){return t.round(e)}function ks(t,e,i){return Ms((n=t.clone(),r=(s=e).source,o=k(n.x-r.x,s.x)+r.x,a=k(n.y-r.y,s.y)+r.y,new j(o,a)),i);var n,s,r,o,a}function Ts(t){return t.clone().toString()}function Ns(t){return new j(0===t.x?0:Math.abs(t.x)/t.x,0===t.y?0:Math.abs(t.y)/t.y)}function Ds(t,e,i,n,s){for(var r,o=[],a=Ns(s.difference(i)),l=Ts(i),h=t[l];h;){var c=Ns((r=e[l]).difference(h));c.equals(a)||(o.unshift(r),a=c),h=t[l=Ts(h)]}var u=e[l];return Ns(u.difference(n)).equals(a)||o.unshift(u),o}function Es(t,e){for(var i=1/0,n=0,s=e.length;n<s;n++){var r=t.manhattanDistance(e[n]);r<i&&(i=r)}return i}function Ls(d,p,t,g,e){var f=e.precision,m=e.directionMap,v=d.difference(p.center()),i=Te(m)?Object.keys(m):[],y=pe(t),n=i.reduce(function(t,e){if(y.includes(e)){for(var i,n=m[e],s=new j(d.x+n.x*(Math.abs(v.x)+p.width),d.y+n.y*(Math.abs(v.y)+p.height)),r=new G(d,s).intersect(p)||[],o=r.length,a=null,l=0;l<o;l++){var h=r[l],c=d.squaredDistance(h);(void 0===i||i<c)&&(i=c,a=h)}if(a){var u=ks(a,g,f);p.containsPoint(u)&&(u=ks(u.offset(n.x*g.x,n.y*g.y),g,f)),t.push(u)}}return t},[]);return p.containsPoint(d)||n.push(ks(d,g,f)),n}function zs(t,e,i,n){var s,r,o,a,l=n.precision;s=Ms(t instanceof Q?As(this,n).clone():t.clone(),l),r=Ms(e instanceof Q?(a=n,(o=this).targetAnchor?o.targetAnchor:xs(o,a).center()).clone():e.clone(),l);var h,c,u,d,p,g,f,m,v,y,b=(h=n.step,u=r,{source:(c=s).clone(),x:Ps(u.x-c.x,h),y:Ps(u.y-c.y,h)});if(g=t instanceof Q?Ls(d=s,t,n.startDirections,b,n):[d=s],f=e instanceof Q?Ls(p=r,e,n.endDirections,b,n):[p=r],g=g.filter(i.isPointAccessible,i),f=f.filter(i.isPointAccessible,i),0<g.length&&0<f.length){for(var w=new Cs,C={},I={},x={},A=0,S=g.length;A<S;A++){var _=g[A],P=Ts(_);w.add(P,Es(_,f)),C[P]=_,x[P]=0}var M,k,T=n.previousDirectionAngle,N=void 0===T,D=n.directions;m=b,y=(v=n).step,pe(v.directions).forEach(function(t){t.gridOffsetX=t.offsetX/y*m.x,t.gridOffsetY=t.offsetY/y*m.y});for(var E=D.length,L=pe(f).reduce(function(t,e){var i=Ts(e);return t.push(i),t},[]),z=n.maximumLoops;!w.isEmpty()&&0<z;){var O,G=w.pop(),B=C[G],j=I[G],R=x[G],V=void 0===j,Z=B.equals(d);O=V?N?Z?null:Ss(d,B,E,b,n):T:Ss(j,B,E,b,n);var W=ce(g,f);if(!(V&&W)&&0<=L.indexOf(G))return n.previousDirectionAngle=O,Ds(I,C,B,d,p);for(A=0;A<E;A++){var Y=(M=D[A]).angle;if(k=_s(O,Y),N&&Z||!(k>n.maxAllowedDirectionChange)){var H=ks(B.clone().offset(M.gridOffsetX,M.gridOffsetY),b,l),F=Ts(H);if(!w.isClose(F)&&i.isPointAccessible(H)){if(0<=L.indexOf(F))if(!H.equals(p))if(_s(Y,Ss(H,p,E,b,n))>n.maxAllowedDirectionChange)continue;var U=R+M.cost+(Z?0:n.penalties[k]);(!w.isOpen(F)||U<x[F])&&(C[F]=H,I[F]=B,x[F]=U,w.add(F,U+Es(H,f)))}}}z--}}return n.fallbackRoute.call(this,d,p,n)}function Os(t,e,i){!function(t){if(t.directions=xe(t,"directions"),t.penalties=xe(t,"penalties"),t.paddingBox=xe(t,"paddingBox"),t.padding=xe(t,"padding"),t.padding){var e=Ht(t.padding);t.paddingBox={x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}pe(t.directions).forEach(function(t){var e=new j(0,0),i=new j(t.offsetX,t.offsetY);t.angle=q(e.theta(i))})}(e),i.options.perpendicular=!!e.perpendicular;for(var n,s,r=Is(i,e),o=xs(i,e),a=As(i,e),l=new ws(e).build(i.paper.model,i.model),h=pe(t).map(j),c=[],u=a,d=0,p=h.length;d<=p;d++){var g=null;if(s=n||r,!(n=h[d]))if(n=o,(!i.model.get("source").id||!i.model.get("target").id)&&ue(e.draggingRoute)){var f=s===r?a:s,m=n.origin();g=e.draggingRoute.call(i,f,m,e)}if(null===(g=g||zs.call(i,s,n,l,e)))return e.fallbackRouter(t,e,i);var v=g[0];v&&v.equals(u)&&g.shift(),u=g[g.length-1]||u,Array.prototype.push.apply(c,g)}return c}ws.prototype.build=function(s,r){var u=this.options,d=pe(u.excludeEnds).reduce(function(t,e){var i=r.get(e);if(i){var n=s.getCell(i.id);n&&t.push(n)}return t},[]),p=[],t=s.getCell(r.get("source").id);t&&(p=Ce(p,t.getAncestors().map(function(t){return t.id})));var e=s.getCell(r.get("target").id);e&&(p=Ce(p,e.getAncestors().map(function(t){return t.id})));var g=this.mapGridSize;return s.getElements().reduce(function(t,e){var i=pe(u.excludeTypes).includes(e.get("type")),n=d.find(function(t){return t.id===e.id}),s=p.includes(e.id);if(!(i||n||s))for(var r=e.getBBox().moveAndExpand(u.paddingBox),o=r.origin().snapToGrid(g),a=r.corner().snapToGrid(g),l=o.x;l<=a.x;l+=g)for(var h=o.y;h<=a.y;h+=g){var c=l+"@"+h;t[c]=t[c]||[],t[c].push(r)}return t},this.map),this},ws.prototype.isPointAccessible=function(e){var t=e.clone().snapToGrid(this.mapGridSize).toString();return pe(this.map[t]).every(function(t){return!t.containsPoint(e)})},Cs.prototype.add=function(t,e){this.hash[t]?this.items.splice(this.items.indexOf(t),1):this.hash[t]=this.OPEN,this.values[t]=e;var i=re(this.items,t,function(t){return this.values[t]}.bind(this));this.items.splice(i,0,t)},Cs.prototype.remove=function(t){this.hash[t]=this.CLOSE},Cs.prototype.isOpen=function(t){return this.hash[t]===this.OPEN},Cs.prototype.isClose=function(t){return this.hash[t]===this.CLOSE},Cs.prototype.isEmpty=function(){return 0===this.items.length},Cs.prototype.pop=function(){var t=this.items.shift();return this.remove(t),t};function Gs(t,e,i){return Os(t,ee({},bs,e),i)}var Bs={maxAllowedDirectionChange:45,diagonalCost:function(){var t=this.step;return Math.ceil(Math.sqrt(t*t<<1))},directions:function(){var t=this.step,e=this.cost(),i=this.diagonalCost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:t,offsetY:t,cost:i},{offsetX:0,offsetY:t,cost:e},{offsetX:-t,offsetY:t,cost:i},{offsetX:-t,offsetY:0,cost:e},{offsetX:-t,offsetY:-t,cost:i},{offsetX:0,offsetY:-t,cost:e},{offsetX:t,offsetY:-t,cost:i}]},fallbackRoute:function(t,e,i){var n=t.theta(e),s=[],r={x:e.x,y:t.y},o={x:t.x,y:e.y};if(90<n%180){var a=r;r=o,o=a}var l=n%90<45?r:o,h=new g.Line(t,l),c=90*Math.ceil(n/90),u=g.Point.fromPolar(h.squaredLength(),g.toRad(135+c),l),d=new g.Line(e,u),p=h.intersection(d),f=p||e,m=p?f:t,v=360/i.directions.length,y=m.theta(e),b=g.normalizeAngle(y+v/2),w=v*Math.floor(b/v);return i.previousDirectionAngle=w,f&&s.push(f.round()),s.push(e),s}},js={normal:function(t,e,i){return t},oneSide:function(t,e,i){var n,s,r,o=e.side||"bottom",a=Ht(e.padding||40),l=i.sourceBBox,h=i.targetBBox,c=l.center(),u=h.center();switch(o){case"bottom":r=1,n="y",s="height";break;case"top":r=-1,n="y",s="height";break;case"left":r=-1,n="x",s="width";break;case"right":r=1,n="x",s="width";break;default:throw new Error("Router: invalid side")}return c[n]+=r*(l[s]/2+a[o]),u[n]+=r*(h[s]/2+a[o]),0<r*(c[n]-u[n])?u[n]=c[n]:c[n]=u[n],[c].concat(t,u)},orthogonal:ys,manhattan:Gs,metro:function(t,e,i){if(!ue(Gs))throw new Error("Metro requires the manhattan router.");return Gs(t,ee({},Bs,e),i)}};function Rs(o){return function(t,e,i,n){if(i instanceof Element){var s,r=this.paper.findView(i);if(r)if(r.isNodeConnection(i))s=Vs(r,"fixedAt"in n?n.fixedAt:"50%");else s=r.getNodeBBox(i).center();else s=new j;return o.call(this,t,e,s,n)}return o.apply(this,arguments)}}function Vs(t,e){var i=parseFloat(e);return Wt(e)?t.getPointAtRatio(i/100):t.getPointAtLength(i)}var Zs=Rs(function(t,e,i,n){var s=t.getConnection(),r=t.getConnectionSubdivisions(),o=new G(i.clone().offset(0,1e6),i.clone().offset(0,-1e6)),a=new G(i.clone().offset(1e6,0),i.clone().offset(-1e6,0)),l=o.intersect(s,{segmentSubdivisions:r}),h=a.intersect(s,{segmentSubdivisions:r}),c=[];return l&&Array.prototype.push.apply(c,l),h&&Array.prototype.push.apply(c,h),0<c.length?i.chooseClosest(c):"fallbackAt"in n?Vs(t,n.fallbackAt):Ws(t,e,i,n)}),Ws=Rs(function(t,e,i,n){var s=t.getClosestPoint(i);return s||new j}),Ys={resolveRef:Rs,connectionRatio:function(t,e,i,n){var s="ratio"in n?n.ratio:.5;return t.getPointAtRatio(s)},connectionLength:function(t,e,i,n){var s="length"in n?n.length:20;return t.getPointAtLength(s)},connectionPerpendicular:Zs,connectionClosest:Ws};function Hs(u){return function(t,e,i,n){var s=!!n.rotate,r=s?t.getNodeUnrotatedBBox(e):t.getNodeBBox(e),o=r[u](),a=n.dx;if(a){var l=Wt(a);a=parseFloat(a),isFinite(a)&&(l&&(a/=100,a*=r.width),o.x+=a)}var h=n.dy;if(h){var c=Wt(h);h=parseFloat(h),isFinite(h)&&(c&&(h/=100,h*=r.height),o.y+=h)}return s?o.rotate(t.model.getBBox().center(),-t.model.angle()):o}}var Fs={center:Hs("center"),top:Hs("topMiddle"),bottom:Hs("bottomMiddle"),left:Hs("leftMiddle"),right:Hs("rightMiddle"),topLeft:Hs("origin"),topRight:Hs("topRight"),bottomLeft:Hs("bottomLeft"),bottomRight:Hs("corner"),perpendicular:Rs(function(t,e,i,n){var s=t.model.angle(),r=t.getNodeBBox(e),o=r.center(),a=r.origin(),l=r.corner(),h=n.padding;if(isFinite(h)||(h=0),a.y+h<=i.y&&i.y<=l.y-h){var c=i.y-o.y;o.x+=0===s||180===s?0:1*c/Math.tan(T(s)),o.y+=c}else if(a.x+h<=i.x&&i.x<=l.x-h){var u=i.x-o.x;o.y+=90===s||270===s?0:u*Math.tan(T(s)),o.x+=u}return o}),midSide:Rs(function(t,e,i,n){var s,r,o,a=!!n.rotate;a?(s=t.getNodeUnrotatedBBox(e),o=t.model.getBBox().center(),r=t.model.angle()):s=t.getNodeBBox(e);var l,h=n.padding;switch(isFinite(h)&&s.inflate(h),a&&i.rotate(o,r),s.sideNearestToPoint(i)){case"left":l=s.leftMiddle();break;case"right":l=s.rightMiddle();break;case"top":l=s.topMiddle();break;case"bottom":l=s.bottomMiddle()}return a?l.rotate(o,-r):l}),modelCenter:function(t,e,i,n,s){return t.model.getPointFromConnectedLink(this.model,s).offset(n.dx,n.dy)}},Us=o.Collection.extend({initialize:function(t,e){e.cellNamespace?this.cellNamespace=e.cellNamespace:this.cellNamespace="undefined"!=typeof joint&&Ie(joint,"shapes")?joint.shapes:null,this.graph=e.graph},model:function(t,e){var i=e.collection,n=i.cellNamespace,s=new("link"===t.type?Li:gt(n,t.type,".")||di)(t,e);return e.dry||(s.graph=i.graph),s},comparator:function(t){return t.get("z")||0}}),Xs=o.Model.extend({_batches:{},initialize:function(t,e){var i=new Us([],{model:(e=e||{}).cellModel,cellNamespace:e.cellNamespace,graph:this});o.Model.prototype.set.call(this,"cells",i),i.on("all",this.trigger,this),this.on("change:z",this._sortOnChangeZ,this),this._out={},this._in={},this._nodes={},this._edges={},i.on("add",this._restructureOnAdd,this),i.on("remove",this._restructureOnRemove,this),i.on("reset",this._restructureOnReset,this),i.on("change:source",this._restructureOnChangeSource,this),i.on("change:target",this._restructureOnChangeTarget,this),i.on("remove",this._removeCell,this)},_sortOnChangeZ:function(){this.get("cells").sort()},_restructureOnAdd:function(t){if(t.isLink()){this._edges[t.id]=!0;var e=t.source(),i=t.target();e.id&&((this._out[e.id]||(this._out[e.id]={}))[t.id]=!0),i.id&&((this._in[i.id]||(this._in[i.id]={}))[t.id]=!0)}else this._nodes[t.id]=!0},_restructureOnRemove:function(t){if(t.isLink()){delete this._edges[t.id];var e=t.source(),i=t.target();e.id&&this._out[e.id]&&this._out[e.id][t.id]&&delete this._out[e.id][t.id],i.id&&this._in[i.id]&&this._in[i.id][t.id]&&delete this._in[i.id][t.id]}else delete this._nodes[t.id]},_restructureOnReset:function(t){t=t.models,this._out={},this._in={},this._nodes={},this._edges={},t.forEach(this._restructureOnAdd,this)},_restructureOnChangeSource:function(t){var e=t.previous("source");e.id&&this._out[e.id]&&delete this._out[e.id][t.id];var i=t.source();i.id&&((this._out[i.id]||(this._out[i.id]={}))[t.id]=!0)},_restructureOnChangeTarget:function(t){var e=t.previous("target");e.id&&this._in[e.id]&&delete this._in[e.id][t.id];var i=t.get("target");i.id&&((this._in[i.id]||(this._in[i.id]={}))[t.id]=!0)},getOutboundEdges:function(t){return this._out&&this._out[t]||{}},getInboundEdges:function(t){return this._in&&this._in[t]||{}},toJSON:function(){var t=o.Model.prototype.toJSON.apply(this,arguments);return t.cells=this.get("cells").toJSON(),t},fromJSON:function(t,e){if(!t.cells)throw new Error("Graph JSON must contain cells array.");return this.set(t,e)},set:function(t,e,i){var n;return"object"==typeof t?(n=t,i=e):(n={})[t]=e,n.hasOwnProperty("cells")&&(this.resetCells(n.cells,i),n=Ae(n,"cells")),o.Model.prototype.set.call(this,n,i)},clear:function(t){t=ee({},t,{clear:!0});var e=this.get("cells");if(0===e.length)return this;this.startBatch("clear",t);for(var i=e.sortBy(function(t){return t.isLink()?1:2});i.shift().remove(t),0<i.length;);return this.stopBatch("clear"),this},_prepareCell:function(t,e){var i;if(t instanceof o.Model?(i=t.attributes,t.graph||e&&e.dry||(t.graph=this)):i=t,!Ne(i.type))throw new TypeError("dia.Graph: cell type must be a string.");return t},minZIndex:function(){var t=this.get("cells").first();return t&&t.get("z")||0},maxZIndex:function(){var t=this.get("cells").last();return t&&t.get("z")||0},addCell:function(t,e){return Array.isArray(t)?this.addCells(t,e):(t instanceof o.Model?t.has("z")||t.set("z",this.maxZIndex()+1):void 0===t.z&&(t.z=this.maxZIndex()+1),this.get("cells").add(this._prepareCell(t,e),e||{}),this)},addCells:function(t,e){return 0===t.length||(t=ve(t),e.maxPosition=e.position=t.length-1,this.startBatch("add",e),t.forEach(function(t){this.addCell(t,e),e.position--},this),this.stopBatch("add",e)),this},resetCells:function(t,e){var i=pe(t).map(function(t){return this._prepareCell(t,e)},this);return this.get("cells").reset(i,e),this},removeCells:function(t,e){return t.length&&(this.startBatch("remove"),se(t,"remove",e),this.stopBatch("remove")),this},_removeCell:function(t,e,i){(i=i||{}).clear||(i.disconnectLinks?this.disconnectLinks(t,i):this.removeLinks(t,i)),this.get("cells").remove(t,{silent:!0}),t.graph===this&&(t.graph=null)},getCell:function(t){return this.get("cells").get(t)},getCells:function(){return this.get("cells").toArray()},getElements:function(){return Object.keys(this._nodes).map(this.getCell,this)},getLinks:function(){return Object.keys(this._edges).map(this.getCell,this)},getFirstCell:function(){return this.get("cells").first()},getLastCell:function(){return this.get("cells").last()},getConnectedLinks:function(t,r){var s=(r=r||{}).indirect,o=r.inbound,a=r.outbound;void 0===o&&void 0===a&&(o=a=!0);var l=[],h={};function c(n,t){if(Pe(n.getOutboundEdges(t.id),function(t,e){if(!h[e]){var i=n.getCell(e);l.push(i),h[e]=!0,s&&(o&&u(n,i),a&&c(n,i))}}.bind(n)),s&&t.isLink()){var e=t.getTargetCell();e&&e.isLink()&&(h[e.id]||(l.push(e),c(n,e)))}}function u(n,t){if(Pe(n.getInboundEdges(t.id),function(t,e){if(!h[e]){var i=n.getCell(e);l.push(i),h[e]=!0,s&&(o&&u(n,i),a&&c(n,i))}}.bind(n)),s&&t.isLink()){var e=t.getSourceCell();e&&e.isLink()&&(h[e.id]||(l.push(e),u(n,e)))}}if(a&&c(this,t),o&&u(this,t),r.deep){var e=t.getEmbeddedCells({deep:!0}),d={};e.forEach(function(t){t.isElement()&&(d[t.id]=!0)}),e.forEach(function(t){t.isLink()||(a&&Pe(this.getOutboundEdges(t.id),function(t,e){if(!h[e]){var i=this.getCell(e),n=i.source().id,s=i.target().id;if(!r.includeEnclosed&&n&&d[n]&&s&&d[s])return;l.push(this.getCell(e)),h[e]=!0}}.bind(this)),o&&Pe(this.getInboundEdges(t.id),function(t,e){if(!h[e]){var i=this.getCell(e),n=i.source().id,s=i.target().id;if(!r.includeEnclosed&&n&&d[n]&&s&&d[s])return;l.push(this.getCell(e)),h[e]=!0}}.bind(this)))},this)}return l},getNeighbors:function(a,l){var h=(l=l||{}).inbound,c=l.outbound;void 0===h&&void 0===c&&(h=c=!0);var t=this.getConnectedLinks(a,l).reduce(function(t,e){var i=e.source(),n=e.target(),s=e.hasLoop(l);if(h&&Ie(i,"id")&&!t[i.id]){var r=this.getCell(i.id);r.isElement()&&(!s&&(!r||r===a||l.deep&&r.isEmbeddedIn(a))||(t[i.id]=r))}if(c&&Ie(n,"id")&&!t[n.id]){var o=this.getCell(n.id);o.isElement()&&(!s&&(!o||o===a||l.deep&&o.isEmbeddedIn(a))||(t[n.id]=o))}return t}.bind(this),{});if(a.isLink()){if(h){var e=a.getSourceCell();e&&e.isElement()&&!t[e.id]&&(t[e.id]=e)}if(c){var i=a.getTargetCell();i&&i.isElement()&&!t[i.id]&&(t[i.id]=i)}}return pe(t)},getCommonAncestor:function(){var t=Array.from(arguments).map(function(t){for(var e=[],i=t.get("parent");i;)e.push(i),i=this.getCell(i).get("parent");return e},this);t=t.sort(function(t,e){return t.length-e.length});var e=pe(t.shift()).find(function(e){return t.every(function(t){return t.includes(e)})});return this.getCell(e)},getSuccessors:function(e,t){t=t||{};var i=[];return this.search(e,function(t){t!==e&&i.push(t)},ee({},t,{outbound:!0})),i},cloneCells:Ee,cloneSubgraph:function(t,e){var i=this.getSubgraph(t,e);return this.cloneCells(i)},getSubgraph:function(t,e){e=e||{};var r=[],o={},a=[],i=[];return pe(t).forEach(function(t){o[t.id]||(r.push(t),(o[t.id]=t).isLink()?i.push(t):a.push(t)),e.deep&&t.getEmbeddedCells({deep:!0}).forEach(function(t){o[t.id]||(r.push(t),(o[t.id]=t).isLink()?i.push(t):a.push(t))})}),i.forEach(function(t){var e=t.source(),i=t.target();if(e.id&&!o[e.id]){var n=this.getCell(e.id);r.push(n),o[n.id]=n,a.push(n)}if(i.id&&!o[i.id]){var s=this.getCell(i.id);r.push(this.getCell(i.id)),o[s.id]=s,a.push(s)}},this),a.forEach(function(t){this.getConnectedLinks(t,e).forEach(function(t){var e=t.source(),i=t.target();!o[t.id]&&e.id&&o[e.id]&&i.id&&o[i.id]&&(r.push(t),o[t.id]=t)})},this),r},getPredecessors:function(e,t){t=t||{};var i=[];return this.search(e,function(t){t!==e&&i.push(t)},ee({},t,{inbound:!0})),i},search:function(t,e,i){(i=i||{}).breadthFirst?this.bfs(t,e,i):this.dfs(t,e,i)},bfs:function(t,e,i){i=i||{};var n={},s={},r=[];for(r.push(t),s[t.id]=0;0<r.length;){var o=r.shift();if(!n[o.id]){if(!(n[o.id]=!0)===e(o,s[o.id]))return;this.getNeighbors(o,i).forEach(function(t){s[t.id]=s[o.id]+1,r.push(t)})}}},dfs:function(t,e,i,n,s){i=i||{};var r=n||{},o=s||0;!1!==e(t,o)&&(r[t.id]=!0,this.getNeighbors(t,i).forEach(function(t){r[t.id]||this.dfs(t,e,i,r,o+1)},this))},getSources:function(){var i=[];return Pe(this._nodes,function(t,e){this._in[e]&&!he(this._in[e])||i.push(this.getCell(e))}.bind(this)),i},getSinks:function(){var i=[];return Pe(this._nodes,function(t,e){this._out[e]&&!he(this._out[e])||i.push(this.getCell(e))}.bind(this)),i},isSource:function(t){return!this._in[t.id]||he(this._in[t.id])},isSink:function(t){return!this._out[t.id]||he(this._out[t.id])},isSuccessor:function(e,i){var n=!1;return this.search(e,function(t){if(t===i&&t!==e)return!(n=!0)},{outbound:!0}),n},isPredecessor:function(e,i){var n=!1;return this.search(e,function(t){if(t===i&&t!==e)return!(n=!0)},{inbound:!0}),n},isNeighbor:function(t,n,e){var s=(e=e||{}).inbound,r=e.outbound;void 0===s&&void 0===r&&(s=r=!0);var o=!1;return this.getConnectedLinks(t,e).forEach(function(t){var e=t.source(),i=t.target();return s&&Ie(e,"id")&&e.id===n.id?!(o=!0):r&&Ie(i,"id")&&i.id===n.id?!(o=!0):void 0}),o},disconnectLinks:function(e,i){this.getConnectedLinks(e).forEach(function(t){t.set(t.source().id===e.id?"source":"target",{x:0,y:0},i)})},removeLinks:function(t,e){se(this.getConnectedLinks(t),"remove",e)},findModelsFromPoint:function(e){return this.getElements().filter(function(t){return t.getBBox().containsPoint(e)})},findModelsInArea:function(e,t){e=F(e);var i=(t=ie(t||{},{strict:!1})).strict?"containsRect":"intersect";return this.getElements().filter(function(t){return e[i](t.getBBox())})},findModelsUnderElement:function(e,t){t=ie(t||{},{searchBy:"bbox"});var i=e.getBBox();return("bbox"===t.searchBy?this.findModelsInArea(i):this.findModelsFromPoint(i[t.searchBy]())).filter(function(t){return e.id!==t.id&&!t.isEmbeddedIn(e)})},getBBox:function(){return this.getCellsBBox(this.getCells())},getCellsBBox:function(t,s){return s=s||{},pe(t).reduce(function(t,e){var i=e.getBBox(s);if(!i)return t;var n=e.angle();return n&&(i=i.bbox(n)),t?t.union(i):i},null)},translate:function(t,e,i){var n=this.getCells().filter(function(t){return!t.isEmbedded()});return se(n,"translate",t,e,i),this},resize:function(t,e,i){return this.resizeCells(t,e,this.getCells(),i)},resizeCells:function(t,e,i,n){var s=this.getCellsBBox(i);if(s){var r=Math.max(t/s.width,0),o=Math.max(e/s.height,0);se(i,"scale",r,o,s.origin(),n)}return this},startBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)+1,this.trigger("batch:start",ee({},e,{batchName:t}))},stopBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)-1,this.trigger("batch:stop",ee({},e,{batchName:t}))},hasActiveBatch:function(t){return 0===arguments.length?pe(this._batches).some(function(t){return 0<t}):Array.isArray(t)?t.some(function(t){return!!this._batches[t]},this):!!this._batches[t]}},{validations:{multiLinks:function(t,e){var n=e.source(),s=e.target();if(n.id&&s.id){var i=e.getSourceCell();if(i)if(1<t.getConnectedLinks(i,{outbound:!0}).filter(function(t){var e=t.source(),i=t.target();return e&&e.id===n.id&&(!e.port||e.port===n.port)&&i&&i.id===s.id&&(!i.port||i.port===s.port)}).length)return!1}return!0},linkPinning:function(t,e){return e.source().id&&e.target().id}}});Ue(Xs.prototype,["resetCells","addCells","removeCells"],$e.cells);var Js=mi.extend({className:function(){var t=mi.prototype.className.apply(this).split(" ");return t.push("link"),t.join(" ")},options:{shortLinkLength:105,doubleLinkTools:!1,longLinkLength:155,linkToolsOffset:40,doubleLinkToolsOffset:65,sampleInterval:50},_labelCache:null,_labelSelectors:null,_markerCache:null,_V:null,_dragData:null,metrics:null,decimalsRounding:2,initialize:function(){mi.prototype.initialize.apply(this,arguments),this._labelCache={},this._labelSelectors={},this._markerCache={},this._V={},this.metrics={}},presentationAttributes:{markup:["RENDER"],attrs:["UPDATE"],router:["UPDATE"],connector:["UPDATE"],smooth:["UPDATE"],manhattan:["UPDATE"],toolMarkup:["TOOLS"],labels:["LABELS"],labelMarkup:["LABELS"],vertices:["VERTICES","UPDATE"],vertexMarkup:["VERTICES"],source:["SOURCE","UPDATE"],target:["TARGET","UPDATE"]},initFlag:["RENDER","SOURCE","TARGET"],UPDATE_PRIORITY:1,confirmUpdate:function(t,e){e=e||{};var i=this.model,n=i.attributes;if(this.hasFlag(t,"SOURCE")){if(!this.updateEndProperties("source"))return t;t=this.removeFlag(t,"SOURCE")}if(this.hasFlag(t,"TARGET")){if(!this.updateEndProperties("target"))return t;t=this.removeFlag(t,"TARGET")}var s=this.sourceView,r=this.targetView;return s&&!s.el.firstChild||r&&!r.el.firstChild?t:this.hasFlag(t,"RENDER")?(this.render(),t=this.removeFlag(t,["RENDER","UPDATE","VERTICES","TOOLS","LABELS"])):(this.hasFlag(t,"VERTICES")&&(this.renderVertexMarkers(),t=this.removeFlag(t,"VERTICES")),this.hasFlag(t,"UPDATE")?(this.update(i,null,e),t=this.removeFlag(t,["UPDATE","TOOLS","LABELS"])):(this.hasFlag(t,"TOOLS")&&(this.renderTools().updateToolsPosition(),t=this.removeFlag(t,"TOOLS")),this.hasFlag(t,"LABELS")&&(this.onLabelsChange(i,n.labels,e),t=this.removeFlag(t,"LABELS")),t))},onLabelsChange:function(t,e,i){var n=!0,s=this.model.previous("labels");if(s&&"propertyPathArray"in i&&"propertyValue"in i){var r=i.propertyPathArray||[],o=r.length;if(1<o)!!s[r[1]]&&(2===o?n="markup"in Object(i.propertyValue):"markup"!==r[2]&&(n=!1))}n?this.renderLabels():this.updateLabels(),this.updateLabelPositions()},render:function(){return this.vel.empty(),this._V={},this.renderMarkup(),this.renderLabels(),this.update(),this},renderMarkup:function(){var t=this.model,e=t.get("markup")||t.markup;if(!e)throw new Error("dia.LinkView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if("string"==typeof e)return this.renderStringMarkup(e);throw new Error("dia.LinkView: invalid markup")},renderJSONMarkup:function(t){var e=this.parseDOMJSON(t,this.el);this.selectors=e.selectors,this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=Ot(t);Array.isArray(e)||(e=[e]);for(var i=this._V,n=0,s=e.length;n<s;n++){var r=e[n],o=r.attr("class");o&&(o=ut(o),i[P.camelCase(o)]=r)}this.renderTools(),this.renderVertexMarkers(),this.renderArrowheadMarkers(),this.vel.append(e)},_getLabelMarkup:function(t){if(t){if(Array.isArray(t))return this.parseDOMJSON(t,null);if("string"==typeof t)return this._getLabelStringMarkup(t);throw new Error("dia.linkView: invalid label markup")}},_getLabelStringMarkup:function(t){var e=Ot(t),i=document.createDocumentFragment();if(Array.isArray(e))for(var n=0,s=e.length;n<s;n++){var r=e[n].node;i.appendChild(r)}else i.appendChild(e.node);return{fragment:i,selectors:{}}},_normalizeLabelMarkup:function(t){if(t){var e,i=t.fragment;if(!(t.fragment instanceof DocumentFragment&&t.fragment.hasChildNodes()))throw new Error("dia.LinkView: invalid label markup.");var n=i.childNodes;return(e=1<n.length||"G"!==n[0].nodeName.toUpperCase()?Ot("g").append(i):Ot(n[0])).addClass("label"),{node:e.node,selectors:t.selectors}}},renderLabels:function(){var t=this._V,e=t.labels,i=this._labelCache={},n=this._labelSelectors={},s=this.model,r=s.attributes.labels||[],o=r.length;if(0===o)return e&&e.remove(),this;e?e.empty():e=t.labels=Ot("g").addClass("labels");for(var a=e.node,l=0;l<o;l++){var h,c,u=r[l],d=this._normalizeLabelMarkup(this._getLabelMarkup(u.markup));if(d)h=d.node,c=d.selectors;else{var p=s._builtins.defaultLabel,g=this._normalizeLabelMarkup(this._getLabelMarkup(p.markup)),f=s._getDefaultLabel(),m=this._normalizeLabelMarkup(this._getLabelMarkup(f.markup))||g;h=m.node,c=m.selectors}h.setAttribute("label-idx",l),a.appendChild(h),i[l]=h;var v=this.selector;if(c[v])throw new Error("dia.LinkView: ambiguous label root selector.");c[v]=h,n[l]=c}return a.parentNode||this.el.appendChild(a),this.updateLabels(),this},_mergeLabelAttrs:function(t,e,i,n){return null===e?null:void 0!==e?t?Tt({},i,e):Tt({},n,i,e):null===i?null:void 0!==i?t?i:Tt({},n,i):t?void 0:n},updateLabels:function(){if(!this._V.labels)return this;for(var t=this.model,e=t.get("labels")||[],i=this.can("labelMove"),n=t._builtins.defaultLabel.attrs,s=t._getDefaultLabel(),r=s.markup,o=s.attrs,a=0,l=e.length;a<l;a++){var h=this._labelCache[a];h.setAttribute("cursor",i?"move":"default");var c=this._labelSelectors[a],u=e[a],d=u.markup,p=u.attrs,g=this._mergeLabelAttrs(d||r,p,o,n);this.updateDOMSubtreeAttributes(h,g,{rootBBox:new Q(u.size),selectors:c})}return this},renderTools:function(){if(!this._V.linkTools)return this;var t,e=P(this._V.linkTools.node).empty(),i=$t(this.model.get("toolMarkup")||this.model.toolMarkup),n=Ot(i());e.append(n.node),this._toolCache=n,this.options.doubleLinkTools&&(t=this.model.get("doubleToolMarkup")||this.model.doubleToolMarkup?(i=$t(this.model.get("doubleToolMarkup")||this.model.doubleToolMarkup),Ot(i())):n.clone(),e.append(t.node),this._tool2Cache=t);return this},renderVertexMarkers:function(){if(!this._V.markerVertices)return this;var i=P(this._V.markerVertices.node).empty(),n=$t(this.model.get("vertexMarkup")||this.model.vertexMarkup);return this.model.vertices().forEach(function(t,e){i.append(Ot(n(ee({idx:e},t))).node)}),this},renderArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;var t=P(this._V.markerArrowheads.node);t.empty();var e=$t(this.model.get("arrowheadMarkup")||this.model.arrowheadMarkup);return this._V.sourceArrowhead=Ot(e({end:"source"})),this._V.targetArrowhead=Ot(e({end:"target"})),t.append(this._V.sourceArrowhead.node,this._V.targetArrowhead.node),this},update:function(t,e,i){return i=i||{},this.cleanNodesCache(),this.updateConnection(i),this.updateDOMSubtreeAttributes(this.el,this.model.attr(),{selectors:this.selectors}),this.updateDefaultConnectionPath(),this.updateLabelPositions(),this.updateToolsPosition(),this.updateArrowheadMarkers(),this.updateTools(i),this.options.perpendicular=null,this},removeRedundantLinearVertices:function(t){for(var e=this.model,i=e.vertices(),n=[],s=i.length,r=0,o=0;o<s;o++){var a=new j(i[o]).round(),l=new j(n[r-1]||this.sourceAnchor).round();if(!l.equals(a)){var h=new j(i[o+1]||this.targetAnchor).round();if(!l.equals(h))0!==new G(l,h).pointOffset(a)&&(n.push(i[o]),r++)}}return s===r?0:(e.vertices(n,t),s-r)},updateDefaultConnectionPath:function(){var t=this._V;t.connection&&t.connection.attr("d",this.getSerializedConnection()),t.connectionWrap&&t.connectionWrap.attr("d",this.getSerializedConnection()),t.markerSource&&t.markerTarget&&this._translateAndAutoOrientArrows(t.markerSource,t.markerTarget)},getEndView:function(t){switch(t){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error("dia.LinkView: type parameter required.")}},getEndAnchor:function(t){switch(t){case"source":return new j(this.sourceAnchor);case"target":return new j(this.targetAnchor);default:throw new Error("dia.LinkView: type parameter required.")}},getEndMagnet:function(t){switch(t){case"source":var e=this.sourceView;if(!e)break;return this.sourceMagnet||e.el;case"target":var i=this.targetView;if(!i)break;return this.targetMagnet||i.el;default:throw new Error("dia.LinkView: type parameter required.")}return null},updateConnection:function(t){t=t||{};var e,i,n=this.model;if(t.translateBy&&n.isRelationshipEmbeddedIn(t.translateBy)){var s=t.tx||0,r=t.ty||0;e=new K(this.route).translate(s,r).points,this._translateConnectionPoints(s,r),(i=this.path).translate(s,r)}else{var o=n.vertices(),a=this.findAnchors(o),l=this.sourceAnchor=a.source,h=this.targetAnchor=a.target;e=this.findRoute(o,t);var c=this.findConnectionPoints(e,l,h),u=this.sourcePoint=c.source,d=this.targetPoint=c.target,p=this.findMarkerPoints(e,u,d);i=this.findPath(e,p.source||u,p.target||d)}this.route=e,this.path=i,this.metrics={}},findMarkerPoints:function(t,e,i){var n,s,r=t[0],o=t[t.length-1],a=this._markerCache;return this._V.markerSource&&(a.sourceBBox=a.sourceBBox||this._V.markerSource.getBBox(),n=j(e).move(r||i,a.sourceBBox.width*this._V.markerSource.scale().sx*-1).round()),this._V.markerTarget&&(a.targetBBox=a.targetBBox||this._V.markerTarget.getBBox(),s=j(i).move(o||e,a.targetBBox.width*this._V.markerTarget.scale().sx*-1).round()),a.sourcePoint=n||e.clone(),a.targetPoint=s||i.clone(),{source:n,target:s}},findAnchorsOrdered:function(t,e,i,n){var s,r,o,a,l=this.model,h=l.get(t),c=l.get(i),u=this.getEndView(t),d=this.getEndView(i),p=this.getEndMagnet(t),g=this.getEndMagnet(i);s=u?(o=e?new j(e):d?g:new j(c),this.getAnchor(h.anchor,u,p,o,t)):new j(h),r=d?(a=new j(n||s),this.getAnchor(c.anchor,d,g,a,i)):new j(c);var f={};return f[t]=s,f[i]=r,f},findAnchors:function(t){var e=this.model,i=t[0],n=t[t.length-1];return e.target().priority&&!e.source().priority?this.findAnchorsOrdered("target",n,"source",i):this.findAnchorsOrdered("source",i,"target",n)},findConnectionPoints:function(t,e,i){var n,s,r,o,a=t[0],l=t[t.length-1],h=this.model,c=h.get("source"),u=h.get("target"),d=this.sourceView,p=this.targetView,g=this.paper.options;if(d&&!d.isNodeConnection(this.sourceMagnet)){n=this.sourceMagnet||d.el;var f=c.connectionPoint||g.defaultConnectionPoint,m=new G(a||i,e);r=this.getConnectionPoint(f,d,n,m,"source")}else r=e;if(p&&!p.isNodeConnection(this.targetMagnet)){s=this.targetMagnet||p.el;var v=u.connectionPoint||g.defaultConnectionPoint,y=new G(l||e,i);o=this.getConnectionPoint(v,p,s,y,"target")}else o=i;return{source:r,target:o}},getAnchor:function(t,e,i,n,s){var r,o=e.isNodeConnection(i),a=this.paper.options;if(!(t=t||(o?a.defaultLinkAnchor:a.perpendicularLinks||this.options.perpendicular?{name:"perpendicular"}:a.defaultAnchor)))throw new Error("Anchor required.");if("function"==typeof t)r=t;else{var l=t.name;if("function"!=typeof(r=a[o?"linkAnchorNamespace":"anchorNamespace"][l]))throw new Error("Unknown anchor: "+l)}var h=r.call(this,e,i,n,t.args||{},s,this);return h?h.round(this.decimalsRounding):new j},getConnectionPoint:function(t,e,i,n,s){var r,o,a=n.end,l=this.paper.options;if("function"==typeof l.linkConnectionPoint){var h=i===e.el?void 0:i;if(r=l.linkConnectionPoint(this,e,h,n.start,s))return r}if(!t)return a;if("function"==typeof t)o=t;else{var c=t.name;if("function"!=typeof(o=l.connectionPointNamespace[c]))throw new Error("Unknown connection point: "+c)}return(r=o.call(this,n,e,i,t.args||{},s,this))?r.round(this.decimalsRounding):a},_translateConnectionPoints:function(t,e){var i=this._markerCache;i.sourcePoint.offset(t,e),i.targetPoint.offset(t,e),this.sourcePoint.offset(t,e),this.targetPoint.offset(t,e),this.sourceAnchor.offset(t,e),this.targetAnchor.offset(t,e)},_normalizeLabelPosition:function(t){return"number"==typeof t?{distance:t,offset:null,angle:0,args:null}:t},updateLabelPositions:function(){if(!this._V.labels)return this;if(!this.path)return this;var t=this.model,e=t.get("labels")||[];if(!e.length)return this;for(var i=t._builtins.defaultLabel.position,n=t._getDefaultLabel(),s=this._normalizeLabelPosition(n.position),r=Tt({},i,s),o=0,a=e.length;o<a;o++){var l=e[o],h=this._normalizeLabelPosition(l.position),c=Tt({},r,h),u=this._getLabelTransformationMatrix(c);this._labelCache[o].setAttribute("transform",Ot.matrixToTransformString(u))}return this},updateToolsPosition:function(){if(!this._V.linkTools)return this;var t="",e=this.options.linkToolsOffset,i=this.getConnectionLength();if(!Number.isNaN(i)){i<this.options.shortLinkLength&&(t="scale(.5)",e/=2);var n=this.getPointAtLength(e);if(this._toolCache.attr("transform","translate("+n.x+", "+n.y+") "+t),this.options.doubleLinkTools&&i>=this.options.longLinkLength){var s=this.options.doubleLinkToolsOffset||e;n=this.getPointAtLength(i-s),this._tool2Cache.attr("transform","translate("+n.x+", "+n.y+") "+t),this._tool2Cache.attr("visibility","visible")}else this.options.doubleLinkTools&&this._tool2Cache.attr("visibility","hidden")}return this},updateArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;if("none"===P.css(this._V.markerArrowheads.node,"display"))return this;var t=this.getConnectionLength()<this.options.shortLinkLength?.5:1;return this._V.sourceArrowhead.scale(t),this._V.targetArrowhead.scale(t),this._translateAndAutoOrientArrows(this._V.sourceArrowhead,this._V.targetArrowhead),this},updateEndProperties:function(t){var e=t+"View",i=t+"Magnet",n=this.model.get(t),s=n&&n.id;if(!s)return this[e]=this[i]=null,!0;var r=this.paper,o=r.getModelById(s);if(!o)throw new Error("LinkView: invalid "+t+" cell.");var a=o.findView(r);if(!a)return!1;var l=(this[e]=a).getMagnetFromLinkEnd(n);return l===a.el&&(l=null),this[i]=l,!0},_translateAndAutoOrientArrows:function(t,e){var i=pe(this.route);t&&t.translateAndAutoOrient(this.sourcePoint,i[0]||this.targetPoint,this.paper.cells),e&&e.translateAndAutoOrient(this.targetPoint,i[i.length-1]||this.sourcePoint,this.paper.cells)},_getLabelPositionAngle:function(t){return(this.model.label(t).position||{}).angle||0},_getLabelPositionArgs:function(t){return(this.model.label(t).position||{}).args},_getDefaultLabelPositionArgs:function(){return(this.model._getDefaultLabel().position||{}).args},_mergeLabelPositionArgs:function(t,e){return null===t?null:void 0===t?null===e?null:e:Tt({},e,t)},addLabel:function(t,e,i,n){var s,r,o,a=0;o="number"!=typeof t?(s=t.x,r=t.y,"number"==typeof e?(a=e,i):e):(s=t,r=e,"number"==typeof i?(a=i,n):i);var l=this._getDefaultLabelPositionArgs(),h=o,c=this._mergeLabelPositionArgs(h,l),u={position:this.getLabelPosition(s,r,a,c)};return this.model.insertLabel(-1,u,o),-1},addVertex:function(t,e,i){var n="number"!=typeof t,s=n?t.x:t,r=n?t.y:e,o=n?e:i,a={x:s,y:r},l=this.getVertexIndex(s,r);return this.model.insertVertex(l,a,o),l},sendToken:function(t,e,i){var n,s,r;r=Te(e)?(n=e.duration,s="reverse"===e.direction,e.connection):(n=e,s=!1,null);var o={dur:(n=n||1e3)+"ms",repeatCount:1,calcMode:"linear",fill:"freeze"};s&&(o.keyPoints="1;0",o.keyTimes="0;1");var a,l,h,c=Ot(t);if("string"==typeof r)a=this.findBySelector(r,this.el,this.selectors)[0];else{var u=this._V;a=u.connection?u.connection.node:this.el.querySelector("path")}if(!(a instanceof SVGPathElement))throw new Error("dia.LinkView: token animation requires a valid connection path.");c.appendTo(this.paper.cells).animateAlongPath(o,a),setTimeout((l=c,h=i,function(){l.remove(),"function"==typeof h&&h()}),n)},findRoute:function(t){t=t||[];var e=js,i=this.model.router(),n=this.paper.options.defaultRouter;if(!i){if(!n)return t.map(j);i=n}var s=ue(i)?i:e[i.name];if(!ue(s))throw new Error('dia.LinkView: unknown router: "'+i.name+'".');var r=i.args||{},o=s.call(this,t,r,this);return o||t.map(j)},findPath:function(t,e,i){var n=Zn,s=this.model.connector(),r=this.paper.options.defaultConnector,o=ue(s=s||(r||{}))?s:n[s.name];if(!ue(o))throw new Error('dia.LinkView: unknown connector: "'+s.name+'".');var a=ae(s.args||{});a.raw=!0;var l=o.call(this,e,i,t,a,this);return"string"==typeof l&&(l=new B(Ot.normalizePathData(l))),l},getConnection:function(){var t=this.path;return t?t.clone():null},getSerializedConnection:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("data"))return e.data;var i=t.serialize();return e.data=i},getConnectionSubdivisions:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("segmentSubdivisions"))return e.segmentSubdivisions;var i=t.getSegmentSubdivisions();return e.segmentSubdivisions=i},getConnectionLength:function(){var t=this.path;if(!t)return 0;var e=this.metrics;if(e.hasOwnProperty("length"))return e.length;var i=t.length({segmentSubdivisions:this.getConnectionSubdivisions()});return e.length=i},getPointAtLength:function(t){var e=this.path;return e?e.pointAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getPointAtRatio:function(t){var e=this.path;return e?(Wt(t)&&(t=parseFloat(t)/100),e.pointAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()})):null},getTangentAtLength:function(t){var e=this.path;return e?e.tangentAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getTangentAtRatio:function(t){var e=this.path;return e?e.tangentAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPoint:function(t){var e=this.path;return e?e.closestPoint(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointLength:function(t){var e=this.path;return e?e.closestPointLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointRatio:function(t){var e=this.path;return e?e.closestPointNormalizedLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getLabelPosition:function(t,e,i,n){var s,r={},o=0;(s="number"==typeof i?(o=i,n):i)&&(r.args=s);var a,l,h=!(s&&s.absoluteDistance),c=s&&s.absoluteDistance&&s.reverseDistance,u=s&&s.absoluteOffset,d=this.path,p={segmentSubdivisions:this.getConnectionSubdivisions()},g=new j(t,e),f=d.closestPointT(g,p),m=d.lengthAtT(f,p);if(h&&(m=m/this.getConnectionLength()||0),c&&(m=-1*(this.getConnectionLength()-m)||1),r.distance=m,u||(a=d.tangentAtT(f)),a)l=a.pointOffset(g);else{var v=d.pointAtT(f),y=g.difference(v);l={x:y.x,y:y.y}}return r.offset=l,r.angle=o,r},_getLabelTransformationMatrix:function(t){var e,i=0,n={};if("number"==typeof t)e=t;else{if("number"!=typeof t.distance)throw new Error("dia.LinkView: invalid label position distance.");n=t.args||{},e=t.distance,i=t.angle||0}var s=0<e&&e<=1,r=0,o={x:0,y:0};if(t.offset){var a=t.offset;"number"==typeof a&&(r=a),a.x&&(o.x=a.x),a.y&&(o.y=a.y)}var l,h=0!==o.x||0!==o.y||0===r,c=n.keepGradient,u=n.ensureLegibility,d=this.path,p={segmentSubdivisions:this.getConnectionSubdivisions()},g=s?e*this.getConnectionLength():e,f=d.tangentAtLength(g,p),m=i;if(f){if(h)(l=f.start).offset(o);else{var v=f.clone();v.rotate(f.start,-90),v.setLength(r),l=v.end}c&&(m=f.angle()+i,u&&(m=q((m+90)%180-90)))}else l=d.start,h&&l.offset(o);return Ot.createSVGMatrix().translate(l.x,l.y).rotate(m)},getLabelCoordinates:function(t){var e=this._getLabelTransformationMatrix(t);return new j(e.e,e.f)},getVertexIndex:function(t,e){for(var i=this.model.vertices(),n=this.getClosestPointLength(new j(t,e)),s=0,r=i.length;s<r;s++){var o=i[s];if(n<this.getClosestPointLength(o))break}return s},notifyPointerdown:function(t,e,i){mi.prototype.pointerdown.call(this,t,e,i),this.notify("link:pointerdown",t,e,i)},notifyPointermove:function(t,e,i){mi.prototype.pointermove.call(this,t,e,i),this.notify("link:pointermove",t,e,i)},notifyPointerup:function(t,e,i){this.notify("link:pointerup",t,e,i),mi.prototype.pointerup.call(this,t,e,i)},pointerdblclick:function(t,e,i){mi.prototype.pointerdblclick.apply(this,arguments),this.notify("link:pointerdblclick",t,e,i)},pointerclick:function(t,e,i){mi.prototype.pointerclick.apply(this,arguments),this.notify("link:pointerclick",t,e,i)},contextmenu:function(t,e,i){mi.prototype.contextmenu.apply(this,arguments),this.notify("link:contextmenu",t,e,i)},pointerdown:function(t,e,i){switch(this.notifyPointerdown(t,e,i),t.target.getAttribute("class")){case"marker-vertex":return void this.dragVertexStart(t,e,i);case"marker-vertex-remove":case"marker-vertex-remove-area":return void this.dragVertexRemoveStart(t,e,i);case"marker-arrowhead":return void this.dragArrowheadStart(t,e,i);case"connection":case"connection-wrap":return void this.dragConnectionStart(t,e,i);case"marker-source":case"marker-target":return}this.dragStart(t,e,i)},pointermove:function(t,e,i){var n=this._dragData;switch(n&&this.eventData(t,n),this.eventData(t).action){case"vertex-move":this.dragVertex(t,e,i);break;case"label-move":this.dragLabel(t,e,i);break;case"arrowhead-move":this.dragArrowhead(t,e,i);break;case"move":this.drag(t,e,i)}n&&ee(n,this.eventData(t)),this.notifyPointermove(t,e,i)},pointerup:function(t,e,i){var n=this._dragData;switch(n&&(this.eventData(t,n),this._dragData=null),this.eventData(t).action){case"vertex-move":this.dragVertexEnd(t,e,i);break;case"label-move":this.dragLabelEnd(t,e,i);break;case"arrowhead-move":this.dragArrowheadEnd(t,e,i);break;case"move":this.dragEnd(t,e,i)}this.notifyPointerup(t,e,i),this.checkMouseleave(t)},mouseover:function(t){mi.prototype.mouseover.apply(this,arguments),this.notify("link:mouseover",t)},mouseout:function(t){mi.prototype.mouseout.apply(this,arguments),this.notify("link:mouseout",t)},mouseenter:function(t){mi.prototype.mouseenter.apply(this,arguments),this.notify("link:mouseenter",t)},mouseleave:function(t){mi.prototype.mouseleave.apply(this,arguments),this.notify("link:mouseleave",t)},mousewheel:function(t,e,i,n){mi.prototype.mousewheel.apply(this,arguments),this.notify("link:mousewheel",t,e,i,n)},onevent:function(t,e,i,n){if(Ot(t.target).findParentByClass("link-tool",this.el)){if(t.stopPropagation(),this.can("useLinkTools")){if("remove"===e)return void this.model.remove({ui:!0});this.notify(e,t,i,n)}this.notifyPointerdown(t,i,n)}else mi.prototype.onevent.apply(this,arguments)},onlabel:function(t,e,i){this.notifyPointerdown(t,e,i),this.dragLabelStart(t,e,i),this.eventData(t).stopPropagation&&t.stopPropagation()},dragConnectionStart:function(t,e,i){if(this.can("vertexAdd")){var n=this.addVertex({x:e,y:i},{ui:!0});this.eventData(t,{action:"vertex-move",vertexIdx:n})}},dragLabelStart:function(t,e,i){if(this.can("labelMove")){var n=t.currentTarget,s=parseInt(n.getAttribute("label-idx"),10),r=this._getLabelPositionAngle(s),o=this._getLabelPositionArgs(s),a=this._getDefaultLabelPositionArgs(),l=this._mergeLabelPositionArgs(o,a);this.eventData(t,{action:"label-move",labelIdx:s,positionAngle:r,positionArgs:l,stopPropagation:!0}),this.paper.delegateDragEvents(this,t.data)}else this.eventData(t,{stopPropagation:!0})},dragVertexStart:function(t,e,i){if(this.can("vertexMove")){var n=t.target,s=parseInt(n.getAttribute("idx"),10);this.eventData(t,{action:"vertex-move",vertexIdx:s})}},dragVertexRemoveStart:function(t,e,i){if(this.can("vertexRemove")){var n=t.target,s=parseInt(n.getAttribute("idx"),10);this.model.removeVertex(s)}},dragArrowheadStart:function(t,e,i){if(this.can("arrowheadMove")){var n=t.target.getAttribute("end"),s=this.startArrowheadMove(n,{ignoreBackwardsCompatibility:!0});this.eventData(t,s)}},dragStart:function(t,e,i){this.can("linkMove")&&this.eventData(t,{action:"move",dx:e,dy:i})},dragLabel:function(t,e,i){var n=this.eventData(t),s={position:this.getLabelPosition(e,i,n.positionAngle,n.positionArgs)};this.model.label(n.labelIdx,s)},dragVertex:function(t,e,i){var n=this.eventData(t);this.model.vertex(n.vertexIdx,{x:e,y:i},{ui:!0})},dragArrowhead:function(t,e,i){var n=this.eventData(t);this.paper.options.snapLinks?this._snapArrowhead(e,i,n):this._connectArrowhead(this.getEventTarget(t),e,i,n)},drag:function(t,e,i){var n=this.eventData(t);this.model.translate(e-n.dx,i-n.dy,{ui:!0}),this.eventData(t,{dx:e,dy:i})},dragLabelEnd:function(){},dragVertexEnd:function(){},dragArrowheadEnd:function(t,e,i){var n=this.eventData(t),s=this.paper;s.options.snapLinks?this._snapArrowheadEnd(n):this._connectArrowheadEnd(n,e,i),s.linkAllowed(this)?(this._finishEmbedding(n),this._notifyConnectEvent(n,t)):this._disallow(n),this._afterArrowheadMove(n)},dragEnd:function(){},_disallow:function(t){switch(t.whenNotAllowed){case"remove":this.model.remove({ui:!0});break;case"revert":default:this.model.set(t.arrowhead,t.initialEnd,{ui:!0})}},_finishEmbedding:function(t){this.paper.options.embeddingMode&&this.model.reparent()&&(t.z=null)},_notifyConnectEvent:function(t,e){var i=t.arrowhead,n=t.initialEnd,s=this.model.prop(i);if(s&&!Li.endsEqual(n,s)){var r=this.paper;n.id&&this.notify("link:disconnect",e,r.findViewByModel(n.id),t.initialMagnet,i),s.id&&this.notify("link:connect",e,r.findViewByModel(s.id),t.magnetUnderPointer,i)}},_snapArrowhead:function(t,e,s){var r,o=this.paper.options.snapLinks.radius||50,i=this.paper.findViewsInArea({x:t-o,y:e-o,width:2*o,height:2*o}),n=s.closestView||null,a=s.closestMagnet||null;s.closestView=s.closestMagnet=null;var l,h=Number.MAX_VALUE,c=j(t,e),u=this.paper;i.forEach(function(n){"false"!==n.el.getAttribute("magnet")&&(r=n.model.getBBox().center().distance(c))<o&&r<h&&(a!==n.el&&!u.options.validateConnection.apply(u,s.validateConnectionArgs(n,null))||(h=r,s.closestView=n,s.closestMagnet=n.el)),n.$("[magnet]").each(function(t,e){var i=n.getNodeBBox(e);(r=c.distance({x:i.x+i.width/2,y:i.y+i.height/2}))<o&&r<h&&(a!==e&&!u.options.validateConnection.apply(u,s.validateConnectionArgs(n,e))||(h=r,s.closestView=n,s.closestMagnet=e))}.bind(this))},this);var d=s.closestView,p=s.closestMagnet,g=s.arrowhead,f=a!==p;if(n&&f&&n.unhighlight(a,{connecting:!0,snapping:!0}),d){if(!f)return;d.highlight(p,{connecting:!0,snapping:!0}),l=d.getLinkEnd(p,t,e,this.model,g)}else l={x:t,y:e};this.model.set(g,l||{x:t,y:e},{ui:!0})},_snapArrowheadEnd:function(t){var e=t.closestView,i=t.closestMagnet;e&&i&&(e.unhighlight(i,{connecting:!0,snapping:!0}),t.magnetUnderPointer=e.findMagnet(i)),t.closestView=t.closestMagnet=null},_connectArrowhead:function(t,e,i,n){n.eventTarget!==t&&(n.magnetUnderPointer&&n.viewUnderPointer.unhighlight(n.magnetUnderPointer,{connecting:!0}),n.viewUnderPointer=this.paper.findView(t),n.viewUnderPointer?(n.magnetUnderPointer=n.viewUnderPointer.findMagnet(t),n.magnetUnderPointer&&this.paper.options.validateConnection.apply(this.paper,n.validateConnectionArgs(n.viewUnderPointer,n.magnetUnderPointer))?n.magnetUnderPointer&&n.viewUnderPointer.highlight(n.magnetUnderPointer,{connecting:!0}):n.magnetUnderPointer=null):n.magnetUnderPointer=null),n.eventTarget=t,this.model.set(n.arrowhead,{x:e,y:i},{ui:!0})},_connectArrowheadEnd:function(t,e,i){var n=t.viewUnderPointer,s=t.magnetUnderPointer;if(s&&n){n.unhighlight(s,{connecting:!0});var r=t.arrowhead,o=n.getLinkEnd(s,e,i,this.model,r);this.model.set(r,o,{ui:!0})}},_beforeArrowheadMove:function(t){t.z=this.model.get("z"),this.model.toFront();var e=this.el.style;t.pointerEvents=e.pointerEvents,e.pointerEvents="none",this.paper.options.markAvailable&&this._markAvailableMagnets(t)},_afterArrowheadMove:function(t){null!==t.z&&(this.model.set("z",t.z,{ui:!0}),t.z=null),this.el.style.pointerEvents=t.pointerEvents,this.paper.options.markAvailable&&this._unmarkAvailableMagnets(t)},_createValidateConnectionArgs:function(t){var e,i=[];i[4]=t,i[5]=this;var n=0,s=0;e="source"===t?(n=2,"target"):(s=2,"source");var r=this.model.get(e);if(r.id){var o=i[n]=this.paper.findViewByModel(r.id),a=o.getMagnetFromLinkEnd(r);a===o.el&&(a=void 0),i[n+1]=a}return function(t,e){return i[s]=t,i[s+1]=t.el===e?void 0:e,i}},_markAvailableMagnets:function(t){function e(t,e){var i=t.paper;return i.options.validateConnection.apply(i,this.validateConnectionArgs(t,e))}var i=this.paper,n=i.model.getCells();t.marked={};for(var s=0,r=n.length;s<r;s++){var o=n[s].findView(i);if(o){var a=Array.prototype.slice.call(o.el.querySelectorAll("[magnet]"));"false"!==o.el.getAttribute("magnet")&&a.push(o.el);var l=a.filter(e.bind(t,o));if(0<l.length){for(var h=0,c=l.length;h<c;h++)o.highlight(l[h],{magnetAvailability:!0});o.highlight(null,{elementAvailability:!0}),t.marked[o.model.id]=l}}}},_unmarkAvailableMagnets:function(t){for(var e,i,n=Object.keys(t.marked),s=0,r=n.length;s<r;s++){e=n[s],i=t.marked[e];var o=this.paper.findViewByModel(e);if(o){for(var a=0,l=i.length;a<l;a++)o.unhighlight(i[a],{magnetAvailability:!0});o.unhighlight(null,{elementAvailability:!0})}}t.marked=null},startArrowheadMove:function(t,e){var i={action:"arrowhead-move",arrowhead:t,whenNotAllowed:(e=e||{}).whenNotAllowed||"revert",initialMagnet:this[t+"Magnet"]||(this[t+"View"]?this[t+"View"].el:null),initialEnd:ae(this.model.get(t)),validateConnectionArgs:this._createValidateConnectionArgs(t)};return this._beforeArrowheadMove(i),!0!==e.ignoreBackwardsCompatibility&&(this._dragData=i),i}});Object.defineProperty(Js.prototype,"sourceBBox",{enumerable:!0,get:function(){var t=this.sourceView;if(!t){var e=this.model.source();return new Q(e.x,e.y)}var i=this.sourceMagnet;return t.isNodeConnection(i)?new Q(this.sourceAnchor):t.getNodeBBox(i||t.el)}}),Object.defineProperty(Js.prototype,"targetBBox",{enumerable:!0,get:function(){var t=this.targetView;if(!t){var e=this.model.target();return new Q(e.x,e.y)}var i=this.targetMagnet;return t.isNodeConnection(i)?new Q(this.targetAnchor):t.getNodeBBox(i||t.el)}});var $s={NONE:"sorting-none",APPROX:"sorting-approximate",EXACT:"sorting-exact"},Ks=1<<30,Qs=gi.extend({className:"paper",options:{width:800,height:600,origin:{x:0,y:0},gridSize:1,drawGrid:!1,background:!1,perpendicularLinks:!1,elementView:vi,linkView:Js,snapLinks:!1,multiLinks:!0,guard:function(t,e){return!1},highlighting:{default:{name:"stroke",options:{padding:3}},magnetAvailability:{name:"addClass",options:{className:"available-magnet"}},elementAvailability:{name:"addClass",options:{className:"available-cell"}}},preventContextMenu:!0,preventDefaultBlankAction:!0,restrictTranslate:!1,markAvailable:!1,defaultLink:new Li,defaultConnector:{name:"normal"},defaultRouter:{name:"normal"},defaultAnchor:{name:"center"},defaultLinkAnchor:{name:"connectionRatio"},defaultConnectionPoint:{name:"bbox"},connectionStrategy:null,validateMagnet:function(t,e){return"passive"!==e.getAttribute("magnet")},validateConnection:function(t,e,i,n,s,r){return("target"===s?i:t)instanceof vi},embeddingMode:!1,validateEmbedding:function(t,e){return!0},findParentBy:"bbox",frontParentOnly:!0,interactive:{labelMove:!1},linkPinning:!0,allowLink:null,clickThreshold:0,moveThreshold:0,magnetThreshold:0,sorting:$s.EXACT,frozen:!1,onViewUpdate:function(t,e,i,n){e&Ks||i.mounting||n.requestConnectedLinksUpdate(t,i)},onViewPostponed:function(t,e){return this.forcePostponedViewUpdate(t,e)},viewport:null,cellViewNamespace:null,highlighterNamespace:Wn,anchorNamespace:Fs,linkAnchorNamespace:Ys,connectionPointNamespace:Jn},events:{dblclick:"pointerdblclick",contextmenu:"contextmenu",mousedown:"pointerdown",touchstart:"pointerdown",mouseover:"mouseover",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousewheel:"mousewheel",DOMMouseScroll:"mousewheel","mouseenter .joint-cell":"mouseenter","mouseleave .joint-cell":"mouseleave","mouseenter .joint-tools":"mouseenter","mouseleave .joint-tools":"mouseleave","mousedown .joint-cell [event]":"onevent","touchstart .joint-cell [event]":"onevent","mousedown .joint-cell [magnet]":"onmagnet","touchstart .joint-cell [magnet]":"onmagnet","dblclick .joint-cell [magnet]":"magnetpointerdblclick","contextmenu .joint-cell [magnet]":"magnetcontextmenu","mousedown .joint-link .label":"onlabel","touchstart .joint-link .label":"onlabel","dragstart .joint-cell image":"onImageDragStart"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup",touchcancel:"pointerup"},svg:null,viewport:null,defs:null,tools:null,$background:null,layers:null,$grid:null,$document:null,_highlights:null,_zPivots:null,_viewportMatrix:null,_viewportTransformString:null,_updates:null,SORT_DELAYING_BATCHES:["add","to-front","to-back"],UPDATE_DELAYING_BATCHES:["translate"],MIN_SCALE:1e-6,init:function(){var t=this.options,e=this.el;t.cellViewNamespace||(t.cellViewNamespace="undefined"!=typeof joint&&Ie(joint,"shapes")?joint.shapes:null);var i=this.model=t.model||new Xs;this.setGrid(t.drawGrid),this.cloneOptions(),this.render(),this.setDimensions(),this.startListening(),this._views={},this._zPivots={},this.$document=P(e.ownerDocument),this._highlights={},this.resetViews(i.attributes.cells.models),!this.isFrozen()&&this.isAsync()&&this.updateViewsAsync()},_resetUpdates:function(){return this._updates={id:null,priorities:[{},{},{}],unmountedCids:[],mountedCids:[],unmounted:{},mounted:{},count:0,keyFrozen:!1,freezeKey:null,sort:!1}},startListening:function(){var t=this.model;this.listenTo(t,"add",this.onCellAdded).listenTo(t,"remove",this.onCellRemoved).listenTo(t,"change",this.onCellChange).listenTo(t,"reset",this.onGraphReset).listenTo(t,"sort",this.onGraphSort).listenTo(t,"batch:stop",this.onGraphBatchStop),this.on("cell:highlight",this.onCellHighlight).on("cell:unhighlight",this.onCellUnhighlight).on("scale translate",this.update)},onCellAdded:function(t,e,i){var n=i.position;this.isAsync()||!Dt(n)?this.renderView(t,i):(i.maxPosition===n&&this.freeze({key:"addCells"}),this.renderView(t,i),0===n&&this.unfreeze({key:"addCells"}))},onCellRemoved:function(t){this.requestViewUpdate(this.findViewByModel(t),1<<29,0)},onCellChange:function(t){if(t!==this.model.attributes.cells&&t.hasChanged("z")&&this.options.sorting===$s.APPROX){var e=this.findViewByModel(t);e&&this.requestViewUpdate(e,Ks,e.UPDATE_PRIORITY)}},onGraphReset:function(t,e){this.removeZPivots(),this.resetViews(t.models,e)},onGraphSort:function(){this.model.hasActiveBatch(this.SORT_DELAYING_BATCHES)||this.sortViews()},onGraphBatchStop:function(t){if(!this.isFrozen()){var e=t&&t.batchName,i=this.model;if(!this.isAsync()){var n=this.UPDATE_DELAYING_BATCHES;n.includes(e)&&!i.hasActiveBatch(n)&&this.updateViews(t)}var s=this.SORT_DELAYING_BATCHES;s.includes(e)&&!i.hasActiveBatch(s)&&this.sortViews()}},cloneOptions:function(){var t=this.options;t.origin=ee({},t.origin),t.defaultConnector=ee({},t.defaultConnector),t.highlighting=ne({},t.highlighting,this.constructor.prototype.options.highlighting),!t.cellViewNamespace&&"undefined"!=typeof joint&&Ie(joint,"shapes")&&(t.cellViewNamespace=joint.shapes)},children:function(){var t=Ot.namespace;return[{namespaceURI:t.xhtml,tagName:"div",className:ct("paper-background"),selector:"background"},{namespaceURI:t.xhtml,tagName:"div",className:ct("paper-grid"),selector:"grid"},{namespaceURI:t.svg,tagName:"svg",attributes:{width:"100%",height:"100%","xmlns:xlink":t.xlink},selector:"svg",children:[{tagName:"defs",selector:"defs"},{tagName:"g",className:ct("layers"),selector:"layers",children:[{tagName:"g",className:ct("cells-layer viewport"),selector:"cells"},{tagName:"g",className:ct("tools-layer"),selector:"tools"}]}]}]},render:function(){this.renderChildren();var t=this.childNodes,e=this.options,i=t.svg,n=t.cells,s=t.defs,r=t.tools,o=t.layers,a=t.background,l=t.grid;return this.svg=i,this.defs=s,this.tools=r,this.cells=n,this.layers=o,this.$background=P(a),this.$grid=P(l),this.viewport=n,e.background&&this.drawBackground(e.background),e.drawGrid&&this.drawGrid(),this},update:function(){return this.options.drawGrid&&this.drawGrid(),this._background&&this.updateBackgroundImage(this._background),this},matrix:function(t){var e=this.layers;if(void 0===t){var i=e.getAttribute("transform");return(this._viewportTransformString||null)===i?t=this._viewportMatrix:(t=e.getCTM(),this._viewportMatrix=t,this._viewportTransformString=i),Ot.createSVGMatrix(t)}t=Ot.createSVGMatrix(t);var n=Ot.matrixToTransformString(t);return e.setAttribute("transform",n),this._viewportMatrix=t,this._viewportTransformString=e.getAttribute("transform"),this},clientMatrix:function(){return Ot.createSVGMatrix(this.cells.getScreenCTM())},requestConnectedLinksUpdate:function(t,e){if(t instanceof mi)for(var i=t.model,n=this.model.getConnectedLinks(i),s=0,r=n.length;s<r;s++){var o=n[s],a=this.findViewByModel(o);if(a){var l=["UPDATE"];o.getTargetCell()===i&&l.push("TARGET"),o.getSourceCell()===i&&l.push("SOURCE"),this.scheduleViewUpdate(a,a.getFlag(l),a.UPDATE_PRIORITY,e)}}},forcePostponedViewUpdate:function(t,e){if(!(t&&t instanceof mi))return!1;var i=t.model;if(i.isElement())return!1;if(0!=(e&t.getFlag(["SOURCE","TARGET"])))return!1;var n=this.findViewByModel(i.getSourceCell()),s=this.dumpView(n),r=this.findViewByModel(i.getTargetCell()),o=this.dumpView(r);return 0===s&&0===o},requestViewUpdate:function(t,e,i,n){n=n||{},this.scheduleViewUpdate(t,e,i,n);var s=this.isAsync();if(!(this.isFrozen()||s&&!1!==n.async||this.model.hasActiveBatch(this.UPDATE_DELAYING_BATCHES))){var r=this.updateViews(n);s&&this.trigger("render:done",r,n)}},scheduleViewUpdate:function(t,e,i,n){var s=this._updates,r=s.priorities[i],o=(r=r||(s.priorities[i]={}))[t.cid]||0;if((o&e)!==e){o||s.count++,e&1<<29&&o&Ks?r[t.cid]^=Ks:e&Ks&&o&1<<29&&(r[t.cid]^=1<<29),r[t.cid]|=e;var a=this.options.onViewUpdate;"function"==typeof a&&a.call(this,t,e,n||{},this)}},dumpViewUpdate:function(t){if(!t)return 0;var e=this._updates,i=t.cid,n=e.priorities[t.UPDATE_PRIORITY],s=this.registerMountedView(t)|n[i];return delete n[i],s},dumpView:function(t,e){var i=this.dumpViewUpdate(t);return i?this.updateView(t,i,e):0},updateView:function(t,e,i){if(!t)return 0;if(t instanceof mi){if(e&1<<29)return this.removeView(t.model),0;e&Ks&&(this.insertView(t),e^=Ks)}return e?t.confirmUpdate(e,i||{}):0},requireView:function(t,e){var i=this.findViewByModel(t);return i?(this.dumpView(i,e),i):null},registerUnmountedView:function(t){var e=t.cid,i=this._updates;if(e in i.unmounted)return 0;var n=i.unmounted[e]|=Ks;return i.unmountedCids.push(e),delete i.mounted[e],n},registerMountedView:function(t){var e=t.cid,i=this._updates;if(e in i.mounted)return 0;i.mounted[e]=!0,i.mountedCids.push(e);var n=i.unmounted[e]||0;return delete i.unmounted[e],n},dumpViews:function(t){var e=ie({},t,{viewport:null});this.checkViewport(e),this.updateViews(e)},updateViews:function(t){for(var e,i=0,n=0,s=2;n++,i+=(e=this.updateViewsBatch(t)).updated,s=Math.min(e.priority,s),!e.empty;);return{updated:i,batches:n,priority:s}},updateViewsAsync:function(t,e){t=t||{},e=e||{processed:0,priority:2};var i=this._updates,n=i.id;if(n){Zt(n);var s=this.updateViewsBatch(t),r=ie({},t,{mountBatchSize:1e3-s.mounted,unmountBatchSize:1e3-s.unmounted}),o=this.checkViewport(r),a=o.unmounted,l=o.mounted,h=e.processed,c=i.count;0<s.updated&&(h+=s.updated+s.unmounted,s.processed=h,e.priority=Math.min(s.priority,e.priority),s.empty&&0===l?(s.unmounted+=a,s.mounted+=l,s.priority=e.priority,this.trigger("render:done",s,t),e.processed=0,i.count=0):e.processed=h);var u=t.progress;if(c&&"function"==typeof u&&u.call(this,s.empty,h,c,s,this),i.id!==n)return}i.id=Vt(this.updateViewsAsync,this,t,e)},updateViewsBatch:function(t){var e=(t=t||{}).batchSize||1/0,i=this._updates,n=0,s=0,r=0,o=0,a=2,l=!0,h=this.options,c=i.priorities,u="viewport"in t?t.viewport:h.viewport;"function"!=typeof u&&(u=null);var d=h.onViewPostponed;"function"!=typeof d&&(d=null);t:for(var p=0,g=c.length;p<g;p++){var f=c[p];for(var m in f){if(e<=n){l=!1;break t}var v=pi[m];if(v){var y=f[m],b=m in i.unmounted;if(!u||u.call(this,v,b,this)){b&&(y|=Ks,o++),y|=this.registerMountedView(v);var w=this.updateView(v,y,t);0<w?(f[m]=w,s++,d&&d.call(this,v,w,this)&&(l=!1)):(p<a&&(a=p),n++,delete f[m])}else b||(this.registerUnmountedView(v),v.unmount()),i.unmounted[m]|=y,delete f[m],r++}else delete f[m]}}return{priority:a,updated:n,postponed:s,unmounted:r,mounted:o,empty:l}},checkUnmountedViews:function(t,e){var i=0;"function"!=typeof t&&(t=null);for(var n=("mountBatchSize"in(e=e||{})?e.mountBatchSize:1/0),s=this._updates,r=s.unmountedCids,o=s.unmounted,a=0,l=Math.min(r.length,n);a<l;a++){var h=r[a];if(h in o){var c=pi[h];if(c)if(!t||t.call(this,c,!0,this)){i++;var u=this.registerMountedView(c);u&&this.scheduleViewUpdate(c,u,c.UPDATE_PRIORITY,{mounting:!0})}else r.push(h)}}return r.splice(0,a),i},checkMountedViews:function(t,e){var i=0;if("function"!=typeof t)return i;for(var n=("unmountBatchSize"in(e=e||{})?e.unmountBatchSize:1/0),s=this._updates,r=s.mountedCids,o=s.mounted,a=0,l=Math.min(r.length,n);a<l;a++){var h=r[a];if(h in o){var c=pi[h];if(c)if(t.call(this,c,!0))r.push(h);else i++,this.registerUnmountedView(c)&&c.unmount()}}return r.splice(0,a),i},checkViewport:function(t){var e=ie({},t,{mountBatchSize:1/0,unmountBatchSize:1/0}),i="viewport"in e?e.viewport:this.options.viewport,n=this.checkMountedViews(i,e);if(0<n){var s=this._updates.unmountedCids;e.mountBatchSize=Math.min(s.length-n,e.mountBatchSize)}return{mounted:this.checkUnmountedViews(i,e),unmounted:n}},freeze:function(t){t=t||{};var e=this._updates,i=t.key,n=this.options.frozen,s=e.freezeKey;if(i&&i!==s){if(n&&s)return;e.freezeKey=i,e.keyFrozen=n}this.options.frozen=!0;var r=e.id;e.id=null,this.isAsync()&&r&&Zt(r)},unfreeze:function(t){t=t||{};var e=this._updates,i=t.key,n=e.freezeKey;i&&n&&i!==n||(e.freezeKey=null,i&&i===n&&e.keyFrozen||(this.isAsync()?(this.freeze(),this.updateViewsAsync(t)):this.updateViews(t),this.options.frozen=e.keyFrozen=!1,e.sort&&(this.sortViews(),e.sort=!1)))},isAsync:function(){return!!this.options.async},isFrozen:function(){return!!this.options.frozen},isExactSorting:function(){return this.options.sorting===$s.EXACT},onRemove:function(){this.freeze(),this.removeViews()},getComputedSize:function(){var t=this.options,e=t.width,i=t.height;return Dt(e)||(e=this.el.clientWidth),Dt(i)||(i=this.el.clientHeight),{width:e,height:i}},setDimensions:function(t,e){var i=this.options,n=void 0===t?i.width:t,s=void 0===e?i.height:e;this.options.width=n,this.options.height=s,Dt(n)&&(n=Math.round(n)),Dt(s)&&(s=Math.round(s)),this.$el.css({width:null===n?"":n,height:null===s?"":s});var r=this.getComputedSize();this.trigger("resize",r.width,r.height)},setOrigin:function(t,e){return this.translate(t||0,e||0,{absolute:!0})},fitToContent:function(t,e,i,n){i=Te(t)?(t=(n=t).gridWidth||1,e=n.gridHeight||1,n.padding||0):(n=n||{},t=t||1,e=e||1,i||0),i=Ht(i);var s="contentArea"in n?new Q(n.contentArea):this.getContentArea(n),r=this.scale(),o=this.translate(),a=r.sx,l=r.sy;s.x*=a,s.y*=l,s.width*=a,s.height*=l;var h=Math.max(Math.ceil((s.width+s.x)/t),1)*t,c=Math.max(Math.ceil((s.height+s.y)/e),1)*e,u=0,d=0;("negative"==n.allowNewOrigin&&s.x<0||"positive"==n.allowNewOrigin&&0<=s.x||"any"==n.allowNewOrigin)&&(u=Math.ceil(-s.x/t)*t,h+=u+=i.left),("negative"==n.allowNewOrigin&&s.y<0||"positive"==n.allowNewOrigin&&0<=s.y||"any"==n.allowNewOrigin)&&(d=Math.ceil(-s.y/e)*e,c+=d+=i.top),h+=i.right,c+=i.bottom,h=Math.max(h,n.minWidth||0),c=Math.max(c,n.minHeight||0),h=Math.min(h,n.maxWidth||Number.MAX_VALUE),c=Math.min(c,n.maxHeight||Number.MAX_VALUE);var p=this.getComputedSize(),g=h!=p.width||c!=p.height;return(u!=o.tx||d!=o.ty)&&this.translate(u,d),g&&this.setDimensions(h,c),new Q(-u/a,-d/l,h/a,c/l)},scaleContentToFit:function(t){var e,i;if("contentArea"in(t=t||{})){var n=t.contentArea;e=this.localToPaperRect(n),i=new j(n)}else e=this.getContentBBox(t),i=this.paperToLocalPoint(e);if(e.width&&e.height){ie(t,{padding:0,preserveAspectRatio:!0,scaleGrid:null,minScale:0,maxScale:Number.MAX_VALUE});var s,r=t.padding,o=t.minScaleX||t.minScale,a=t.maxScaleX||t.maxScale,l=t.minScaleY||t.minScale,h=t.maxScaleY||t.maxScale;if(t.fittingBBox)s=t.fittingBBox;else{var c=this.translate(),u=this.getComputedSize();s={x:c.tx,y:c.ty,width:u.width,height:u.height}}s=new Q(s).inflate(-r);var d=this.scale(),p=s.width/e.width*d.sx,g=s.height/e.height*d.sy;if(t.preserveAspectRatio&&(p=g=Math.min(p,g)),t.scaleGrid){var f=t.scaleGrid;p=f*Math.floor(p/f),g=f*Math.floor(g/f)}p=Math.min(a,Math.max(o,p)),g=Math.min(h,Math.max(l,g));var m=this.options.origin,v=s.x-i.x*p-m.x,y=s.y-i.y*g-m.y;this.scale(p,g),this.translate(v,y)}},getContentArea:function(t){if(t&&t.useModelGeometry){var e=this.model;return e.getCellsBBox(e.getCells(),{includeLinks:!0})||new Q}return Ot(this.cells).getBBox()},getContentBBox:function(t){return this.localToPaperRect(this.getContentArea(t))},getArea:function(){return this.paperToLocalRect(this.getComputedSize())},getRestrictedArea:function(){return ue(this.options.restrictTranslate)?this.options.restrictTranslate.apply(this,arguments):!0===this.options.restrictTranslate?this.getArea():this.options.restrictTranslate||null},createViewForModel:function(t){var e,i,n=this.options.cellViewNamespace,s=t.get("type")+"View",r=gt(n,s,".");return i=t.isLink()?(e=this.options.linkView,Js):(e=this.options.elementView,vi),new(e.prototype instanceof o.View?r||e:e.call(this,t)||r||i)({model:t,interactive:this.options.interactive})},removeView:function(t){var e=t.id,i=this._views[e];return i&&(i.remove(),delete this._views[e]),i},renderView:function(t,e){var i,n,s=t.id,r=this._views;return n=s in r?(i=r[s],Ks):((i=r[t.id]=this.createViewForModel(t)).paper=this,Ks|i.getFlag(i.initFlag)),this.requestViewUpdate(i,n,i.UPDATE_PRIORITY,e),i},onImageDragStart:function(){return!1},resetViews:function(t,e){e=e||{},t=t||[],this._resetUpdates(),this.removeViews(),this.freeze({key:"reset"});for(var i=0,n=t.length;i<n;i++)this.renderView(t[i],e);this.unfreeze({key:"reset"}),this.sortViews()},removeViews:function(){se(this._views,"remove"),this._views={}},sortViews:function(){this.isExactSorting()&&(this.isFrozen()?this._updates.sort=!0:this.sortViewsExact())},sortViewsExact:function(){var t=P(this.cells).children("[model-id]"),o=this.model.get("cells");Pt(t,function(t,e){var i=o.get(t.getAttribute("model-id")),n=o.get(e.getAttribute("model-id")),s=i.attributes.z||0,r=n.attributes.z||0;return s===r?0:s<r?-1:1})},insertView:function(t){var e=this.cells;switch(this.options.sorting){case $s.APPROX:var i=t.model.get("z"),n=this.addZPivot(i);e.insertBefore(t.el,n);break;case $s.EXACT:default:e.appendChild(t.el)}},addZPivot:function(t){t=(t=+t)||0;var e=this._zPivots,i=e[t];if(i)return i;i=e[t]=document.createComment("z-index:"+(t+1));var n=-1/0;for(var s in e)(s=+s)<t&&n<s&&(n=s);var r=this.cells;if(n!==-1/0){var o=e[n];r.insertBefore(i,o.nextSibling)}else r.insertBefore(i,r.firstChild);return i},removeZPivots:function(){var t=this._zPivots,e=this.viewport;for(var i in t)e.removeChild(t[i]);this._zPivots={}},scale:function(t,e,i,n){if(void 0===t)return Ot.matrixToScale(this.matrix());void 0===e&&(e=t),void 0===i&&(n=i=0);var s=this.translate();if(i||n||s.tx||s.ty){var r=s.tx-i*(t-1),o=s.ty-n*(e-1);this.translate(r,o)}t=Math.max(t||0,this.MIN_SCALE),e=Math.max(e||0,this.MIN_SCALE);var a=this.matrix();return a.a=t,a.d=e,this.matrix(a),this.trigger("scale",t,e,i,n),this},rotate:function(t,e,i){if(void 0===t)return Ot.matrixToRotate(this.matrix());if(void 0===e){var n=this.cells.getBBox();e=n.width/2,i=n.height/2}var s=this.matrix().translate(e,i).rotate(t).translate(-e,-i);return this.matrix(s),this},translate:function(t,e){if(void 0===t)return Ot.matrixToTranslate(this.matrix());var i=this.matrix();i.e=t||0,i.f=e||0,this.matrix(i);var n=this.translate(),s=this.options.origin;return s.x=n.tx,s.y=n.ty,this.trigger("translate",n.tx,n.ty),this.options.drawGrid&&this.drawGrid(),this},findView:function(t){var e=Ne(t)?this.cells.querySelector(t):t instanceof P?t[0]:t,i=this.findAttribute("model-id",e);if(i)return this._views[i]},findViewByModel:function(t){var e=Ne(t)||Dt(t)?t:t&&t.id;return this._views[e]},findViewsFromPoint:function(e){return e=new j(e),this.model.getElements().map(this.findViewByModel,this).filter(function(t){return t&&t.vel.getBBox({target:this.cells}).containsPoint(e)},this)},findViewsInArea:function(e,t){t=ie(t||{},{strict:!1}),e=new Q(e);var i=this.model.getElements().map(this.findViewByModel,this),n=t.strict?"containsRect":"intersect";return i.filter(function(t){return t&&e[n](t.vel.getBBox({target:this.cells}))},this)},removeTools:function(){return this.dispatchToolsEvent("remove"),this},hideTools:function(){return this.dispatchToolsEvent("hide"),this},showTools:function(){return this.dispatchToolsEvent("show"),this},dispatchToolsEvent:function(t){for(var e,i=[],n=arguments.length-1;0<n--;)i[n]=arguments[n+1];"string"==typeof t&&(e=this).trigger.apply(e,["tools:event",t].concat(i))},getModelById:function(t){return this.model.getCell(t)},snapToGrid:function(t,e){return this.clientToLocalPoint(t,e).snapToGrid(this.options.gridSize)},localToPaperPoint:function(t,e){var i=new j(t,e);return Ot.transformPoint(i,this.matrix())},localToPaperRect:function(t,e,i,n){var s=new Q(t,e,i,n);return Ot.transformRect(s,this.matrix())},paperToLocalPoint:function(t,e){var i=new j(t,e);return Ot.transformPoint(i,this.matrix().inverse())},paperToLocalRect:function(t,e,i,n){var s=new Q(t,e,i,n);return Ot.transformRect(s,this.matrix().inverse())},localToClientPoint:function(t,e){var i=new j(t,e);return Ot.transformPoint(i,this.clientMatrix())},localToClientRect:function(t,e,i,n){var s=new Q(t,e,i,n);return Ot.transformRect(s,this.clientMatrix())},clientToLocalPoint:function(t,e){var i=new j(t,e);return Ot.transformPoint(i,this.clientMatrix().inverse())},clientToLocalRect:function(t,e,i,n){var s=new Q(t,e,i,n);return Ot.transformRect(s,this.clientMatrix().inverse())},localToPagePoint:function(t,e){return this.localToPaperPoint(t,e).offset(this.pageOffset())},localToPageRect:function(t,e,i,n){return this.localToPaperRect(t,e,i,n).offset(this.pageOffset())},pageToLocalPoint:function(t,e){var i=new j(t,e).difference(this.pageOffset());return this.paperToLocalPoint(i)},pageToLocalRect:function(t,e,i,n){var s=this.pageOffset(),r=new Q(t,e,i,n);return r.x-=s.x,r.y-=s.y,this.paperToLocalRect(r)},clientOffset:function(){var t=this.svg.getBoundingClientRect();return new j(t.left,t.top)},pageOffset:function(){return this.clientOffset().offset(window.scrollX,window.scrollY)},linkAllowed:function(t){if(!(t instanceof Js))throw new Error("Must provide a linkView.");var e=t.model,i=this.options,n=this.model,s=n.constructor.validations;return!(!i.multiLinks&&!s.multiLinks.call(this,n,e))&&(!(!i.linkPinning&&!s.linkPinning.call(this,n,e))&&!("function"==typeof i.allowLink&&!i.allowLink.call(this,t,this)))},getDefaultLink:function(t,e){return ue(this.options.defaultLink)?this.options.defaultLink.call(this,t,e):this.options.defaultLink.clone()},resolveHighlighter:function(e){var t=(e=e||{}).highlighter,i=this.options;if(void 0===t){var n=["embedding","connecting","magnetAvailability","elementAvailability"].find(function(t){return!!e[t]});t=n&&i.highlighting[n]||i.highlighting.default}if(!t)return!1;Ne(t)&&(t={name:t});var s=t.name,r=i.highlighterNamespace[s];if(!r)throw new Error('Unknown highlighter ("'+s+'")');if("function"!=typeof r.highlight)throw new Error('Highlighter ("'+s+'") is missing required highlight() method');if("function"!=typeof r.unhighlight)throw new Error('Highlighter ("'+s+'") is missing required unhighlight() method');return{highlighter:r,options:t.options||{},name:s}},onCellHighlight:function(t,e,i){if(i=this.resolveHighlighter(i)){e.id||(e.id=Ot.uniqueId());var n=i.name+e.id+JSON.stringify(i.options);if(!this._highlights[n]){var s=i.highlighter;s.highlight(t,e,ee({},i.options)),this._highlights[n]={cellView:t,magnetEl:e,opt:i.options,highlighter:s}}}},onCellUnhighlight:function(t,e,i){if(i=this.resolveHighlighter(i)){var n=i.name+e.id+JSON.stringify(i.options),s=this._highlights[n];s&&(s.highlighter.unhighlight(s.cellView,s.magnetEl,s.opt),this._highlights[n]=null)}},pointerdblclick:function(t){t.preventDefault(),t=bt(t);var e=this.findView(t.target);if(!this.guard(t,e)){var i=this.snapToGrid(t.clientX,t.clientY);e?e.pointerdblclick(t,i.x,i.y):this.trigger("blank:pointerdblclick",t,i.x,i.y)}},pointerclick:function(t){if(this.eventData(t).mousemoved<=this.options.clickThreshold){t=bt(t);var e=this.findView(t.target);if(this.guard(t,e))return;var i=this.snapToGrid(t.clientX,t.clientY);e?e.pointerclick(t,i.x,i.y):this.trigger("blank:pointerclick",t,i.x,i.y)}},contextmenu:function(t){this.options.preventContextMenu&&t.preventDefault(),t=bt(t);var e=this.findView(t.target);if(!this.guard(t,e)){var i=this.snapToGrid(t.clientX,t.clientY);e?e.contextmenu(t,i.x,i.y):this.trigger("blank:contextmenu",t,i.x,i.y)}},pointerdown:function(t){t=bt(t);var e=this.findView(t.target);if(!this.guard(t,e)){var i=this.snapToGrid(t.clientX,t.clientY);e?(t.preventDefault(),e.pointerdown(t,i.x,i.y)):(this.options.preventDefaultBlankAction&&t.preventDefault(),this.trigger("blank:pointerdown",t,i.x,i.y)),this.delegateDragEvents(e,t.data)}},pointermove:function(t){var e=this.eventData(t);if(e.mousemoved||(e.mousemoved=0),!(++e.mousemoved<=this.options.moveThreshold)){t=bt(t);var i=this.snapToGrid(t.clientX,t.clientY),n=e.sourceView;n?n.pointermove(t,i.x,i.y):this.trigger("blank:pointermove",t,i.x,i.y),this.eventData(t,e)}},pointerup:function(t){this.undelegateDocumentEvents();var e=bt(t),i=this.snapToGrid(e.clientX,e.clientY),n=this.eventData(t).sourceView;n?n.pointerup(e,i.x,i.y):this.trigger("blank:pointerup",e,i.x,i.y),e.isPropagationStopped()||this.pointerclick(P.Event(t,{type:"click",data:t.data})),t.stopImmediatePropagation(),this.delegateEvents()},mouseover:function(t){t=bt(t);var e=this.findView(t.target);if(!this.guard(t,e))if(e)e.mouseover(t);else{if(this.el===t.target)return;this.trigger("blank:mouseover",t)}},mouseout:function(t){t=bt(t);var e=this.findView(t.target);if(!this.guard(t,e))if(e)e.mouseout(t);else{if(this.el===t.target)return;this.trigger("blank:mouseout",t)}},mouseenter:function(t){t=bt(t);var e=this.findView(t.target);if(!this.guard(t,e)){var i=this.findView(t.relatedTarget);if(e){if(i===e)return;e.mouseenter(t)}else{if(i)return;this.trigger("paper:mouseenter",t)}}},mouseleave:function(t){t=bt(t);var e=this.findView(t.target);if(!this.guard(t,e)){var i=this.findView(t.relatedTarget);if(e){if(i===e)return;e.mouseleave(t)}else{if(i)return;this.trigger("paper:mouseleave",t)}}},mousewheel:function(t){t=bt(t);var e=this.findView(t.target);if(!this.guard(t,e)){var i=t.originalEvent,n=this.snapToGrid(i.clientX,i.clientY),s=Math.max(-1,Math.min(1,i.wheelDelta||-i.detail));e?e.mousewheel(t,n.x,n.y,s):this.trigger("blank:mousewheel",t,n.x,n.y,s)}},onevent:function(t){var e=t.currentTarget,i=e.getAttribute("event");if(i){var n=this.findView(e);if(n){if(t=bt(t),this.guard(t,n))return;var s=this.snapToGrid(t.clientX,t.clientY);n.onevent(t,i,s.x,s.y)}}},magnetEvent:function(t,e){var i=t.currentTarget;if(i.getAttribute("magnet")){var n=this.findView(i);if(n){if(t=bt(t),this.guard(t,n))return;var s=this.snapToGrid(t.clientX,t.clientY);e.call(this,n,t,i,s.x,s.y)}}},onmagnet:function(t){this.magnetEvent(t,function(t,e,i,n,s){t.onmagnet(e,n,s)})},magnetpointerdblclick:function(t){this.magnetEvent(t,function(t,e,i,n,s){t.magnetpointerdblclick(e,i,n,s)})},magnetcontextmenu:function(t){this.options.preventContextMenu&&t.preventDefault(),this.magnetEvent(t,function(t,e,i,n,s){t.magnetcontextmenu(e,i,n,s)})},onlabel:function(t){var e=t.currentTarget,i=this.findView(e);if(i){if(t=bt(t),this.guard(t,i))return;var n=this.snapToGrid(t.clientX,t.clientY);i.onlabel(t,n.x,n.y)}},getPointerArgs:function(t){var e=bt(t),i=this.snapToGrid(e.clientX,e.clientY);return[e,i.x,i.y]},delegateDragEvents:function(t,e){e=e||{},this.eventData({data:e},{sourceView:t||null,mousemoved:0}),this.delegateDocumentEvents(null,e),this.undelegateEvents()},guard:function(t,e){return"mousedown"===t.type&&2===t.button||(!(!this.options.guard||!this.options.guard(t,e))||(t.data&&void 0!==t.data.guarded?t.data.guarded:!(e&&e.model&&e.model instanceof Je)&&(this.svg!==t.target&&this.el!==t.target&&!P.contains(this.svg,t.target))))},setGridSize:function(t){return this.options.gridSize=t,this.options.drawGrid&&this.drawGrid(),this},clearGrid:function(){return this.$grid&&this.$grid.css("backgroundImage","none"),this},_getGridRefs:function(){return this._gridCache||(this._gridCache={root:Ot("svg",{width:"100%",height:"100%"},Ot("defs")),patterns:{},add:function(t,e){Ot(this.root.node.childNodes[0]).append(e),this.patterns[t]=e,this.root.append(Ot("rect",{width:"100%",height:"100%",fill:"url(#"+t+")"}))},get:function(t){return this.patterns[t]},exist:function(t){return void 0!==this.patterns[t]}}),this._gridCache},setGrid:function(t){return this.clearGrid(),this._gridCache=null,this._gridSettings=[],(Array.isArray(t)?t:[t||{}]).forEach(function(t){this._gridSettings.push.apply(this._gridSettings,this._resolveDrawGridOption(t))},this),this},_resolveDrawGridOption:function(t){var e=this.constructor.gridPatterns;if(Ne(t)&&Array.isArray(e[t]))return e[t].map(function(t){return ee({},t)});var i=t||{args:[{}]},n=Array.isArray(i),s=i.name;if(n||s||i.markup||(s="dot"),s&&Array.isArray(e[s])){var r=e[s].map(function(t){return ee({},t)}),o=Array.isArray(i.args)?i.args:[i.args||{}];ie(o[0],Ae(t,"args"));for(var a=0;a<o.length;a++)r[a]&&ee(r[a],o[a]);return r}return n?i:[i]},drawGrid:function(t){var a=this.options.gridSize;if(a<=1)return this.clearGrid();var l=Array.isArray(t)?t:[t],h=this.matrix(),c=this._getGridRefs();this._gridSettings.forEach(function(t,e){var i="pattern_"+e,n=Tt(t,l[e],{sx:h.a||1,sy:h.d||1,ox:h.e||0,oy:h.f||0});n.width=a*(h.a||1)*(n.scaleFactor||1),n.height=a*(h.d||1)*(n.scaleFactor||1),c.exist(i)||c.add(i,Ot("pattern",{id:i,patternUnits:"userSpaceOnUse"},Ot(n.markup)));var s=c.get(i);ue(n.update)&&n.update(s.node.childNodes[0],n);var r=n.ox%n.width;r<0&&(r+=n.width);var o=n.oy%n.height;o<0&&(o+=n.height),s.attr({x:r,y:o,width:n.width,height:n.height})});var e=(new XMLSerializer).serializeToString(c.root.node);return e="url(data:image/svg+xml;base64,"+btoa(e)+")",this.$grid.css("backgroundImage",e),this},updateBackgroundImage:function(t){var e=(t=t||{}).position||"center",i=t.size||"auto auto",n=this.scale(),s=this.translate();Te(e)&&(e=s.tx+n.sx*(e.x||0)+"px "+(s.ty+n.sy*(e.y||0))+"px");Te(i)&&(i=(i=new Q(i).scale(n.sx,n.sy)).width+"px "+i.height+"px"),this.$background.css({backgroundSize:i,backgroundPosition:e})},drawBackgroundImage:function(t,e){if(t instanceof HTMLImageElement){var i,n=(e=e||{}).size,s=e.repeat||"no-repeat",r=e.opacity||1,o=Math.abs(e.quality)||1,a=this.constructor.backgroundPatterns[Me(s)];if(ue(a)){t.width*=o,t.height*=o;var l=a(t,e);if(!(l instanceof HTMLCanvasElement))throw new Error("dia.Paper: background pattern must return an HTML Canvas instance");i=l.toDataURL("image/png"),s="repeat",Te(n)?(n.width*=l.width/t.width,n.height*=l.height/t.height):void 0===n&&(e.size={width:l.width/o,height:l.height/o})}else i=t.src,void 0===n&&(e.size={width:t.width,height:t.height});this.$background.css({opacity:r,backgroundRepeat:s,backgroundImage:"url("+i+")"}),this.updateBackgroundImage(e)}else this.$background.css("backgroundImage","")},updateBackgroundColor:function(t){this.$el.css("backgroundColor",t||"")},drawBackground:function(t){if(t=t||{},this.updateBackgroundColor(t.color),t.image){t=this._background=le(t);var e=document.createElement("img");e.onload=this.drawBackgroundImage.bind(this,e,t),e.src=t.image}else this.drawBackgroundImage(null),this._background=null;return this},setInteractivity:function(t){this.options.interactive=t,se(this._views,"setInteractivity",t)},isDefined:function(t){return!!this.svg.getElementById(t)},defineFilter:function(t){if(!Te(t))throw new TypeError("dia.Paper: defineFilter() requires 1. argument to be an object.");var e=t.id,i=t.name;if(e=e||i+this.svg.id+pt(JSON.stringify(t)),!this.isDefined(e)){var n=Xt[i]&&Xt[i](t.args||{});if(!n)throw new Error("Non-existing filter "+i);var s=ee({filterUnits:"objectBoundingBox",x:-1,y:-1,width:3,height:3},t.attrs,{id:e});Ot(n,s).appendTo(this.defs)}return e},defineGradient:function(t){if(!Te(t))throw new TypeError("dia.Paper: defineGradient() requires 1. argument to be an object.");var e=t.id,i=t.type,n=t.stops;if(e=e||i+this.svg.id+pt(JSON.stringify(t)),!this.isDefined(e)){var s=$t('<stop offset="${offset}" stop-color="${color}" stop-opacity="${opacity}"/>'),r=["<"+i+">",pe(n).map(function(t){return s({offset:t.offset,color:t.color,opacity:Number.isFinite(t.opacity)?t.opacity:1})}).join(""),"</"+i+">"].join(""),o=ee({id:e},t.attrs);Ot(r,o).appendTo(this.defs)}return e},defineMarker:function(t){if(!Te(t))throw new TypeError("dia.Paper: defineMarker() requires 1. argument to be an object.");var e=t.id;if(e=e||this.svg.id+pt(JSON.stringify(t)),!this.isDefined(e)){var i=Ae(t,"type","userSpaceOnUse");Ot("marker",{id:e,orient:"auto",overflow:"visible",markerUnits:t.markerUnits||"userSpaceOnUse"},[Ot(t.type||"path",i)]).appendTo(this.defs)}return e}},{sorting:$s,backgroundPatterns:{flipXy:function(t){var e=document.createElement("canvas"),i=t.width,n=t.height;e.width=2*i,e.height=2*n;var s=e.getContext("2d");return s.drawImage(t,0,0,i,n),s.setTransform(-1,0,0,-1,e.width,e.height),s.drawImage(t,0,0,i,n),s.setTransform(-1,0,0,1,e.width,0),s.drawImage(t,0,0,i,n),s.setTransform(1,0,0,-1,0,e.height),s.drawImage(t,0,0,i,n),e},flipX:function(t){var e=document.createElement("canvas"),i=t.width,n=t.height;e.width=2*i,e.height=n;var s=e.getContext("2d");return s.drawImage(t,0,0,i,n),s.translate(2*i,0),s.scale(-1,1),s.drawImage(t,0,0,i,n),e},flipY:function(t){var e=document.createElement("canvas"),i=t.width,n=t.height;e.width=i,e.height=2*n;var s=e.getContext("2d");return s.drawImage(t,0,0,i,n),s.translate(0,2*n),s.scale(1,-1),s.drawImage(t,0,0,i,n),e},watermark:function(t,e){e=e||{};var i=t.width,n=t.height,s=document.createElement("canvas");s.width=3*i,s.height=3*n;for(var r=s.getContext("2d"),o=Dt(e.watermarkAngle)?-e.watermarkAngle:-20,a=T(o),l=s.width/4,h=s.height/4,c=0;c<4;c++)for(var u=0;u<4;u++)0<(c+u)%2&&(r.setTransform(1,0,0,1,(2*c-1)*l,(2*u-1)*h),r.rotate(a),r.drawImage(t,-i/2,-n/2,i,n));return s}},gridPatterns:{dot:[{color:"#AAAAAA",thickness:1,markup:"rect",update:function(t,e){Ot(t).attr({width:e.thickness*e.sx,height:e.thickness*e.sy,fill:e.color})}}],fixedDot:[{color:"#AAAAAA",thickness:1,markup:"rect",update:function(t,e){var i=e.sx<=1?e.thickness*e.sx:e.thickness;Ot(t).attr({width:i,height:i,fill:e.color})}}],mesh:[{color:"#AAAAAA",thickness:1,markup:"path",update:function(t,e){var i,n=e.width,s=e.height,r=e.thickness;i=0<=n-r&&0<=s-r?["M",n,0,"H0 M0 0 V0",s].join(" "):"M 0 0 0 0",Ot(t).attr({d:i,stroke:e.color,"stroke-width":e.thickness})}}],doubleMesh:[{color:"#AAAAAA",thickness:1,markup:"path",update:function(t,e){var i,n=e.width,s=e.height,r=e.thickness;i=0<=n-r&&0<=s-r?["M",n,0,"H0 M0 0 V0",s].join(" "):"M 0 0 0 0",Ot(t).attr({d:i,stroke:e.color,"stroke-width":e.thickness})}},{color:"#000000",thickness:3,scaleFactor:4,markup:"path",update:function(t,e){var i,n=e.width,s=e.height,r=e.thickness;i=0<=n-r&&0<=s-r?["M",n,0,"H0 M0 0 V0",s].join(" "):"M 0 0 0 0",Ot(t).attr({d:i,stroke:e.color,"stroke-width":e.thickness})}}]}}),qs=gi.extend({name:null,tagName:"g",className:"tool",svgElement:!0,_visible:!0,init:function(){var t=this.name;t&&this.vel.attr("data-tool-name",t)},configure:function(t,e){return this.relatedView=t,this.paper=t.paper,this.parentView=e,this.simulateRelatedView(this.el),this},simulateRelatedView:function(t){t&&t.setAttribute("model-id",this.relatedView.model.id)},getName:function(){return this.name},show:function(){this.el.style.display="",this._visible=!0},hide:function(){this.el.style.display="none",this._visible=!1},isVisible:function(){return!!this._visible},focus:function(){var t=this.options.focusOpacity;isFinite(t)&&(this.el.style.opacity=t),this.parentView.focusTool(this)},blur:function(){this.el.style.opacity="",this.parentView.blurTool(this)},update:function(){}}),tr=gi.extend({tagName:"g",className:"tools",svgElement:!0,tools:null,options:{tools:null,relatedView:null,name:null,component:!1},configure:function(t){var e=(t=ee(this.options,t)).tools;if(!Array.isArray(e))return this;var i=t.relatedView;if(!(i instanceof mi))return this;for(var n=this.tools=[],s=0,r=e.length;s<r;s++){var o=e[s];o instanceof qs&&(o.configure(i,this),o.render(),this.vel.append(o.el),n.push(o))}return this},getName:function(){return this.options.name},update:function(t){t=t||{};var e=this.tools;if(e){for(var i=0,n=e.length;i<n;i++){var s=e[i];t.tool!==s.cid&&s.isVisible()&&s.update()}return this}},focusTool:function(t){var e=this.tools;if(!e)return this;for(var i=0,n=e.length;i<n;i++){var s=e[i];t===s?s.show():s.hide()}return this},blurTool:function(t){var e=this.tools;if(!e)return this;for(var i=0,n=e.length;i<n;i++){var s=e[i];s===t||s.isVisible()||(s.show(),s.update())}return this},hide:function(){return this.focusTool(null)},show:function(){return this.blurTool(null)},onRemove:function(){var t=this.tools;if(!t)return this;for(var e=0,i=t.length;e<i;e++)t[e].remove();this.tools=null},mount:function(){var t=this.options,e=t.relatedView;e&&(t.component?e.el:e.paper.tools).appendChild(this.el);return this}}),er={ElementView:vi,Graph:Xs,Cell:Je,CellView:mi,Element:di,attributes:Xe,Link:Li,LinkView:Js,Paper:Qs,ToolView:qs,ToolsView:tr};function ir(t,e,i){return is.call(this.paper,{},e,i,t,this.model).anchor}var nr=gi.extend({tagName:"circle",svgElement:!0,className:"marker-vertex",events:{mousedown:"onPointerDown",touchstart:"onPointerDown",dblclick:"onDoubleClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},attributes:{r:6,fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move"},position:function(t,e){this.vel.attr({cx:t,cy:e})},onPointerDown:function(t){t.stopPropagation(),t.preventDefault(),this.options.paper.undelegateEvents(),this.delegateDocumentEvents(null,t.data),this.trigger("will-change",this,t)},onPointerMove:function(t){this.trigger("changing",this,t)},onDoubleClick:function(t){this.trigger("remove",this,t)},onPointerUp:function(t){this.trigger("changed",this,t),this.undelegateDocumentEvents(),this.options.paper.delegateEvents()}}),sr=qs.extend({name:"vertices",options:{handleClass:nr,snapRadius:20,redundancyRemoval:!0,vertexAdding:!0,stopPropagation:!0},children:[{tagName:"path",selector:"connection",className:"joint-vertices-path",attributes:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"cell"}}],handles:null,events:{"mousedown .joint-vertices-path":"onPathPointerDown","touchstart .joint-vertices-path":"onPathPointerDown"},onRender:function(){return this.options.vertexAdding&&(this.renderChildren(),this.updatePath()),this.resetHandles(),this.renderHandles(),this},update:function(){return this.relatedView.model.vertices().length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.vertexAdded&&this.updatePath(),this},resetHandles:function(){var t=this.handles;if(this.handles=[],this.stopListening(),Array.isArray(t))for(var e=0,i=t.length;e<i;e++)t[e].remove()},renderHandles:function(){for(var t=this.relatedView.model.vertices(),e=0,i=t.length;e<i;e++){var n=t[e],s=new this.options.handleClass({index:e,paper:this.paper});s.render(),s.position(n.x,n.y),this.simulateRelatedView(s.el),s.vel.appendTo(this.el),this.handles.push(s),this.startHandleListening(s)}},updateHandles:function(){for(var t=this.relatedView.model.vertices(),e=0,i=t.length;e<i;e++){var n=t[e],s=this.handles[e];if(!s)return;s.position(n.x,n.y)}},updatePath:function(){var t=this.childNodes.connection;t&&t.setAttribute("d",this.relatedView.getSerializedConnection())},startHandleListening:function(t){var e=this.relatedView;e.can("vertexMove")&&(this.listenTo(t,"will-change",this.onHandleWillChange),this.listenTo(t,"changing",this.onHandleChanging),this.listenTo(t,"changed",this.onHandleChanged)),e.can("vertexRemove")&&this.listenTo(t,"remove",this.onHandleRemove)},getNeighborPoints:function(t){var e=this.relatedView,i=e.model.vertices(),n=0<t?i[t-1]:e.sourceAnchor,s=t<i.length-1?i[t+1]:e.targetAnchor;return{prev:new j(n),next:new j(s)}},onHandleWillChange:function(t,e){this.focus();var i=this.relatedView,n=this.options;i.model.startBatch("vertex-move",{ui:!0,tool:this.cid}),n.stopPropagation||i.notifyPointerdown.apply(i,i.paper.getPointerArgs(e))},onHandleChanging:function(t,e){var i=this.options,n=this.relatedView,s=t.options.index,r=n.paper.getPointerArgs(e),o=r[0],a=r[1],l=r[2],h={x:a,y:l};this.snapVertex(h,s),n.model.vertex(s,h,{ui:!0,tool:this.cid}),t.position(h.x,h.y),i.stopPropagation||n.notifyPointermove(o,a,l)},onHandleChanged:function(t,e){var i=this.options,n=this.relatedView;if(i.vertexAdding&&this.updatePath(),i.redundancyRemoval){n.removeRedundantLinearVertices({ui:!0,tool:this.cid})&&this.render(),this.blur(),n.model.stopBatch("vertex-move",{ui:!0,tool:this.cid}),this.eventData(e).vertexAdded&&n.model.stopBatch("vertex-add",{ui:!0,tool:this.cid});var s=n.paper.getPointerArgs(e),r=s[0],o=s[1],a=s[2];i.stopPropagation||n.notifyPointerup(r,o,a),n.checkMouseleave(r)}},snapVertex:function(t,e){var i=this.options.snapRadius;if(0<i){var n=this.getNeighborPoints(e),s=n.prev,r=n.next;Math.abs(t.x-s.x)<i?t.x=s.x:Math.abs(t.x-r.x)<i&&(t.x=r.x),Math.abs(t.y-s.y)<i?t.y=n.prev.y:Math.abs(t.y-r.y)<i&&(t.y=r.y)}},onHandleRemove:function(t,e){var i=t.options.index,n=this.relatedView;n.model.removeVertex(i,{ui:!0}),this.options.vertexAdding&&this.updatePath(),n.checkMouseleave(bt(e))},onPathPointerDown:function(t){t.stopPropagation(),t.preventDefault();var e=bt(t),i=this.paper.snapToGrid(e.clientX,e.clientY).toJSON(),n=this.relatedView;n.model.startBatch("vertex-add",{ui:!0,tool:this.cid});var s=n.getVertexIndex(i.x,i.y);this.snapVertex(i,s),n.model.insertVertex(s,i,{ui:!0,tool:this.cid}),this.render();var r=this.handles[s];this.eventData(e,{vertexAdded:!0}),r.onPointerDown(e)},onRemove:function(){this.resetHandles()}},{VertexHandle:nr}),rr=gi.extend({tagName:"g",svgElement:!0,className:"marker-segment",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},children:[{tagName:"line",selector:"line",attributes:{stroke:"#33334F","stroke-width":2,fill:"none","pointer-events":"none"}},{tagName:"rect",selector:"handle",attributes:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#33334F",stroke:"#FFFFFF","stroke-width":2}}],onRender:function(){this.renderChildren()},position:function(t,e,i,n){var s=Ot.createSVGMatrix().translate(t,e).rotate(i),r=this.childNodes.handle;r.setAttribute("transform",Ot.matrixToTransformString(s)),r.setAttribute("cursor",i%180==0?"row-resize":"col-resize");var o=n.getClosestPoint(new j(t,e)),a=this.childNodes.line;a.setAttribute("x1",t),a.setAttribute("y1",e),a.setAttribute("x2",o.x),a.setAttribute("y2",o.y)},onPointerDown:function(t){this.trigger("change:start",this,t),t.stopPropagation(),t.preventDefault(),this.options.paper.undelegateEvents(),this.delegateDocumentEvents(null,t.data)},onPointerMove:function(t){this.trigger("changing",this,t)},onPointerUp:function(t){this.undelegateDocumentEvents(),this.options.paper.delegateEvents(),this.trigger("change:end",this,t)},show:function(){this.el.style.display=""},hide:function(){this.el.style.display="none"}}),or=qs.extend({name:"segments",precision:.5,options:{handleClass:rr,segmentLengthThreshold:40,redundancyRemoval:!0,anchor:ir,snapRadius:10,snapHandle:!0},handles:null,onRender:function(){this.resetHandles();var t=this.relatedView,e=t.model.vertices();e.unshift(t.sourcePoint),e.push(t.targetPoint);for(var i=0,n=e.length;i<n-1;i++){var s=e[i],r=e[i+1],o=this.renderHandle(s,r);this.simulateRelatedView(o.el),this.handles.push(o),o.options.index=i}return this},renderHandle:function(t,e){var i=new this.options.handleClass({paper:this.paper});return i.render(),this.updateHandle(i,t,e),i.vel.appendTo(this.el),this.startHandleListening(i),i},update:function(){return this.render(),this},startHandleListening:function(t){this.listenTo(t,"change:start",this.onHandleChangeStart),this.listenTo(t,"changing",this.onHandleChanging),this.listenTo(t,"change:end",this.onHandleChangeEnd)},resetHandles:function(){var t=this.handles;if(this.handles=[],this.stopListening(),Array.isArray(t))for(var e=0,i=t.length;e<i;e++)t[e].remove()},shiftHandleIndexes:function(t){for(var e=this.handles,i=0,n=e.length;i<n;i++)e[i].options.index+=t},resetAnchor:function(t,e){var i=this.relatedView.model;e?i.prop([t,"anchor"],e,{rewrite:!0,ui:!0,tool:this.cid}):i.removeProp([t,"anchor"],{ui:!0,tool:this.cid})},snapHandle:function(t,e,i){var n=t.options.index,s=this.relatedView.model.vertices(),r=t.options.axis,o=s[n-2]||i.sourceAnchor,a=s[n+1]||i.targetAnchor,l=this.options.snapRadius;return Math.abs(e[r]-o[r])<l?e[r]=o[r]:Math.abs(e[r]-a[r])<l&&(e[r]=a[r]),e},onHandleChanging:function(t,e){var i=this.eventData(e),n=this.relatedView,s=n.paper,r=t.options.index-1,o=bt(e),a=s.snapToGrid(o.clientX,o.clientY),l=this.snapHandle(t,a.clone(),i),h=t.options.axis,c=this.options.snapHandle?0:a[h]-l[h],u=n.model,d=le(u.vertices()),p=d[r],g=d[1+r],f=this.options.anchor;"function"!=typeof f&&(f=null);var m=n.sourceView,v=n.sourceBBox,y=!1,b=!1;if(p?0==r?v.containsPoint(p)?(d.shift(),this.shiftHandleIndexes(-1),y=!0):(p[h]=l[h],b=!0):p[h]=l[h]:((p=n.sourceAnchor.toJSON())[h]=l[h],v.containsPoint(p)?(p[h]=l[h],y=!0):(d.unshift(p),this.shiftHandleIndexes(1),b=!0)),f&&m){if(y){var w=i.sourceAnchor.clone();w[h]=l[h];var C=f.call(n,w,m,n.sourceMagnet||m.el,"source",n);this.resetAnchor("source",C)}b&&this.resetAnchor("source",i.sourceAnchorDef)}var I=n.targetView,x=n.targetBBox,A=!1,S=!1;if(g?r==d.length-2?x.containsPoint(g)?(d.pop(),A=!0):(g[h]=l[h],S=!0):g[h]=l[h]:((g=n.targetAnchor.toJSON())[h]=l[h],x.containsPoint(g)?A=!0:(d.push(g),S=!0)),f&&I){if(A){var _=i.targetAnchor.clone();_[h]=l[h];var P=f.call(n,_,I,n.targetMagnet||I.el,"target",n);this.resetAnchor("target",P)}S&&this.resetAnchor("target",i.targetAnchorDef)}u.vertices(d,{ui:!0,tool:this.cid}),this.updateHandle(t,p,g,c)},onHandleChangeStart:function(t,e){var i=t.options.index,n=this.handles;if(Array.isArray(n)){for(var s=0,r=n.length;s<r;s++)s!==i&&n[s].hide();this.focus();var o=this.relatedView,a=o.model;this.eventData(e,{sourceAnchor:o.sourceAnchor.clone(),targetAnchor:o.targetAnchor.clone(),sourceAnchorDef:ae(a.prop(["source","anchor"])),targetAnchorDef:ae(a.prop(["target","anchor"]))}),o.model.startBatch("segment-move",{ui:!0,tool:this.cid})}},onHandleChangeEnd:function(t,e){var i=this.relatedView;this.options.redundancyRemoval&&i.removeRedundantLinearVertices({ui:!0,tool:this.cid}),this.render(),this.blur(),i.model.stopBatch("segment-move",{ui:!0,tool:this.cid}),i.checkMouseleave(bt(e))},updateHandle:function(t,e,i,n){var s=Math.abs(e.x-i.x)<this.precision,r=Math.abs(e.y-i.y)<this.precision;if(s||r){var o=new G(e,i);if(o.length()<this.options.segmentLengthThreshold)t.hide();else{var a=o.midpoint(),l=s?"x":"y";a[l]+=n||0;var h=o.vector().vectorAngle(new j(1,0));t.position(a.x,a.y,h,this.relatedView),t.show(),t.options.axis=l}}else t.hide()},onRemove:function(){this.resetHandles()}},{SegmentHandle:rr}),ar=qs.extend({tagName:"path",xAxisVector:new j(1,0),events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},onRender:function(){this.update()},update:function(){var t,e,i=this.ratio,n=this.relatedView,s=n.getTangentAtRatio(i);if(e=s?(t=s.start,s.vector().vectorAngle(this.xAxisVector)||0):(t=n.getPointAtRatio(i),0),!t)return this;var r=Ot.createSVGMatrix().translate(t.x,t.y).rotate(e);return this.vel.transform(r,{absolute:!0}),this},onPointerDown:function(t){t.stopPropagation(),t.preventDefault();var e=this.relatedView;e.model.startBatch("arrowhead-move",{ui:!0,tool:this.cid}),e.can("arrowheadMove")&&(e.startArrowheadMove(this.arrowheadType),this.delegateDocumentEvents(),e.paper.undelegateEvents()),this.focus(),this.el.style.pointerEvents="none"},onPointerMove:function(t){var e=bt(t),i=this.paper.snapToGrid(e.clientX,e.clientY);this.relatedView.pointermove(e,i.x,i.y)},onPointerUp:function(t){this.undelegateDocumentEvents();var e=this.relatedView,i=e.paper,n=bt(t),s=i.snapToGrid(n.clientX,n.clientY);e.pointerup(n,s.x,s.y),i.delegateEvents(),this.blur(),this.el.style.pointerEvents="",e.model.stopBatch("arrowhead-move",{ui:!0,tool:this.cid})}}),lr=ar.extend({name:"target-arrowhead",ratio:1,arrowheadType:"target",attributes:{d:"M -10 -8 10 0 -10 8 Z",fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move",class:"target-arrowhead"}}),hr=ar.extend({name:"source-arrowhead",ratio:0,arrowheadType:"source",attributes:{d:"M 10 -8 -10 0 10 8 Z",fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move",class:"source-arrowhead"}}),cr=qs.extend({name:"button",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},options:{distance:0,offset:0,rotate:!1},onRender:function(){this.renderChildren(this.options.markup),this.update()},update:function(){var t,e,i,n=this.options.distance||0;i=(t=Wt(n)?this.relatedView.getTangentAtRatio(parseFloat(n)/100):this.relatedView.getTangentAtLength(n))?(e=t.start,t.vector().vectorAngle(new j(1,0))||0):(e=this.relatedView.getConnection().start,0);var s=Ot.createSVGMatrix().translate(e.x,e.y).rotate(i).translate(0,this.options.offset||0);return this.options.rotate||(s=s.rotate(-i)),this.vel.transform(s,{absolute:!0}),this},onPointerDown:function(t){t.stopPropagation(),t.preventDefault();var e=this.options.action;"function"==typeof e&&e.call(this.relatedView,t,this.relatedView,this)}}),ur=cr.extend({children:[{tagName:"circle",selector:"button",attributes:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attributes:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],options:{distance:60,offset:0,action:function(t,e,i){e.model.remove({ui:!0,tool:i.cid})}}}),dr=qs.extend({name:"boundary",tagName:"rect",options:{padding:10},attributes:{fill:"none",stroke:"#33334F","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"},onRender:function(){this.update()},update:function(){var t=this.options.padding;isFinite(t)||(t=0);var e=this.relatedView.getConnection().bbox().inflate(t);return this.vel.attr(e.toJSON()),this}}),pr=qs.extend({tagName:"g",type:null,children:[{tagName:"circle",selector:"anchor",attributes:{cursor:"pointer"}},{tagName:"rect",selector:"area",attributes:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onPointerDown",touchstart:"onPointerDown",dblclick:"onPointerDblClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{snap:function(t,e,i,n,s,r){var o=r.options.snapRadius,a="source"===n,l=a?0:-1,h=this.model.vertex(l)||this.getEndAnchor(a?"target":"source");return h&&(Math.abs(h.x-t.x)<o&&(t.x=h.x),Math.abs(h.y-t.y)<o&&(t.y=h.y)),t},anchor:ir,customAnchorAttributes:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttributes:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,restrictArea:!0,redundancyRemoval:!0},onRender:function(){this.renderChildren(),this.toggleArea(!1),this.update()},update:function(){var t=this.type;return this.relatedView.getEndView(t)?(this.updateAnchor(),this.updateArea(),this.el.style.display=""):this.el.style.display="none",this},updateAnchor:function(){var t=this.childNodes;if(t){var e=t.anchor;if(e){var i=this.relatedView,n=this.type,s=i.getEndAnchor(n),r=this.options,o=i.model.prop([n,"anchor"]);e.setAttribute("transform","translate("+s.x+","+s.y+")");var a=o?r.customAnchorAttributes:r.defaultAnchorAttributes;for(var l in a)e.setAttribute(l,a[l])}}},updateArea:function(){var t=this.childNodes;if(t){var e=t.area;if(e){var i,n,s,r=this.relatedView,o=this.type,a=r.getEndView(o),l=a.model,h=r.getEndMagnet(o),c=this.options.areaPadding;isFinite(c)||(c=0),a.isNodeConnection(h)?(n=0,s=(i=a.getBBox()).center()):(i=a.getNodeUnrotatedBBox(h),n=l.angle(),s=i.center(),n&&s.rotate(l.getBBox().center(),-n)),i.inflate(c),e.setAttribute("x",-i.width/2),e.setAttribute("y",-i.height/2),e.setAttribute("width",i.width),e.setAttribute("height",i.height),e.setAttribute("transform","translate("+s.x+","+s.y+") rotate("+n+")")}}},toggleArea:function(t){this.childNodes.area.style.display=t?"":"none"},onPointerDown:function(t){t.stopPropagation(),t.preventDefault(),this.paper.undelegateEvents(),this.delegateDocumentEvents(),this.focus(),this.toggleArea(this.options.restrictArea),this.relatedView.model.startBatch("anchor-move",{ui:!0,tool:this.cid})},resetAnchor:function(t){var e=this.type,i=this.relatedView.model;t?i.prop([e,"anchor"],t,{rewrite:!0,ui:!0,tool:this.cid}):i.removeProp([e,"anchor"],{ui:!0,tool:this.cid})},onPointerMove:function(t){var e,i=this.relatedView,n=this.type,s=i.getEndView(n),r=s.model,o=i.getEndMagnet(n),a=bt(t),l=this.paper.clientToLocalPoint(a.clientX,a.clientY),h=this.options.snap;if("function"==typeof h&&(l=h.call(i,l,s,o,n,i,this),l=new j(l)),this.options.restrictArea)if(s.isNodeConnection(o)){var c=s.getClosestPoint(l);c&&(l=c)}else{var u=s.getNodeUnrotatedBBox(o),d=r.angle(),p=r.getBBox().center(),g=l.clone().rotate(p,d);u.containsPoint(g)||(l=u.pointNearestToPoint(g).rotate(p,-d))}var f=this.options.anchor;"function"==typeof f&&(e=f.call(i,l,s,o,n,i)),this.resetAnchor(e),this.update()},onPointerUp:function(t){this.paper.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);var e=this.relatedView;this.options.redundancyRemoval&&e.removeRedundantLinearVertices({ui:!0,tool:this.cid}),e.model.stopBatch("anchor-move",{ui:!0,tool:this.cid})},onPointerDblClick:function(){this.resetAnchor(),this.update()}}),gr={Vertices:sr,Segments:or,SourceArrowhead:hr,TargetArrowhead:lr,SourceAnchor:pr.extend({name:"source-anchor",type:"source"}),TargetAnchor:pr.extend({name:"target-anchor",type:"target"}),Button:cr,Remove:ur,Boundary:dr},fr=Ot,mr=di,vr=vi.prototype,yr=mr.define("standard.Record",{size:{width:100},padding:0,items:[],itemHeight:20,itemOffset:20,itemMinLabelWidth:10,itemButtonSize:10,itemIcon:{width:16,height:16,padding:2},itemOverflow:!1,attrs:{bodiesGroups:{fill:"transparent",stroke:"none"},labelsGroups:{fill:"#333333"},buttonsGroups:{fill:"transparent",stroke:"#333333",strokeWidth:1},forksGroups:{stroke:"#333333"},groups:{groupPosition:!0},itemBodies:{groupWidth:!0,itemHighlight:{fill:"#eeeeee"}},itemLabels:{fontSize:16,textVerticalAnchor:"middle",pointerEvents:"bounding-box",itemText:{textWrap:!0,ellipsis:!0},itemHighlight:{fill:"red"}}}},{markup:[],metrics:null,markupAttributes:["items","itemHeight","itemOffset","itemIcon","itemMinLabelWidth","itemButtonSize","itemOverflow","padding"],initialize:function(){di.prototype.initialize.apply(this,arguments),this.on("change",this.onChange,this),this.buildMarkup()},anyHasChanged:function(t){return!!Array.isArray(t)&&t.some(function(t){return this.hasChanged(t)},this)},onChange:function(t,e){e.record!==this.id&&this.hasChanged("markup")&&xr("Markup can not be modified."),this.anyHasChanged(this.markupAttributes)&&this.buildMarkup(e)},buildMarkup:function(t){var e=this.metrics={},i=e.items={},n=this.attributes,s=n.itemHeight,r=n.itemOffset,o=!!n.itemOverflow,a=n.items;Array.isArray(a)||(a=[]);var l=a.length,h=0,c=le(this.markup);Array.isArray(c)||xr("Expects Prototype JSON Markup.");for(var u=Ht(n.padding),d=0,p=0;p<l;p++){for(var g=[],f=[],m=[],v=[],y=[],b=Array.from(a[p]),w=this.createQueue(b,0,[],null),C=0,I=0;0<w.length;){var x=w.pop(),A=x.path,S=x.level,_=x.item,P=x.parent;0===S&&A.splice(1,0,p);var M=_.id,k=-1!==S,T=_.height||s,N=_.icon,D=_.items,E=!!_.highlighted,L=!!_.collapsed,z=Array.isArray(D)&&0<D.length;M||xr("Item id required."),i.hasOwnProperty(M)&&xr("Duplicated item id.");var O=i[M]={path:A,visible:k,parent:P,label:_.label,height:T,group:p,hasSubItems:z,highlighted:E,collapsed:L};if(z&&(O.children=D.map(function(t){return t.id}),Array.prototype.push.apply(w,this.createQueue(D,L||!k?-1:S+1,A,M))),k){var G=r*S;if(O.x=G+r,O.y=C,O.cx=G+r/2,O.cy=C+T/2,O.span=_.span||1,M){var B=this.getItemBodyMarkup(_,G,C,p,o&&0===p?u.left:0);g.push(B);var j=this.getItemLabelMarkup(_,G,C,p);f.push(j),z&&(m.push(this.getButtonMarkup(_,G,C,p)),L||y.push(M)),N&&(v.push(this.getIconMarkup(_,G,C,p)),O.x+=n.itemIcon.width+n.itemIcon.padding)}I=Math.max(I,O.x+n.itemMinLabelWidth),C+=T}}d=Math.max(I,d),h=Math.max(h,C);var R=[];c.push({tagName:"g",selector:this.getSelector("group",p),groupSelector:"groups",attributes:{"record-group":p},children:R}),R.push({tagName:"g",selector:this.getSelector("bodiesGroup",p),groupSelector:"bodiesGroups",children:g},{tagName:"g",selector:this.getSelector("labelsGroup",p),groupSelector:"labelsGroups",children:f}),0<y.length&&R.push({tagName:"g",selector:this.getSelector("forksGroup",p),groupSelector:"forksGroups",children:y.map(this.getForkMarkup,this)}),0<m.length&&R.push({tagName:"g",selector:this.getSelector("buttonsGroup",p),groupSelector:"buttonsGroups",children:m}),0<v.length&&R.push({tagName:"g",selector:this.getSelector("iconsGroup",p),groupSelector:"iconsGroups",children:v})}e.padding=u,e.groupsCount=l,e.overflow=o,e.minHeight=h+u.top+u.bottom,e.minWidth=d*l+u.left+u.right;var V=ee({record:this.id},t);this.set("markup",c,V),this.autoresize(V)},autoresize:function(t){var e=this.getMinimalSize(),i=this.attributes.size.width;this.resize(Math.max(i,e.width),e.height,t)},getMinimalSize:function(){var t=this.metrics;return{width:t.minWidth,height:t.minHeight}},removeInvalidLinks:function(e){var t=this.graph;return t?t.getConnectedLinks(this).filter(this.isLinkInvalid,this).map(function(t){return t.remove(e)}):[]},isLinkInvalid:function(t){var e=this.id,i=this.metrics.items,n=t.source();if(n.id===e&&n.hasOwnProperty("port")&&!i[n.port])return!0;var s=t.target();return!(s.id!==e||!s.hasOwnProperty("port")||i[s.port])},createQueue:function(n,s,r,o){var a=n.length;return Array.from({length:a},function(t,e){var i=a-e-1;return{path:r.concat(["items",i]),item:n[i],level:s,parent:o}})},getGroupSelector:function(t){for(var e=Array.prototype.slice.call(arguments,1),i=[t],n=0,s=e.length;n<s;n++){var r=e[n];if(null!=r){Array.isArray(r)||(r=[r]);for(var o=0,a=r.length;o<a;o++)i.push(this.getSelector(t,r[o]))}}return i},getItemLabelMarkup:function(t,e,i,n){var s=this.attributes,r=s.itemOffset,o=t.height||s.itemHeight,a=t.id,l=e+r;return t.icon&&(l+=s.itemIcon.width+2*s.itemIcon.padding),{tagName:"text",className:"record-item-label",selector:this.getSelector("itemLabel",a),groupSelector:this.getGroupSelector("itemLabels",n,t.group),attributes:{x:l,y:i+o/2,"item-id":a}}},getItemBodyMarkup:function(t,e,i,n,s){var r=0;s&&(r-=s);var o={x:r,y:i,height:t.height||this.attributes.itemHeight,"item-id":t.id},a=t.span;return a&&(o["item-span"]=a),{tagName:"rect",selector:this.getSelector("itemBody",t.id),groupSelector:this.getGroupSelector("itemBodies",n,t.group),className:"record-item-body",attributes:o}},getButtonMarkup:function(t,e,i){var n=this.attributes,s=n.itemButtonSize,r=n.itemOffset,o=t.height||n.itemHeight;return{tagName:"path",className:"record-item-button",attributes:{d:this.getButtonPathData(e+r/2,i+o/2,s/2,t.collapsed),"item-id":t.id,cursor:"pointer","shape-rendering":"geometricprecision"}}},getIconMarkup:function(t,e,i){var n=this.attributes,s=n.itemOffset,r=n.itemIcon,o=t.height||n.itemHeight;return{tagName:"image",className:"record-item-icon",attributes:{x:e+s+r.padding,y:i+(o-r.height)/2,width:r.width,height:r.height,"xlink:href":t.icon}}},getForkMarkup:function(t){return{tagName:"path",attributes:{d:this.getForkPathData(t),fill:"none"}}},getButtonPathData:function(t,e,i,n){var s=["M",t-i,e-i,t+i,e-i,t+i,e+i,t-i,e+i,"Z","M",t-i/2,e,t+i/2,e];return n&&Array.prototype.push.apply(s,["M",t,e-i/2,t,e+i/2]),s.join(" ")},getForkPathData:function(t){var e=this.metrics.items;if(!e)return null;var i=e[t];if(!i)return null;var n=i.children;if(!n||0===n.length)return null;for(var s,r=this.attributes.itemButtonSize,o=[],a=0,l=n.length;a<l;a++){var h=(s=e[n[a]]).cx+(s.hasSubItems?-1:1)*r/2;o.push("M",i.cx,s.cy,h,s.cy)}return o.push("M",i.cx,i.cy+r/2,i.cx,s.cy),o.join(" ")},item:function(t,e,i){var n=this.getItemPathArray(t);return n?void 0===e?this.prop(n):this.prop(n,e,i):null},toggleItemCollapse:function(t,e){var i=this.getItemPathArray(t);if(!i)return this;i.push("collapsed");var n=!!this.prop(i);return this.prop(i,!n,e),this},toggleItemHighlight:function(t,e){var i=this.getItemPathArray(t);if(!i)return this;i.push("highlighted");var n=!!this.prop(i);return this.prop(i,!n,e),this},isItemVisible:function(t){return this.getItemCacheAttribute(t,"visible")},isItemCollapsed:function(t){return this.getItemCacheAttribute(t,"collapsed")},isItemHighlighted:function(t){return this.getItemCacheAttribute(t,"highlighted")},getItemParentId:function(t){return this.getItemCacheAttribute(t,"parent")},getItemGroupIndex:function(t){return this.getItemCacheAttribute(t,"group")},getItemPathArray:function(t){var e=this.getItemCacheAttribute(t,"path");return e?e.slice():null},getItemSide:function(t){var e=this.getItemGroupIndex(t);if(null===e)return null;var i=this.metrics,n=i.groupsCount;if(1<n){if(0===e)return"left";if(e+i.items[t].span-1==n-1)return"right"}return"middle"},getItemCacheAttribute:function(t,e){if(!e)return null;var i=this.metrics.items;if(!i)return null;var n=i[t];return n?n[e]:null},getSelector:function(t,e){return t+"_"+e},removeItem:function(t,e){var i=this.getItemPathArray(t);if(!i)return this;var n=i.pop(),s=this.prop(i).slice();return 1<s.length?(s.splice(n,1),this.prop(i,s,ee({rewrite:!0},e))):2<i.length?this.removeProp(i,e):(n=i.pop(),(s=this.get("items").slice()).splice(n,1),this.prop(i,s,ee({rewrite:!0},e))),this},addNextSibling:function(t,e,i){var n=this.getItemPathArray(t);if(!n)return this;var s=this.getItemParentId(t)||this.getItemGroupIndex(t),r=n[n.length-1]+1;return this.addItemAtIndex(s,r,e,i)},addPrevSibling:function(t,e,i){var n=this.getItemPathArray(t);if(!n)return this;var s=this.getItemParentId(t)||this.getItemGroupIndex(t),r=n[n.length-1];return this.addItemAtIndex(s,r,e,i)},addItemAtIndex:function(t,e,i,n){if(!i)return this;var s;switch(typeof t){case"number":var r=this.prop("items");s=["items",Math.min(Math.max(t,0),r.length)];break;case"string":if(!(s=this.getItemPathArray(t)))return this;s.push("items");break;default:xr("Requires an item id.")}var o=this.prop(s);o=Array.isArray(o)?o.slice():[];var a=Math.min(Math.max(e,0),o.length);return o.splice(a,0,i),this.prop(s,o,ee({rewrite:!0},n))},toJSON:function(){var t=di.prototype.toJSON.apply(this,arguments);return delete t.markup,t}},{attributes:{itemText:{set:function(t,e,i,n){if(!de(t))return null;var s=this.model,r=i.getAttribute("item-id"),o=s.metrics.items[r];if(o){var a,l,h=o.label,c=s.metrics.padding,u=s.metrics.groupsCount,d=o.x,p=(e.width-c.left-c.right)/u*o.span-d,g=new Q(d,o.y,p,o.height);l=t.textWrap?(a="textWrap",{text:h,ellipsis:t.ellipsis}):(a="text",h),this.getAttributeDefinition(a).set.call(this,l,g,i,n)}}},itemHighlight:{set:function(t,e,i,n){if(!de(t))return null;var s=this.model,r=i.getAttribute("item-id");switch(s.getItemCacheAttribute(r,"highlighted")){case!0:return t;case null:case!1:return Object.keys(t).reduce(function(t,e){return!(n.hasOwnProperty(e)||n.hasOwnProperty(Me(e)))&&i.getAttribute(e)&&(t[e]=null),t},{})}}},groupWidth:{set:function(t,e,i){var n=this.model.metrics,s=n.padding,r=n.groupsCount,o=(e.width-s.left-s.right)/r,a=i.getAttribute("item-span");if(a&&(o*=Number(a)),n.overflow){var l=Number(this.findAttribute("record-group",i));0===l&&(o+=s.left),l===r-1&&(o+=s.right)}return{width:o}}},groupPosition:{position:function(t,e,i){var n=Number(i.getAttribute("record-group")),s=this.model.metrics,r=s.groupsCount,o=s.padding,a=(e.width-o.left-o.right)/r,l=o.left+n*a,h=o.top;return new j(l,h)}}}}),br=yr.define("standard.BorderedRecord",{padding:0,attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#000000",fill:"#FFFFFF"}}},{markup:[{tagName:"rect",selector:"body"}]}),wr=yr.define("standard.HeaderedRecord",{padding:{top:30,left:0,right:0,bottom:0},attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#000000",fill:"#FFFFFF"},header:{refWidth:"100%",height:30,stroke:"#000000",fill:"transparent"},headerLabel:{refX:"50%",refY:15,textAnchor:"middle",textVerticalAnchor:"middle",fontSize:20,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerLabel"}]}),Cr=yr.prototype.markupAttributes.reduce(function(t,e){return t[e]=["UPDATE"],t},{}),Ir=vi.extend({events:{"mousedown .record-item-button":"onItemButtonClick","touchstart .record-item-button":"onItemButtonClick"},presentationAttributes:vi.addPresentationAttributes(Cr),getLinkEnd:function(t){return{id:this.model.id,port:this.findAttribute("item-id",t)}},getMagnetFromLinkEnd:function(t){for(var e=t.port,i=this.model;e&&!i.isItemVisible(e);)e=i.getItemParentId(e);e||vr.getMagnetFromLinkEnd.apply(this,arguments);var n=i.getSelector("itemBody",e);return this.findBySelector(n,this.el,this.selectors)[0]},onItemButtonClick:function(t){t.stopPropagation(),t.preventDefault();var e=t.currentTarget.getAttribute("item-id");this.model.toggleItemCollapse(e,{ui:!0})}});function xr(t){throw new Error("shapes.standard.Record: "+t)}var Ar={Record:yr,BorderedRecord:br,HeaderedRecord:wr,RecordView:Ir,BorderedRecordView:Ir,HeaderedRecordView:Ir},Sr=di.define("basic.Generic",{attrs:{".":{fill:"#ffffff",stroke:"none"}}}),_r=(Sr.define("basic.Rect",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:100,height:60},text:{fill:"#000000",text:"","font-size":14,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><rect/></g><text/></g>'}),vi.extend({presentationAttributes:vi.addPresentationAttributes({attrs:["SCALE"]}),confirmUpdate:function(){var t=vi.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"SCALE")&&(this.resize(),t=this.removeFlag(t,"SCALE")),t}}),Sr.define("basic.Text",{attrs:{text:{"font-size":18,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><text/></g></g>'}),Sr.define("basic.Circle",{size:{width:60,height:60},attrs:{circle:{fill:"#ffffff",stroke:"#000000",r:30,cx:30,cy:30},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><circle/></g><text/></g>'}),Sr.define("basic.Ellipse",{size:{width:60,height:40},attrs:{ellipse:{fill:"#ffffff",stroke:"#000000",rx:30,ry:20,cx:30,cy:20},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><ellipse/></g><text/></g>'}),Sr.define("basic.Polygon",{size:{width:60,height:40},attrs:{polygon:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>'}),Sr.define("basic.Polyline",{size:{width:60,height:40},attrs:{polyline:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polyline/></g><text/></g>'}),Sr.define("basic.Image",{attrs:{text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><image/></g><text/></g>'}),Sr.define("basic.Path",{size:{width:60,height:60},attrs:{path:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle",ref:"path","ref-x":.5,"ref-dy":10,fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><path/></g><text/></g>'}).define("basic.Rhombus",{attrs:{path:{d:"M 30 0 L 60 30 30 60 0 30 z"},text:{"ref-y":.5,"ref-dy":null,"y-alignment":"middle"}}}),yi.test("svgforeignobject")),Pr=Sr.define("basic.TextBlock",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000","font-size":14,"font-family":"Arial, helvetica, sans-serif"},".content":{text:"","ref-x":.5,"ref-y":.5,"y-alignment":"middle","x-alignment":"middle"}},content:""},{markup:['<g class="rotatable">','<g class="scalable"><rect/></g>',_r?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>',"</g>"].join(""),initialize:function(){this.listenTo(this,"change:size",this.updateSize),this.listenTo(this,"change:content",this.updateContent),this.updateSize(this,this.get("size")),this.updateContent(this,this.get("content")),Sr.prototype.initialize.apply(this,arguments)},updateSize:function(t,e){this.attr({".fobj":ee({},e),div:{style:ee({},e)}})},updateContent:function(t,e){_r?this.attr({".content":{html:It(e)}}):this.attr({".content":{text:e}})},setForeignObjectSize:function(){this.updateSize.apply(this,arguments)},setDivContent:function(){this.updateContent.apply(this,arguments)}}),Mr=vi.extend({presentationAttributes:_r?vi.prototype.presentationAttributes:vi.addPresentationAttributes({content:["CONTENT"],size:["CONTENT"]}),initFlag:["RENDER","CONTENT"],confirmUpdate:function(){var t=vi.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"CONTENT")&&(this.updateContent(this.model),t=this.removeFlag(t,"CONTENT")),t},update:function(t,e){var i=this.model;if(_r)vi.prototype.update.call(this,i,e);else{var n=Ae(e||i.get("attrs"),".content");vi.prototype.update.call(this,i,n),e&&!Ie(e,".content")||this.updateContent(i,e)}},updateContent:function(t,e){var i=Tt({},(e||t.get("attrs"))[".content"]);i=Ae(i,"text");var n=Ct(t.get("content"),t.get("size"),i,{svgDocument:this.paper.svg}),s=ft({},".content",i,"/");s[".content"].text=n,vi.prototype.update.call(this,t,s)}}),kr=Sr.extend({markup:['<clipPath class="clip"><rect/></clipPath>','<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="axis">','<g class="y-axis"><path/><g class="ticks"></g></g>','<g class="x-axis"><path/><g class="ticks"></g></g>','<g class="markings"></g>',"</g>",'<g class="data"><g class="series"></g></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>','<line class="guideline x-guideline" /><line class="guideline y-guideline" />',"</g>","</g>"].join(""),tickMarkup:'<g class="tick"><line/><text/></g>',pointMarkup:'<g class="point"><circle/><text/></g>',barMarkup:'<path class="bar"/>',markingMarkup:'<g class="marking"><rect/><text/></g>',serieMarkup:'<g><clipPath class="serie-clip"><rect/></clipPath><path/><g class="bars"></g><g class="points"></g></g>',legendItemMarkup:'<g class="legend-item"><circle/><text/></g>',defaults:te({type:"chart.Plot",attrs:{".data path":{fill:"none",stroke:"black"},".data .bars rect":{fill:"none",stroke:"black"},".background rect":{fill:"white",stroke:"#e5e5e5",opacity:1},".background text":{fill:"black",text:"No data available.",ref:".","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":10,"text-anchor":"middle","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":23,"text-anchor":"middle","y-alignment":"middle","font-size":10},".point":{display:"inline-block"},".point circle":{r:2,stroke:"black",fill:"black",opacity:.3},".point text":{fill:"black","font-size":8,"text-anchor":"middle",display:"none"},".axis path":{fill:"none",stroke:"black"},".axis .tick":{fill:"none",stroke:"black"},".y-axis .tick line":{fill:"none",stroke:"black",x2:2,y2:0,opacity:1},".x-axis .tick line":{fill:"none",stroke:"black",x2:0,y2:-3,opacity:1},".y-axis .tick text":{fill:"black",stroke:"none","font-size":10,"text-anchor":"end"},".x-axis .tick text":{fill:"black",stroke:"none","font-size":10,"text-anchor":"middle"},".y-axis .tick text > tspan":{dy:"-.5em",x:-5},".x-axis .tick text > tspan":{dy:".5em",x:0},".axis .markings":{fill:"black",stroke:"none","fill-opacity":1},".axis .markings text":{fill:"black","text-anchor":"end","font-size":10,dy:-5,dx:-5},".guideline":{"pointer-events":"none",display:"none"},".x-guideline":{stroke:"black",visibility:"hidden"},".y-guideline":{stroke:"black",visibility:"hidden"},".legend":{"ref-x":10,"ref-y":10},".legend-item text":{fill:"black",transform:"translate(14, 0)","font-size":11},".legend-item circle":{r:5,transform:"translate(5,5)"},".legend-item":{cursor:"pointer"},".legend-item.disabled circle":{fill:"gray"},".legend-item.disabled text":{opacity:.5}}},Sr.prototype.defaults),legendPosition:function(t,e){e=e||{},this.trigger("batch:start"),[".legend/ref-x",".legend/ref-y",".legend/ref-dx",".legend/ref-dy",".legend/x-alignment",".legend/y-alignment"].forEach(function(t){this.removeAttr(t,{silent:!0})},this);var i=e.padding||10,n={n:{".legend":{"ref-x":.5,"x-alignment":-.5,"ref-y":i}},ne:{".legend":{"ref-dx":-i,"x-alignment":-.999,"ref-y":i}},e:{".legend":{"ref-dx":-i,"x-alignment":-.999,"ref-y":.5,"y-alignment":-.5}},se:{".legend":{"ref-dx":-i,"ref-dy":-i,"x-alignment":-.999,"y-alignment":-.999}},s:{".legend":{"ref-x":.5,"ref-dy":-i,"x-alignment":-.5,"y-alignment":-.999}},sw:{".legend":{"ref-x":i,"ref-dy":-i,"y-alignment":-.999}},w:{".legend":{"ref-x":i,"ref-y":.5,"y-alignment":-.5}},nw:{".legend":{"ref-x":i,"ref-y":i}},nnw:{".legend":{"ref-x":i,"ref-y":-i,"y-alignment":-.999}},nn:{".legend":{"ref-x":.5,"ref-y":-i,"x-alignment":-.5,"y-alignment":-.999}},nne:{".legend":{"ref-dx":-i,"ref-y":-i,"x-alignment":-.999,"y-alignment":-.999}},nnee:{".legend":{"ref-dx":i,"ref-y":-i,"y-alignment":-.999}},nee:{".legend":{"ref-y":i,"ref-dx":i}},ee:{".legend":{"ref-dx":i,"ref-y":.5,"y-alignment":-.5}},see:{".legend":{"ref-dx":i,"ref-dy":-i,"y-alignment":-.999}},ssee:{".legend":{"ref-dx":i,"ref-dy":i}},sse:{".legend":{"ref-dx":-i,"ref-dy":i,"x-alignment":-.999}},ss:{".legend":{"ref-x":.5,"ref-dy":i,"x-alignment":-.5}},ssw:{".legend":{"ref-x":i,"ref-dy":i}},ssww:{".legend":{"ref-x":-i,"ref-dy":i,"x-alignment":-.999}},sww:{".legend":{"ref-x":-i,"ref-dy":-i,"x-alignment":-.999,"y-alignment":-.999}},ww:{".legend":{"ref-x":-i,"ref-y":.5,"x-alignment":-.999,"y-alignment":-.5}},nww:{".legend":{"ref-x":-i,"ref-y":i,"x-alignment":-.999}},nnww:{".legend":{"ref-x":-i,"ref-y":-i,"x-alignment":-.999,"y-alignment":-.999}}};n[t]&&this.attr(n[t]),this.trigger("batch:stop")},addPoint:function(t,e,i){i=i||{};var n=this.get("series"),s=pe(n).findIndex(function(t){return t.name===e});if(-1===s)throw new Error("Serie "+e+" was not found.");var r=le(n[s]);r.data.push(t),Number.isFinite(i.maxLen)&&r.data.length>i.maxLen&&r.data.shift(),(n=n.slice())[s]=r,this.set("series",n,i)},lastPoint:function(e){var t=pe(this.get("series")).find(function(t){return t&&t.name===e}).data;return t[t.length-1]},firstPoint:function(e){return pe(this.get("series")).find(function(t){return t&&t.name===e}).data[0]}}),Tr=vi.extend({events:{mousemove:"onMouseMove",mouseout:"onMouseOut"},presentationAttributes:vi.addPresentationAttributes({series:["UPDATE"],interpolate:["UPDATE"],padding:["UPDATE"],canvas:["UPDATE"],markings:["UPDATE"],axis:["UPDATE"]}),initialize:function(){vi.prototype.initialize.apply(this,arguments),this.on("cell:pointerdown",this.onPointerDown,this),this._disabledSeries=[]},renderMarkup:function(){vi.prototype.renderMarkup.apply(this,arguments),this.elDataClipPath=this.$(".clip")[0],this.elDataClipPathRect=this.elDataClipPath.firstChild,this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForeground=this.$(".foreground")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elDataSeries=this.$(".data .series")[0],this.elYAxisPath=this.$(".y-axis path")[0],this.elYAxisTicks=this.$(".y-axis .ticks")[0],this.elXAxisPath=this.$(".x-axis path")[0],this.elXAxisTicks=this.$(".x-axis .ticks")[0],this.elMarkings=this.$(".axis .markings")[0],this.elXGuideline=this.$(".x-guideline")[0],this.elYGuideline=this.$(".y-guideline")[0],this.elLegend=this.$(".legend")[0],this.elLegendItems=this.$(".legend-items")[0],this.elTick=V(this.model.tickMarkup),this.elMarking=V(this.model.markingMarkup),this.elLegendItem=V(this.model.legendItemMarkup),this.elPoint=V(this.model.pointMarkup),this.elBar=V(this.model.barMarkup),this.elSerie=V(this.model.serieMarkup),this.elDataClipPath.id="clip_"+this.cid,V(this.$(".data")[0]).attr("clip-path","url(#"+this.elDataClipPath.id+")"),V(this.elMarkings).attr("clip-path","url(#"+this.elDataClipPath.id+")")},update:function(){var t=this.filterSeries();this.calculateStats(t);var e,i=this.model.get("size"),n=i.width,s=i.height;this.canvas=ee({x:0,y:0,width:n,height:s},this.model.get("canvas"));var r={top:0,right:0,bottom:0,left:0},o=this.model.get("padding");e=Te(o)?ee({},r,o):void 0!==o?{top:o,right:2*o,bottom:2*o,left:o}:r,this.canvas=g.rect(this.canvas).moveAndExpand(g.rect(e.left,e.top,-e.right,-e.bottom));var a={x:0,y:0,width:n,height:s};V(this.elDataClipPathRect).attr(a),V(this.elBackgroundRect).attr(a),V(this.elForegroundRect).attr(a),this.updateAxis(),this.updateMarkings(),this.isEmpty()?P(this.elBackgroundText).show():P(this.elBackgroundText).hide(),this.updateSeries(t),this.updateLegend(),vi.prototype.update.apply(this,arguments)},calculateStats:function(t){t=t||this.model.get("series");var s=[],r=[],o={},a={},l={};pe(t).forEach(function(e,t){var i,n=l[e.name||t]||(l[e.name||t]={});n.decreasingX=!0,n.decreasingY=!0,n.nonDecreasingX=!0,n.nonDecreasingY=!0,Pe(e.data,function(t){n.minX=void 0===n.minX?t.x:Math.min(n.minX,t.x),n.maxX=void 0===n.maxX?t.x:Math.max(n.maxX,t.x),n.minY=void 0===n.minY?t.y:Math.min(n.minY,t.y),n.maxY=void 0===n.maxY?t.y:Math.max(n.maxY,t.y),i&&(n.decreasingX=n.decreasingX&&t.x<i.x,n.decreasingY=n.decreasingY&&t.y<i.y,n.nonDecreasingX=n.nonDecreasingX&&t.x>=i.x,n.nonDecreasingY=n.nonDecreasingY&&t.y>=i.y),s.includes(t.x)||s.push(t.x),r.includes(t.y)||r.push(t.y),(o[t.x]||(o[t.x]=[])).push({serie:e,x:t.x,y:t.y}),(a[t.y]||(a[t.y]=[])).push({serie:e,x:t.x,y:t.y}),i=t})});var e=this.model.get("axis")||{},i=e["x-axis"]||{},n=e["y-axis"]||{};this.stats={minX:void 0===i.min?s.reduce(function(t,e){return e<t?e:t},1/0):i.min,maxX:void 0===i.max?s.reduce(function(t,e){return t<e?e:t},-1/0):i.max,minY:void 0===n.min?r.reduce(function(t,e){return e<t?e:t},1/0):n.min,maxY:void 0===n.max?r.reduce(function(t,e){return t<e?e:t},-1/0):n.max,bySerie:l,xValues:s,yValues:r,xMap:o,yMap:a}},isEmpty:function(){return!this.stats.xValues.length},updateSeries:function(t){if(t=t||this.model.get("series"),this.elDataSeries.textContent="",!this.isEmpty()){var c=[this.stats.minX,this.stats.maxX],u=[this.stats.minY,this.stats.maxY],d=[this.canvas.x,this.canvas.x+this.canvas.width],p=[this.canvas.y+this.canvas.height,this.canvas.y],f=this.model.get("attrs");pe(t).forEach(function(n,t){var e=n.data,s=[],i=this.elSerie.clone().attr("class",n.name||"serie-"+t);V(this.elDataSeries).append(i),Pe(e,function(t){var e=g.scale.linear(c,d,t.x),i=g.scale.linear(u,p,t.y);s.push({x:e,y:i}),f[".point"]&&"none"!==f[".point"].display&&this.renderPoint(t,n),n.bars&&this.renderBar(t,n)}.bind(this));var r=i.findOne(".serie-clip"),o=this.model.get("size"),a=this.stats.bySerie[n.name||t],l=g.scale.linear(c,d,a.minX),h=g.scale.linear(c,d,a.maxX);r.findOne("rect").attr(g.rect(l,0,h-l,o.height)),n.bars||i.findOne("path").attr({d:this.seriePathData(s,n,t),"clip-path":"url(#"+r.node.id+")"})},this)}},seriePathClipData:function(t,e){var i=this.model.get("size"),n=t[0];return["M",n.x,n.y,"V",i.height+10].join(" ")},renderBar:function(t,e){var i=[this.stats.minX,this.stats.maxX],n=[this.stats.minY,this.stats.maxY],s=[this.canvas.x,this.canvas.x+this.canvas.width],r=[this.canvas.y+this.canvas.height,this.canvas.y],o=g.scale.linear(i,s,t.x),a=g.scale.linear(n,r,t.y),l=e.bars.barWidth||.8,h=1<l?l:this.canvas.width/(this.stats.maxX-this.stats.minX)*l,c=g.scale.linear(n,r,0)-a;n[0]===n[1]&&(a=this.canvas.y+this.canvas.height,c=0);var u=t["top-rx"]||e.bars["top-rx"],d=t["top-ry"]||e.bars["top-ry"],p=t["bottom-rx"]||e.bars["bottom-rx"],f=t["bottom-ry"]||e.bars["bottom-ry"],m={left:o,middle:o-h/2,right:o-h}[e.bars.align||"middle"],v=this.elBar.clone();v.attr({"data-serie":e.name,"data-x":t.x,"data-y":t.y,d:V.rectToPath({x:m,y:a,width:h,height:c,"top-rx":u,"top-ry":d,"bottom-rx":p,"bottom-ry":f})});var y=e.name||"serie-"+this.model.get("series").indexOf(e);return V(this.elDataSeries).findOne("."+y+" .bars").append(v),v.node},renderPoint:function(t,e){var i=[this.stats.minX,this.stats.maxX],n=[this.stats.minY,this.stats.maxY],s=[this.canvas.x,this.canvas.x+this.canvas.width],r=[this.canvas.y+this.canvas.height,this.canvas.y],o=g.scale.linear(i,s,t.x),a=g.scale.linear(n,r,t.y);n[0]===n[1]&&(a=this.canvas.y+this.canvas.height);var l=this.elPoint.clone();l.attr({"data-serie":e.name,"data-x":t.x,"data-y":t.y}),l.findOne("circle").attr({cx:o,cy:a}),l.findOne("text").attr({x:o,dy:a}).text(this.pointLabel(t,e));var h=e.name||"serie-"+this.model.get("series").indexOf(e);return V(this.elDataSeries).findOne("."+h+" .points").append(l),l.node},seriePathData:function(t,e,i){var n,s,r=t.length,o=[this.stats.minY,this.stats.maxY];if(o[0]===o[1])for(n=0;n<r;n++)t[n].y=this.canvas.y+this.canvas.height;switch(void 0===e.interpolate?this.model.get("interpolate"):e.interpolate){case"bezier":s=new g.Path(g.Curve.throughPoints(t));break;case"step":for((s=new g.Path).appendSegment(g.Path.createSegment("M",t[0].x,t[0].y)),n=1;n<r;n++)s.appendSegment(g.Path.createSegment("L",(t[n-1].x+t[n].x)/2,t[n-1].y)),s.appendSegment(g.Path.createSegment("L",(t[n-1].x+t[n].x)/2,t[n].y));s.appendSegment(g.Path.createSegment("L",t[r-1].x,t[r-1].y));break;case"stepBefore":for((s=new g.Path).appendSegment(g.Path.createSegment("M",t[0].x,t[0].y)),n=1;n<r;n++)s.appendSegment(g.Path.createSegment("L",t[n-1].x,t[n].y)),s.appendSegment(g.Path.createSegment("L",t[n].x,t[n].y));break;case"stepAfter":for((s=new g.Path).appendSegment(g.Path.createSegment("M",t[0].x,t[0].y)),n=1;n<r;n++)s.appendSegment(g.Path.createSegment("L",t[n].x,t[n-1].y)),s.appendSegment(g.Path.createSegment("L",t[n].x,t[n].y));break;default:for((s=new g.Path).appendSegment(g.Path.createSegment("M",t[0].x,t[0].y)),n=1;n<r;n++)s.appendSegment(g.Path.createSegment("L",t[n].x,t[n].y))}return this.fixPathForFill(s,t,e,i).serialize()},fixPathForFill:function(t,e,i,n){if(0===e.length)return t;if(i.hideFillBoundaries)return t;if(!this.stats.bySerie[i.name||n].nonDecreasingX)return t;var s=t.getSegment(0);t.replaceSegment(0,g.Path.createSegment("L",s.end.x,s.end.y));var r=i.fillPadding&&i.fillPadding.left||0,o=i.fillPadding&&i.fillPadding.right||0,a=i.fillPadding&&i.fillPadding.bottom||10,l=this.model.get("size"),h=e[0],c=e[e.length-1];return t.insertSegment(0,g.Path.createSegment("M",c.x+o,l.height+a)),t.insertSegment(1,g.Path.createSegment("L",h.x-r,l.height+a)),t.insertSegment(2,g.Path.createSegment("L",h.x-r,h.y)),i.showRightFillBoundary&&(t.appendSegment(g.Path.createSegment("L",c.x+o,c.y)),t.appendSegment(g.Path.createSegment("Z"))),t},updateAxis:function(){var t=this.model.get("axis"),e=this.model.get("size"),i=e.height,n=e.width;if(V(this.elXAxisPath).attr("d",["M",0,i,"L",n,i].join(" ")),V(this.elYAxisPath).attr("d",["M",0,0,"L",0,i].join(" ")),this.elXAxisTicks.textContent="",this.elYAxisTicks.textContent="",!this.isEmpty()){var s=[this.stats.minX,this.stats.maxX],r=[this.stats.minY,this.stats.maxY],o=[this.canvas.x,this.canvas.x+this.canvas.width],a=[0,this.canvas.height],l=t&&t["y-axis"]||{},h=t&&t["x-axis"]||{};(function(t,e,i,n){function s(t,e,i){t.translate(e,i.height),V(this.elXAxisTicks).append(t)}function r(t,e,i){return g.scale.linear(t,e,i)}function o(t){return t}if(!t.ticks){var a=this.stats.xValues;return void function(i,n,s,r,o,a,l,t){t.forEach(function(t,e){e%(i.tickStep||1)==0&&p.call(this,i,n,s,r,o,a,l,t)},this)}.call(this,t,e,i,n,r,s,o,a)}var l=this.canvas.width/(e.width-2*this.canvas.x);c.call(this,t,e,i,n,r,s,o,l)}).call(this,h,e,s,o),function(t,e,i,n){var s=this.canvas.height/e.height;c.call(this,t,e,i,n,function(t,e,i){return t[0]===t[1]?this.canvas.y+this.canvas.height:g.scale.linear(t,e,i)},function(t,e){t.translate(0,e),V(this.elYAxisTicks).append(t)},function(t,e,i){var n=e[1]-(t-e[0]);return n+=g.scale.linear(i,e,this.canvas.y)-e[0]},s)}.call(this,l,e,r,a)}function c(t,e,i,n,s,r,o,a){var l=i[1]-i[0],h=t.ticks||11;0==l&&(h=1);for(var c=l/h/a,u=i[0],d=0;d<h;d++)p.call(this,t,e,i,n,s,r,o,u),u+=c}function p(t,e,i,n,s,r,o,a){var l=this.elTick.clone(),h=s.call(this,i,n,a);if(!(h>e.width)){r.call(this,l,h,e);var c=o.call(this,a,i,n);l.findOne("text").text(this.tickLabel(c,t))}}},tickLabel:function(t,e){if(ue(e.tickFormat))return e.tickFormat(t);var i=e.tickFormat||".1f";return Jt.number(i,t)+(ue(e.tickSuffix)?e.tickSuffix(t):e.tickSuffix||"")},pointLabel:function(t,e){if(ue(e.pointFormat))return e.pointFormat(t);var i=e.pointFormat||".1f";return Jt.number(i,t.y)+(e.pointSuffix||"")},updateMarkings:function(){this.elMarkings.textContent="";var t=this.model.get("markings");if(t&&0!==t.length){var e=this.model.get("size"),C=e.width,I=e.height,x=[this.stats.minX,this.stats.maxX],A=[this.stats.minY,this.stats.maxY],S=[this.canvas.x,this.canvas.x+this.canvas.width],_=[this.canvas.y,this.canvas.y+this.canvas.height];pe(t).forEach(function(t,e){var i=t.start||t.end,n=t.end||t.start,s=Math.min(P(i.x,this.stats.minX),P(n.x,this.stats.minX)),r=Math.max(P(i.x,this.stats.maxX),P(n.x,this.stats.maxX)),o=Math.min(P(i.y,this.stats.minY),P(n.y,this.stats.minY)),a=Math.max(P(i.y,this.stats.maxY),P(n.y,this.stats.maxY)),l=void 0===i.x||void 0===n.x,h=void 0===i.y||void 0===n.y;l&&(S=[0,C]),h&&(_=[0,I]);var c=g.scale.linear(x,S,s),u=g.scale.linear(x,S,r),d=g.scale.linear(A,_,o),p=g.scale.linear(A,_,a),f=c,m=_[1]-p+_[0],v=u-c,y=p-d;if(A[0]===A[1]&&o===a){if(A[0]!==o)return;m=this.canvas.y+this.canvas.height,y=1}v=Math.max(v,1),y=Math.max(y,1);var b=this.elMarking.clone();b.findOne("rect").attr({x:f,y:m,width:v,height:y}),b.findOne("text").text(t.label||"").attr({x:f+v,y:m});var w=b.attr("class")+" "+(t.name||"marking-"+e);b.attr(ee({class:w},t.attrs)),V(this.elMarkings).append(b)},this)}function P(t,e){return void 0===t?e:t}},updateLegend:function(){var t=this.model.get("series");this.elLegendItems.textContent="",pe(t).forEach(function(t,e){if((!ue(t.showLegend)||t.showLegend(t,this.stats.bySerie[t.name||e]))&&!1!==t.showLegend){var i=this.elLegendItem.clone();this._disabledSeries.includes(t.name)&&i.addClass("disabled"),i.attr("data-serie",t.name),i.findOne("circle").attr({fill:this.getSerieColor(t.name)}),i.findOne("text").text(t.label||t.name),i.translate(0,e*(t.legendLabelLineHeight||16)),V(this.elLegendItems).append(i)}},this)},getSerieColor:function(e){var t=this.model.get("attrs"),i=Object.keys(t).find(function(t){return t.includes(e)});return i?t[i].stroke||t[i].fill:"black"},hideSerie:function(t){this._disabledSeries.includes(t)||this._disabledSeries.push(t);var e=this.filterSeries();this.update(e)},showSerie:function(t){this._disabledSeries=ye(this._disabledSeries,t);var e=this.filterSeries();this.update(e)},filterSeries:function(t){return t=t||this.model.get("series"),t=pe(t).filter(function(t){return!this._disabledSeries.includes(t.name)},this)},onPointerDown:function(t,e,i){var n=P(t.target).closest(".legend-item")[0];n&&(V(n).toggleClass("disabled"),V(n).hasClass("disabled")?this.hideSerie(V(n).attr("data-serie")):this.showSerie(V(n).attr("data-serie")))},onMouseMove:function(t){this.showGuidelines(t.clientX,t.clientY,t)},onMouseOut:function(t){this.hideGuidelines(),this.trigger("mouseout",t)},showGuidelines:function(t,e,i){var n=this.model.get("angle"),s=this.model.getBBox(),r=new g.Point(V(this.paper.layers).toLocalPoint(t,e)).rotate(s.center(),n);if(g.rect(s).containsPoint(r)){var o=this.model.get("size"),a=r.x-s.x,l=r.y-s.y;V(this.elXGuideline).attr({x1:a,y1:0,x2:a,y2:o.height,visibility:"visible"}),V(this.elYGuideline).attr({x1:0,y1:l,x2:o.width,y2:l,visibility:"visible"});var h=g.scale.linear([this.canvas.x,this.canvas.x+this.canvas.width],[this.stats.minX,this.stats.maxX],a),c=g.scale.linear([this.canvas.y,this.canvas.y+this.canvas.height],[this.stats.minY,this.stats.maxY],l),u={x:h,y:this.stats.minY+this.stats.maxY-c},d={x:t,y:e},p=this.closestPoints(h);this.trigger("mouseover",u,d,p,i)}},closestPoints:function(t){var e=re(this.stats.xValues,t),i=this.stats.xValues[e],n=this.stats.xValues[e-1],s=void 0===n?i:Math.abs(t-i)<Math.abs(t-n)?i:n;return this.stats.xMap[s]},hideGuidelines:function(){V(this.elXGuideline).attr("visibility","hidden"),V(this.elYGuideline).attr("visibility","hidden")}}),Nr=Sr.extend({markup:['<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="data"></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>',"</g>","</g>"].join(""),sliceMarkup:'<g class="slice"/>',sliceFillMarkup:'<path class="slice-fill"/>',sliceBorderMarkup:'<path class="slice-border"/>',sliceInnerLabelMarkup:'<text class="slice-inner-label"/>',legendSerieMarkup:'<g class="legend-serie"><text/></g>',legendSliceMarkup:'<g class="legend-slice"><circle/><text/></g>',defaults:te({type:"chart.Pie",size:{width:200,height:200},pieHole:0,serieDefaults:{startAngle:0,degree:360,label:null,showLegend:!0,labelLineHeight:6},sliceDefaults:{innerLabel:"{percentage:.0f}%",innerLabelMargin:6,legendLabel:"{label}: {value}",legendLabelLineHeight:6,legendLabelMargin:14,offset:0,onClickEffect:{type:"offset",offset:20},onHoverEffect:null},series:[],attrs:{".background > rect":{opacity:0},".background > text":{fill:"black",text:"No data available.",ref:".background > rect","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":6,"text-anchor":"start","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":18,"text-anchor":"start","y-alignment":"middle","font-size":10},".data":{ref:".background","ref-x":.5,"ref-y":.5},".slice":{cursor:"pointer"},".slice > .slice-fill":{stroke:"#ffffff","stroke-width":1,"fill-opacity":1},".slice.hover > .slice-fill":{"fill-opacity":.8},".slice > .slice-border":{"stroke-width":6,"stroke-opacity":.4,"fill-opacity":1,fill:"none",display:"none"},".slice.hover > .slice-border":{display:"block"},".slice > .slice-inner-label":{"text-anchor":"middle","font-size":"12",stroke:"none","stroke-width":"0",fill:"#ffffff"},".slice > .slice-inner-label > tspan":{dy:"-.5em"},".legend":{"ref-dx":20,"ref-y":5},".legend-serie text":{fill:"grey",transform:"translate(2, 0)","font-size":13},".legend-slice":{cursor:"pointer"},".legend-slice text":{"font-weight":"normal",fill:"black","font-size":11},".legend-slice.hover text":{"font-weight":"bold"},".legend-slice circle":{r:5,transform:"translate(5,5)"}}},Sr.prototype.defaults),addSlice:function(t,e,i){i=i||{},e=e||0;var n=this.get("series");void 0===n[e]&&(n[e]={data:[]});var s=le(n[e]);s.data.push(t),i=1<((n=n.slice())[e]=s).data.length?ee(i,{changedSerieIndex:e}):i,this.set("series",n,i)},editSlice:function(t,e,i,n){n=n||{},i=i||0;var s=this.get("series");if(void 0===s[i]||void 0===s[i].data[e])throw new Error("Slice "+e+" on serie "+i+" was not found.");var r=le(s[i]);r.data[e]=ee(r.data[e],t),(s=s.slice())[i]=r,this.set("series",s,ee(n,{changedSerieIndex:i}))}}),Dr=vi.extend({events:{"mouseover .slice":"onMouseOverSlice","mouseout .slice":"onMouseOverSlice","mousemove .slice":"onMouseMoveSlice","mouseover .legend-slice":"onEventLegendItem","mouseout .legend-slice":"onEventLegendItem"},presentationAttributes:vi.addPresentationAttributes({series:["UPDATE"],serieDefaults:["UPDATE"],sliceDefaults:["UPDATE"],pieHole:["UPDATE"]}),initialize:function(){vi.prototype.initialize.apply(this,arguments),this.on("cell:pointerclick",this.onClickSlice,this),this.on("cell:pointerclick",this.onEventLegendItem,this)},renderMarkup:function(){vi.prototype.renderMarkup.apply(this,arguments),this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elLegendItems=this.$(".legend-items")[0],this.elPie=this.$(".data")[0],this.elSlice=V(this.model.sliceMarkup),this.elSliceFill=V(this.model.sliceFillMarkup),this.elSliceBorder=V(this.model.sliceBorderMarkup),this.elSliceInnerLabel=V(this.model.sliceInnerLabelMarkup),this.elLegendSerie=V(this.model.legendSerieMarkup),this.elLegendSlice=V(this.model.legendSliceMarkup)},update:function(t,e,i){var n=(i=i||{}).changedSerieIndex,s=this.calculateSeries(n);n in s?P(this.elPie).find(".serie-"+n).remove():P(this.elPie).empty();var r=this.model.get("size");V(this.elBackgroundRect).attr(r),V(this.elForegroundRect).attr(r),s.length?P(this.elBackgroundText).hide():P(this.elBackgroundText).show(),pe(s).forEach(function(t,e){void 0!==n&&n!==e||Pe(t.data,this.updateSlice.bind(this))},this),this.updateLegend(),vi.prototype.update.apply(this,arguments)},calculateSeries:function(i){var t=le(this.model.get("series")),a=this.model.get("serieDefaults"),l=this.model.get("sliceDefaults"),e=this.model.get("size"),n=Math.min(e.width,e.height)/2,s=this.model.get("pieHole"),h=n,c=(n-(s=1<s?s:n*s))/t.length;return this._series=t.map(function(t,n){if(void 0!==i&&i!==n)return t;var s=(t=ie(t,a)).startAngle,e=t.data.reduce(function(t,e){return t+e.value},0),r=t.degree/e||0,o=100/e;return t.data=t.data.map(function(t,e){(t=ie(t,Ae(l,"offset","onClickEffect","onHoverEffect"))).outerRadius=h,t.innerRadius=h-c,n||((t=ie(t,Se(l,"offset","onClickEffect","onHoverEffect"))).isOuter=!0,t.offset=1<t.offset?t.offset:t.offset*t.outerRadius,t.onClickEffect.offset=1<t.onClickEffect.offset?t.onClickEffect.offset:t.onClickEffect.offset*t.outerRadius),t.serieIndex=n,t.sliceIndex=e,t.innerLabelMargin=t.innerLabelMargin<-1||1<t.innerLabelMargin?t.innerLabelMargin:t.innerLabelMargin*t.outerRadius,t.percentage=t.value*o;var i=t.value*r;return t.degree={angle:i,start:s,end:i+s},t.rad={angle:g.toRad(t.degree.angle,!0),start:g.toRad(t.degree.start,!0),end:g.toRad(t.degree.end,!0)},t.middleangle=(t.rad.start+t.rad.end)/2,s=t.degree.end,t}),h-=c,t}),this._series},updateLegend:function(){var t=this._series;this.elLegendItems.textContent="";var r=0,i=parseInt(this.model.attr(".legend-serie text/font-size"),10),o=parseInt(this.model.attr(".legend-slice text/font-size"),10);pe(t).forEach(function(t,s){if(t.showLegend){if(t.label){var e=this.elLegendSerie.clone();t.name&&e.addClass(t.name),e.attr({"data-serie":s}),e.findOne("text").text(t.label),e.translate(0,r),V(this.elLegendItems).append(e),r+=i+t.labelLineHeight}Pe(t.data,function(t,e){var i=this.elLegendSlice.clone(),n=this.getSliceFillColor(e,s);t.name&&i.addClass(t.name),i.attr({"data-serie":s,"data-slice":e}),i.findOne("text").text(Jt.string(t.legendLabel,t)),i.findOne("text").translate(t.legendLabelMargin),i.translate(0,r),r+=o+t.legendLabelLineHeight,Te(n)?this.applyGradient(i.findOne("circle"),"fill",n):i.findOne("circle").attr({fill:n}),V(this.elLegendItems).append(i)}.bind(this))}},this)},applyGradient:function(t,e,i){var n=Ne(t)?this.findBySelector(t):P(t).toArray(),s=this.paper.defineGradient(i);n.forEach(function(t){V(t).attr(e,"url(#"+s+")")})},updateSlice:function(t){var e=this.elSlice.clone();V(this.elPie).append(e);var i=this.elSliceFill.clone(),n=this.getSliceFillColor(t.sliceIndex,t.serieIndex);i.attr({fill:n,d:V.createSlicePathData(t.innerRadius,t.outerRadius,t.rad.start,t.rad.end)}),e.append(i),Te(n)&&this.applyGradient("#"+i.attr("id"),"fill",n);var s=this.elSliceBorder.clone(),r=parseInt(this.model.attr(".slice > .slice-border/stroke-width"),10),o=g.point.fromPolar(t.outerRadius+r/2,-t.rad.start,g.point(0,0)),a=g.point.fromPolar(t.outerRadius+r/2,-t.rad.end,g.point(0,0));s.attr({stroke:n,d:this.drawArc(o,a,t.outerRadius+r/2,t.rad.start,t.rad.end)}),e.append(s),Te(n)&&this.applyGradient("#"+s.attr("id"),"stroke",n);var l=this.elSliceInnerLabel.clone();l.text(Jt.string(t.innerLabel,t)),e.append(l);var h=l.bbox(),c=t.outerRadius-h.width/2-t.innerLabelMargin;l.translate(c*Math.cos(-t.middleangle),-c*Math.sin(-t.middleangle)),e.attr({"data-serie":t.serieIndex,"data-slice":t.sliceIndex,"data-value":t.value});var u=this._series[t.serieIndex].name;return u&&e.addClass(u),t.name&&e.addClass(t.name),e.addClass("serie-"+t.serieIndex+" slice-"+t.sliceIndex),t.isOuter&&(e.addClass("outer"),t.offset&&(e.addClass("clicked"),this.effectOnSlice(e,t,{type:"offset",offset:t.offset}))),e},getSliceFillColor:function(e,i){i=i||0;var t=this.model.get("attrs"),n=Object.keys(t).find(function(t){return-1<t.indexOf(".serie-"+i+".slice-"+e+" > .slice-fill")});return n?t[n].fill:this._series[i].data[e].fill},onMouseMoveSlice:function(t){var e=V(t.currentTarget),i=e.attr("data-serie"),n=e.attr("data-slice"),s=this._series[i].data[n];this.trigger(t.type,s,t)},mouseOverSlice:function(t,e){e=e||0;var i=V(this.$('.slice[data-serie="'+e+'"][data-slice="'+t+'"]')[0]),n=this._series[e].data[t];i.toggleClass("hover"),n.isOuter&&!he(n.onHoverEffect)&&this.effectOnSlice(i,n,n.onHoverEffect,!i.hasClass("hover"));var s=V(this.$('.legend-slice[data-serie="'+e+'"][data-slice="'+t+'"]')[0]);s&&s.toggleClass("hover");var r=Object.keys(this.model.get("attrs")).filter(function(t){return-1<t.indexOf(".slice")||-1<t.indexOf(".legend-slice")});vi.prototype.update.call(this,this.model,Se(this.model.get("attrs"),r))},onMouseOverSlice:function(t){var e=V(t.currentTarget),i=e.attr("data-serie"),n=e.attr("data-slice");this.mouseOverSlice(n,i);var s=this._series[i].data[n];this.trigger(t.type,s,t)},clickSlice:function(t,e){e=e||0;var i=V(this.$('.slice[data-serie="'+e+'"][data-slice="'+t+'"]')[0]),n=this._series[e].data[t];n.isOuter&&(i.hasClass("clicked")?(i.removeClass("clicked"),this.model.get("series")[e].data[t].offset=0,this.effectOnSlice(i,n,n.onClickEffect,!0)):(i.addClass("clicked"),this.model.get("series")[e].data[t].offset=n.onClickEffect.offset,this.effectOnSlice(i,n,n.onClickEffect)))},onClickSlice:function(t){var e=V(P(t.target).closest(".slice.outer")[0]);if(e){var i=e.attr("data-serie"),n=e.attr("data-slice");this.clickSlice(n,i);var s=this._series[i].data[n];this.trigger(t.type,s,t)}},onEventLegendItem:function(t){var e=V(P(t.target).closest(".legend-slice")[0]);if(e){var i=e.attr("data-serie"),n=e.attr("data-slice");switch(t.type){case"click":this.clickSlice(n,i);break;case"mouseover":case"mouseout":this.mouseOverSlice(n,i)}}},effectOnSlice:function(t,e,i,n){switch(n=n||!1,i.type){case"enlarge":n?t.scale(1):t.scale(i.scale||1.05);break;case"offset":n?t.translate(0,0,{absolute:!0}):t.translate(i.offset*Math.cos(-e.middleangle),-i.offset*Math.sin(-e.middleangle))}},svgArcMax:2*Math.PI-1e-6,drawArc:function(t,e,i,n,s){var r=0,o=1,a=s-n;return a>Math.PI&&(r=1,a>=this.svgArcMax&&(o=r=0)),"M"+t.x+","+t.y+" A"+i+","+i+" 0 "+r+","+o+" "+e.x+","+e.y}}),Er=Nr.extend({defaults:te({type:"chart.Knob",sliceDefaults:{legendLabel:"{value:.0f}",outer:{offsetOnClick:0}},pieHole:.7,value:0,attrs:{".legend":{"ref-x":.5,"ref-y":.5,"ref-dx":null,"x-alignment":-.5,"y-alignment":-.5},".legend-slice text":{"font-size":30},".legend-slice circle":{display:"none"},".slice-inner-label":{display:"none"},".slice-fill":{stroke:"none"}}},Nr.prototype.defaults),initialize:function(){this.set("series",this.getKnobSeries(),{silent:!0}),Nr.prototype.initialize.apply(this,arguments),this.on("change:value change:min change:max change:fill",this.updateKnob,this)},getKnobSeries:function(){var t=Array.isArray(this.get("value"))?this.get("value"):[this.get("value")],r=Array.isArray(this.get("fill"))?this.get("fill"):[this.get("fill")],o=Array.isArray(this.get("min"))?this.get("min"):[this.get("min")],a=Array.isArray(this.get("max"))?this.get("max"):[this.get("max")];return t.map(function(t,e){var i=void 0===o[e]?o[0]:o[e],n=void 0===a[e]?a[0]:a[e],s=void 0===r[e]?r[0]:r[e];return{degree:g.scale.linear([i,n],[0,360],t),data:[{value:t,fill:s}],showLegend:!(0<e)}})},updateKnob:function(){this.set("series",this.getKnobSeries())}}),Lr=Dr,zr=Sr.extend({markup:['<g class="rotatable">','<g class="scalable">','<g class="background"><rect/></g>','<g class="cells"/>','<g class="foreground"/>',"</g>",'<g class="labels">','<g class="rows"/>','<g class="columns"/>',"</g>","</g>"].join(""),cellMarkup:'<rect class="cell"/>',labelMarkup:'<text class="label"/>',gridLineMarkup:'<path class="grid-line"/>',defaults:te({type:"chart.Matrix",attrs:{".background rect":{fill:"#eeeeee"},".grid-line":{stroke:"white","stroke-width":2},".label":{fill:"black","alignment-baseline":"middle"},".labels .rows .label":{"text-anchor":"end"},".labels .columns .label":{"text-anchor":"start"}}},Sr.prototype.defaults)}),Or=vi.extend({presentationAttributes:vi.addPresentationAttributes({size:["LABELS"],cells:["MARKUP","LABELS"]}),initFlag:["LABELS"].concat(vi.prototype.initFlag),confirmUpdate:function(){var t=vi.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"MARKUP")&&(this.renderMarkup(),t=this.removeFlag(t,"MARKUP")),this.hasFlag(t,"LABELS")&&(this.renderLabels(),t=this.removeFlag(t,"LABELS")),t},renderMarkup:function(){vi.prototype.renderMarkup.apply(this,arguments),this.elCells=this.$(".cells")[0],this.elRowLabels=this.$(".labels .rows")[0],this.elColumnLabels=this.$(".labels .columns")[0],this.elForeground=this.$(".foreground")[0],this.elCell=V(this.model.cellMarkup),this.elGridLine=V(this.model.gridLineMarkup);var t=this.model.get("cells")||[],e=this.model.get("size");this.elBackgroundRect=this.$(".background rect")[0],V(this.elBackgroundRect).attr(e);var i=e.height/t.length,n=e.width/t.length,s=document.createDocumentFragment();this.elCells.textContent="",this.elForeground.textContent="";for(var r,o,a,l,h,c=document.createDocumentFragment(),u=0;u<t.length;u++)for((a=this.elGridLine.clone()).addClass("horizontal"),a.attr("d","M 0 "+u*i+" "+e.width+" "+u*i),c.appendChild(a.node),r=t[u],o=0;o<r.length;o++)0===u&&((a=this.elGridLine.clone()).addClass("vertical"),a.attr("d","M "+o*n+" 0 "+o*n+" "+e.height),c.appendChild(a.node)),(l=r[o])&&((h=this.elCell.clone()).attr(ee({x:o*n,y:u*i,width:n,height:i},l)),s.appendChild(h.node));this.elForeground.appendChild(c),this.elCells.appendChild(s)},renderLabels:function(){this.elLabel=V(this.model.labelMarkup);var t,e,i=this.model.get("cells")||[],n=this.model.get("labels")||{},s=n.rows||[],r=n.columns||[],o=this.model.get("size"),a=o.height/i.length,l=o.width/i.length;this.elRowLabels.textContent="",this.elColumnLabels.textContent="";for(var h,c,u=document.createDocumentFragment(),d=0;d<s.length;d++)t=n.rows[d],(e=this.elLabel.clone()).text(t.text),e.attr(ee({x:-(n.padding||5),y:d*a+a/2,"text-anchor":"end","dominant-baseline":"central","font-size":a,"data-row":d},Ae(t,"text"))),u.appendChild(e.node);this.elRowLabels.appendChild(u);for(var p=document.createDocumentFragment(),g=0;g<r.length;g++)t=n.columns[g],e=this.elLabel.clone(),h=g*l+l/2,c=-(n.padding||5),e.attr("x",h),e.text(t.text),e.attr(ee({y:c,"text-anchor":"start","dominant-baseline":"central","font-size":l,"data-column":g},Ae(t,"text"))),e.rotate(-90,h,c),p.appendChild(e.node);this.elColumnLabels.appendChild(p)}}),Gr={Plot:kr,PlotView:Tr,Pie:Nr,PieView:Dr,Knob:Er,KnobView:Lr,Matrix:zr,MatrixView:Or},Br={none:"",message:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDUxMiA1MTIiIGhlaWdodD0iNTEycHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB3aWR0aD0iNTEycHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGQ9Ik00NzkuOTk4LDY0SDMyQzE0LjMyOSw2NCwwLDc4LjMxMiwwLDk2djMyMGMwLDE3LjY4OCwxNC4zMjksMzIsMzIsMzJoNDQ3Ljk5OEM0OTcuNjcxLDQ0OCw1MTIsNDMzLjY4OCw1MTIsNDE2Vjk2ICBDNTEyLDc4LjMxMiw0OTcuNjcxLDY0LDQ3OS45OTgsNjR6IE00MTYsMTI4TDI1NiwyNTZMOTYsMTI4SDQxNnogTTQ0OCwzODRINjRWMTYwbDE5MiwxNjBsMTkyLTE2MFYzODR6Ii8+PC9zdmc+",plus:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIyLjUsMTRIMTR2OC41YzAsMC4yNzYtMC4yMjQsMC41LTAuNSwwLjVoLTRDOS4yMjQsMjMsOSwyMi43NzYsOSwyMi41VjE0SDAuNSAgQzAuMjI0LDE0LDAsMTMuNzc2LDAsMTMuNXYtNEMwLDkuMjI0LDAuMjI0LDksMC41LDlIOVYwLjVDOSwwLjIyNCw5LjIyNCwwLDkuNSwwaDRDMTMuNzc2LDAsMTQsMC4yMjQsMTQsMC41VjloOC41ICBDMjIuNzc2LDksMjMsOS4yMjQsMjMsOS41djRDMjMsMTMuNzc2LDIyLjc3NiwxNCwyMi41LDE0eiIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+",cross:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGQ9Ik0yMi4yNDUsNC4wMTVjMC4zMTMsMC4zMTMsMC4zMTMsMC44MjYsMCwxLjEzOWwtNi4yNzYsNi4yN2MtMC4zMTMsMC4zMTItMC4zMTMsMC44MjYsMCwxLjE0bDYuMjczLDYuMjcyICBjMC4zMTMsMC4zMTMsMC4zMTMsMC44MjYsMCwxLjE0bC0yLjI4NSwyLjI3N2MtMC4zMTQsMC4zMTItMC44MjgsMC4zMTItMS4xNDIsMGwtNi4yNzEtNi4yNzFjLTAuMzEzLTAuMzEzLTAuODI4LTAuMzEzLTEuMTQxLDAgIGwtNi4yNzYsNi4yNjdjLTAuMzEzLDAuMzEzLTAuODI4LDAuMzEzLTEuMTQxLDBsLTIuMjgyLTIuMjhjLTAuMzEzLTAuMzEzLTAuMzEzLTAuODI2LDAtMS4xNGw2LjI3OC02LjI2OSAgYzAuMzEzLTAuMzEyLDAuMzEzLTAuODI2LDAtMS4xNEwxLjcwOSw1LjE0N2MtMC4zMTQtMC4zMTMtMC4zMTQtMC44MjcsMC0xLjE0bDIuMjg0LTIuMjc4QzQuMzA4LDEuNDE3LDQuODIxLDEuNDE3LDUuMTM1LDEuNzMgIEwxMS40MDUsOGMwLjMxNCwwLjMxNCwwLjgyOCwwLjMxNCwxLjE0MSwwLjAwMWw2LjI3Ni02LjI2N2MwLjMxMi0wLjMxMiwwLjgyNi0wLjMxMiwxLjE0MSwwTDIyLjI0NSw0LjAxNXoiLz48L3N2Zz4=",user:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIyLDIwLjk5OGgtMWMwLDAtMSwwLTEtMVYxNy41YzAtMC4yNzctMC4yMjQtMC41LTAuNS0wLjVTMTksMTcuMjIzLDE5LDE3LjUgIGwtMC4wMDgsNC4yOTVjMCwwLjYwOS0yLjAxLDIuMjA1LTYuNDkyLDIuMjA1cy02LjQ5Mi0xLjU5Ni02LjQ5Mi0yLjIwNUw2LDE3LjVDNiwxNy4yMjMsNS43NzYsMTcsNS41LDE3UzUsMTcuMjIzLDUsMTcuNXYyLjQ5OCAgYzAsMS0xLDEtMSwxSDNjMCwwLTEsMC0xLTFWMTUuNzVjMC0yLjkyMiwyLjg5Mi01LjQwMSw2LjkzLTYuMzQxYzAsMCwxLjIzNCwxLjEwNywzLjU3LDEuMTA3czMuNTctMS4xMDcsMy41Ny0xLjEwNyAgYzQuMDM4LDAuOTQsNi45MywzLjQxOSw2LjkzLDYuMzQxdjQuMjQ4QzIzLDIwLjk5OCwyMiwyMC45OTgsMjIsMjAuOTk4eiBNMTIuNDc3LDljLTIuNDg1LDAtNC41LTIuMDE1LTQuNS00LjVTOS45OTEsMCwxMi40NzcsMCAgczQuNSwyLjAxNSw0LjUsNC41UzE0Ljk2Miw5LDEyLjQ3Nyw5eiIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+",circle:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3gULEBE3DEP64QAAAwlJREFUaN7dmktrU0EUx38ZmmBbfEIL2hSjkYKC1EW6EDFudC+404/gE6WKSvGxERQfIH4AX1T9EOKrCrYurVrbgsZWoaBVixDbpC6ci+Fyz9ybZG478cBs7syc+Z+5c86c+c8ksCPrgW1ADtgEbARafG1+AW+AYWAIGADGWUTZAJwHxoD5GssocA7ILiTwLcADoFQHcH8pAfeB7jiBtwO3gLJF4P5S1mO02wa/C5iMEbi/TAI7bYE/Y3m5VLOs+sLAJULqrgKHIxhZBp4DT4FX2jkLGoinq1M7fg7YDmwFVATd14CjFboiy5UIs/QBOAmka/izaeCU1hE2zuVqlZ8IUfgVOAA0WViiTcBBrdM0Zm9UhTuAOYOiRzXOeJh0Ak8M484B+TAlK4BPBiU3gWSMoTqpw6g0fgFYblJww9D5dojT25IEcMeA47rUsdsQLp9FmPmURSNSOqpJS2lzUKd+ocN3IBNx5mz+oXXADwHTXX/jjMFxjy1iwtgrYJoF1lY27BMafozZaaMspYKA7XRlw7f1xt4Y5biA7bXXIGv4TW0OGNCmsQRhzCidlwTJADDlgAFTwAuhLq+AHqHyMe6IhKVHAV1C5ZBDBkhYupThPPreIQNGJTJBGXKLLw4Z8NmQu/Fb8PCkQwakBIxFRWPLvAJmhMpWh4AuFb7PKGBaqFzjkAGrhe/TSjNrQZJ1yAAJy5gCRoTKnEMGSFhGFDBoOBu7IhKWQe8wLRFLHQ6A7zCcFNNK59vvAjoqYK8DBuwTCLBhTUD8Hweahj9S2jjU297VqzrU26BVmi2yEjXRKg1PbHnpqYla7AeWxAi+GbhHHdSit2mYyN2XQQ5kQTJ6Y6qL3PUkCr2+H7v0+jcs0eueRLngGNeKa9mxY73g8JzpEtHusorAQ/7e+e7WUWIl//jSVTrK7QEu6KgW9d7tYr3B44iBWPJfkZZ8pZ4r2VngkC0HywMTLNwN5YSBcKtZWoGzernEBbyox2iJc6Np2KcGfnHisYet1CDouc2yCjbhp07MrD+3+QNxi4JkAscRswAAAABJRU5ErkJggg==",service:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB1RJREFUeNrMWltMVFcUHZAIRSAkSFACITRAVbQ/DVhHiRZC2y9jotFgqgmxKqShKdFCggZbEpP2h1Q/oLUg8GH0xy/LKwpDEEFsjKCM8kYkgAhTpggDMzCc7kX2mGF677w80J5khbnnntc+Zz/W2ReNxvsSQLhPWCBYGPhdTdjg7aBCCI/gVSfu+CHBfPz48ba7d+82AocOHfqT6mYIEV6Oua4CfE6YHxsbeyS49Pf3P6C6RYJ2vQTwVTtKHx+fXYRzhM0qTbYR/g4JCQmyVYSFhQXTHyMhUWXMzTzmTo3MorATHxH0eEXAriYrtCmNiop6tby8bLCdgNVqfR0ZGTlC735RaJ/EY+HhGSFhTVSIyg7CIO3mRHNzs44WOYydJuQQ/AjxhJ9hsFqt9qlwKElJSRB8nvAjIYYN+hucDMbCmMHBwZP03E/YLlUAKh8TnoSHh49NT0+vLG5paWk0JyfnPu9cJ8EUGho6cfTo0fbBwcFWRwH6+vpaYcy0yCk26Hb0zc7ObsFYaIOxaY5xqn9M2ClTgGw8wqM4LuzevXu6xMTEnitXrjTOz8/3Chfl7du3Ly5fvtyUkJDQrzRedXV1I2/KWZkCwCDrsMMWi+WV46Sk42+EhwV24VhnNpuHaY43NFct5pRtA7tw9BkZGQ/peVHIL+bDhw8/YrtKXJM4QOVrVNfV1TXKXr2d6mTK8EI+tk4KPrszNjY2mIJTiK+vb5iK+zX29vbqW1paLNRe7N271590PpF+hyq1hzpt3bpVTE5ODlDfFIU5FdfiTRxAkDKVlpY2QI2VVNvOHUIVXjJmUEcC6Rz7keGLffv2CdoMK5/AogzupCZA8aZNmwxkbEMKi18sKSmxqcF1QjohmgF6UYl3LPw7GxoYGBAbN24U+fn5puLi4qWqqqoBGdwJxZ+J2ZeEXF6U9dixYw+VdLi1tbWJF3/aycBn0aa9vb3J1q++vl4EBARAfYRM7oTSwpFzjjAeExMznJ6e/mRkZORfAoA20Mn8Re3KFAaD9zpH2MzP13GK1GcafSl+iIiICGEymd6Nh4BG7SbVNgNj8Zg7nQmwdPLkybahoaG22dnZbntu41i6u7sh7CzhM1fciZCKTUEf9M3KyhLJycnYBCGTO6FYmpqa3HKX5eXlDWysUW5wp0K0LSoqasvLyxP+/v7ixIkTQjZ3WhFAR8UbAdzgTmY/Pz9rfHy8KCgoEKOjo0I2d1pxzxhAr9e3GI3GZ87ogp0KpbriTrdv3+6ghS9XVlYaFxYWxFpxJ5QaltxMeAOOf+DAgQ4VI55mIy53hzuRx7GuNXfSsM5FwJURzhBK3HSjZ/8P3MmrQIYgxUJUcvDKx/OtW7c61ps7ObtSziHiqlEJ0AU+VqgfPI8lOjraajAYVNUGKgg7Kisra4RDwG9bnFAqZMTjcBBI3ziLA0ovQPL0cXFxg6STU84W1NPT8+DSpUtt8DY3btwwqqm2p9zJ1q+wsBAqC7uL9EQA3H+Fu+41NzdXkPELMmQhizvZeSc9bQ5OucAtATiKLsAPK+0KXCKIWW1trSBSJjIzM8EwxYULF4RM7mRf0tLSnrCX/JXwLW9CLPO4VVfKcHAj4kMvldwZ6ojzr5CywMBAsWXLFrFnz54VmjAxMSE84U4KQqziTvYFapqSktIJnkbtXjNvW+DU5ioB8vDIOrlq7Xfu3GmgINNHl47lixcvIiO3QszsuY273ElFgFXcSSVGTBFfew7eBv4GHucoAHz6Y+I1r23UgFRmED6e1QD8XZBOW7zlTk4EgE28rKioaHBnbNgnPJ+vw8UGrO8rcoVzdJ2MqKmp0ZEbC7l58yaSWacJn0LqoKCgcc1/XOg0nHqhBDt6XI+TsXvnNXdycQJpUCHouzOagTkxN9/mrKqZAE7QgloEOtR7zZ1cCFABRqpkxNgIMuKnmIsvQGaOJ9UepzLelzupjJnlzI2mpqZ28KKvcspHy2vY4I0AMrhTDOMLQhXeXbt2zftAJikd7yl3AmZAxXFK3lIJH08lUUo++aBSo+ki7vQBGaHTRBjdwJ7TghGENFqtNoAuPTvUEmFkDxN0Z7ZSkBymvlqltUj5DOQpd/Kk4HbG6pct5fuYp9xJQlk8depUK1/8P5EqgDvcydPV4g6gVMcutNmWd5IlgEvuhA8ixJl63LjU64uKinS4g+AW5niauE+wKn0vUwB3uNMcvM+RI0faQcKU0ioHDx60pVWMtmQWvj9jLFtaBXNwWmWXbBvYThiAO8TO8UIMHHAQaOIIPyEQ7d+/v9NRgN27d3exfv/AhG4D9zVgLIzJ7heJrW3SjdgVd7Jr8zsybfZUATyKU4tXVXKt9Txml2pqUdbXdDXuZPf+OySPkX+1CQBixtzmjEqfQL6tJaqtxU/ix3I9n4JaeUEInZmZGSHasVIxNTU1wx9TulTGNNGf35zN67eOFL6X4Hv+/Hkr3aN14PNEPYL5atgvjde4+1HBy3/PaXb49xwwzD/eZyP/EWAAQ3AUnjpOYHIAAAAASUVORK5CYII="},jr={initialize:function(){this._parent=(this._parent||this).constructor.__super__,this._parent.initialize.apply(this,arguments),this.listenTo(this,"change:icon",this._onIconChange),this._onIconChange(this,this.get("icon")||"none")},_onIconChange:function(t,e){if(!Ie(Br,e))throw"BPMN: Unknown icon: "+e;t.attr({image:{"xlink:href":Br[e],dataIconType:e}})}},Rr={initialize:function(){this._parent=(this._parent||this).constructor.__super__,this._parent.initialize.apply(this,arguments),this.listenTo(this,"change:subProcess",this._onSubProcessChange),this._onSubProcessChange(this,this.get("subProcess")||null)},_onSubProcessChange:function(t,e){t.attr({".sub-process":{visibility:e?"visible":"hidden","data-sub-process":e||""}})}},Vr=Mr,Zr=Pr.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body outer"/><rect class="body inner"/></g>',yi.test("svgforeignobject")?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>','<path class="sub-process"/><image class="icon"/></g>'].join(""),defaults:te({size:{width:100,height:100},type:"bpmn.Activity",attrs:{rect:{rx:8,ry:8,width:100,height:100},".body":{fill:"#ffffff",stroke:"#000000"},".inner":{transform:"scale(0.9,0.9) translate(5,5)"},path:{d:"M 0 0 L 30 0 30 30 0 30 z M 15 4 L 15 26 M 4 15 L 26 15",ref:".inner","ref-x":.5,"ref-dy":-30,"x-alignment":"middle",stroke:"#000000",fill:"transparent"},image:{ref:".inner","ref-x":5,width:20,height:20}},activityType:"task",subProcess:null},Pr.prototype.defaults),initialize:function(){Pr.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:activityType",this.onActivityTypeChange),this.listenTo(this,"change:subProcess",this.onSubProcessChange),this.onSubProcessChange(this,this.get("subProcess")),this.onActivityTypeChange(this,this.get("activityType"))},onActivityTypeChange:function(t,e){switch(e){case"task":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":1,"stroke-dasharray":"none"},path:{ref:".outer"},image:{ref:".outer"}});break;case"transaction":t.attr({".inner":{visibility:"visible"},".outer":{"stroke-width":1,"stroke-dasharray":"none"},path:{ref:".inner"},image:{ref:".inner"}});break;case"event-sub-process":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":1,"stroke-dasharray":"1,2"},path:{ref:".outer"},image:{ref:".outer"}});break;case"call-activity":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":5,"stroke-dasharray":"none"},path:{ref:".outer"},image:{ref:".outer"}});break;default:throw"BPMN: Unknown Activity Type: "+e}},onSubProcessChange:function(t,e){e?t.attr({".fobj div":{style:{verticalAlign:"baseline",paddingTop:10}},image:{"ref-dy":-25,"ref-y":""},".content":{"ref-y":10,"y-alignment":null}}):t.attr({".fobj div":{style:{verticalAlign:"middle",paddingTop:0}},image:{"ref-dy":"","ref-y":5},".content":{"ref-y":.5,"y-alignment":"middle"}})}}).extend(jr).extend(Rr),Wr=Mr,Yr=Pr.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body"/></g>',yi.test("svgforeignobject")?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>','<path class="stroke"/></g>'].join(""),defaults:te({size:{width:100,height:100},type:"bpmn.Annotation",attrs:{rect:{width:100,height:100},".body":{"fill-opacity":.1,fill:"#ffffff",stroke:"none"},".fobj div":{style:{textAlign:"left",paddingLeft:10}},".stroke":{stroke:"#000000",fill:"none","stroke-width":3}},wingLength:20},Pr.prototype.defaults),initialize:function(){Pr.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:size",this.onSizeChange),this.onSizeChange(this,this.get("size"))},onSizeChange:function(t,e){t.attr(".stroke",{d:t.getStrokePathData(e.width,e.height,t.get("wingLength"))})},getStrokePathData:function(t,e,i){return["M",i=Math.min(i,t),"0 L 0 0 0",e,i,e].join(" ")}}),Hr=di.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/><image/></g></g><text class="label"/>',defaults:te({type:"bpmn.Gateway",size:{width:80,height:80},attrs:{".body":{points:"40,0 80,40 40,80 0,40",fill:"#ffffff",stroke:"#000000"},".label":{text:"",ref:".body","ref-x":.5,"ref-dy":20,"y-alignment":"middle","x-alignment":"middle","font-size":14,"font-family":"Arial, helvetica, sans-serif",fill:"#000000"},image:{width:40,height:40,"xlink:href":"",transform:"translate(20,20)"}}},di.prototype.defaults)}).extend(jr),Fr=di.extend({markup:'<g class="rotatable"><g class="scalable"><circle class="body outer"/><circle class="body inner"/><image/></g><text class="label"/></g>',defaults:te({type:"bpmn.Event",size:{width:60,height:60},attrs:{".body":{fill:"#ffffff",stroke:"#000000"},".outer":{"stroke-width":1,r:30,transform:"translate(30,30)"},".inner":{"stroke-width":1,r:26,transform:"translate(30,30)"},image:{width:40,height:40,"xlink:href":"",transform:"translate(10,10)"},".label":{text:"",fill:"#000000","font-family":"Arial","font-size":14,ref:".outer","ref-x":.5,"ref-dy":20,"x-alignment":"middle","y-alignment":"middle"}},eventType:"start"},di.prototype.defaults),initialize:function(){di.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:eventType",this.onEventTypeChange),this.onEventTypeChange(this,this.get("eventType"))},onEventTypeChange:function(t,e){switch(e){case"start":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":1}});break;case"end":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":5}});break;case"intermediate":t.attr({".inner":{visibility:"visible"},".outer":{"stroke-width":1}});break;default:throw"BPMN: Unknown Event Type: "+e}}}).extend(jr),Ur=di.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body"/></g>','<svg overflow="hidden" class="blackbox-wrap"><text class="blackbox-label"/></svg>','<rect class="header"/><text class="label"/>','<g class="lanes"/>',"</g>"].join(""),laneMarkup:'<g class="lane"><rect class="lane-body"/><rect class="lane-header"/><text class="lane-label"/></g>',defaults:te({type:"bpmn.Pool",size:{width:600,height:300},attrs:{".body":{fill:"#ffffff",stroke:"#000000",width:500,height:200,"pointer-events":"stroke"},".header":{fill:"#ffffff",stroke:"#000000",width:20,ref:".body","ref-height":1,"pointer-events":"visiblePainted"},".label":{fill:"#000000",transform:"rotate(-90)",ref:".header","ref-x":10,"ref-y":.5,"font-family":"Arial","font-size":14,"x-alignment":"middle","text-anchor":"middle"},".lane-body":{fill:"#ffffff",stroke:"#000000","pointer-events":"stroke"},".lane-header":{fill:"#ffffff",stroke:"#000000","pointer-events":"visiblePainted"},".lane-label":{fill:"#000000",transform:"rotate(-90)","text-anchor":"middle","font-family":"Arial","font-size":13},".blackbox-wrap":{ref:".body","ref-width":1,"ref-height":1},".blackbox-label":{text:"Black Box","text-anchor":"middle",transform:"translate(0,-7)"},".blackbox-label > tspan":{dx:"50%",dy:"50%"}}},di.prototype.defaults)}),Xr=vi.extend({options:{headerWidth:20},presentationAttributes:vi.addPresentationAttributes({lanes:["LANES"]}),confirmUpdate:function(){var t=vi.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"LANES")&&(this.renderLanes(this.model.get("lanes")),t=this.removeFlag(t,["LANES"])),t},update:function(){return void 0===this.lanesAttrs?this.renderLanes(this.model.get("lanes")):vi.prototype.update.call(this,this.model,Tt({},this.model.get("attrs"),this.lanesAttrs||{}))},renderMarkup:function(){vi.prototype.renderMarkup.apply(this,arguments),this.$lanes=this.$(".lanes"),this.laneMarkup=Ot(this.model.laneMarkup)},renderLanes:function(t){t=t||{};var e=void(this.index=0)===t.headerWidth?this.options.headerWidth:t.headerWidth;this.lanesAttrs={".header":{width:e},".label":{text:t.label||""}},this.$lanes.empty(),t.sublanes&&this.renderSublanes(t.sublanes,e,0,1,"lanes"),this.update(this.model,Tt({},this.model.get("attrs"),this.lanesAttrs))},calculateRatios:function(t,e){for(var i=0,n=[],s=[],r=0,o=t.length;r<o;r++){var a=t[r].ratio;Number.isFinite(a)?(i+=a/10,s[r]=a/10/e):n.push(r)}for(var l=Math.max(1-i,0)*e/n.length,h=0,c=n.length;h<c;h++)s[n[h]]=l;return s},renderSublanes:function(t,d,p,e,i){var g=this.options.headerWidth,f=i+"/sublanes/",m=this.calculateRatios(t,e);pe(t).reduce(function(t,e,i){var n="lane"+this.index,s="."+n+" .lane-body",r="."+n+" .lane-header",o="."+n+" .lane-label";e.name&&(n+=" "+e.name);var a=f+i,l=this.laneMarkup.clone().addClass(n).attr({"data-lane-path":a,"data-lane-index":this.index});this.$lanes.append(l.node);var h=m[i],c=void 0===e.headerWidth?g:e.headerWidth,u=p+t;return this.lanesAttrs[s]={ref:".body","ref-height":h,"ref-width":-d,"ref-x":d,"ref-y":u},this.lanesAttrs[r]={width:c,ref:".body","ref-height":h,"ref-x":d,"ref-y":u},this.lanesAttrs[o]={text:e.label,ref:r,"ref-x":10,"ref-y":.5,"x-alignment":"middle"},this.index++,e.sublanes&&this.renderSublanes(e.sublanes,d+c,u,h,a),t+h}.bind(this),0)}}),Jr=di.extend({markup:'<g class="rotatable"><g class="scalable"><rect class="body"/></g><rect class="label-rect"/><g class="label-group"><svg overflow="hidden" class="label-wrap"><text class="label"/></svg></g></g>',defaults:te({type:"bpmn.Group",size:{width:200,height:200},attrs:{".body":{width:200,height:200,stroke:"#000000","stroke-dasharray":"6,6","stroke-width":2,fill:"transparent",rx:15,ry:15,"pointer-events":"stroke"},".label-rect":{ref:".body","ref-width":.6,"ref-x":.4,"ref-y":-30,height:25,fill:"#ffffff",stroke:"#000000"},".label-group":{ref:".label-rect","ref-x":0,"ref-y":0},".label-wrap":{ref:".label-rect","ref-width":1,"ref-height":1},".label":{text:"",x:"50%",y:"1.3em","text-anchor":"middle","font-family":"Arial","font-size":14,fill:"#000000"}}},di.prototype.defaults)}),$r=di.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/></g><text class="label"/></g>',defaults:te({type:"bpmn.DataObject",size:{width:60,height:80},attrs:{".body":{points:"20,0 60,0 60,80 0,80 0,20 20,0 20,20 0,20",stroke:"#000000",fill:"#ffffff"},".label":{ref:".body","ref-x":.5,"ref-dy":5,text:"","text-anchor":"middle"}}},di.prototype.defaults)}),Kr=di.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/></g><text class="label"/><path class="sub-process"/></g>',defaults:te({type:"bpmn.Conversation",size:{width:100,height:100},attrs:{".body":{points:"25,0 75,0 100,50 75,100 25,100 0,50",stroke:"#000000",fill:"#ffffff"},".label":{text:"",ref:".body","ref-x":.5,"ref-dy":5,"text-anchor":"middle"},path:{d:"M 0 0 L 30 0 30 30 0 30 z M 15 4 L 15 26 M 4 15 L 26 15",ref:".body","ref-x":.5,"ref-dy":-30,"x-alignment":"middle",fill:"#ffffff",stroke:"#000000","fill-opacity":0}},conversationType:"conversation"},di.prototype.defaults),initialize:function(){di.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:conversationType",this.onConversationTypeChange),this.onConversationTypeChange(this,this.get("conversationType"))},onConversationTypeChange:function(t,e){switch(e){case"conversation":t.attr("polygon/stroke-width",1);break;case"call-conversation":t.attr("polygon/stroke-width",4);break;default:throw"BPMN: Unknown Conversation Type: "+e}}}).extend(Rr),Qr=Pr.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body"/></g>',yi.test("svgforeignobject")?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>','<text class="label"/><path class="sub-process"/><g class="participants"/>',"</g>"].join(""),participantMarkup:'<g class="participant"><rect class="participant-rect"/><text class="participant-label"/></g>',defaults:te({type:"bpmn.Choreography",size:{width:60,height:80},attrs:{rect:{},".body":{width:60,height:80,stroke:"#000000",fill:"#ffffff"},".label":{ref:".body","ref-x":.5,"ref-dy":5,text:"","text-anchor":"middle"},".participant-rect":{stroke:"#000000",fill:"#aaaaaa",ref:".body","ref-width":1},".participant-label":{"text-anchor":"middle",ref:".participant_0 .participant-rect","ref-x":.5,"ref-y":.5,"y-alignment":"middle"},".sub-process":{d:"M 0 0 L 30 0 30 30 0 30 z M 15 4 L 15 26 M 4 15 L 26 15",ref:".body","ref-x":.5,"ref-dy":-30,"x-alignment":"middle",fill:"transparent",stroke:"#000000"}},participants:[],initiatingParticipant:0},Pr.prototype.defaults)}).extend(Rr),qr=Mr.extend({options:{participantHeight:20},presentationAttributes:Mr.addPresentationAttributes({participants:"PARTICIPANTS",initiatingParticipant:"INIT_PARTICIPANT"}),initFlag:["PARTICIPANTS"].concat(Mr.prototype.initFlag),confirmUpdate:function(){var t=Mr.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"PARTICIPANTS")?(this.renderParticipants(this.model.get("participants")),t=this.removeFlag(t,["PARTICIPANTS","INIT_PARTICIPANT"])):(this.hasFlag(t,"INIT_PARTICIPANT")&&(this.layoutAndUpdate(),t=this.removeFlag(t,"INIT_PARTICIPANT")),t)},update:function(){return void 0===this.participantsAttrs?this.renderParticipants(this.model.get("participants")):(this.layoutAndUpdate(),this)},render:function(){this.participantsAttrs=void 0,vi.prototype.render.apply(this,arguments)},renderMarkup:function(){vi.prototype.renderMarkup.apply(this,arguments),this.$participants=this.$(".participants"),this.participantMarkup=Ot(this.model.participantMarkup)},renderParticipants:function(t){this.$participants.empty(),this.participantsAttrs={},pe(t).forEach(function(t,e){var i="participant_"+e,n="."+i;this.participantsAttrs[n+" .participant-rect"]={height:this.options.participantHeight},this.participantsAttrs[n+" .participant-label"]={text:t},this.$participants.append(this.participantMarkup.clone().addClass(i).node)},this),this.layoutAndUpdate()},layoutAndUpdate:function(){var t=this.model.get("participants")||[],e=t.length,n=this.options.participantHeight,i=this.model.get("size").height,s=Math.max(0,i-n*e),r=0,o=this.model.get("initiatingParticipant"),a=Math.max(Dt(o)?Math.abs(o):t.indexOf(o),0),l=Math.min(a,e-2);pe(t).forEach(function(t,e){var i=".participant_"+e;this.participantsAttrs[i]={transform:"translate(0,"+r+")"},this.participantsAttrs[i+" .participant-rect"].fill=a==e?this.model.attr(".body/fill"):this.model.attr(".participant-rect/fill"),this.participantsAttrs[i+" .participant-rect"].stroke=a==e?this.model.attr(".body/stroke"):this.model.attr(".participant-rect/stroke"),r+=n+(l==e?s:0)},this);var h=e<2?0:l-e+1;this.participantsAttrs[".sub-process"]={"ref-dy":Math.max(-i,h*n-30)};var c=e<2?0:l+1;this.participantsAttrs[".fobj div"]={style:{height:s,paddingTop:n*c}},this.participantsAttrs[".content"]={"ref-y":n*c+s/2};var u=Tt({},this.model.get("attrs"),this.participantsAttrs||{});mt(u,"div/html"),Mr.prototype.update.call(this,this.model,u)}}),to=di.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/></g><text class="label"/></g>',defaults:te({type:"bpmn.Message",size:{width:60,height:40},attrs:{".body":{points:"0,0 60,0 60,40 0,40 0,0 60,0 30,20 0,0",stroke:"#000000",fill:"#ffffff"},".label":{ref:".body","ref-x":.5,"ref-dy":5,text:"","text-anchor":"middle"}}},di.prototype.defaults)}),eo=Li.extend({defaults:{type:"bpmn.Flow",attrs:{".marker-source":{d:"M 0 0"},".marker-target":{d:"M 10 0 L 0 5 L 10 10 z",fill:"#000000"},".connection":{"stroke-dasharray":" ","stroke-width":1},".connection-wrap":{style:"",onMouseOver:"",onMouseOut:""}},flowType:"normal"},initialize:function(){Li.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:flowType",this.onFlowTypeChange),this.onFlowTypeChange(this,this.get("flowType"))},onFlowTypeChange:function(t,e){var i;switch(e){case"default":i={".marker-source":{d:"M 0 5 L 20 5 M 20 0 L 10 10",fill:"none"}};break;case"conditional":i={".marker-source":{d:"M 20 8 L 10 0 L 0 8 L 10 16 z",fill:"#FFF"}};break;case"normal":i={};break;case"message":i={".marker-target":{fill:"#FFF"},".connection":{"stroke-dasharray":"4,4"}};break;case"association":i={".marker-target":{d:"M 0 0"},".connection":{"stroke-dasharray":"4,4"}};break;case"conversation":i={".marker-target":{d:"M 0 0"},".connection":{"stroke-width":"7px"},".connection-wrap":{style:"stroke: #fff; stroke-width: 5px; opacity: 1;",onMouseOver:"var s=this.style;s.stroke='#000';s.strokeWidth=15;s.opacity=.4",onMouseOut:"var s=this.style;s.stroke='#fff';s.strokeWidth=5;s.opacity=1"}};break;default:throw"BPMN: Unknown Flow Type: "+e}i.root={dataFlowType:e},t.attr(Tt({},this.defaults.attrs,i))}}),io={icons:Br,IconInterface:jr,SubProcessInterface:Rr,ActivityView:Vr,Activity:Zr,AnnotationView:Wr,Annotation:Yr,Gateway:Hr,Event:Fr,Pool:Ur,PoolView:Xr,Group:Jr,DataObject:$r,Conversation:Kr,Choreography:Qr,ChoreographyView:qr,Message:to,Flow:eo},no={exportElement:function(t){return t.size()},exportLink:function(t){var e=t.get("labelSize")||{};return{minLen:t.get("minLen")||1,weight:t.get("weight")||1,labelpos:t.get("labelPosition")||"c",labeloffset:t.get("labelOffset")||0,width:e.width||0,height:e.height||0}},importElement:function(t,e,i){var n=this.getCell(e),s=i.node(e);t.setPosition?t.setPosition(n,s):n.set("position",{x:s.x-s.width/2,y:s.y-s.height/2})},importLink:function(t,e,i){var n=this.getCell(e.name),s=i.edge(e),r=s.points||[];if((t.setVertices||t.setLinkVertices)&&(ue(t.setVertices)?t.setVertices(n,r):n.set("vertices",r.slice(1,r.length-1))),t.setLabels&&"x"in s&&"y"in s){var o={x:s.x,y:s.y};if(ue(t.setLabels))t.setLabels(n,o,r);else{var a=K(r),l=a.closestPointLength(o),h=a.pointAtLength(l),c=l/a.length();n.label(0,{position:{distance:c,offset:j(o).difference(h).toJSON()}})}}},layout:function(t,e){var i;i=t instanceof Xs?t:(new Xs).resetCells(t,{dry:!0,sort:!1});var n=(e=ie(e||{},{resizeClusters:!(t=null),clusterPadding:10,exportElement:this.exportElement,exportLink:this.exportLink})).dagre||("undefined"!=typeof dagre?dagre:void 0);if(void 0===n)throw new Error('The the "dagre" utility is a mandatory dependency.');var s=no.toGraphLib(i,{graphlib:e.graphlib,directed:!0,multigraph:!0,compound:!0,setNodeLabel:e.exportElement,setEdgeLabel:e.exportLink,setEdgeName:function(t){return t.id}}),r={},o=e.marginX||0,a=e.marginY||0;if(e.rankDir&&(r.rankdir=e.rankDir),e.align&&(r.align=e.align),e.nodeSep&&(r.nodesep=e.nodeSep),e.edgeSep&&(r.edgesep=e.edgeSep),e.rankSep&&(r.ranksep=e.rankSep),e.ranker&&(r.ranker=e.ranker),o&&(r.marginx=o),a&&(r.marginy=a),s.setGraph(r),n.layout(s,{debugTiming:!!e.debugTiming}),i.startBatch("layout"),no.fromGraphLib(s,{importNode:this.importElement.bind(i,e),importEdge:this.importLink.bind(i,e)}),e.resizeClusters){var l=s.nodes().filter(function(t){return 0<s.children(t).length}).map(i.getCell.bind(i)).sort(function(t,e){return e.getAncestors().length-t.getAncestors().length});se(l,"fitEmbeds",{padding:e.clusterPadding})}i.stopBatch("layout");var h=s.graph();return Q(o,a,Math.abs(h.width-2*o),Math.abs(h.height-2*a))},fromGraphLib:function(e,i){var n=(i=i||{}).importNode||De,s=i.importEdge||De,r=this instanceof Xs?this:new Xs;return e.nodes().forEach(function(t){n.call(r,t,e,r,i)}),e.edges().forEach(function(t){s.call(r,t,e,r,i)}),r},toGraphLib:function(t,e){var i=(e=e||{}).graphlib||("undefined"!=typeof graphlib?graphlib:void 0);if(void 0===i)throw new Error('The the "graphlib" utility is a mandatory dependency.');for(var n=Se(e,"directed","compound","multigraph"),s=new i.Graph(n),r=e.setNodeLabel||De,o=e.setEdgeLabel||De,a=e.setEdgeName||De,l=t.get("cells"),h=0,c=l.length;h<c;h++){var u=l.at(h);if(u.isLink()){var d=u.get("source"),p=u.get("target");if(!d.id||!p.id)break;s.setEdge(d.id,p.id,o(u),a(u))}else if(s.setNode(u.id,r(u)),s.isCompound()&&u.has("parent")){var g=u.get("parent");l.has(g)&&s.setParent(u.id,g)}}return s}};Xs.prototype.toGraphLib=function(t){return no.toGraphLib(this,t)},Xs.prototype.fromGraphLib=function(t,e){return no.fromGraphLib.call(this,t,e)};var so={Port:ii,PortLabel:hi,DirectedGraph:no},ro=o.Model.extend({defaults:{linkDistance:10,linkStrength:1,charge:10,x:0,y:0},cacheAttribute:"_fcache",initialize:function(){var t,e,i=this.get("graph");if(Array.isArray(i)){var n=i;t=[],e=[];for(var s=0,r=n.length;s<r;s++){var o=n[s];o.isLink()?t.push(o):e.push(o)}}else e=i.getElements(),t=i.getLinks();this.links=t,this.elements=e,this.x=this.get("x"),this.y=this.get("y"),this.width=this.get("width"),this.height=this.get("height"),this.gravityCenter=this.get("gravityCenter"),this.t=1,this.energy=1/0,this.progress=0},start:function(){var s=this.width,r=this.height,o=this.x,a=this.y;this.elements.forEach(function(t){var e=g.random(o,o+s),i=g.random(a,a+r);t.position(e,i,{forceDirected:!0});var n=t[this.cacheAttribute]={};n.charge=t.get("charge")||this.get("charge"),n.weight=t.get("weight")||1,n.x=n.px=e,n.y=n.py=i,n.fx=0,n.fy=0},this),this.links.forEach(function(t){var e=t[this.cacheAttribute]={};e.source=t.getSourceElement(),e.target=t.getTargetElement(),e.strength=t.get("strength")||this.get("linkStrength"),e.distance=t.get("distance")||this.get("linkDistance")},this)},step:function(){if(.99*this.t<.005)return this.notifyEnd();var t,e,i,n,s,r,o,a,l,h,c,u=this.cacheAttribute,d=this.width,p=this.height,g=this.x,f=this.y,m=this.gravityCenter,v=this.energy,y=this.energy=0,b=0,w=0,C=0,I=this.elements.length,x=this.links.length;for(t=0;t<I-1;t++)for(y+=(i=this.elements[t][u]).x,b+=i.y,e=t+1;e<I;e++)o=(s=(n=this.elements[e][u]).x-i.x)*s+(r=n.y-i.y)*r,a=Math.sqrt(o),h=(l=this.t*i.charge/o)*s,c=l*r,i.fx-=h,i.fy-=c,n.fx+=h,n.fy+=c,this.energy+=h*h+c*c;var A,S,_,P,M,k,T=this.elements[I-1][u];for(y+=T.x,b+=T.y,t=0;t<x;t++)i=(A=this.links[t][u]).source[u],o=(s=(n=A.target[u]).x-i.x)*s+(r=n.y-i.y)*r,a=Math.sqrt(o),h=(S=this.t*A.strength*(a-A.distance)/a)*s,c=S*r,_=i.weight/(i.weight+n.weight),i.x+=h*(1-_),i.y+=c*(1-_),n.x-=h*_,n.y-=c*_,this.energy+=h*h+c*c;for(t=0;t<I;t++){k={x:(M=(P=this.elements[t])[u]).x,y:M.y},m&&(k.x+=(m.x-k.x)*this.t*.1,k.y+=(m.y-k.y)*this.t*.1),k.x+=M.fx,k.y+=M.fy,k.x=Math.max(g,Math.min(g+d,k.x)),k.y=Math.max(f,Math.min(g+p,k.y));k.x+=.9*(M.px-k.x),k.y+=.9*(M.py-k.y),M.px=k.x,M.py=k.y,M.fx=M.fy=0,M.x=k.x,M.y=k.y,w+=M.x,C+=M.y,this.notify(P,t,k)}this.t=this.cool(this.t,this.energy,v);var N=y-w,D=b-C;Math.sqrt(N*N+D*D)<1&&this.notifyEnd()},cool:function(t,e,i){return e<i?(this.progress+=1,5<=this.progress?(this.progress=0,t/.99):t):(this.progress=0,.99*t)},notify:function(t,e,i){t.set("position",i,{forceDirected:!0})},notifyEnd:function(){this.trigger("end")}}),oo={layout:function(t,p){var e;e=t instanceof Xs?t:(new Xs).resetCells(t,{dry:!0,sort:!1}),t=null,p=p||{};var i=e.getElements(),g=p.columns||1,n=Math.ceil(i.length/g),f=p.dx||0,m=p.dy||0,v=void 0===p.centre||!1!==p.centre,y=!!p.resizeToFit,s=p.marginX||0,r=p.marginY||0,b=[],o=p.columnWidth;if("compact"===o)for(var a=0;a<g;a++){var l=this._elementsAtColumn(i,a,g);b.push(this._maxDim(l,"width")+f)}else{o&&!Ne(o)||(o=this._maxDim(i,"width")+f);for(var h=0;h<g;h++)b.push(o)}var w=this._accumulate(b,s),C=[],c=p.rowHeight;if("compact"===c)for(var u=0;u<n;u++){var d=this._elementsAtRow(i,u,g);C.push(this._maxDim(d,"height")+m)}else{c&&!Ne(c)||(c=this._maxDim(i,"height")+m);for(var I=0;I<n;I++)C.push(c)}var x=this._accumulate(C,r);e.startBatch("layout"),i.forEach(function(t,e){var i=e%g,n=Math.floor(e/g),s=b[i],r=C[n],o=0,a=0,l=t.get("size");if(y){var h=s-2*f,c=r-2*m,u=l.height*(l.width?h/l.width:1),d=l.width*(l.height?c/l.height:1);r<u?h=d:c=u,l={width:h,height:c},t.set("size",l,p)}v&&(o=(s-l.width)/2,a=(r-l.height)/2),t.position(w[i]+f+o,x[n]+m+a,p)}),e.stopBatch("layout")},_maxDim:function(t,i){return t.reduce(function(t,e){return Math.max(e.get("size")[i],t)},0)},_elementsAtRow:function(t,e,i){for(var n=[],s=i*e,r=s+i;s<r;s++)n.push(t[s]);return n},_elementsAtColumn:function(t,e,i){for(var n=[],s=e,r=t.length;s<r;s+=i)n.push(t[s]);return n},_accumulate:function(t,e){return t.reduce(function(t,e,i){return t.push(t[i]+e),t},[e||0])}};function ao(t,e,i){i=ie(i||{},{siblingGap:0}),this.width=0,this.height=0,this.layoutAreas=this.sortLayoutAreas(t),this.parentArea=e,this.siblingGap=i.siblingGap,this.exists()&&this.computeSize(i)}ee(ao.prototype,{sortLayoutAreas:function(t){var e=me(t,"siblingRank");return e.forEach(function(t,e){t.siblingRank=e}),e},move:function(t,e){for(var i=0,n=this.layoutAreas.length;i<n;i++)this.layoutAreas[i].dx+=t,this.layoutAreas[i].dy+=e},exists:function(){return 0<this.layoutAreas.length},sumGaps:function(t){return Math.max(this.layoutAreas.length-1,0)*t},getSiblingRankByPoint:function(t){if(!this.exists())return-1;var e=this.findAreaByPoint(t);return e?e.siblingRank-1:this.layoutAreas.length-1},getFirstChildConnectionPoints:function(){return[]},getConnectionPoints:function(t,e){if(!this.exists())return this.getFirstChildConnectionPoints(t);var i={dx:t.x-this.parentArea.rootCX,dy:t.y-this.parentArea.rootCY};return this.layoutAreas[0].getRootVertices(i,e)},getParentConnectionPoint:function(){var t=this.parentArea,e=this.proxyLayoutArea("getConnectionPoint",t.rootSize);return H(t.rootCX,t.rootCY).offset(e.x,e.y)},getChildConnectionPoint:function(t,e){var i=this.proxyLayoutArea("getConnectionPoint",e);return H(t).difference(i)},proxyLayoutArea:function(t){var e=Array.prototype.slice.call(arguments,1);return Io.fromDirection(this.direction).prototype[t].apply(this.parentArea,e)}}),ao.extend=o.Model.extend;var lo=ao.extend({getTopDY:function(){return-this.height/2},findAreaByPoint:function(e){return this.layoutAreas.find(function(t){return t.rootCY>e.y})},computeSize:function(i){this.height=this.sumGaps(i.siblingGap);var t=this.layoutAreas;this.height+=t.reduce(function(t,e){return t+e.height+e.prevSiblingGap+e.nextSiblingGap},0),t.reduce(function(t,e){return this.width=Math.max(this.width,e.getExtendedWidth()),e.dy+=t+e.getCY(),t+e.prevSiblingGap+e.height+e.nextSiblingGap+i.siblingGap}.bind(this),this.getTopDY())},getYTowardsParent:function(){return this.parentArea.rootCY},getXTowardsParent:function(){var t=this.parentArea;return t.rootCX+this.LRSign*(t.rootSize.width/2+t.gap)},getNeighborPointFromRank:function(t){var e,i=this.siblingGap;if(this.exists()){var n=this.layoutAreas[t],s=this.layoutAreas[t+1];e=n?s?(n.y+n.height+s.y)/2:n.y+n.height+i/2:s.y-i/2}else e=this.getYTowardsParent();return{x:this.getXTowardsParent(),y:e}}}),ho=lo.extend({direction:"L",LRSign:-1}),co=lo.extend({direction:"R",LRSign:1}),uo={getXTowardsParent:function(){var t=this.parentArea;return t.rootCX+this.LRSign*t.gap},getYTowardsParent:function(){var t=this.parentArea,e=t.getLRHeight(t.siblings)/2;return e+=Math.min(t.firstChildGap,this.siblingGap/2),t.rootCY+this.TBSign*e},getFirstChildConnectionPoints:function(t){return[H(this.parentArea.rootCX,t.y)]},getChildConnectionPoint:function(t,e){return H(t).offset(-this.LRSign*e.width/2,0)},getParentConnectionPoint:function(){var t=this.parentArea;return H(t.rootCX,t.rootCY).offset(0,this.TBSign*(t.rootSize.height-t.rootMargin)/2)}},po={getTopDY:function(){return 0}},go={getTopDY:function(){return-this.height}},fo=lo.extend({direction:"BR",LRSign:1,TBSign:1});ee(fo.prototype,uo,po);var mo=lo.extend({direction:"BL",LRSign:-1,TBSign:1});ee(mo.prototype,uo,po);var vo=lo.extend({direction:"TR",LRSign:1,TBSign:-1});ee(vo.prototype,uo,go);var yo=lo.extend({direction:"TL",LRSign:-1,TBSign:-1});ee(yo.prototype,uo,go);var bo=ao.extend({getLeftDX:function(){return-this.width/2},findAreaByPoint:function(e){return this.layoutAreas.find(function(t){return t.rootCX>e.x})},computeSize:function(i){this.width=this.sumGaps(i.siblingGap);var t=this.layoutAreas;this.width+=t.reduce(function(t,e){return t+e.width+e.prevSiblingGap+e.nextSiblingGap},0),t.reduce(function(t,e){return this.height=Math.max(this.height,e.getExtendedHeight()),e.dx+=t+e.getCX(),t+e.prevSiblingGap+e.width+e.nextSiblingGap+i.siblingGap}.bind(this),this.getLeftDX())},getNeighborPointFromRank:function(t){var e;if(this.exists()){var i=this.layoutAreas[t],n=this.layoutAreas[t+1];e=i?n?(i.x+i.width+n.x)/2:i.x+i.width+this.siblingGap/2:n.x-this.siblingGap/2}else e=this.parentArea.rootCX;return{x:e,y:this.getYTowardsParent()}}}),wo=bo.extend({direction:"T",getYTowardsParent:function(){var t=this.parentArea;return t.rootCY-t.getLRHeight()/2-t.gap}}),Co=bo.extend({direction:"B",getYTowardsParent:function(){var t=this.parentArea;return t.rootCY+t.getLRHeight()/2+t.gap}});function Io(t,e){this.root=t;var i=ee({},e,this.getRootAttributes(t,e.attributeNames)),n=e.gap||0;ie(i,{parentGap:n,siblingGap:n,firstChildGap:n}),this.siblingRank=i.siblingRank,this.rootOffset=i.rootOffset,this.rootMargin=i.rootMargin,this.siblingGap=i.siblingGap,this.gap=this.parentGap=i.parentGap,this.nextSiblingGap=i.nextSiblingGap,this.prevSiblingGap=i.prevSiblingGap,this.firstChildGap=i.firstChildGap,this.dx=0,this.dy=0,this.width=0,this.height=0}ee(Io,{create:function(t,e,i){return new(Io.fromDirection(t,i))(e,i)},fromDirection:function(t,e){var i;switch(t){case"L":i=So;break;case"T":i=_o;break;case"R":i=Ao;break;case"B":i=Po;break;case"BR":i=Mo;break;case"BL":i=ko;break;case"TR":i=To;break;case"TL":i=No;break;default:i=Io}return i}}),ee(Io.prototype,{direction:null,compute:function(t){this.childAreas=t,this.computeRelativePosition(this.root,t)},getHeight:function(t,e){return this.getTHeight(t)+this.getBHeight(t)+this.getLRHeight()},getWidth:function(t,e){var i=Math.max(t.T.width,t.B.width)/2;return Math.max(this.getLWidth(t,e)+e.width/2,i)+Math.max(this.getRWidth(t,e)+e.width/2,i)},getLRHeight:function(){return Math.max(this.rootSize.height,this.siblings.L.height,this.siblings.R.height)},getTHeight:function(t){return t.T.height+this.getTXHeight(t)},getBHeight:function(t){return t.B.height+this.getBXHeight(t)},getXLRWidth:function(t,e){return this.getLWidth(t,e)+e.width+this.getRWidth(t,e)},getXRWidth:function(t,e){var i=Math.max(t.BR.width,t.TR.width);return 0<i&&(i-=e.width/2),i},getTXHeight:function(t){var e=Math.max(t.TR.height,t.TL.height);return 0<e&&(e+=this.firstChildGap),e},getBXHeight:function(t){var e=Math.max(t.BR.height,t.BL.height);return 0<e&&(e+=this.firstChildGap),e},getXLWidth:function(t,e){var i=Math.max(t.BL.width,t.TL.width);return 0<i&&(i-=e.width/2),i},getRWidth:function(t,e){return Math.max(t.R.width,this.getXRWidth(t,e))},getLWidth:function(t,e){return Math.max(t.L.width,this.getXLWidth(t,e))},getTBOverlap:function(t,e){var i=Math.max(t.T.width,t.B.width);return 0<i&&(i-=e.width,i/=2),i},getRootDX:function(t,e){var i=this.getTBOverlap(t,e),n=Math.max(this.getLWidth(t,e),i);return(n-=Math.max(this.getRWidth(t,e),i))/2},getMinimalGap:function(t){return Math.min(t.siblingGap,this.firstChildGap,this.parentGap)},getBBox:function(t){var e=F(this),i=t&&t.expandBy;return i&&e.moveAndExpand({x:-i,y:-i,width:2*i,height:2*i}),e},containsPoint:function(t,e){return this.getBBox(e).containsPoint(t)},getLayoutSiblings:function(t){return this.siblings[t]},getExtendedWidth:function(){return this.width+this.gap+this.rootOffset},getExtendedHeight:function(){return this.height+this.gap+this.rootOffset},findMinimalAreaByPoint:function(e,i){return this.containsPoint(e,i)?(this.childAreas.some(function(t){return!!(n=t.findMinimalAreaByPoint(e,i))}),n||this):null;var n},getType:function(){return Object.keys(this.siblings).reduce(function(t,e){return this.siblings[e].exists()?t.concat(e):t}.bind(this),[]).sort().join("-")},getRootAttributes:function(t,e){var i={rootOffset:t.get(e.offset||"offset")||0,rootMargin:t.get(e.margin||"margin")||0,prevSiblingGap:t.get(e.prevSiblingGap||"prevSiblingGap")||0,nextSiblingGap:t.get(e.nextSiblingGap||"nextSiblingGap")||0},n=t.get(e.siblingRank||"siblingRank");Dt(n)&&(i.siblingRank=n);var s=t.get(e.firstChildGap||"firstChildGap");return Dt(s)&&(i.firstChildGap=s),i},getRootSize:function(t,e){var i=t.size();return i[this.marginDimension]+=e,i},createSiblings:function(t,e){var i=fe(t,"direction");return{L:new ho(i.L,this,e),T:new wo(i.T,this,e),R:new co(i.R,this,e),B:new Co(i.B,this,e),BR:new fo(i.BR,this,e),BL:new mo(i.BL,this,e),TR:new vo(i.TR,this,e),TL:new yo(i.TL,this,e)}},computeSize:function(t,e){return{width:this.getWidth(t,e),height:this.getHeight(t,e)}},computeOrigin:function(){var t=this.siblings,e=this.rootSize,i=Math.max(this.getLWidth(t,e)+e.width/2,this.getXLWidth(t,e)+e.width/2,t.T.width/2,t.B.width/2);return{x:this.rootCX-i,y:this.rootCY-this.getTHeight(t)-this.getLRHeight()/2}},moveSiblings:function(t,e){if(this.hasHorizontalSiblings(t)){var i=e.width/2;t.L.move(-i,0),t.R.move(i,0)}if(this.hasVerticalSiblings(t)){var n=this.getLRHeight()/2;t.T.move(0,-n),t.B.move(0,n),t.BR.move(0,n),t.BL.move(0,n),t.B.move(0,this.getBXHeight(t)),t.TR.move(0,-n),t.TL.move(0,-n),t.T.move(0,-this.getTXHeight(t))}},moveRootToConnectionPoint:function(t){var e=this.getConnectionPoint(t);this.dx+=e.x,this.dy+=e.y},computeRelativePosition:function(t,e){var i=this.siblings=this.createSiblings(e,{siblingGap:this.siblingGap}),n=this.rootSize=this.getRootSize(t,this.rootMargin);ee(this,this.computeSize(i,n)),this.moveSiblings(i,n),this.moveRootToConnectionPoint(n),this.moveRootBehindSiblings(i,n),this.moveRootFromParent()},computeAbsolutePosition:function(){if(this.parentArea)this.rootCX=this.parentArea.rootCX+this.dx,this.rootCY=this.parentArea.rootCY+this.dy,this.level=this.parentArea.level+1;else{var t=this.root.getBBox().center();this.rootCX=t.x,this.rootCY=t.y,this.level=0}ee(this,this.computeOrigin())},hasVerticalSiblings:function(t){return t.T.exists()||t.B.exists()||t.BR.exists()||t.BL.exists()||t.TR.exists()||t.TL.exists()},hasHorizontalSiblings:function(t){return t.L.exists()||t.R.exists()},isSourceArea:function(){return!this.parentArea},isSinkArea:function(){return 0===this.childAreas.length},getRootPosition:function(){var t=this.root.get("size");return{x:this.rootCX-t.width/2,y:this.rootCY-t.height/2}},getRootVertices:function(t,e){if(e=e||{},0===(t=t||this)[this.deltaCoordinate]||!this.parentArea)return[];var i,n=this.parentArea.getInnerSize();if(!e.ignoreSiblings&&this.hasSiblingsBetweenParent()){var s=this.siblings[this.oppositeDirection];i=this.getRelativeVerticesAvoidingSiblings(n,t,s)}else i=this.getRelativeVertices(n,t);return se(i,"offset",this.parentArea.rootCX,this.parentArea.rootCY)},getInnerSize:function(){return{width:this.rootSize.width,height:this.getLRHeight()}},getConnectionPoint:function(){return null},getRelativeVertices:function(){return null},moveRootFromParent:function(){},moveRootBehindSiblings:function(){},hasSiblingsBetweenParent:function(){return!this.isSourceArea()&&this.siblings[this.oppositeDirection].exists()},getCY:function(){return this.height/2+this.prevSiblingGap},getCX:function(){return this.width/2+this.prevSiblingGap}}),Io.extend=o.Model.extend;function xo(){this.options={handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElement"},icon:null},{name:"direction",position:"se",events:{pointerdown:"directionSwap"},icon:null}],bbox:function(t){var e=.5*t.getConnectionLength();return t.getPointAtLength(e)},typeCssName:"type-link",tinyThreshold:-1,smallThreshold:-1,boxContent:!1}}var Ao=Io.extend({direction:"R",oppositeDirection:"L",deltaCoordinate:"dx",marginDimension:"height",getConnectionPoint:function(t){return H(t.width/2,0)},moveRootBehindSiblings:function(t,e){this.dx+=Math.max(this.getLWidth(t,e),this.getTBOverlap(t,e)),this.dy+=(this.getTHeight(t)-this.getBHeight(t))/2},moveRootFromParent:function(){this.dx+=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var i=this.getConnectionPoint(t),n=this.parentGap/2;return[i.clone().offset(n,0),i.clone().offset(n,e.dy)]},getRelativeVerticesAvoidingSiblings:function(t,e,i){var n=this.getConnectionPoint(t),s=i.siblingGap/2,r=0<this.dx?-1:1,o=e.dy+r*(i.height+s)/2,a=e.dy+r*this.rootSize.height/4,l=this.gap/2,h=1.5*l+Math.max(this.getLWidth(this.siblings,this.rootSize),this.getTBOverlap(this.siblings,this.rootSize));return[n.clone().offset(l,0),n.clone().offset(l,o),n.clone().offset(h,o),n.clone().offset(h,a)]}}),So=Io.extend({direction:"L",oppositeDirection:"R",deltaCoordinate:"dx",marginDimension:"height",getConnectionPoint:function(t){return H(-t.width/2,0)},moveRootBehindSiblings:function(t,e){this.dx-=Math.max(this.getRWidth(t,e),this.getTBOverlap(t,e)),this.dy+=(this.getTHeight(t)-this.getBHeight(t))/2},moveRootFromParent:function(){this.dx-=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var i=this.getConnectionPoint(t),n=-this.parentGap/2;return[i.clone().offset(n,0),i.clone().offset(n,e.dy)]},getRelativeVerticesAvoidingSiblings:function(t,e,i){var n=this.getConnectionPoint(t),s=0<this.dx?-1:1,r=e.dy+s*(i.height+i.siblingGap/2)/2,o=e.dy+s*this.rootSize.height/4,a=this.gap/2,l=1.5*a+Math.max(this.getRWidth(this.siblings,this.rootSize),this.getTBOverlap(this.siblings,this.rootSize));return[n.clone().offset(-a,0),n.clone().offset(-a,r),n.clone().offset(-l,r),n.clone().offset(-l,o)]}}),_o=Io.extend({direction:"T",oppositeDirection:"B",deltaCoordinate:"dy",marginDimension:"width",getConnectionPoint:function(t){return H(0,-t.height/2)},moveRootBehindSiblings:function(t,e){this.dx+=this.getRootDX(t,e),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2),this.dy-=this.getBHeight(t)},moveRootFromParent:function(){this.dy-=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var i=this.getConnectionPoint(t),n=-this.getTXHeight(this.parentArea.siblings)-this.parentGap/2;return[i.clone().offset(0,n),i.clone().offset(e.dx,n)]},getRelativeVerticesAvoidingSiblings:function(t,e){var i=this.getConnectionPoint(t),n=this.siblings,s=n.B,r=this.getTXHeight(this.parentArea.siblings)+this.parentGap/2,o=r+s.height;o+=this.getBXHeight(this.siblings)+this.parentGap/4;var a=this.dy<0?-1:1,l=n[0<a?"BR":"BL"].width,h=e.dx;h+=a*(Math.max(l,s.width/2)+s.siblingGap/4);var c=e.dx+a*this.rootSize.width/4;return[i.clone().offset(0,-r),i.clone().offset(h,-r),i.clone().offset(h,-o),i.clone().offset(c,-o)]}}),Po=Io.extend({direction:"B",oppositeDirection:"T",deltaCoordinate:"dy",marginDimension:"width",getConnectionPoint:function(t){return H(0,t.height/2)},moveRootBehindSiblings:function(t,e){this.dx+=this.getRootDX(t,e),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){this.dy+=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var i=this.getConnectionPoint(t),n=this.getBXHeight(this.parentArea.siblings)+this.parentGap/2;return[i.clone().offset(0,n),i.clone().offset(e.dx,n)]},getRelativeVerticesAvoidingSiblings:function(t,e){var i=this.getConnectionPoint(t),n=this.siblings,s=n.T,r=this.getBXHeight(this.parentArea.siblings)+this.parentGap/2,o=r+s.height;o+=this.getTXHeight(n)+this.parentGap/4;var a=this.dy<0?-1:1,l=n[0<a?"TR":"TL"].width,h=e.dx;h+=a*(Math.max(l,s.width/2)+s.siblingGap/4);var c=e.dx+a*this.rootSize.width/4;return[i.clone().offset(0,r),i.clone().offset(h,r),i.clone().offset(h,o),i.clone().offset(c,o)]}}),Mo=Io.extend({direction:"BR",oppositeDirection:"L",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return H(0,t.height/2)},getCY:function(){return this.prevSiblingGap},moveRootBehindSiblings:function(t,e){var i=Math.max(t.T.width,t.B.width);this.dx+=Math.max(this.getLWidth(t,e),(i-e.width)/2),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy+=t.firstChildGap),this.dx+=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){return[this.getConnectionPoint(t).clone().offset(0,e.dy-t.height/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,i){var n=e.dx-this.rootSize.width/4,s=e.dy;return s+=Math.max(i.height,this.rootSize.height)/2,s+=this.getMinimalGap(i)/2,[H(0,s),H(n,s)]}}),ko=Io.extend({direction:"BL",oppositeDirection:"R",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return H(0,t.height/2)},getCY:function(){return this.prevSiblingGap},moveRootBehindSiblings:function(t,e){var i=Math.max(t.T.width,t.B.width);this.dx-=Math.max(this.getRWidth(t,e),(i-e.width)/2),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy+=t.firstChildGap),this.dx-=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){return[this.getConnectionPoint(t).clone().offset(0,e.dy-t.height/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,i){var n=e.dx+this.rootSize.width/4,s=e.dy;return s+=Math.max(i.height,this.rootSize.height)/2,s+=this.getMinimalGap(i)/2,[H(0,s),H(n,s)]}}),To=Io.extend({direction:"TR",oppositeDirection:"L",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return H(0,t.height/2)},getCY:function(){return this.height-this.rootSize.height+this.prevSiblingGap},moveRootBehindSiblings:function(t,e){this.dx+=Math.max(this.getLWidth(t,e),this.getTBOverlap(t,e)),this.dy-=this.getBHeight(t),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy-=t.firstChildGap),this.dx+=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){return[this.getConnectionPoint(t).clone().offset(0,e.dy-t.height/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,i){var n=e.dx-this.rootSize.width/4,s=e.dy;return s-=Math.max(i.height,this.rootSize.height)/2,s-=this.getMinimalGap(i)/2,[H(0,s),H(n,s)]}}),No=Io.extend({direction:"TL",oppositeDirection:"R",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return H(0,t.height/2)},getCY:function(){return this.height-this.rootSize.height+this.prevSiblingGap},moveRootBehindSiblings:function(t,e){this.dx-=Math.max(this.getRWidth(t,e),this.getTBOverlap(t,e)),this.dy-=this.getBHeight(t),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy-=t.firstChildGap),this.dx-=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){return[this.getConnectionPoint(t).clone().offset(0,e.dy-t.height/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,i){var n=e.dx+this.rootSize.width/4,s=e.dy;return s-=Math.max(i.height,this.rootSize.height)/2,s-=this.getMinimalGap(i)/2,[H(0,s),H(n,s)]}}),Do={rotate:function(t){var i="LRBT",n=i.indexOf(t[0])-i.indexOf(t[1]);return function(t){var e=i.indexOf(t);return 0<=e?i[(4+e-n)%4]:t}},flip:function(t){var e=t[0],i=t[1];return function(t){return t===e?i:t===i?e:t}},straighten:function(t){return function(){return t[1]}}},Eo=o.Model.extend({defaults:{graph:void 0,gap:20,parentGap:20,siblingGap:20,firstChildGap:20,direction:"R",directionRule:Do.straighten,updatePosition:function(t,e,i){t.set("position",e,i)},updateVertices:function(t,e,i){t.set("vertices",e,i)},updateAttributes:null,filter:null,attributeNames:{}},initialize:function(){this._cacheOptions(this.attributes),this.layoutAreas={}},layout:function(t){this.layoutAreas={};for(var e=this.getGraphSources(t),i=0,n=e.length;i<n;i++)this.layoutTree(e[i],t);return this.trigger("layout:done",t),this},layoutTree:function(t,e){(e=e||{}).treeLayout=!0;var i=this._computeLayoutAreas(t,null,e);return this._computeAbsolutePositions(i),this._updateCells(i,e),this},getLayoutBBox:function(){return this.getRootLayoutAreas().reduce(function(t,e){var i=e.getBBox();return t?t.union(i):i},null)},getLayoutArea:function(t){return this.layoutAreas[t.id||t]||null},getRootLayoutAreas:function(){return this.getGraphSources().map(this.getLayoutArea,this)},getGraphSources:function(t){var e=this.graph.getSources();return this.filter&&0<e.length&&(e=this.filter(e,null,t)||e),e},getMinimalRootAreaByPoint:function(e){var t=this.getRootLayoutAreas().filter(function(t){return t.containsPoint(e)});return he(t)?null:t.reduce(function(t,e){return e.width*e.height<t.min&&(t.min=e.width*e.height,t.item=e),t},{min:1/0,item:void 0}).item},_computeLayoutAreas:function(t,e,i){var n=e?e.direction:this.get("direction"),s=t.get(this.getAttributeName("direction"))||n,r=Io.create(s,t,this.attributes);r.parentArea=e,r.link=this.graph.getConnectedLinks(t,{inbound:!0})[0];var o=this._getChildren(t,i);this.layoutAreas[t.id]=r;for(var a=[],l=0,h=o.length;l<h;l++)a.push(this._computeLayoutAreas(o[l],r,i));return r.compute(a),r},_cacheOptions:function(e){["updateAttributes","updateVertices","updatePosition","filter"].forEach(function(t){this[t]=ue(e[t])?e[t]:null},this),this.graph=e.graph},_getChildren:function(t,e){if(this.layoutAreas[t.id])return[];var i=this.graph.getNeighbors(t,{outbound:!0});return this.filter&&0<i.length&&(i=this.filter(i,t,e)||i),i},_computeAbsolutePositions:function(t){t.computeAbsolutePosition(t);for(var e=0,i=t.childAreas.length;e<i;e++)this._computeAbsolutePositions(t.childAreas[e])},_updateCells:function(t,e){var i=t.root,n=t.link||null;n&&(this.updatePosition&&this.updatePosition(i,t.getRootPosition(),e),this.updateVertices&&this.updateVertices(n,t.getRootVertices(),e)),this.changeSiblingRank(i,t.siblingRank,e),this.updateAttributes&&this.updateAttributes(t,i,n,e);for(var s=0,r=t.childAreas.length;s<r;s++)this._updateCells(t.childAreas[s],e)},updateDirections:function(t,e,n){n=n||{};var s=this.getAttributeName("direction"),r=this.get("directionRule")(e);this.graph.search(t,function(t,e){if(0!==e){var i=r(t.get(s));this.changeDirection(t,i,n)}}.bind(this),{outbound:!0})},reconnectElement:function(t,e,i){i=i||{};var n=this.getLayoutArea(t),s=n.link;if(s){s.set("source",{id:e.id||e},i);var r=n.direction,o=i.direction||r,a=i.siblingRank||void 0;return this.changeSiblingRank(t,a,i),this.changeDirection(t,o,i),r!==o&&this.updateDirections(t,[r,i.direction],i),!0}return!1},changeSiblingRank:function(t,e,i){t.set(this.getAttributeName("siblingRank"),e,i)},changeDirection:function(t,e,i){t.set(this.getAttributeName("direction"),e,i)},getAttributeName:function(t){return this.get("attributeNames")[t]||t},getAttribute:function(t,e){return t.get(this.getAttributeName(e))},prepare:function(){return this}},{directionRules:Do}),Lo={ForceDirected:ro,GridLayout:oo,TreeLayout:Eo},zo=o.Collection.extend({LOCAL_STORAGE_KEY:"joint.ui.Clipboard.cells",defaults:{useLocalStorage:!0},copyElements:function(t,e,i){this.options=ee({},this.defaults,i),i=this.options;var n=t.toArray(),s=me(e.cloneSubgraph(n,i),function(t){return t.isLink()?2:1});return this.reset(s),i.useLocalStorage&&window.localStorage&&localStorage.setItem(this.LOCAL_STORAGE_KEY,JSON.stringify(this.toJSON())),n},cutElements:function(t,e,i){var n=this.copyElements(t,e,i);return e.trigger("batch:start",{batchName:"cut"}),se(n,"remove"),e.trigger("batch:stop",{batchName:"cut"}),n},pasteCells:function(t,e){if((e=ie(e||{},this.options)).useLocalStorage&&window.localStorage){var i=JSON.parse(localStorage.getItem(this.LOCAL_STORAGE_KEY));if(i){var n={cells:i},s=(new Xs).fromJSON(n,{sort:!1,dry:!0});this.reset(s.getCells())}}var r=this.map(function(t){return this.modifyCell(t,e)}.bind(this));return t.trigger("batch:start",{batchName:"paste"}),t.addCells(r),t.trigger("batch:stop",{batchName:"paste"}),this.copyElements(this,t),r},clear:function(){this.options={},this.reset([]),window.localStorage&&localStorage.removeItem(this.LOCAL_STORAGE_KEY)},modifyCell:function(t,e){return t.unset("z"),t.isLink()&&e.link&&t.set(e.link),e.translate&&t.translate(e.translate.dx||20,e.translate.dy||20),t.collection=null,t}}),Oo=gi.extend({className:"select-box",events:{"click .select-box-selection":"onToggle"},options:{options:[],width:void 0,openPolicy:"auto",target:null,keyboardNavigation:!0,selected:void 0,selectBoxOptionsClass:void 0,disabled:!1},init:function(){this.options.target=this.options.target||document.body,_e(this,"onOutsideClick","onOptionSelect"),P(document).on("click.selectBox",this.onOutsideClick),this.$el.data("view",this),void 0===this.options.selected?this.selection=pe(this.options.options).find(function(t){return!0===t.selected})||this.options.options[0]:this.selection=this.options.options[this.options.selected]},render:function(){return this.$el.empty(),this.$selection=null,this.renderSelection(this.selection),this.options.width&&this.$el.css("width",this.options.width),this.options.disabled&&this.disable(),this.$el.append(this.$options),this},renderOptions:function(){this.removeOptions();var t=this.options,e={selectBoxView:this,parentClassName:xe(this,"className")||null,extraClassName:xe(t,"selectBoxOptionsClass")||null,options:t.options};t.width&&(e.width=t.width),t.theme&&(e.theme=t.theme);var i=this.optionsView=new this.constructor.OptionsView(e);i.render(),this.listenTo(i,"option:select",this.onOptionSelect),this.listenTo(i,"option:hover",this.onOptionHover),this.listenTo(i,"options:mouseout",this.onOptionsMouseOut),this.$options=i.$el,this.$optionsArrow=i.$arrow,this.$target=P(t.target)},onOptionHover:function(t,e){this.trigger("option:hover",t,e)},onOptionsMouseOut:function(t){this.trigger("options:mouseout",t)},onOptionSelect:function(t,e){this.select(t,e)},removeOptions:function(){this.optionsView&&(this.stopListening(this.optionsView),this.optionsView.remove(),this.optionsView=null)},renderSelection:function(t){if(this.$selection||(this.$selection=P("<div/>",{class:"select-box-selection"}),this.$el.append(this.$selection)),this.$selection.empty(),t){var e=this.constructor.OptionsView.prototype.renderOptionContent.call(void 0,t);this.$selection.append(e)}else if(this.options.placeholder){var i=P("<div/>",{class:"select-box-placeholder",html:this.options.placeholder});this.$selection.append(i)}},onToggle:function(t){this.toggle()},onOutsideClick:function(t){!this.el.contains(t.target)&&this.$el.hasClass("opened")&&this.close()},getSelection:function(){return this.selection},getSelectionValue:function(t){return(t=t||this.selection)&&(void 0===t.value?t.content:t.value)},getSelectionIndex:function(){return pe(this.options.options).findIndex(function(t){return t===this.selection}.bind(this))},select:function(t,e){this.selection=this.options.options[t],this.renderSelection(this.selection),this.trigger("option:select",this.selection,t,e),this.close()},selectByValue:function(t,e){for(var i=this.options.options||[],n=0;n<i.length;n++){var s=i[n];if(void 0===s.value&&s.content===t)return this.select(n,e);if(void 0!==s.value&&ce(s.value,t))return this.select(n,e)}},isOpen:function(){return this.$el.hasClass("opened")},toggle:function(){this.isOpen()?this.close():this.open()},position:function(){var t=this.$(".select-box-selection"),e=t.outerHeight(),i=t.offset(),n=i.left,s=i.top,r=this.$options.outerHeight(),o={left:0,top:0};this.options.target!==document.body?((o=this.$target.offset()).width=this.$target.outerWidth(),o.height=this.$target.outerHeight(),o.left-=this.$target.scrollLeft(),o.top-=this.$target.scrollTop()):(o.width=P(window).width(),o.height=P(window).height());var a=n,l="auto",h=this.options.openPolicy;switch("selected"!==h||this.selection||(h="auto"),h){case"above":l=s-r;break;case"coverAbove":l=s-r+e;break;case"below":l=s+e;break;case"coverBelow":l=s;break;case"selected":l=s-this.$options.find(".selected").position().top;break;default:l=s-this.$target.scrollTop()+r>o.top+o.height?s-r+e:s}a-=o.left,l-=o.top,this.$options.css({left:a,top:l})},open:function(){this.isDisabled()||(this.renderOptions(),this.$options.appendTo(this.options.target),this.$options.addClass("rendered"),this.position(),this.$el.addClass("opened"),this.respectWindowBoundaries(),this.alignOptionsArrow())},respectWindowBoundaries:function(){var t=this.calculateElOverflow(this.$options),e={left:0,top:0};this.$options.outerWidth()<=this.$target.innerWidth()&&(t.left&&t.right||(t.left?e.left=t.left:t.right&&(e.left=-t.right))),this.$options.outerHeight()<=this.$target.innerHeight()&&(t.top&&t.bottom||(t.top?e.top=t.top:t.bottom&&(e.top=-t.bottom))),this.$options.css({left:"+="+e.left,top:"+="+e.top})},alignOptionsArrow:function(){var t=this.$el[0].getBoundingClientRect(),e=this.$options[0].getBoundingClientRect(),i=t.left+t.width/2;i-=e.left,i-=this.$optionsArrow.outerWidth()/2,this.$optionsArrow.css({left:i})},close:function(){this.removeOptions(),this.$el.removeClass("opened"),this.trigger("close")},onRemove:function(){this.removeOptions(),P(document).off(".selectBox",this.onOutsideClick)},isDisabled:function(){return this.$el.hasClass("disabled")},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.close(),this.$el.addClass("disabled")},onSetTheme:function(t,e){this.$options&&(t&&this.$options.removeClass(this.themeClassNamePrefix+t),this.$options.addClass(this.themeClassNamePrefix+e))},calculateElOverflow:function(t,e){e=e||window,t instanceof P&&(t=t[0]),e instanceof P&&(e=e[0]);var i,n={},s=t.getBoundingClientRect();if(e===window){var r=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;i={width:r,height:o,left:0,top:0,right:r,bottom:o}}else i=e.getBoundingClientRect();return["left","top"].forEach(function(t){n[t]=Math.min(0,s[t]-i[t])}),["right","bottom"].forEach(function(t){n[t]=Math.min(0,i[t]-s[t])}),Pe(n,function(t,e){n[e]=Math.abs(Math.round(t))}),n}},{OptionsView:gi.extend({events:{"mouseover .select-box-option":"onOptionHover","click .select-box-option":"onOptionClick"},className:function(){var t=["select-box-options"],e=this.options.parentClassName;return e&&t.push(e),t.join(" ")},init:function(){_e(this,"onMouseout","onKeydown"),P(document).on({"keydown.selectBoxOptions":this.onKeydown,"mouseleave.selectBoxOptions mouseout.selectBoxOptions":this.onMouseout})},render:function(){var t=this.options.extraClassName;return t&&this.$el.addClass(t),this.options.width&&this.$el.css("width",this.options.width),pe(this.options.options).forEach(function(t,e){var i=this.renderOption(t,e);this.options.selectBoxView.selection===t&&i.addClass("selected hover"),this.$el.append(i)},this),this.$arrow=P("<div/>").addClass("select-box-options-arrow").appendTo(this.$el),this},renderOption:function(t,e){var i=this.renderOptionContent(t);return i.addClass("select-box-option"),i.data("index",e),i},renderOptionContent:function(t){var e=P("<div/>",{class:"select-box-option-content",html:t.content});return t.icon&&e.prepend(P("<img/>",{class:"select-box-option-icon",src:t.icon})),e},select:function(t,e){this.trigger("option:select",t,e)},hover:function(t){var e=this.options.options[t];this.markOptionHover(t),this.trigger("option:hover",e,t)},onOptionClick:function(t){var e=this.getOptionIndex(t.target);this.select(e,{ui:!0})},onOptionHover:function(t){var e=this.getOptionIndex(t.target);this.hover(e)},onMouseout:function(t){this.trigger("options:mouseout",t)},onKeydown:function(t){var e=this.options.selectBoxView;if(e.options.keyboardNavigation&&e.isOpen()){var i;switch(t.which){case 39:case 40:i=1;break;case 38:case 37:i=-1;break;case 13:var n=this.getOptionHoverIndex();return void(0<=n&&this.select(n));case 27:return e.close();default:return}t.preventDefault();var s=this.getOptionHoverIndex()+i,r=this.options.options;s<0&&(s=r.length-1),s>=r.length&&(s=0),this.hover(s)}},onRemove:function(){P(document).off(".selectBoxOptions")},markOptionHover:function(t){this.$el.find(".hover").removeClass("hover"),P(this.$el.find(".select-box-option")[t]).addClass("hover")},getOptionHoverIndex:function(){return this.$el.find(".select-box-option.hover").index()},getOptionIndex:function(t){return P(t).closest(".select-box-option").data("index")}})}),Go=Oo.extend({className:"select-box color-palette",position:function(){var t=this.$(".select-box-selection"),e=t.outerHeight(),i=t.offset(),n=i.left,s=i.top+e;if(this.options.target!==document.body){this.$target=this.$target||P(this.options.target);var r=this.$target.offset();n-=r.left-this.$target.scrollLeft(),s-=r.top-this.$target.scrollTop()}this.$options.css({left:n,top:s})}},{OptionsView:Oo.OptionsView.extend({renderOptionContent:function(t){var e=P("<div/>",{class:"select-box-option-content"});return e.css("background-color",t.content),t.icon&&e.prepend(P("<img/>",{class:"select-box-option-icon",src:t.icon})),e}})}),Bo=gi.extend({className:"context-toolbar",eventNamespace:"context-toolbar",events:{"click .tool":"onToolPointerdown"},options:{padding:20,autoClose:!0,vertical:!1},documentEvents:{mousedown:"onDocumentPointerdown",touchstart:"onDocumentPointerdown"},init:function(){_e(this,"onDocumentPointerdown")},render:function(){var t=this.options,e=this.constructor;return e.opened&&e.close(),t.autoClose&&this.delegateAutoCloseEvents(),t.type&&this.$el.attr("data-type",t.type),this.$el.toggleClass("joint-vertical",!!t.vertical),this.getRoot().append(this.$el),this.renderContent(),this.position(),e.opened=this},delegateAutoCloseEvents:function(){this.delegateDocumentEvents(),document.addEventListener("mousedown",this.onDocumentPointerdown,!0),document.addEventListener("touchstart",this.onDocumentPointerdown,!0)},undelegateAutoCloseEvents:function(){this.undelegateDocumentEvents(),document.removeEventListener("mousedown",this.onDocumentPointerdown,!0),document.removeEventListener("touchstart",this.onDocumentPointerdown,!0)},renderContent:function(){var n=P("<div/>",{class:"tools"});this.options.tools&&pe(this.options.tools).forEach(function(t){var e;e=t.icon?P("<img/>",{src:t.icon}):t.content;var i=P("<button/>",{class:"tool",html:e,"data-action":t.action});t.attrs&&i.attr(t.attrs),n.append(i)}),this.$el.append(n)},getRoot:function(){return P(this.options.root||document.documentElement)},position:function(){var t=_t(this.options.target),e=_t(this.getRoot()),i=this.$el.outerWidth(),n=t.x+t.width/2-i/2,s=t.y+t.height+this.options.padding;n-=e.x,s-=e.y,this.$el.css({left:n,top:s})},onRemove:function(){this.undelegateAutoCloseEvents(),this.constructor.opened=void 0},onToolPointerdown:function(t){var e=P(t.currentTarget).attr("data-action");e&&this.trigger("action:"+e,t)},onDocumentPointerdown:function(t){var e=this.options.target,i=t.target;this.el.contains(i)||e.contains(i)||e===i||(this.constructor.close(),this.remove())}},{opened:void 0,close:function(){this.opened&&(this.opened.remove(),this.opened=void 0)},update:function(){this.opened&&this.opened.position()}}),jo=gi.extend({className:"dialog",events:{"click .bg":"action","click .btn-close":"action","click .controls button":"action","mousedown .titlebar":"onDragStart","touchstart .titlebar":"onDragStart"},options:{draggable:!1,closeButtonContent:"&times;",closeButton:!0,inlined:!1,modal:!0,width:0,title:"",buttons:null,type:"",content:null},init:function(){_e(this,"onDrag","onDragEnd"),this.buttons=this.options.buttons},render:function(){var t=P("<div/>",{class:"bg","data-action":"close"}),e=P("<div/>",{class:"fg"}),i=P("<div/>",{class:"titlebar"}),n=P("<div/>",{class:"body"}),s=P("<button/>",{class:"btn-close","data-action":"close",html:this.options.closeButtonContent}),r=P("<div/>",{class:"controls"});if(this.$el.toggleClass("draggable",!!this.options.draggable),this.options.type&&this.$el.attr("data-type",this.options.type),this.options.inlined&&this.$el.addClass("inlined"),this.options.modal&&this.$el.addClass("modal"),this.options.width&&e.width(this.options.width),this.options.title?i.append(this.options.title):i.addClass("empty"),this.options.content&&n.append(this.options.content),this.buttons){var o=[],a=[],l=[];this.buttons.forEach(function(t){var e=P("<button/>",{class:"control-button",html:t.content,"data-action":t.action});t.position?"left"===t.position?(e.addClass(t.position),l.push(e)):"center"===t.position?(e.addClass(t.position),a.push(e)):(e.addClass(t.position),o.push(e)):o.push(e)}),o.reverse().forEach(function(t){r.append(t)}),l.forEach(function(t){r.append(t)}),a.forEach(function(t){r.append(t)})}return e.append(i,n,r),this.options.closeButton&&e.append(s),this.$el.empty().append(t,e),this},open:function(t){return this.delegateEvents(),this.on("action:close",this.close,this),P(document.body).on({"mousemove.dialog touchmove.dialog":this.onDrag,"mouseup.dialog touchend.dialog":this.onDragEnd}),P(t||document.body).append(this.render().el),this.$el.addClass("rendered"),this},close:function(){return this.remove(),this},onRemove:function(){P(document.body).off(".dialog",this.onDrag).off(".dialog",this.onDragStart)},action:function(t){var e=P(t.target).closest("[data-action]").attr("data-action");e&&this.trigger("action:"+e)},onDragStart:function(t){this.options.draggable&&(t=bt(t),this._dx=t.clientX,this._dy=t.clientY,this._dragging=!0)},onDrag:function(t){if(this._dragging){t=bt(t);var e=this.$(".fg"),i=e.offset();e.css({top:i.top+(t.clientY-this._dy),left:i.left+(t.clientX-this._dx),margin:0}),this._dx=t.clientX,this._dy=t.clientY}},onDragEnd:function(){this._dragging=!1}}),Ro=jo.extend({className:jo.prototype.className+" flash-message",options:Tt({},jo.prototype.options,{closeButton:!0,modal:!1,cascade:!0,closeAnimation:{delay:2e3,duration:200,easing:"swing",properties:{opacity:0}},openAnimation:{duration:200,easing:"swing",properties:{opacity:1}}}),init:function(){_e(this,"startCloseAnimation"),jo.prototype.init.apply(this,arguments),this.on("close:animation:complete",this.close,this)},open:function(){jo.prototype.open.apply(this,arguments);var t=this.$(".fg");return this._foregroundHeight=t.height(),this.addToCascade(),t.css("height",0),this.startOpenAnimation(),this.options.closeAnimation&&this.options.closeAnimation.delay&&setTimeout(this.startCloseAnimation,this.options.closeAnimation.delay),this},close:function(){return jo.prototype.close.apply(this,arguments),this.removeFromCascade(),this},addToCascade:function(){if(this.options.cascade){var t=this.constructor.top;this.$(".fg").css("top",t),this.constructor.top+=this._foregroundHeight+this.constructor.padding}this.constructor.opened.push(this)},removeFromCascade:function(){if(this.options.cascade){for(var t=this.constructor.opened,e=!1,i=0;i<t.length;i++){var n=t[i];if(n.options.cascade&&e){var s=parseInt(n.$(".fg").css("top"),10);n.$(".fg").css("top",s-this._foregroundHeight-this.constructor.padding)}n===this&&(e=!0)}e&&(this.constructor.top-=this._foregroundHeight+this.constructor.padding)}this.constructor.opened=ye(this.constructor.opened,this)},startCloseAnimation:function(){this.$(".fg").animate(this.options.closeAnimation.properties,ee({complete:function(){this.trigger("close:animation:complete")}.bind(this)},this.options.closeAnimation))},startOpenAnimation:function(){this.$(".fg").animate(ee({},this.options.openAnimation.properties,{height:this._foregroundHeight}),ee({complete:function(){this.trigger("open:animation:complete")}.bind(this)},this.options.openAnimation))}},{top:20,padding:15,opened:[],open:function(t,e,i){return new Ro(ee({title:e,type:"info",content:t},i=i||{})).open(i.target)},close:function(){se(this.opened,"close")}}),Vo=gi.extend({className:"free-transform",events:{"mousedown .resize":"startResizing","mousedown .rotate":"startRotating","touchstart .resize":"startResizing","touchstart .rotate":"startRotating"},DIRECTIONS:["nw","n","ne","e","se","s","sw","w"],POSITIONS:["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"],options:{cellView:void 0,rotateAngleGrid:15,preserveAspectRatio:!1,minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,allowOrthogonalResize:!0,allowRotation:!0,clearAll:!0,clearOnBlankPointerdown:!0},init:function(){var t=this.options;t.cellView?ie(t,{cell:t.cellView.model,paper:t.cellView.paper,graph:t.cellView.paper.model}):t.paper&&t.cell&&ie(t,{cellView:t.cell.findView(t.paper),graph:t.paper.model}),_e(this,"update","remove","pointerup","pointermove");var e=t.paper,i=t.graph;t.clearAll&&this.constructor.clear(e),P(document.body).on("mousemove touchmove",this.pointermove),P(document).on("mouseup touchend",this.pointerup),this.listenTo(i,"all",this.update),this.listenTo(e,"scale translate",this.update),this.listenTo(i,"reset",this.remove),this.listenTo(t.cell,"remove",this.remove),t.clearOnBlankPointerdown&&this.listenTo(e,"blank:pointerdown",this.remove),e.$el.append(this.el),this.constructor.registerInstanceToPaper(this,e)},renderHandles:function(){var e=P("<div/>").prop("draggable",!1),t=e.clone().addClass("rotate"),i=this.POSITIONS.map(function(t){return e.clone().addClass("resize").attr("data-position",t)});this.$el.empty().append(i,t)},render:function(){this.renderHandles(),this.$el.attr("data-type",this.options.cell.get("type")),this.$el.toggleClass("no-orthogonal-resize",this.options.preserveAspectRatio||!this.options.allowOrthogonalResize),this.$el.toggleClass("no-rotation",!this.options.allowRotation),this.update()},update:function(){var t=this.options.paper.matrix(),e=this.options.cell.getBBox();e.x*=t.a,e.x+=t.e,e.y*=t.d,e.y+=t.f,e.width*=t.a,e.height*=t.d;var i=q(this.options.cell.get("angle")||0),n="rotate("+i+"deg)";this.$el.css({width:e.width+4,height:e.height+4,left:e.x-3,top:e.y-3,transform:n,"-webkit-transform":n,"-ms-transform":n});var s=Math.floor(i*(this.DIRECTIONS.length/360));if(s!=this._previousDirectionsShift){var r=this.DIRECTIONS.slice(s).concat(this.DIRECTIONS.slice(0,s));this.$(".resize").removeClass(this.DIRECTIONS.join(" ")).each(function(t,e){P(e).addClass(r[t])}),this._previousDirectionsShift=s}},calculateTrueDirection:function(t){var e=this.options.cell,i=q(e.get("angle")),n=this.POSITIONS.indexOf(t);return n+=Math.floor(i*(this.POSITIONS.length/360)),n%=this.POSITIONS.length,this.POSITIONS[n]},startResizing:function(t){t.stopPropagation(),this.options.graph.startBatch("free-transform",{freeTransform:this.cid});var e=P(t.target).data("position"),i=this.calculateTrueDirection(e),n=0,s=0;e.split("-").forEach(function(t){n={left:-1,right:1}[t]||n,s={top:-1,bottom:1}[t]||s});var r=this.toValidResizeDirection(e),o={"top-right":"bottomLeft","top-left":"corner","bottom-left":"topRight","bottom-right":"origin"}[r];this._initial={angle:q(this.options.cell.get("angle")||0),resizeX:n,resizeY:s,selector:o,direction:r,relativeDirection:e,trueDirection:i},this._action="resize",this.startOp(t.target)},toValidResizeDirection:function(t){return{top:"top-left",bottom:"bottom-right",left:"bottom-left",right:"top-right"}[t]||t},startRotating:function(t){t.stopPropagation(),this.options.graph.startBatch("free-transform",{freeTransform:this.cid});var e=this.options.cell.getBBox().center(),i=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY});this._initial={centerRotation:e,modelAngle:q(this.options.cell.get("angle")||0),startAngle:H(i).theta(e)},this._action="rotate",this.startOp(t.target)},pointermove:function(t){if(this._action){t=bt(t);var e=this.options,i=e.paper.snapToGrid({x:t.clientX,y:t.clientY}),n=e.paper.options.gridSize,s=e.cell,r=this._initial;switch(this._action){case"resize":var o=s.getBBox(),a=H(i).rotate(o.center(),r.angle).difference(o[r.selector]()),l=r.resizeX?a.x*r.resizeX:o.width,h=r.resizeY?a.y*r.resizeY:o.height;if(l=k(l,n),h=k(h,n),l=Math.max(l,e.minWidth||n),h=Math.max(h,e.minHeight||n),l=Math.min(l,e.maxWidth),h=Math.min(h,e.maxHeight),e.preserveAspectRatio){var c=o.width*h/o.height,u=o.height*l/o.width;l<c?h=u:l=c}o.width==l&&o.height==h||s.resize(l,h,{freeTransform:this.cid,direction:r.direction,relativeDirection:r.relativeDirection,trueDirection:r.trueDirection,ui:!0,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,preserveAspectRatio:e.preserveAspectRatio});break;case"rotate":var d=r.startAngle-H(i).theta(r.centerRotation);s.rotate(k(r.modelAngle+d,e.rotateAngleGrid),!0)}}},pointerup:function(t){this._action&&(this.stopOp(),this.options.graph.stopBatch("free-transform",{freeTransform:this.cid}),this._action=null,this._initial=null)},onRemove:function(){P(document.body).off("mousemove touchmove",this.pointermove),P(document).off("mouseup touchend",this.pointerup),Vo.unregisterInstanceFromPaper(this,this.options.paper)},startOp:function(t){t&&(P(t).addClass("in-operation"),this._elementOp=t),this.$el.addClass("in-operation"),this.options.paper.undelegateEvents()},stopOp:function(){this._elementOp&&(P(this._elementOp).removeClass("in-operation"),this._elementOp=null),this.$el.removeClass("in-operation"),this.options.paper.delegateEvents()}},{instancesByPaper:{},clear:function(t){t.trigger("freetransform:create"),this.removeInstancesForPaper(t)},removeInstancesForPaper:function(t){se(this.getInstancesForPaper(t),"remove")},getInstancesForPaper:function(t){return this.instancesByPaper[t.cid]||{}},registerInstanceToPaper:function(t,e){this.instancesByPaper[e.cid]||(this.instancesByPaper[e.cid]={}),this.instancesByPaper[e.cid][t.cid]=t},unregisterInstanceFromPaper:function(t,e){this.instancesByPaper[e.cid]&&(this.instancesByPaper[e.cid][t.cid]=null)}});xo.prototype.directionSwap=function(){var t=this.options.cellView.model;t.set({source:t.get("target"),target:t.get("source")},{halo:this.cid})};function Zo(){this.options={handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElement"},icon:null},{name:"resize",position:"se",events:{pointerdown:"startResizing",pointermove:"doResize",pointerup:"stopBatch"},icon:null},{name:"clone",position:"n",events:{pointerdown:"startCloning",pointermove:"doClone",pointerup:"stopCloning"},icon:null},{name:"link",position:"e",events:{pointerdown:"startLinking",pointermove:"doLink",pointerup:"stopLinking"},icon:null},{name:"fork",position:"ne",events:{pointerdown:"startForking",pointermove:"doFork",pointerup:"stopForking"},icon:null},{name:"unlink",position:"w",events:{pointerdown:"unlinkElement"},icon:null},{name:"rotate",position:"sw",events:{pointerdown:"startRotating",pointermove:"doRotate",pointerup:"stopBatch"},icon:null}],bbox:function(t,e){return t.getBBox({useModelGeometry:e.options.useModelGeometry})},typeCssName:"type-element",tinyThreshold:40,smallThreshold:80,boxContent:function(t,e){var i=$t("x: <%= x %>, y: <%= y %>, width: <%= width %>, height: <%= height %>, angle: <%= angle %>"),n=t.model,s=n.getBBox();return i({x:Math.floor(s.x),y:Math.floor(s.y),width:Math.floor(s.width),height:Math.floor(s.height),angle:Math.floor(n.get("angle")||0)})},magnet:function(t){return t.el},loopLinkPreferredSide:"top",loopLinkWidth:40,rotateAngleGrid:15,rotateEmbeds:!1,linkAttributes:{},smoothLinks:void 0}}Zo.prototype.startLinking=function(t,e,i){this.startBatch();var n=this.options,s=n.paper,r=n.graph,o=this.createLinkConnectedToSource();o.set({target:{x:e,y:i}}).addTo(r,{validation:!1,halo:this.cid,async:!1}),s.undelegateEvents(),(this._linkView=o.findView(s)).startArrowheadMove("target",{whenNotAllowed:"remove"})},Zo.prototype.startForking=function(t,e,i){var n=this.options,s=n.paper,r=n.graph;this.startBatch();var o=n.clone(n.cellView.model,{fork:!0});if(!(o instanceof Je))throw new Error('ui.Halo: option "clone" has to return a cell.');this.centerElementAtCursor(o,e,i),o.addTo(r,{halo:this.cid,async:!1});var a=this.createLinkConnectedToSource(),l=o.findView(s),h=this.getElementMagnet(l,"target"),c=this.getLinkEnd(l,h);a.set("target",c).addTo(r,{halo:this.cid,async:!1}),l.pointerdown(t,e,i),this.eventData(t,{cloneView:l})},Zo.prototype.getElementMagnet=function(t,e){var i=this.options.magnet;if(ue(i)){var n=i.call(this,t,e);if(n instanceof SVGElement)return n}throw new Error("ui.Halo: magnet() has to return an SVGElement.")},Zo.prototype.getLinkEnd=function(t,e){var i={id:t.model.id};if(e!==t.el){var n=e.getAttribute("port");n?i.port=n:i.selector=t.getSelector(e)}return i},Zo.prototype.createLinkConnectedToSource=function(){var t=this.options,e=t.paper,i=t.cellView,n=this.getElementMagnet(i,"source"),s=this.getLinkEnd(i,n),r=e.getDefaultLink(i,n).set("source",s);return r.attr(t.linkAttributes),Nt(t.smoothLinks)&&r.set("smooth",t.smoothLinks),r},Zo.prototype.startResizing=function(t){this.startBatch(),this._flip=[1,0,0,1,1,0,0,1][Math.floor(q(this.options.cellView.model.get("angle"))/45)]},Zo.prototype.startRotating=function(t,e,i){this.startBatch();var n=this.options.cellView.model,s=n.getBBox().center(),r=[n];this.options.rotateEmbeds&&n.getEmbeddedCells({deep:!0}).reduce(function(t,e){return e.isElement()&&t.push(e),t},r),this.eventData(t,{center:s,elements:r,rotationStartAngles:r.map(function(t){return t.angle()}),clientStartAngle:new j(e,i).theta(s)})},Zo.prototype.doResize=function(t,e,i,n,s){var r=this.options.cellView.model.get("size"),o=Math.max(r.width+(this._flip?n:s),1),a=Math.max(r.height+(this._flip?s:n),1);this.options.cellView.model.resize(o,a,{absolute:!0})},Zo.prototype.doRotate=function(t,e,i){var s=this.eventData(t),r=s.clientStartAngle-new j(e,i).theta(s.center);s.elements.forEach(function(t,e){var i=s.rotationStartAngles[e],n=k(i+r,this.options.rotateAngleGrid);t.rotate(n,!0,s.center,{halo:this.cid})},this)},Zo.prototype.doClone=function(t,e,i){var n=this.eventData(t).cloneView;n&&n.pointermove(t,e,i)},Zo.prototype.startCloning=function(t,e,i){var n=this.options;this.startBatch();var s=n.clone(n.cellView.model,{clone:!0});if(!(s instanceof Je))throw new Error('ui.Halo: option "clone" has to return a cell.');this.centerElementAtCursor(s,e,i),s.addTo(n.graph,{halo:this.cid,async:!1});var r=s.findView(n.paper);r.pointerdown(t,e,i),this.eventData(t,{cloneView:r})},Zo.prototype.centerElementAtCursor=function(t,e,i){var n=t.getBBox().center(),s=e-n.x,r=i-n.y;t.translate(s,r)},Zo.prototype.doFork=function(t,e,i){var n=this.eventData(t).cloneView;n&&n.pointermove(t,e,i)},Zo.prototype.doLink=function(t,e,i){this._linkView&&this._linkView.pointermove(t,e,i)},Zo.prototype.stopLinking=function(t,e,i){var n=this._linkView;if(n){n.pointerup(t,e,i);var s=n.model;s.hasLoop()&&this.makeLoopLink(s),this.stopBatch(),this.triggerAction("link","add",s),this._linkView=null}this.options.paper.delegateEvents()},Zo.prototype.stopForking=function(t,e,i){var n=this.eventData(t).cloneView;n&&n.pointerup(t,e,i),this.stopBatch()},Zo.prototype.stopCloning=function(t,e,i){var n=this.eventData(t).cloneView;n&&n.pointerup(t,e,i),this.stopBatch()},Zo.prototype.unlinkElement=function(t){this.startBatch(),this.options.graph.removeLinks(this.options.cellView.model),this.stopBatch()},Zo.prototype.makeLoopLink=function(t){var s,r,o=this.options.loopLinkWidth,e=this.options.paper.options,a=F({x:0,y:0,width:e.width,height:e.height}),l=this.options.paper.paperToLocalRect(this.options.cellView.getBBox());oe([this.options.loopLinkPreferredSide,"top","bottom","left","right"]).find(function(t){var e,i=0,n=0;switch(t){case"top":e=H(l.x+l.width/2,l.y-o),i=o/2;break;case"bottom":e=H(l.x+l.width/2,l.y+l.height+o),i=o/2;break;case"left":e=H(l.x-o,l.y+l.height/2),n=o/2;break;case"right":e=H(l.x+l.width+o,l.y+l.height/2),n=o/2}return s=H(e).offset(-i,-n),r=H(e).offset(i,n),a.containsPoint(s)&&a.containsPoint(r)},this)&&t.set("vertices",[s,r])};function Wo(){_e(this,"handleKey"),this.parser=new Uo,this.enable()}var Yo=gi.extend({PIE_INNER_RADIUS:20,PIE_OUTER_RADIUS:50,className:"halo",events:{"mousedown .handle":"onHandlePointerDown","touchstart .handle":"onHandlePointerDown","mousedown .pie-toggle":"onPieTogglePointerDown","touchstart .pie-toggle":"onPieTogglePointerDown"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup"},options:{clearAll:!0,clearOnBlankPointerdown:!0,useModelGeometry:!1,clone:function(t,e){return t.clone().unset("z")},type:"surrounding",pieSliceAngle:45,pieStartAngleOffset:0,pieIconSize:14,pieToggles:[{name:"default",position:"e"}]},init:function(){var t=this.options,e=t.cellView,i=e.model,n=i.isLink()?new xo:new Zo;ee(this,Ae(n,"options"));var s=e.paper,r=s.model;ie(t,n.options,{paper:s,graph:r}),_e(this,"render","update"),t.clearAll&&this.constructor.clear(s),this.listenTo(r,"reset",this.remove),this.listenTo(i,"remove",this.remove),this.listenTo(s,"halo:create",this.remove),t.clearOnBlankPointerdown&&this.listenTo(s,"blank:pointerdown",this.remove),this.listenTo(r,"all",this.update),this.listenTo(s,"scale translate",this.update),this.handles=[],pe(t.handles).forEach(this.addHandle,this)},render:function(){var t=this.options;switch(this.$el.empty(),this.$handles=P("<div/>").addClass("handles").appendTo(this.el),this.$box=P("<label/>").addClass("box").appendTo(this.el),this.$pieToggles={},this.$el.addClass(t.type),this.$el.addClass(this.cellTypeCssClass()),this.$el.attr("data-type",t.cellView.model.get("type")),this.$handles.append(pe(this.handles).map(this.renderHandle,this)),t.type){case"toolbar":case"surrounding":this.hasHandle("fork")&&this.toggleFork();break;case"pie":pe(this.options.pieToggles).forEach(function(t){var e=P("<div/>");e.addClass("pie-toggle "+(t.position||"e")),e.attr("data-name",t.name),Mt(e,t.attrs),e.appendTo(this.el),this.$pieToggles[t.name]=e},this);break;default:throw new Error("ui.Halo: unknown type")}return this.update(),this.$el.addClass("animate").appendTo(t.paper.el),this.setPieIcons(),this},setPieIcons:function(){"pie"===this.options.type&&this.$el.find(".handle").each(function(t,e){var i,n=P(e),s=n.attr("data-action"),r=this.getHandle(s);if(!r||!r.icon){var o=window.getComputedStyle(e,":before").getPropertyValue("content");o&&"none"!==o&&0<(i=n.find(".slice-text-icon")).length&&Ot(i[0]).text(o.replace(/['"]/g,""));var a=n.css("background-image");if(a){var l=a.match(/url\(['"]?([^'"]+)['"]?\)/);if(l){var h=l[1];0<(i=n.find(".slice-img-icon")).length&&Ot(i[0]).attr("xlink:href",h)}}}}.bind(this))},update:function(){if(this.isRendered()){this.updateBoxContent();var t=this.getBBox();this.$el.toggleClass("tiny",t.width<this.options.tinyThreshold&&t.height<this.options.tinyThreshold),this.$el.toggleClass("small",!this.$el.hasClass("tiny")&&t.width<this.options.smallThreshold&&t.height<this.options.smallThreshold),this.$el.css({width:t.width,height:t.height,left:t.x,top:t.y}),this.hasHandle("unlink")&&this.toggleUnlink()}},getBBox:function(){var t=this.options.cellView,e=this.options.bbox,i=ue(e)?e(t,this):e;return i=ie({},i,{x:0,y:0,width:1,height:1}),F(i)},cellTypeCssClass:function(){return this.options.typeCssName},updateBoxContent:function(){var t=this.options.boxContent,e=this.options.cellView;if(ue(t)){var i=t.call(this,e,this.$box[0]);i&&this.$box.html(i)}else t?this.$box.html(t):this.$box.remove()},extendHandles:function(t){Pe(t,function(t){var e=this.getHandle(t.name);e&&ee(e,t)}.bind(this))},addHandles:function(t){return pe(t).forEach(this.addHandle,this),this},addHandle:function(i){return this.getHandle(i.name)||(this.handles.push(i),Pe(i.events,function(t,e){Ne(t)?this.on("action:"+i.name+":"+e,this[t],this):this.on("action:"+i.name+":"+e,t)}.bind(this)),this.$handles&&this.renderHandle(i).appendTo(this.$handles)),this},renderHandle:function(t){var e=this.getHandleIdx(t.name),i=P("<div/>").addClass("handle").addClass(t.name).attr("data-action",t.name).prop("draggable",!1);switch(this.options.type){case"toolbar":case"surrounding":i.addClass(t.position),t.content&&i.html(t.content);break;case"pie":var n=this.PIE_OUTER_RADIUS,s=this.PIE_INNER_RADIUS,r=(n+s)/2,o=H(n,n),a=T(this.options.pieSliceAngle),l=e*a+T(this.options.pieStartAngleOffset),h=l+a,c=Ot.createSlicePathData(s,n,l,h),u=Ot("svg").addClass("slice-svg"),d=Ot("path").attr("d",c).translate(n,n).addClass("slice"),p=H.fromPolar(r,-l-a/2,o),g=this.options.pieIconSize,f=Ot("image").attr(p).addClass("slice-img-icon");p.y=p.y+g-2;var m=Ot("text",{"font-size":g}).attr(p).addClass("slice-text-icon");f.attr({width:g,height:g}),f.translate(-g/2,-g/2),m.translate(-g/2,-g/2),u.append([d,f,m]),i.append(u.node)}return t.icon&&this.setHandleIcon(i,t.icon),Mt(i,t.attrs),i},setHandleIcon:function(t,e){switch(this.options.type){case"pie":var i=t.find(".slice-img-icon");Ot(i[0]).attr("xlink:href",e);break;case"toolbar":case"surrounding":t.css("background-image","url("+e+")")}},removeHandles:function(){for(;this.handles.length;)this.removeHandle(this.handles[0].name);return this},removeHandle:function(i){var t=this.getHandleIdx(i),e=this.handles[t];return e&&(Pe(e.events,function(t,e){this.off("action:"+i+":"+e)}.bind(this)),this.$(".handle."+i).remove(),this.handles.splice(t,1)),this},changeHandle:function(t,e){var i=this.getHandle(t);return i&&(this.removeHandle(t),this.addHandle(Tt({name:t},i,e))),this},hasHandle:function(t){return-1!==this.getHandleIdx(t)},getHandleIdx:function(e){return pe(this.handles).findIndex(function(t){return t.name===e})},getHandle:function(e){return pe(this.handles).find(function(t){return t.name===e})},toggleHandle:function(t,e){var i=this.getHandle(t);if(i){var n=this.$(".handle."+t);void 0===e&&(e=!n.hasClass("selected")),n.toggleClass("selected",e);var s=e?i.iconSelected:i.icon;s&&this.setHandleIcon(n,s)}return this},selectHandle:function(t){return this.toggleHandle(t,!0)},deselectHandle:function(t){return this.toggleHandle(t,!1)},deselectAllHandles:function(){return pe(this.handles).forEach(function(t){this.deselectHandle(t.name)},this),this},onHandlePointerDown:function(t){var e=this._action=P(t.target).closest(".handle").attr("data-action");if(e){t.preventDefault(),t.stopPropagation(),t=bt(t);var i=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY}),n=i.x,s=i.y;this._localX=n,this._localY=s,"mousedown"===(this._evt=t).type&&2===t.button?this.triggerAction(e,"contextmenu",t,n,s):(this.triggerAction(e,"pointerdown",t,n,s),this.delegateDocumentEvents(null,t.data))}},onPieTogglePointerDown:function(t){t.stopPropagation();var e=P(t.target).closest(".pie-toggle").attr("data-name");this.isOpen(e)||this.isOpen()&&this.toggleState(),this.toggleState(e)},triggerAction:function(t,e,i){var n=Array.prototype.slice.call(arguments,2);n.unshift("action:"+t+":"+e),this.trigger.apply(this,n)},stopBatch:function(){this.options.graph.stopBatch("halo",{halo:this.cid})},startBatch:function(){this.options.graph.startBatch("halo",{halo:this.cid})},pointermove:function(t){if(this._action){t.preventDefault(),t.stopPropagation(),t=bt(t);var e=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY}),i=e.x-this._localX,n=e.y-this._localY;this._localX=e.x,this._localY=e.y,this._evt=t,this.triggerAction(this._action,"pointermove",t,e.x,e.y,i,n)}},pointerup:function(t){var e=this._action;if(e){this._action=null,this._evt=null;var i=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY});this.triggerAction(e,"pointerup",t,i.x,i.y),this.undelegateDocumentEvents()}},onRemove:function(){this._action&&this._evt&&this.pointerup(this._evt),this.options.graph.hasActiveBatch("halo")&&this.stopBatch()},onSetTheme:function(){this.setPieIcons()},removeElement:function(){this.options.cellView.model.remove()},toggleUnlink:function(){var t=0<this.options.graph.getConnectedLinks(this.options.cellView.model).length;this.$handles.children(".unlink").toggleClass("hidden",!t)},toggleFork:function(){var t=this.options.cellView.model.clone(),e=this.options.paper.createViewForModel(t),i=this.options.paper.options.validateConnection(this.options.cellView,null,e,null,"target");this.$handles.children(".fork").toggleClass("hidden",!i),e.remove(),t=null},toggleState:function(e){if(this.isRendered()){var t=this.$el;if(Pe(this.$pieToggles,function(t){t.removeClass("open")}),this.isOpen())this.trigger("state:close",e),t.removeClass("open");else{if(this.trigger("state:open",e),e){var i=pe(this.options.pieToggles).find(function(t){return t.name===e});i&&t.attr({"data-pie-toggle-position":i.position,"data-pie-toggle-name":i.name}),this.$pieToggles[e].addClass("open")}t.addClass("open")}}},isOpen:function(t){return!!this.isRendered()&&(t?this.$pieToggles[t].hasClass("open"):this.$el.hasClass("open"))},isRendered:function(){return void 0!==this.$box}},{clear:function(t){t.trigger("halo:create")}}),Ho=gi.extend({className:"select-button-group",events:{"click .select-button-group-button":"onSelect","mouseover .select-button-group-button":"onOptionHover",mouseleave:"onMouseOut","mousedown .select-button-group-button":"pointerdown","touchstart .select-button-group-button":"pointerdown","mouseup .select-button-group-button":"pointerup","touchend .select-button-group-button":"pointerup"},options:{options:[],disabled:!1,multi:!1,selected:void 0,singleDeselect:!1,noSelectionValue:void 0,width:void 0,buttonWidth:void 0,buttonHeight:void 0,iconWidth:void 0,iconHeight:void 0},init:function(){_e(this,"onSelect","pointerup"),this.$el.data("view",this);var t=this.options.options,e=this.options.multi,i=this.options.selected;if(void 0===i){var n=pe(t).filter(function(t){return t&&!0===t.selected});this.selection=e?n:n[0]}else this.selection=e?Array.isArray(i)?t.filter(function(t,e){return i.includes(e)}):[t[i]]:t[i]},render:function(){return this.renderOptions(this.selection),this.options.width&&this.$el.css("width",this.options.width),this.options.disabled&&this.disable(),this.$el.append(this.$options),this},renderOptions:function(){this.removeOptions(),pe(this.options.options).forEach(function(t,e){var i=this.options.multi?this.selection.includes(t):this.selection===t,n=this.renderOption(t,e,i);this.$el.append(n),i&&n.addClass("selected")},this)},removeOptions:function(){this.$el.empty()},renderOption:function(t,e,i){var n=this.renderOptionContent(t,i);n.data("index",e);var s=t.buttonWidth||this.options.buttonWidth;s&&n.css("width",s);var r=t.buttonHeight||this.options.buttonHeight;return r&&n.css("height",r),n},renderOptionContent:function(t,e){var i=P("<div/>",{class:"select-button-group-button",html:t.content});if(t.icon||e&&t.iconSelected){var n=P("<img/>",{class:"select-button-group-button-icon",src:e&&t.iconSelected?t.iconSelected:t.icon}),s=t.iconWidth||this.options.iconWidth;s&&n.css("width",s);var r=t.iconHeight||this.options.iconHeight;r&&n.css("height",r),i.prepend(n)}return Mt(i,t.attrs),i},getOptionIndex:function(t){return P(t).closest(".select-button-group-button").data("index")},onSelect:function(t){if(!this.isDisabled()){var e=this.getOptionIndex(t.target);this.select(e,{ui:!0})}},onOptionHover:function(t){if(!this.isDisabled()){var e=this.getOptionIndex(t.target);this.trigger("option:hover",this.options.options[e],e)}},onMouseOut:function(t){this.isDisabled()||this.trigger("mouseout",t)},getSelection:function(){return this.selection},getSelectionValue:function(t){t=t||this.selection;var e=this.options.noSelectionValue;if(this.options.multi){var i=pe(t);return 0===i.length?void 0!==e?e:void 0:i.map(function(t){var e=t.value;return void 0!==e?e:t.content})}if(!t)return void 0!==e?e:void 0;var n=t.value;return void 0!==n?n:t.content},select:function(t,e){var i=P(this.$(".select-button-group-button")[t]),n=this.options.options[t],s=null,r=null,o=null,a=null;if(this.options.multi)i.toggleClass("selected"),i.hasClass("selected")?(o=t,a=n,-1===this.selection.indexOf(n)&&this.selection.push(n),n.iconSelected&&i.find(".select-button-group-button-icon").attr("src",n.iconSelected)):(s=t,r=n,this.selection=ye(this.selection,n),n.iconSelected&&i.find(".select-button-group-button-icon").attr("src",n.icon));else{var l=this.$(".selected"),h=l.index(),c=this.options.options[h];i.toggleClass("selected"),i.hasClass("selected")?(c&&(s=h,r=c,l.removeClass("selected"),c.iconSelected&&l.find(".select-button-group-button-icon").attr("src",c.icon)),o=t,a=n,(this.selection=n).iconSelected&&i.find(".select-button-group-button-icon").attr("src",n.iconSelected)):this.options.singleDeselect?(s=t,r=n,this.selection=void 0,n.iconSelected&&i.find(".select-button-group-button-icon").attr("src",n.icon)):i.addClass("selected")}var u=ee({},e);u.deselectedIndex=s,u.deselectedOption=r,u.selectedIndex=o,u.selectedOption=a,this.trigger("option:select",this.selection,t,u)},selectByValue:function(t,e){Array.isArray(t)||(t=[t]);for(var i=this.options.options||[],n=0;n<i.length;n++){var s=i[n];if(void 0===s.value&&t.includes(s.content))this.select(n,e);else if(void 0!==s.value){t.find(function(t){return ce(t,s.value)})&&this.select(n,e)}}},deselect:function(){this.$(".selected").removeClass("selected"),this.options.multi?this.selection=[]:this.selection=void 0},isDisabled:function(){return this.$el.hasClass("disabled")},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},pointerdown:function(t){var e=this.getOptionIndex(t.target);P(this.$(".select-button-group-button")[e]).addClass("is-in-action"),P(document).on("mouseup.select-button-group touchend.select-button-group",this.pointerup)},pointerup:function(){this.$(".is-in-action").removeClass("is-in-action"),P(document).off("mouseup.select-button-group touchend.select-button-group")}}),Fo=gi.extend({className:"inspector",options:{cellView:void 0,cell:void 0,live:!0,validateInput:function(t,e,i,n){return!t.validity||t.validity.valid},renderFieldContent:void 0,renderLabel:void 0,operators:{},multiOpenGroups:!0,stateKey:function(t){return t.id}},events:{"change [data-attribute]:not([data-custom-field])":"onChangeInput","click .group-label":"onGroupLabelClick","click .btn-list-add":"addListItem","click .btn-list-del":"deleteListItem","mousedown .field":"pointerdown","touchstart .field":"pointerdown","focusin .field":"pointerfocusin","focusout .field":"pointerfocusout"},HTMLEntities:{lt:"<",gt:">",amp:"&",nbsp:" ",quot:'"',cent:"\xa2",pound:"\xa3",euro:"\u20ac",yen:"\xa5",copy:"\xa9",reg:"\xae"},init:function(){var t=this.options.groups=this.options.groups||{};_e(this,"stopBatchCommand","pointerup","onContentEditableBlur","replaceHTMLEntity"),this.widgets={},this._attributeKeysInUse=[],this.flatAttributes=this.flattenInputs(this.options.inputs),this.expandAttributes=this.expandAttrs(this.options.inputs||{}),this._when={},this._bound={};var e=Object.keys(this.flatAttributes).map(function(t){var e=this.flatAttributes[t];if(e.when){var i={expression:e.when,path:t};this.extractExpressionPaths(i.expression).forEach(function(t){(this._when[t]||(this._when[t]=[])).push(i)},this)}return this.needsResolving(e)&&(this._bound[t]=e.options),e.path=t,e},this);for(var i in t){var n=t[i];n&&t.hasOwnProperty(i)&&this.extractExpressionPaths(n.when).forEach(function(t){this._when[t]||(this._when[t]=[])},this)}var s=me(e,"index");this.groupedFlatAttributes=me(s,function(t){var e=this.options.groups[t.group];return e&&e.index||Number.MAX_VALUE}.bind(this)),this.listenTo(this.getModel(),"all",this.onCellChange,this)},cacheInputs:function(){var n={};Array.from(this.$("[data-attribute]")).forEach(function(t){var e=P(t),i=e.attr("data-attribute");n[i]=e},this),this._byPath=n,this._attributeKeysInUse=this.getAttributeKeysInUse()},updateGroupsVisibility:function(){for(var t=this.$groups,e=0,i=t.length;e<i;e++){var n=P(t[e]),s=n.attr("data-name"),r=this.options.groups[s],o=0===n.find("> .field:not(.hidden)").length;n.toggleClass("empty",o);var a=!(!r||!r.when||this.isExpressionValid(r.when));n.toggleClass("hidden",a)}},expandAttrs:function(t){for(var e={},i=Object.keys(t),n=0;n<i.length;n++){var s=i[n],r=t[s],o=s.split("/");ft(e,o,de(r)?this.expandAttrs(r):r)}return e},flattenInputs:function(t){return jt(t,"/",function(t){return"string"==typeof t.type})},getModel:function(){return this.options.cell||this.options.cellView.model},onCellChange:function(t,e,i,n){if((n=n||{}).inspector!=this.cid)switch(t){case"remove":this.remove();break;case"change:position":this.updateInputPosition();break;case"change:size":this.updateInputSize();break;case"change:angle":this.updateInputAngle();break;case"change:source":case"change:target":case"change:vertices":break;default:var s="change:";if(t.slice(0,s.length)===s){var r=t.slice(s.length);this._attributeKeysInUse.includes(r)&&this.render({refresh:!0})}}},render:function(t){var i,n=t&&t.refresh;n&&this.options.storeGroupsState&&this.storeGroupsState(),this.$el.empty(),this.removeWidgets();var s,r=[];return this.groupedFlatAttributes.forEach(function(t){if(i!==t.group){var e=this.options.groups[t.group];s=this.renderGroup({name:t.group,label:e&&e.label}),n||(e&&e.closed?this.closeGroup(s,{init:!0}):this.openGroup(s,{init:!0})),r.push(s)}this.renderTemplate(s,t,t.path),i=t.group},this),this.$document=P(this.el.ownerDocument),this.$groups=P(r),this.$el.append(r),n&&this.options.restoreGroupsState&&this.restoreGroupsState(),this.afterRender(),this},getAttributeKeysInUse:function(){var t=Object.keys(this._byPath).map(function(t){return t.substring(0,t.indexOf("/"))||t}),e=pe(this._bound),i=Object.keys(this._when);return oe([].concat(t,e,i))},getCellAttributeValue:function(t,e){var i=this.getModel(),n=gt(i.attributes,t,"/");if(!(e=e||this.flatAttributes[t]))return n;if(void 0===n&&void 0!==e.defaultValue&&(n=e.defaultValue),e.valueRegExp){if(void 0===n)throw new Error("Inspector: defaultValue must be present when valueRegExp is used.");var s=n.match(new RegExp(e.valueRegExp));n=s&&s[2]}return n},resolvableTypes:["select","select-box","color-palette","select-button-group"],needsResolving:function(t){return!!t&&-1<this.resolvableTypes.indexOf(t.type)&&Ne(t.options)},resolveBindings:function(t){if(-1<this.resolvableTypes.indexOf(t.type)){var e=t.options||[];Ne(e)&&(e=gt(this.getModel().attributes,e,"/")||[]),Te(e[0])||(e=pe(e).map(function(t){return{value:t,content:t}})),t.items=e}},updateBindings:function(n){var t=Object.keys(this._bound).reduce(function(t,e){var i=this._bound[e];return 0===n.indexOf(i)&&t.push(e),t}.bind(this),[]);he(t)||(t.forEach(function(t){this.renderTemplate(null,this.flatAttributes[t],t,{replace:!0})},this),this.afterRender())},renderFieldContent:function(s,t,r){var e,o,a,l,i;if(ue(this.options.renderFieldContent)&&(e=this.options.renderFieldContent(s,t,r,this)))return P(e).attr({"data-attribute":t,"data-type":s.type,"data-custom-field":!0});switch(s.type){case"select-box":a=pe(s.items).findIndex(function(t){var e=t.value,i=r;if(void 0===e&&t.content===i)return!0;var n=s.key;return n&&(i=gt(i,n,"/"),e=gt(e,n,"/")),ce(e,i)});var n=ee({theme:this.options.theme},Ae(s,"type","group","index","selectBoxOptionsClass","options"),{options:s.items,selected:a,selectBoxOptionsClass:[ct("inspector-select-box-options"),s.selectBoxOptionsClass].filter(function(t){return!!t}).join(" ")});(o=new Oo(n)).$el.attr({"data-attribute":t,"data-type":s.type,"data-overwrite":s.overwrite}),o.render(),i=this.renderOwnLabel(s,t),e=P("<div/>").append(i,o.el),s.previewMode?(l=o.selection,o.on("options:mouseout close",function(){o.selection=l,this.processInput(o.$el,{previewCancel:!0,dry:!0})},this),o.on("option:hover",function(t,e){o.selection=t,this.processInput(o.$el,{dry:!0})},this),o.on("option:select",function(t,e){var i=void 0===l?void 0:o.getSelectionValue(l),n=i===o.getSelectionValue(t);this.processInput(o.$el,{previewDone:!0,dry:n,originalValue:i}),l=t},this)):o.on("option:select",function(t,e){this.processInput(o.$el)},this),this.widgets[t]=o;break;case"color-palette":a=pe(s.items).findIndex(function(t){return t.value===r||void 0===t.value&&t.content===r});var h=ee({theme:this.options.theme},Ae(s,"type","group","index","options"),{options:s.items,selected:a});(o=new Go(h)).$el.attr({"data-attribute":t,"data-type":s.type}),o.render(),i=this.renderOwnLabel(s,t),e=P("<div/>").append(i,o.el),s.previewMode?(l=o.selection,o.on("options:mouseout close",function(){o.selection=l,this.processInput(o.$el,{previewCancel:!0,dry:!0})},this),o.on("option:hover",function(t,e){o.selection=t,this.processInput(o.$el,{dry:!0})},this),o.on("option:select",function(t,e){var i=void 0===l?void 0:o.getSelectionValue(l),n=i===o.getSelectionValue(t);this.processInput(o.$el,{previewDone:!0,dry:n,originalValue:i}),l=t},this)):o.on("option:select",function(t,e){this.processInput(o.$el)},this),this.widgets[t]=o;break;case"select-button-group":s.multi?(a=[],pe(s.items).forEach(function(t,e){var i=void 0===t.value?t.content:t.value,n=s.key;n&&(i=gt(i,n,"/")),pe(r).find(function(t){return n&&(t=gt(t,n,"/")),ce(i,t)})&&a.push(e)})):a=pe(s.items).findIndex(function(t){var e=t.value,i=r;if(void 0===e&&t.content===i)return!0;var n=s.key;return n&&(i=gt(i,n,"/"),e=gt(e,n,"/")),ce(e,i)});var c=ee({theme:this.options.theme},Ae(s,"type","group","index","options"),{options:s.items,selected:a});(o=new Ho(c)).$el.attr({"data-attribute":t,"data-type":s.type,"data-overwrite":s.overwrite}),o.render(),i=this.renderOwnLabel(s,t),e=P("<div/>").append(i,o.el),s.previewMode?(l=o.selection,o.on("mouseout",function(){o.selection=l,this.processInput(o.$el,{previewCancel:!0,dry:!0})},this),o.on("option:hover",function(t,e){s.multi?o.selection=oe(o.selection.concat([t])):o.selection=t,this.processInput(o.$el,{dry:!0})},this),o.on("option:select",function(t,e){var i=void 0===l?void 0:o.getSelectionValue(l),n=o.getSelectionValue(t),s=ce(i,n);this.processInput(o.$el,{previewDone:!0,dry:s,originalValue:i}),l=t},this)):o.on("option:select",function(t,e){this.processInput(o.$el)},this),this.widgets[t]=o;break;default:e=this.renderOwnFieldContent({options:s,type:s.type,overwrite:s.overwrite,label:s.label||t,attribute:t,value:r})}return e},renderGroup:function(t){t=t||{};var e=P("<div/>").addClass("group").attr("data-name",t.name),i=P("<h3/>").addClass("group-label").text(t.label||t.name);return e.append(i)},renderOwnLabel:function(t,e){var i,n=this.options.renderLabel;if("function"==typeof n&&(i=n(t,e,this)),void 0!==i)return P(i);switch(t.type){case"select-box":case"color-palette":case"select-button-group":return P("<label/>").html(t.label||e);default:return P("<label/>").text(t.label||e)}},renderOwnFieldContent:function(n){var t,s,e,i,r,o,a;switch(a=this.renderOwnLabel(n.options,n.attribute),n.type){case"number":s=P("<input/>",{type:"number",min:n.options.min,max:n.options.max,step:n.options.step}).val(n.value),t=[a,P("<div/>").addClass("input-wrapper").append(s)];break;case"range":a.addClass("with-output"),e=P("<output/>").text(n.value),i=P("<span/>").addClass("units").text(n.options.unit),(s=P("<input/>",{type:"range",name:n.type,min:n.options.min,max:n.options.max,step:n.options.step}).val(n.value)).on("change input",function(){e.text(s.val())}),t=[a,e,i,s];break;case"textarea":s=P("<textarea/>").text(n.value),t=[a,P("<div/>").addClass("input-wrapper").append(s)];break;case"content-editable":var l=Ne(n.value)?n.value.replace(/\n/g,"<br>").replace(/ /g,"&nbsp;"):"";s=P("<div/>").prop("contenteditable",!0).css("display","inline-block").html(l).on("blur",this.onContentEditableBlur),t=[a,P("<div/>").addClass("input-wrapper").append(s)];break;case"select":var h=n.options.items;s=P("<select/>"),n.options.multiple&&s.prop({size:n.options.size||h.length,multiple:!0});pe(h).forEach(function(t){var e,i=P("<option/>",{value:t.value}).text(t.content);e=t.value,(n.options.multiple?pe(n.value).find(function(t){return ce(e,t)}):ce(e,n.value))&&i.attr("selected","selected"),s.append(i)}),t=[a,s];break;case"toggle":r=P("<span><i/></span>"),s=P("<input/>",{type:"checkbox"}).prop("checked",!!n.value),t=[a,P("<div/>").addClass(n.type).append(s,r)];break;case"color":t=[a,s=P("<input/>",{type:"color"}).val(n.value)];break;case"text":s=P("<input/>",{type:"text"}).val(n.value),t=[a,P("<div/>").addClass("input-wrapper").append(s)];break;case"object":s=P("<div/>"),o=P("<div/>").addClass("object-properties"),t=[a,s.append(o)];break;case"list":r=P("<button/>").addClass("btn-list-add").text(n.options.addButtonLabel||"+"),o=P("<div/>").addClass("list-items"),t=[a,(s=P("<div/>")).append(r,o)]}return s&&s.addClass(n.type).attr({"data-type":n.type,"data-attribute":n.attribute,"data-overwrite":n.overwrite}),P.fn.append.apply(P("<div>"),t).children()},onContentEditableBlur:function(t){var e=P("<input/>",{disabled:!0,tabIndex:-1,style:{width:"1px",height:"1px",border:"none",margin:0,padding:0}}).appendTo(this.$el);e.focus(),e[0].setSelectionRange(0,0),e.blur().remove(),P(t.target).trigger("change")},replaceHTMLEntity:function(t,e){return this.HTMLEntities[e]||""},renderObjectProperty:function(t){return P("<div/>",{"data-property":(t=t||{}).property,class:"object-property"})},renderListItem:function(t){t=t||{};var e=P("<button/>").addClass("btn-list-del").text(t.options.removeButtonLabel||"-");return P("<div/>",{"data-index":t.index,class:"list-item"}).append(e)},renderFieldContainer:function(t){return P("<div/>",{"data-field":(t=t||{}).path,class:"field "+t.type+"-field"})},renderTemplate:function(t,n,s,e){t=t||this.$el,e=e||{},this.resolveBindings(n);var i=this.renderFieldContainer({path:s,type:n.type});n.when&&!this.isExpressionValid(n.when)&&(i.addClass("hidden"),n.when.otherwise&&n.when.otherwise.unset&&this.unsetProperty(s));var r=this.getCellAttributeValue(s,n),o=this.renderFieldContent(n,s,r);if(i.append(o),Mt(i,n.attrs),"list"===n.type){pe(r).forEach(function(t,e){var i=this.renderListItem({index:e,options:n});this.renderTemplate(i,n.item,s+"/"+e),o.children(".list-items").append(i)},this);var a=r&&r.length,l=n&&n.min,h=n&&n.max;this.fixListButtons(o,a,l,h)}else if("object"===n.type){var c=this.flattenInputs(n.properties),u=Object.keys(c).map(function(t){var e=this[t];return e.path=t,e},c);(u=me(u,function(t){return t.index})).forEach(function(t){var e=this.renderObjectProperty({property:t.path});this.renderTemplate(e,t,s+"/"+t.path),o.children(".object-properties").append(e)},this)}e.replace?t.find('[data-field="'+s+'"]').replaceWith(i):t.append(i)},updateInputPosition:function(){var t=this._byPath["position/x"],e=this._byPath["position/y"],i=this.getModel().get("position");t&&t.val(i.x),e&&e.val(i.y)},updateInputSize:function(){var t=this._byPath["size/width"],e=this._byPath["size/height"],i=this.getModel().get("size");t&&t.val(i.width),e&&e.val(i.height)},updateInputAngle:function(){var t=this._byPath.angle,e=this.getModel().get("angle");t&&t.val(e)},validateInput:function(t,e,i){switch(t){case"select-box":case"color-palette":var n=this.widgets[i];return!!n&&-1!==n.getSelectionIndex();case"select-button-group":return!!this.widgets[i];default:return this.options.validateInput(e,i,t,this)}},onChangeInput:function(t){t.target===t.currentTarget&&this.processInput(P(t.target))},processInput:function(t,e){var i=t.attr("data-attribute"),n=t.attr("data-type");if(this.validateInput(n,t[0],i)){this.options.live&&this.updateCell(t,i,e);var s=this.getFieldValue(t[0],n),r=this.parse(n,s,t[0]);this.trigger("change:"+i,r,t[0],e)}},updateDependants:function(t){pe(this._when[t]).forEach(function(t){var e=this._byPath[t.path],i=e.closest(".field"),n=i.hasClass("hidden"),s=this.isExpressionValid(t.expression);i.toggleClass("hidden",!s),t.expression.otherwise&&t.expression.otherwise.unset&&this.options.live&&(s?n&&this.updateCell(e,t.path):(this.unsetProperty(t.path),this.renderTemplate(null,this.flatAttributes[t.path],t.path,{replace:!0}),this.afterRender()))},this)},unsetProperty:function(t,e){var i=this.getModel(),n=t.split("/"),s=n[0],r=n.slice(1).join("/");if((e=e||{}).inspector=this.cid,e["inspector_"+this.cid]=!0,"attrs"==t)i.removeAttr(r,e);else if(t==s)i.unset(s,e);else{var o=Tt({},i.get(s)),a=mt(o,r,"/");i.set(s,a,e)}},getOptions:function(t){if(0!==t.length){var e=t.attr("data-attribute");return this.getOptionsFromPath(e)}},markForRemoval:function(t,e){var i=this.findParentListByPath(t);if(i){var n=t.substr(i.length+1),s=parseInt(n,10);Number.isFinite(s)&&(e.remove[i]=e.remove[i]||[],e.remove[i].includes(s)||e.remove[i].push(s))}},markForUpdate:function(t,e,i,n){var s=t.substr(n.length+1);e.update[n]&&ft(e.update[n].value,s,i,"/")},updateCell:function(t,e,i){var d=this.getModel(),n={};t?n[e]=t:n=this._byPath,this.startBatchCommand();var p={},g={update:{},remove:{}};Pe(n,function(t,e){if(!t.closest(".field").hasClass("hidden")){var i=t.attr("data-type"),n=t.attr("data-overwrite"),s="false"!==n&&void 0!==n,r=t.hasClass("remove");switch(i){case"list":case"object":r&&this.markForRemoval(e,g);break;default:if(!this.validateInput(i,t[0],e))return;var o=this.getFieldValue(t[0],i),a=this.parse(i,o,t[0]),l=this.getOptionsFromPath(e);if(l.valueRegExp)a=(gt(d.attributes,e,"/")||l.defaultValue).replace(new RegExp(l.valueRegExp),"$1"+a+"$3");if(r)this.markForRemoval(e,g);else{var h=l.parent;if(h&&"object"===h.type&&void 0!==h.overwrite&&!1!==h.overwrite){var c={},u=e.split("/");c[u[u.length-1]]=a,g.update[h.path]={value:c,overwrite:!0}}else p[e]={value:a,overwrite:s}}}}}.bind(this)),Pe(p,function(t,e){this.setProperty(e,t.value,ee({overwrite:t.overwrite},i)),this.updateBindings(e),this.updateDependants(e)}.bind(this)),me(Object.keys(g.remove),function(t){return t.split("/").length}).reverse().forEach(function(t){var e=g.remove[t];this.removeProperty(t,e,ee({rewrite:!0},i))}.bind(this)),Pe(g.update,function(t,e){this.setProperty(e,this.compactDeep(t.value),ee({rewrite:!0,overwrite:t.overwrite},i)),this.updateBindings(e),this.updateDependants(e)}.bind(this)),this.updateGroupsVisibility(),this.stopBatchCommand()},compactDeep:function(t){return Array.isArray(t)?t.reduce(function(t,e){return e&&t.push(this.compactDeep(e)),t}.bind(this),[]):t},findParentListByPath:function(t){var e=t.split("/");e.pop();for(var i=e;i.length;){var n=this.getOptionsFromPath(i.join("/"));if(n&&"list"===n.type)return e.slice(0,i.length).join("/");i.pop()}return null},getOptionsFromPath:function(t){for(var e,i=t.split("/"),n=this.expandAttributes,s=[];i.length;){var r,o=r;if(n&&"object"===n.type?r="properties":(r=i.shift(),!i.length&&"list"!==n.type||(e=n,s.push(r))),r=!Number.isNaN(parseInt(r))&&"list"===n.type?"item":r,Object(n)!==n||!(r in n||n[t]))return{};n=n[r]||n[t]}return n=ee({},n),(e=ee({},e)).path=s.join("/"),o&&"properties"===o&&(e.type="object"),n.parent=e,n},getFieldValue:function(t,e){if(ue(this.options.getFieldValue)){var i=this.options.getFieldValue(t,e,this);if(i)return i.value}var n=P(t);switch(e){case"select-box":case"color-palette":case"select-button-group":var s=n.attr("data-attribute");return this.widgets[s].getSelectionValue();case"content-editable":return n.html().replace(/<br\s*\/*>/gi,"\n").replace(/(<(p|div)\s)/gi,"\n$1").replace(/(<([^>]+)>)/gi,"").replace(/&(\w+);/gi,this.replaceHTMLEntity).replace(/\n$/,"");default:return n.val()}},removeProperty:function(t,n,e){var i=this.getModel(),s=Je.prototype.prop,r=s.call(i,t);if(r){var o=r.reduce(function(t,e,i){return n.includes(i)||t.push(e),t},[]),a=this.flatAttributes[t];Array.isArray(o)&&0===o.length&&!a&&(o=null),s.call(i,t,o,e)}},setProperty:function(t,e,i){(i=i||{}).inspector=this.cid;var n=Je.prototype.prop,s=this.getModel(),r=i.overwrite||!1;if(i.previewDone&&n.call(s,t,i.originalValue,{rewrite:!0,silent:!0}),void 0===e)Je.prototype.removeProp.call(s,t,i);else{var o;if(Te(e)&&!r){var a=n.call(s,t),l=Array.isArray(e)?[]:{};o=Tt(l,a,e)}else o=ae(e);r&&(i.rewrite=!0),n.call(s,t,o,i)}},parse:function(t,e,i){switch(t){case"number":case"range":e=parseFloat(e);break;case"toggle":e=i.checked}return e},startBatchCommand:function(){if(!this.inBatch){this.inBatch=!0;var t=this.getModel();t instanceof Je&&t.startBatch("inspector",{cid:this.cid})}},stopBatchCommand:function(){if(this.inBatch){var t=this.getModel();t instanceof Je&&t.stopBatch("inspector",{cid:this.cid}),this.inBatch=!1}},afterRender:function(){this.cacheInputs(),this.updateGroupsVisibility(),this.trigger("render")},addListItem:function(t){var e=P(t.target).parent("[data-attribute]"),i=this.getOptions(e),n=e.children(".list-items"),s=n.children(".list-item"),r=s.last(),o=(0===r.length?-1:parseInt(r.attr("data-index"),10))+1,a=this.renderListItem({index:o,options:i}),l=e.attr("data-attribute")+"/"+o;this.renderTemplate(a,i.item,l),n.append(a),a.find("input:first").focus();var h=(s=n.children(".list-item")).not(".remove").length;this.fixListButtons(e,h,i.min,i.max),this.afterRender(),this.options.live&&this.updateCell()},deleteListItem:function(t){var e=P(t.target),i=e.closest("[data-attribute]"),n=this.getOptions(i),s=e.closest(".list-item");s.hide(),s.addClass("remove"),s.find("[data-field]").each(function(){P(this).hide().addClass("remove")}),s.find("[data-attribute]").each(function(){P(this).hide().addClass("remove")});var r=i.children(".list-items").children(".list-item").not(".remove").length;this.fixListButtons(i,r,n.min,n.max),this.afterRender(),this.options.live&&this.updateCell()},fixListButtons:function(t,e,i,n){var s,r,o=t.children(".btn-list-add");(s=e,"number"!=typeof(r=n)||"number"!=typeof s||s<r)?o.removeClass("hidden"):o.addClass("hidden");var a,l,h=t.children(".list-items").children(".list-item").children(".btn-list-del");(a=e,"number"!=typeof(l=i)||l<=0||!("number"!=typeof a||a<=0)&&l<a)?h.removeClass("hidden"):h.addClass("hidden")},bindDocumentEvents:function(){var t=this.getEventNamespace();this.$document.on("mouseup"+t+" touchend"+t,this.pointerup)},unbindDocumentEvents:function(){this.$document.off(this.getEventNamespace())},pointerdown:function(t){this.bindDocumentEvents(),this.startBatchCommand(),this._$activeField=P(t.currentTarget).addClass("is-in-action")},pointerup:function(){this.unbindDocumentEvents(),this.stopBatchCommand(),this._$activeField&&(this._$activeField.removeClass("is-in-action"),this._$activeField=null)},pointerfocusin:function(t){t.stopPropagation(),P(t.currentTarget).addClass("is-focused")},pointerfocusout:function(t){t.stopPropagation(),P(t.currentTarget).removeClass("is-focused")},onRemove:function(){this.unbindDocumentEvents(),this.removeWidgets(),this===this.constructor.instance&&(this.constructor.instance=null)},removeWidgets:function(){var t=this.widgets;for(var e in t)t[e].remove();this.widgets={}},onGroupLabelClick:function(t){t.preventDefault(),this.options.multiOpenGroups||this.closeGroups();var e=P(t.target).closest(".group");this.toggleGroup(e)},toggleGroup:function(t){var e=Ne(t)?this.$('.group[data-name="'+t+'"]'):P(t);e.hasClass("closed")?this.openGroup(e):this.closeGroup(e)},closeGroup:function(t,e){e=e||{};var i=Ne(t)?this.$('.group[data-name="'+t+'"]'):P(t);!e.init&&i.hasClass("closed")||(i.addClass("closed"),this.trigger("group:close",i.data("name"),e))},openGroup:function(t,e){e=e||{};var i=Ne(t)?this.$('.group[data-name="'+t+'"]'):P(t);(e.init||i.hasClass("closed"))&&(i.removeClass("closed"),this.trigger("group:open",i.data("name"),e))},closeGroups:function(){for(var t=0,e=this.$groups.length;t<e;t++)this.closeGroup(this.$groups[t])},openGroups:function(){for(var t=0,e=this.$groups.length;t<e;t++)this.openGroup(this.$groups[t])},COMPOSITE_OPERATORS:["not","and","or","nor"],PRIMITIVE_OPERATORS:["eq","ne","regex","text","lt","lte","gt","gte","in","nin","equal"],_isComposite:function(t){return 0<we(this.COMPOSITE_OPERATORS,Object.keys(t)).length},_isPrimitive:function(t){var e=Object.keys(this.options.operators).concat(this.PRIMITIVE_OPERATORS);return 0<we(e,Object.keys(t)).length},_evalCustomPrimitive:function(t,e,i){return!!this.options.operators[t].apply(this,[this.getModel(),e].concat(i))},_evalPrimitive:function(e){return Object.keys(e).reduce(function(t,s){var r=e[s];return Object.keys(r).reduce(function(t,e){var i=r[e],n=this.getCellAttributeValue(e);if(ue(this.options.operators[s]))return this._evalCustomPrimitive(s,n,i);switch(s){case"eq":return i==n;case"ne":return i!=n;case"regex":return new RegExp(i).test(n);case"text":return!i||Ne(n)&&-1<n.toLowerCase().indexOf(i);case"lt":return n<i;case"lte":return n<=i;case"gt":return i<n;case"gte":return i<=n;case"in":return Array.isArray(i)&&i.includes(n);case"nin":return Array.isArray(i)&&!i.includes(n);case"equal":return ce(i,n);default:return t}}.bind(this),!1)}.bind(this),!1)},_evalExpression:function(s){return this._isPrimitive(s)?this._evalPrimitive(s):Object.keys(s).reduce(function(t,e){var i=s[e];if("not"==e)return!this._evalExpression(i);var n=pe(i).map(this._evalExpression,this);switch(e){case"and":return n.every(function(t){return!!t});case"or":return n.some(function(t){return!!t});case"nor":return!n.some(function(t){return!!t});default:return t}}.bind(this),!1)},_extractVariables:function(t){return Array.isArray(t)||this._isComposite(t)?pe(t).reduce(function(t,e){return t.concat(this._extractVariables(e))}.bind(this),[]):pe(t).reduce(function(t,e){return Object.keys(e)},[])},isExpressionValid:function(t){return t=Ae(t,"otherwise","dependencies"),this._evalExpression(t)},extractExpressionPaths:function(t){var e=t&&t.dependencies||[];return t=Ae(t,"otherwise","dependencies"),oe(this._extractVariables(t).concat(e))},getGroupsStateKey:function(){if(ue(this.options.stateKey))return this.options.stateKey(this.getModel());throw new Error("Inspector: Option stateKey must be a function")},storeGroupsState:function(){var t=this.getGroupsStateKey(),e=pe(this.$(".group.closed"));Fo.groupStates[t]=e.map(function(t){return P(t).attr("data-name")})},getGroupsState:function(){return Fo.groupStates[this.getGroupsStateKey()]},restoreGroupsState:function(){function t(i,t){Pe(t.options.groups,function(t,e){i(t,e)?this.closeGroup(e):this.openGroup(e)}.bind(t))}var i=this.getGroupsStateKey();Fo.groupStates[i]?t(function(t,e){return Fo.groupStates[i].includes(e)},this):t(function(t){return t.closed},this)}},{groupStates:{},instance:null,create:function(t,e){ie(e=e||{},{restoreGroupsState:!0,storeGroupsState:!0});var i=e.cell||e.cellView.model,n=this.instance;return n&&n.getModel()===i||(n&&n.el.parentNode&&(e.storeGroupsState&&n.storeGroupsState(),n.updateCell(),n.remove()),n=new this(e).render(),this.instance=n,P(t).html(n.el),e.restoreGroupsState&&n.restoreGroupsState()),n},close:function(){var t=this.instance;t&&t.remove()}});ee(Wo.prototype,o.Events),Wo.prototype.on=function(t,e,i){return o.Events.on.call(this,this.normalizeEvent(t),e,i),this},Wo.prototype.off=function(t,e,i){var n=t?this.normalizeEvent(t):null;return o.Events.off.call(this,n,e,i),this},Wo.prototype.normalizeEvent=function(t){if("object"!=typeof t)return this.normalizeShortcut(t);for(var e=Object.keys(t),i={},n=0,s=e.length;n<s;n++){var r=e[n];i[this.normalizeEvent(r)]=t[r]}return i},Wo.prototype.normalizeShortcut=function(t){if("all"===t.toLowerCase())return t;for(var e=this.parser.toEventObjectList(t),i=[],n=0;n<e.length;n++)i.push(this.hash(e[n]));return i.join(" ")},Wo.prototype.enable=function(){window.addEventListener?(document.addEventListener("keydown",this.handleKey,!1),document.addEventListener("keypress",this.handleKey,!1),document.addEventListener("keyup",this.handleKey,!1)):window.attachEvent&&(document.attachEvent("keydown",this.handleKey,!1),document.attachEvent("keypress",this.handleKey,!1),document.attachEvent("keyup",this.handleKey,!1))},Wo.prototype.disable=function(){window.removeEventListener?(document.removeEventListener("keydown",this.handleKey,!1),document.removeEventListener("keypress",this.handleKey,!1),document.removeEventListener("keyup",this.handleKey,!1)):window.detachEvent&&(document.detachEvent("keydown",this.handleKey,!1),document.detachEvent("keypress",this.handleKey,!1),document.detachEvent("keyup",this.handleKey,!1))},Wo.prototype.isActive=function(t,e){return this.isModifierActive(t,e)},Wo.prototype.isModifierActive=function(t,e){for(var i=this.parser.toEventObjectList(t),n=0;n<i.length;n++)if(i[n].modifiersCompare(e))return!0;return!1},Wo.prototype.hash=function(t){function e(t){return t?1:0}return[t.type,":",t.which,e(t.shiftKey),e(t.ctrlKey),e(t.altKey),e(t.metaKey)].join("")},Wo.prototype.handleKey=function(t){if(!this.isUnsupportedElement(t)){var e=ta.fromNative(t);o.Events.trigger.call(this,this.hash(e),t)}},Wo.prototype.isUnsupportedElement=function(t){var e=t.target||t.srcElement;if(e){var i=e.tagName.toUpperCase();return"INPUT"===i||"SELECT"===i||"TEXTAREA"===i||e.isContentEditable}return!1};var Uo=function(){};Uo.prototype={constructor:Uo,parseEventString:function(t){var e,i,n=(t=t||"").split("+"),s=new ta(0);for(i=0;i<n.length;i++){e=n[i];var r=this.getModifierPropertyName(e);r&&(s[r]=!0),1!==n.length&&void 0!==r||(s.which=Uo.getCode(e))}return s},toEventObjectList:function(t){return t.replace(/\s*\+\s*/gi,"+").split(" ").map(this.composeEventObject,this)},composeEventObject:function(t){var e=t.split(":"),i=Qo.KEYDOWN,n=e[0];if(1<e.length&&(n=e[1],i=e[0]),-1===qo.indexOf(i))throw t+": invalid shortcut definition";var s=this.parseEventString(n);return i===Qo.KEYUP&&Jo[s.which]&&(s[Jo[s.which]]=!1),s.setType(i)},getModifierPropertyName:function(t){var e=Xo[t];return Jo[e]}},Uo.getCode=function(t){return Ko[t]||t.toUpperCase().charCodeAt(0)};var Xo={"\u21e7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91,meta:91},Jo={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"},$o={226:"\\",57392:"ctrl",63289:"num",59:";",61:"=",173:"-"},Ko={backspace:8,tab:9,shift:16,ctrl:17,alt:18,meta:91,clear:12,enter:13,return:13,esc:27,escape:27,capslock:20,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,insert:45,ins:45,pageup:33,pagedown:34,plus:187,minus:189,"-":189,",":188,".":190,"/":191,"`":192,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123},Qo={KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup"},qo=[Qo.KEYPRESS,Qo.KEYDOWN,Qo.KEYUP],ta=function(t,e,i,n,s,r){this.which=t,this.shiftKey=e||!1,this.ctrlKey=i||!1,this.altKey=n||!1,this.metaKey=s||!1,this.type=r||Qo.KEYDOWN};ta.fromNative=function(t){var e=t.which;t.type===Qo.KEYPRESS&&(e=String.fromCharCode(t.which).toUpperCase().charCodeAt(0)),$o[e]&&(e=Uo.getCode($o[e]));var i=new ta(e,t.shiftKey,t.ctrlKey,t.altKey,t.metaKey,t.type);return t.type===Qo.KEYUP&&Jo[e]&&(i[Jo[e]]=!1),i},ta.prototype.modifiersCompare=function(t){return!(this.shiftKey&&this.shiftKey!==t.shiftKey||this.ctrlKey&&this.ctrlKey!==t.ctrlKey||this.altKey&&this.altKey!==t.altKey||this.metaKey&&this.metaKey!==t.metaKey)},ta.prototype.setType=function(t){return this.type=t,this};var ea=jo.extend({className:jo.prototype.className+" lightbox",options:Tt({},jo.prototype.options,{closeButton:!0,modal:!0,downloadable:!1,downloadAction:"download",fileName:"Image",closeAnimation:{delay:2e3,duration:200,easing:"swing",properties:{opacity:0}},top:100,windowArea:.8,openAnimation:!1}),init:function(){if(_e(this,"startCloseAnimation","positionAndScale"),jo.prototype.init.apply(this,arguments),this.options.image&&(this.$image=P("<img/>").on("load",this.positionAndScale),this.options.content=this.$image),this.options.downloadable){var t={action:this.options.downloadAction,content:"Download",position:"center"};this.buttons=Array.isArray(this.buttons)?this.buttons.slice():[],this.buttons.push(t)}this.on("action:"+this.options.downloadAction,this.download),P(window).on("resize",this.positionAndScale),this.on("close:animation:complete",this.remove,this)},open:function(){return jo.prototype.open.apply(this,arguments),this.$image&&this.$image.attr("src",this.options.image),this.positionAndScale(),this.startOpenAnimation(),this},positionAndScale:function(){var t=this.$(".fg"),e=this.$(".body > img"),i=this.$(".titlebar"),n=this.$(".controls"),s=this.options.windowArea,r=window.innerWidth*s;this.$el.css("margin-top",this.options.top),i.css("width",r);var o=i.height(),a=n.height(),l=window.innerHeight*s-this.options.top-o-a;t.css({width:r,height:l});var h=e.width(),c=e.height();t.css({width:h,height:c}),i.css("width","auto"),i.hasClass("empty")||n.css("top",i.outerHeight())},download:function(){St(this.options.image,function(t,e){At(e,this.options.fileName)}.bind(this))},close:function(){return this.options.closeAnimation?this.startCloseAnimation():jo.prototype.close.apply(this,arguments),this},onRemove:function(){jo.prototype.onRemove.apply(this,arguments),P(window).off("resize",this.positionAndScale),this.$image&&this.$image.off("load",this.positionAndScale)},startCloseAnimation:function(){this.$el.animate(this.options.closeAnimation.properties,ee({complete:function(){this.trigger("close:animation:complete")}.bind(this)},this.options.closeAnimation))},startOpenAnimation:function(){this.$el.animate(ee({},this.options.openAnimation.properties,{height:this._foregroundHeight}),ee({complete:function(){this.trigger("open:animation:complete")}.bind(this)},this.options.openAnimation))}}),ia=gi.extend({className:"navigator",events:{mousedown:"startAction",touchstart:"startAction"},options:{paperConstructor:Qs,paperOptions:{},zoomOptions:null,zoom:{min:.5,max:2},width:300,height:200,padding:10},init:function(){this.options.zoomOptions?this.options.zoom=ee({},this.options.zoom,this.options.zoomOptions):this.options.zoom&&(this.options.zoom=ie({},this.options.zoom,this.constructor.prototype.options.zoom)),_e(this,"updateCurrentView","doAction","stopAction","scrollTo"),this.updateCurrentView=ge(this.updateCurrentView,0);var t=this.options.paperScroller;t.$el.on("scroll.navigator",this.updateCurrentView);var e=this.sourcePaper=t.options.paper;this.listenTo(e,"resize",this.updatePaper),(this.targetPaper=new this.options.paperConstructor(Tt({model:e.model,interactive:!1,frozen:!0},this.options.paperOptions))).$el.on({"mousedown.navigator":this.scrollTo,"touchstart.navigator":this.scrollTo}),P(document.body).on({"mousemove.navigator touchmove.navigator":this.doAction,"mouseup.navigator touchend.navigator":this.stopAction})},render:function(){if(this.targetPaper.$el.appendTo(this.el),this.targetPaper.unfreeze(),this.$currentView=P("<div>").addClass("current-view"),this.options.zoom){var t=P("<div>").addClass("current-view-control");this.$currentView.append(t)}return this.$el.append(this.$currentView).css({width:this.options.width,height:this.options.height,padding:this.options.padding}),this.updatePaper(this.sourcePaper.options.width,this.sourcePaper.options.height),this},updatePaper:function(t,e){var i=this.sourcePaper.options.origin,n=this.sourcePaper.scale(),s=this.options.width-2*this.options.padding,r=this.options.height-2*this.options.padding;t/=n.sx,e/=n.sy;var o=this.ratio=Math.min(s/t,r/e),a=i.x*o/n.sx,l=i.y*o/n.sy;t*=o,e*=o,this.targetPaper.setDimensions(t,e),this.targetPaper.setOrigin(a,l),this.targetPaper.scale(o,o),this.updateCurrentView()},updateCurrentView:function(){var t=this.ratio,e=this.sourcePaper.scale(),i=this.options.paperScroller,n=i.clientToLocalPoint(0,0),s=this.targetPaper.$el.position(),r=this.targetPaper.translate();r.ty=r.ty||0,this.currentViewGeometry={top:s.top+n.y*t+r.ty,left:s.left+n.x*t+r.tx,width:i.$el.innerWidth()*t/e.sx,height:i.$el.innerHeight()*t/e.sy},this.$currentView.css(this.currentViewGeometry)},startAction:function(t){t=bt(t),this._action=P(t.target).hasClass("current-view-control")?"zooming":"panning",this._clientX=t.clientX,this._clientY=t.clientY},doAction:function(t){if(this._action){t=bt(t);var e=this.sourcePaper.scale(),i=(t.clientX-this._clientX)*e.sx,n=(t.clientY-this._clientY)*e.sy;switch(this._action){case"panning":this.options.paperScroller.el.scrollLeft+=i/this.ratio,this.options.paperScroller.el.scrollTop+=n/this.ratio;break;case"zooming":var s=-i/this.currentViewGeometry.width;this.options.paperScroller.zoom(s,this.options.zoom)}this._clientX=t.clientX,this._clientY=t.clientY}},stopAction:function(){this._action=null},scrollTo:function(t){t=bt(t);var e,i,n=this.targetPaper.translate();if(n.ty=n.ty||0,void 0===t.offsetX){var s=this.targetPaper.$el.offset();e=t.pageX-s.left,i=t.pageY-s.top}else e=t.offsetX,i=t.offsetY;var r=(e-n.tx)/this.ratio,o=(i-n.ty)/this.ratio;this.options.paperScroller.center(r,o)},onRemove:function(){this.targetPaper.$el.off(".navigator"),this.targetPaper.remove(),this.options.paperScroller.$el.off(".navigator"),P(document.body).off(".navigator")}}),na=gi.extend({className:"paper-scroller",options:{paper:void 0,padding:function(){var t=this.getClientSize(),e=Math.max(this.options.minVisiblePaperSize,1)||1,i={};return i.left=i.right=Math.max(t.width-e,0),i.top=i.bottom=Math.max(t.height-e,0),i},minVisiblePaperSize:50,autoResizePaper:!1,baseWidth:void 0,baseHeight:void 0,contentOptions:void 0,cursor:"default"},_padding:{left:0,top:0},init:function(){_e(this,"startPanning","stopPanning","pan","onBackgroundEvent");var t=this.options.paper,e=t.scale();this._sx=e.sx,this._sy=e.sy,void 0===this.options.baseWidth&&(this.options.baseWidth=t.options.width),void 0===this.options.baseHeight&&(this.options.baseHeight=t.options.height),this.$background=P("<div/>").addClass("paper-scroller-background").css({width:t.options.width,height:t.options.height}).append(t.el).appendTo(this.el),this.listenTo(t,"scale",this.onScale).listenTo(t,"resize",this.onResize).listenTo(t,"beforeprint beforeexport",this.storeScrollPosition).listenTo(t,"afterprint afterexport",this.restoreScrollPosition),this.options.autoResizePaper&&(t.isAsync()?this.listenTo(t,"render:done",this.onPaperRenderDone):this.listenTo(t.model,"change add remove reset",this.adjustPaper)),this.delegateBackgroundEvents(),this.setCursor(this.options.cursor)},onPaperRenderDone:function(t){t.priority<2&&this.adjustPaper()},lock:function(){return this.$el.css("overflow","hidden"),this},unlock:function(){return this.$el.css("overflow","scroll"),this},setCursor:function(t){switch(t){case"grab":this.$el.css("cursor","");break;default:this.$el.css("cursor",t)}return this.$el.attr("data-cursor",t),this.options.cursor=t,this},delegateBackgroundEvents:function(n){n=n||xe(this.options.paper,"events");var t=this.paperEvents=Object.keys(n||{}).reduce(function(t,e){var i=n[e];-1===e.indexOf(" ")&&(t[e]=ue(i)?i:this.options.paper[i]);return t}.bind(this),{});return Object.keys(t).forEach(function(t){this.delegate(t,{guarded:!1},this.onBackgroundEvent)},this),this},onBackgroundEvent:function(t){if(this.$background.is(t.target)){var e=this.paperEvents[t.type];ue(e)&&e.apply(this.options.paper,arguments)}},onResize:function(){this._center&&this.center(this._center.x,this._center.y)},onScale:function(t,e,i,n){this.adjustScale(t,e),this._sx=t,this._sy=e,(i||n)&&this.center(i,n),"function"==typeof this.options.contentOptions&&this.adjustPaper()},storeScrollPosition:function(){this._scrollLeftBeforePrint=this.el.scrollLeft,this._scrollTopBeforePrint=this.el.scrollTop},restoreScrollPosition:function(){this.el.scrollLeft=this._scrollLeftBeforePrint,this.el.scrollTop=this._scrollTopBeforePrint,this._scrollLeftBeforePrint=null,this._scrollTopBeforePrint=null},beforePaperManipulation:function(){(yi.test("msie")||yi.test("msedge"))&&this.$el.css("visibility","hidden")},afterPaperManipulation:function(){(yi.test("msie")||yi.test("msedge"))&&this.$el.css("visibility","visible")},clientToLocalPoint:function(t,e){var i=this.options.paper.matrix();return t+=this.el.scrollLeft-this._padding.left-i.e,t/=i.a,e+=this.el.scrollTop-this._padding.top-i.f,e/=i.d,new j(t,e)},localToBackgroundPoint:function(t,e){var i=new j(t,e),n=this.options.paper.matrix(),s=this._padding;return Ot.transformPoint(i,n).offset(s.left,s.top)},adjustPaper:function(){var t=this.getClientSize();this._center=this.clientToLocalPoint(t.width/2,t.height/2);var e=this.options.contentOptions;"function"==typeof e&&(e=e.call(this,this));var i=ee({gridWidth:this.options.baseWidth,gridHeight:this.options.baseHeight,allowNewOrigin:"negative"},e);return this.options.paper.fitToContent(this.transformContentOptions(i)),this},adjustScale:function(t,e){var i=this.options.paper.options,n=t/this._sx,s=e/this._sy;this.options.paper.setOrigin(i.origin.x*n,i.origin.y*s),this.options.paper.setDimensions(i.width*n,i.height*s)},transformContentOptions:function(t){var e=this._sx,i=this._sy;return t.gridWidth&&(t.gridWidth*=e),t.gridHeight&&(t.gridHeight*=i),t.minWidth&&(t.minWidth*=e),t.minHeight&&(t.minHeight*=i),Te(t.padding)?t.padding={left:(t.padding.left||0)*e,right:(t.padding.right||0)*e,top:(t.padding.top||0)*i,bottom:(t.padding.bottom||0)*i}:Dt(t.padding)&&(t.padding=t.padding*e),t},center:function(t,e,i){var n,s=this.options.paper.matrix(),r=-s.e,o=-s.f,a=r+this.options.paper.options.width,l=o+this.options.paper.options.height,h=Dt(t),c=Dt(e);if(h||c){n=i;var u=this.getVisibleArea().center();h?t*=s.a:t=u.x,c?e*=s.d:e=u.y}else n=t,t=(r+a)/2,e=(o+l)/2;var d=this.getClientSize(),p=this.getPadding(),g=d.width/2,f=d.height/2,m=g-p.left-t+r,v=g-p.right+t-a,y=f-p.top-e+o,b=f-p.bottom+e-l;return this.addPadding(Math.max(m,0),Math.max(v,0),Math.max(y,0),Math.max(b,0)),this.scroll(t,e,n),this},centerContent:function(t){return this.positionContent("center",t)},centerElement:function(t,e){return this.checkElement(t,"centerElement"),this.positionElement(t,"center",e)},positionContent:function(t,e){var i=this.options.paper.getContentArea();return this.positionRect(i,t,e)},positionElement:function(t,e,i){this.checkElement(t,"positionElement");var n=t.getBBox();return this.positionRect(n,e,i)},positionRect:function(t,e,i){var n;switch(e){case"center":return n=t.center(),this.positionPoint(n,"50%","50%",i);case"top":return n=t.topMiddle(),this.positionPoint(n,"50%",0,i);case"top-right":return n=t.topRight(),this.positionPoint(n,"100%",0,i);case"right":return n=t.rightMiddle(),this.positionPoint(n,"100%","50%",i);case"bottom-right":return n=t.bottomRight(),this.positionPoint(n,"100%","100%",i);case"bottom":return n=t.bottomMiddle(),this.positionPoint(n,"50%","100%",i);case"bottom-left":return n=t.bottomLeft(),this.positionPoint(n,0,"100%",i);case"left":return n=t.leftMiddle(),this.positionPoint(n,0,"50%",i);case"top-left":return n=t.topLeft(),this.positionPoint(n,0,0,i);default:throw new Error("Provided positionName ('"+e+"') was not recognized.")}},positionPoint:function(t,e,i,n){var s=Ht((n=n||{}).padding),r=new Q(this.getClientSize()),o=r.clone().moveAndExpand({x:s.left,y:s.top,width:-s.right-s.left,height:-s.top-s.bottom}),a=Wt(e);e=parseFloat(e),a&&(e=e/100*Math.max(0,o.width)),e<0&&(e=o.width+e);var l=Wt(i);i=parseFloat(i),l&&(i=i/100*Math.max(0,o.height)),i<0&&(i=o.height+i);var h=o.origin().offset(e,i),c=r.center().difference(h),u=this.zoom(),d=c.scale(1/u,1/u),p=t.clone().offset(d);return this.center(p.x,p.y,n)},scroll:function(t,e,i){var n=this.options.paper.matrix(),s=this.getClientSize(),r={};if(Dt(t)){var o=s.width/2;r.scrollLeft=t-o+n.e+(this._padding.left||0)}if(Dt(e)){var a=s.height/2;r.scrollTop=e-a+n.f+(this._padding.top||0)}i&&i.animation?this.$el.animate(r,i.animation):this.$el.prop(r)},scrollToContent:function(t){var e=this.options.paper.getContentArea().center(),i=this._sx,n=this._sy;return e.x*=i,e.y*=n,this.scroll(e.x,e.y,t)},scrollToElement:function(t,e){this.checkElement(t,"scrollToElement");var i=t.getBBox().center(),n=this._sx,s=this._sy;return i.x*=n,i.y*=s,this.scroll(i.x,i.y,e)},addPadding:function(t,e,i,n){var s=this.getPadding(),r=this._padding={left:Math.round(s.left+(t||0)),top:Math.round(s.top+(i||0)),bottom:Math.round(s.bottom+(n||0)),right:Math.round(s.right+(e||0))};return this.$background.css({width:r.left+this.options.paper.options.width+r.right,height:r.top+this.options.paper.options.height+r.bottom}),this.options.paper.$el.css({left:r.left,top:r.top}),this},zoom:function(t,e){if(void 0===t)return this._sx;e=e||{};var i,n,s=this.getClientSize(),r=this.clientToLocalPoint(s.width/2,s.height/2),o=t,a=t;if(e.absolute||(o+=this._sx,a+=this._sy),e.grid&&(o=Math.round(o/e.grid)*e.grid,a=Math.round(a/e.grid)*e.grid),e.max&&(o=Math.min(e.max,o),a=Math.min(e.max,a)),e.min&&(o=Math.max(e.min,o),a=Math.max(e.min,a)),void 0===e.ox||void 0===e.oy)i=r.x,n=r.y;else{var l=o/this._sx,h=a/this._sy;i=e.ox-(e.ox-r.x)/l,n=e.oy-(e.oy-r.y)/h}return this.beforePaperManipulation(),this.options.paper.scale(o,a),this.center(i,n),this.afterPaperManipulation(),this},zoomToFit:function(t){t=t||{};var e=this.options.paper,i=ee({},e.options.origin);return t.fittingBBox=t.fittingBBox||ee({},new j(i),{width:this.$el.width(),height:this.$el.height()}),this.beforePaperManipulation(),e.scaleContentToFit(t),e.setOrigin(i.x,i.y),this.adjustPaper().centerContent(),this.afterPaperManipulation(),this},transitionClassName:"transition-in-progress",transitionEventName:"transitionend.paper-scroller-transition",transitionToPoint:function(t,e,i){Te(t)&&(i=e,e=t.y,t=t.x),i=i||{};var n,s,r=this._sx,o=Math.max(i.scale||r,1e-6),a=this.getClientSize(),l=new j(t,e),h=this.clientToLocalPoint(a.width/2,a.height/2);if(r===o){var c=h.difference(l).scale(r,r).round();n="translate("+c.x+"px,"+c.y+"px)"}else{var u=o/(r-o)*l.distance(h),d=h.clone().move(l,u),p=this.localToBackgroundPoint(d).round();n="scale("+o/r+")",s=p.x+"px "+p.y+"px"}return this.$el.addClass(this.transitionClassName),this.$background.off(this.transitionEventName).on(this.transitionEventName,function(t){var e=this.paperScroller;e.syncTransition(this.scale,{x:this.x,y:this.y});var i=this.onTransitionEnd;ue(i)&&i.call(e,t)}.bind({paperScroller:this,scale:o,x:t,y:e,onTransitionEnd:i.onTransitionEnd})).css({transition:"transform",transitionDuration:i.duration||"1s",transitionDelay:i.delay,transitionTimingFunction:i.timingFunction,transformOrigin:s,transform:n}),this},syncTransition:function(t,e){return this.beforePaperManipulation(),this.options.paper.scale(t),this.removeTransition().center(e.x,e.y),this.afterPaperManipulation(),this},removeTransition:function(){return this.$el.removeClass(this.transitionClassName),this.$background.off(this.transitionEventName).css({transition:"",transitionDuration:"",transitionDelay:"",transitionTimingFunction:"",transform:"",transformOrigin:""}),this},transitionToRect:function(t,e){t=new Q(t);var i=(e=e||{}).maxScale||1/0,n=e.minScale||Number.MIN_VALUE,s=e.scaleGrid||null,r=e.visibility||1,o=e.center?new j(e.center):t.center(),a=this.getClientSize(),l=a.width*r,h=a.height*r,c=new Q({x:o.x-l/2,y:o.y-h/2,width:l,height:h}).maxRectUniformScaleToFit(t,o);return c=Math.min(c,i),s&&(c=Math.floor(c/s)*s),c=Math.max(n,c),this.transitionToPoint(o,ie({scale:c},e))},startPanning:function(t){t=bt(t),this._clientX=t.clientX,this._clientY=t.clientY,this.$el.addClass("is-panning"),this.trigger("pan:start",t),P(document.body).on({"mousemove.panning touchmove.panning":this.pan,"mouseup.panning touchend.panning":this.stopPanning}),P(window).on("mouseup.panning",this.stopPanning)},pan:function(t){var e=(t=bt(t)).clientX-this._clientX,i=t.clientY-this._clientY;this.el.scrollTop-=i,this.el.scrollLeft-=e,this._clientX=t.clientX,this._clientY=t.clientY},stopPanning:function(t){P(document.body).off(".panning"),P(window).off(".panning"),this.$el.removeClass("is-panning"),this.trigger("pan:stop",t)},getClientSize:function(){return{width:this.el.clientWidth,height:this.el.clientHeight}},getPadding:function(){var t=this.options.padding;return ue(t)&&(t=t.call(this)),Ht(t)},getVisibleArea:function(){var t=this.options.paper.matrix(),e=this.getClientSize(),i={x:this.el.scrollLeft||0,y:this.el.scrollTop||0,width:e.width,height:e.height},n=Ot.transformRect(i,t.inverse());return n.x-=(this._padding.left||0)/this._sx,n.y-=(this._padding.top||0)/this._sy,new Q(n)},isElementVisible:function(t,e){this.checkElement(t,"isElementVisible");var i=(e=e||{}).strict?"containsRect":"intersect";return!!this.getVisibleArea()[i](t.getBBox())},isPointVisible:function(t){return this.getVisibleArea().containsPoint(t)},checkElement:function(t,e){if(!(t&&t instanceof di))throw new TypeError("ui.PaperScroller."+e+"() accepts instance of dia.Element only")},onRemove:function(){this.stopPanning()}});yi.addTest("msie",function(){var t=window.navigator.userAgent;return-1!==t.indexOf("MSIE")||-1!==t.indexOf("Trident")}),yi.addTest("msedge",function(){return/Edge\/\d+/.test(window.navigator.userAgent)});var sa=gi.extend({tagName:"g",svgElement:!0,className:"path-drawer",events:{"mousedown .start-point":"onStartPointPointerDown",mousedown:"onPointerDown","touchstart .start-point":"onStartPointPointerDown",touchstart:"onPointerDown",dblclick:"onDoubleClick",contextmenu:"onContextMenu"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{pathAttributes:{class:null,fill:"#ffffff",stroke:"#000000","stroke-width":1,"pointer-events":"none"},startPointMarkup:'<circle r="5"/>',snapRadius:0},init:function(){var t=this.svgTarget=Ot(this.options.target);this.$document=P(t.node.ownerDocument),this.action="awaiting-input",this.render()},onRemove:function(){var t=this.pathNode;t&&Ot(t).remove(),this.clear()},clear:function(){var t=this.pathNode;t&&t.pathSegList.numberOfItems<=1&&Ot(t).remove(),this.svgStart.remove(),this.svgControl.remove(),this.pathNode=null,this.undelegateDocumentEvents(),this.action="awaiting-input",this.trigger("clear")},render:function(){var t=this.options;return this.svgPathTemplate=Ot("path").attr(t.pathAttributes),this.svgStart=Ot(t.startPointMarkup).addClass("start-point"),this.svgControl=Ot("path").addClass("control-path"),this.vel.append(Ot("rect",{x:0,y:0,width:"100%",height:"100%",fill:"transparent",stroke:"none"})),this.svgTarget.append(this.el),this},createPath:function(t,e){var i=this.svgPathTemplate.clone(),n=this.pathNode=i.node,s=this.svgStart.translate(t,e,{absolute:!0});this.trigger("path:create",n),this.addMoveSegment(t,e),this.vel.before(i),this.vel.append(s)},closePath:function(){var t=this.pathNode,e=t.pathSegList.getItem(0),i=t.pathSegList.getItem(t.pathSegList.numberOfItems-1);i.pathSegType==SVGPathSeg.PATHSEG_LINETO_ABS?t.pathSegList.replaceItem(t.createSVGPathSegClosePath(),t.pathSegList.numberOfItems-1):(i.x=e.x,i.y=e.y,t.pathSegList.appendItem(t.createSVGPathSegClosePath())),this.finishPath("path:close")},finishPath:function(t){var e=this.pathNode;e&&0<this.numberOfVisibleSegments()?(this.trigger("path:finish",e),this.trigger(t,e)):this.trigger("path:abort",e),this.clear()},numberOfVisibleSegments:function(){var t=this.pathNode,e=t.pathSegList.numberOfItems;return--e,t.pathSegList.getItem(t.pathSegList.numberOfItems-1).pathSegType==SVGPathSeg.PATHSEG_CLOSEPATH&&--e,e},addMoveSegment:function(t,e){var i=this.pathNode,n=i.createSVGPathSegMovetoAbs(t,e);i.pathSegList.appendItem(n),this.trigger("path:segment:add",i),this.trigger("path:move-segment:add",i)},addLineSegment:function(t,e){var i=this.pathNode,n=i.createSVGPathSegLinetoAbs(t,e);i.pathSegList.appendItem(n),this.trigger("path:segment:add",i),this.trigger("path:line-segment:add",i)},addCurveSegment:function(t,e,i,n,s,r){var o=this.pathNode,a=o.createSVGPathSegCurvetoCubicAbs(t,e,i,n,s||t,r||e);o.pathSegList.appendItem(a),this.trigger("path:segment:add",o),this.trigger("path:curve-segment:add",o)},adjustLastSegment:function(t,e,i,n,s,r){var o=this.pathNode,a=this.options.snapRadius;if(a){var l=this.snapLastSegmentCoordinates(t,e,a);t=l.x,e=l.y}var h=o.pathSegList.getItem(o.pathSegList.numberOfItems-1);null!==t&&(h.x=t),null!==e&&(h.y=e),null!==i&&(h.x1=i),null!==n&&(h.y1=n),null!==s&&(h.x2=s),null!==r&&(h.y2=r),this.trigger("path:edit",o),this.trigger("path:last-segment:adjust",o)},snapLastSegmentCoordinates:function(t,e,i){for(var n=this.pathNode,s=!1,r=!1,o=t,a=e,l=n.pathSegList.numberOfItems-2;0<=l&&(!s||!r);l--){var h=n.pathSegList.getItem(l),c=h.x,u=h.y;!s&&Math.abs(c-t)<i&&(o=c,s=!0),!r&&Math.abs(u-e)<i&&(a=u,r=!0)}return new j(o,a)},removeLastSegment:function(){var t=this.pathNode;t.pathSegList.removeItem(t.pathSegList.numberOfItems-1),this.trigger("path:edit",t),this.trigger("path:last-segment:remove",t)},findControlPoint:function(t,e){var i=this.pathNode,n=i.pathSegList.getItem(i.pathSegList.numberOfItems-1);return H(t,e).reflection(n)},replaceLastSegmentWithCurve:function(){var t=this.pathNode,e=t.pathSegList.getItem(t.pathSegList.numberOfItems-1),i=t.pathSegList.getItem(t.pathSegList.numberOfItems-2),n=t.createSVGPathSegCurvetoCubicAbs(e.x,e.y,i.x,i.y,e.x,e.y);t.pathSegList.replaceItem(n,t.pathSegList.numberOfItems-1),this.trigger("path:edit",t),this.trigger("path:last-segment:replace-with-curve",t)},adjustControlPath:function(t,e,i,n){var s=this.pathNode,r=this.svgControl.node;r.pathSegList.initialize(r.createSVGPathSegMovetoAbs(t,e)),r.pathSegList.appendItem(r.createSVGPathSegLinetoAbs(i,n)),this.vel.append(r),this.trigger("path:interact",s),this.trigger("path:control:adjust",s)},removeControlPath:function(){var t=this.pathNode,e=this.svgControl.node;e.pathSegList.clear(),this.vel.append(e),this.trigger("path:interact",t),this.trigger("path:control:remove",t)},onPointerDown:function(t){var e=bt(t);if(e.stopPropagation(),!(1<e.which)&&!(1<e.originalEvent.detail)&&this.el.parentNode){var i=this.vel.toLocalPoint(e.clientX,e.clientY);switch(this.action){case"awaiting-input":this.createPath(i.x,i.y),this.action="path-created",this.delegateDocumentEvents();break;case"adjusting-line-end":this.action="awaiting-line-end";break;case"adjusting-curve-end":this.action="awaiting-curve-control-2"}this._timeStamp=e.timeStamp}},MOVEMENT_DETECTION_THRESHOLD:150,onPointerMove:function(t){var e=bt(t);if(e.stopPropagation(),"awaiting-input"!=this.action){var i,n,s=this.vel.toLocalPoint(e.clientX,e.clientY),r=this._timeStamp;if(r)if(r&&e.timeStamp-r<this.MOVEMENT_DETECTION_THRESHOLD)switch(this.action){case"path-created":i=this.svgStart.translate(),this.adjustControlPath(i.tx,i.ty,s.x,s.y);break;case"awaiting-line-end":case"adjusting-curve-control-1":this.adjustLastSegment(s.x,s.y);break;case"awaiting-curve-control-2":this.adjustLastSegment(s.x,s.y,null,null,s.x,s.y)}else switch(this.action){case"path-created":this.action="adjusting-curve-control-1";break;case"awaiting-line-end":this.replaceLastSegmentWithCurve(),this.action="adjusting-curve-control-2";break;case"awaiting-curve-control-2":this.action="adjusting-curve-control-2";break;case"adjusting-curve-control-1":i=this.svgStart.translate(),this.adjustControlPath(i.tx,i.ty,s.x,s.y);break;case"adjusting-curve-control-2":n=this.findControlPoint(s.x,s.y),this.adjustLastSegment(null,null,null,null,n.x,n.y),this.adjustControlPath(n.x,n.y,s.x,s.y)}else switch(this.action){case"adjusting-line-end":this.adjustLastSegment(s.x,s.y);break;case"adjusting-curve-end":this.adjustLastSegment(s.x,s.y,null,null,s.x,s.y)}}},onPointerUp:function(t){this._timeStamp=null;var e=bt(t);if(e.stopPropagation(),!(1<e.which||1<e.originalEvent.detail)){var i=this.vel.toLocalPoint(e.clientX,e.clientY);switch(this.action){case"path-created":case"awaiting-line-end":this.addLineSegment(i.x,i.y),this.action="adjusting-line-end";break;case"awaiting-curve-control-2":this.removeControlPath(),this.addLineSegment(i.x,i.y),this.action="adjusting-line-end";break;case"adjusting-curve-control-1":case"adjusting-curve-control-2":this.addCurveSegment(i.x,i.y,i.x,i.y),this.action="adjusting-curve-end"}}},onStartPointPointerDown:function(t){var e=bt(t);e.stopPropagation(),1<e.which||1<e.originalEvent.detail||this.closePath()},onDoubleClick:function(t){var e=bt(t);e.preventDefault(),e.stopPropagation(),1<e.which||this.pathNode&&0<this.numberOfVisibleSegments()&&(this.removeLastSegment(),this.finishPath("path:stop"))},onContextMenu:function(t){var e=bt(t);e.preventDefault(),e.stopPropagation(),1<e.originalEvent.detail||this.pathNode&&0<this.numberOfVisibleSegments()&&(this.removeLastSegment(),this.finishPath("path:stop"))}}),ra=gi.extend({tagName:"g",svgElement:!0,className:"path-editor",events:{"mousedown .anchor-point":"onAnchorPointPointerDown","mousedown .control-point":"onControlPointPointerDown","mousedown .segment-path":"onSegmentPathPointerDown","touchstart .anchor-point":"onAnchorPointPointerDown","touchstart .control-point":"onControlPointPointerDown","touchstart .segment-path":"onSegmentPathPointerDown","dblclick .anchor-point":"onAnchorPointDoubleClick","dblclick .control-point":"onControlPointDoubleClick","dblclick .segment-path":"onSegmentPathDoubleClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{anchorPointMarkup:'<circle r="2.5"/>',controlPointMarkup:'<circle r="2.5"/>'},init:function(){var t=this.pathNode=Ot(this.options.pathElement).normalizePath().node;this.segList=t.pathSegList,this.svgRoot=Ot(t.ownerSVGElement),this.$document=P(t.ownerDocument),this.render()},onRemove:function(){this.undelegateDocumentEvents(),this.clear()},clear:function(){this.vel.empty(),this.directionPaths=[],this.segmentPaths=[],this.controlPoints=[],this.anchorPoints=[],this._subPathIndices=[0],this.trigger("clear",this.pathNode)},_transformPoint:function(t,e,i){return Ot.transformPoint(j(t,e),i)},_getPathCTM:function(){return this.pathNode.getCTM()},render:function(){this.clear();var t,e,i,n=this.vel,s=this._getPathCTM(),r=Ot(this.options.anchorPointMarkup).addClass("anchor-point"),o=Ot(this.options.controlPointMarkup).addClass("control-point"),a=Ot('<path class="direction-path"/>'),l=Ot('<path class="segment-path"/>'),h=this.segList,c=this.anchorPoints,u=this.controlPoints,d=this.directionPaths,p=this.segmentPaths,g=this._subPathIndices;for(i=e=t=0;t<h.numberOfItems;t++){var f=h.getItem(t),m=this._transformPoint(f.x,f.y,s),v=m.x,y=m.y;if(f.pathSegType!=SVGPathSeg.PATHSEG_CLOSEPATH&&(c[t]=r.clone().attr({index:t,cx:v,cy:y})),f.pathSegType!=SVGPathSeg.PATHSEG_MOVETO_ABS){var b=l.clone().attr("index",t).node;switch(b.pathSegList.initialize(b.createSVGPathSegMovetoAbs(e,i)),f.pathSegType){case SVGPathSeg.PATHSEG_CLOSEPATH:var w=h.getItem(g[0]),C=this._transformPoint(w.x,w.y,s);v=C.x,y=C.y,b.pathSegList.appendItem(b.createSVGPathSegLinetoAbs(v,y)),g.unshift(t+1);break;case SVGPathSeg.PATHSEG_LINETO_ABS:b.pathSegList.appendItem(b.createSVGPathSegLinetoAbs(v,y));break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:var I=this._transformPoint(f.x1,f.y1,s),x=o.clone().attr({index:t,"attribute-index":1,cx:I.x,cy:I.y}),A=this._transformPoint(f.x2,f.y2,s),S=o.clone().attr({index:t,"attribute-index":2,cx:A.x,cy:A.y});u[t]=[x,S],b.pathSegList.appendItem(b.createSVGPathSegCurvetoCubicAbs(v,y,I.x,I.y,A.x,A.y)),d[t]=[a.clone().attr("d",["M",e,i,"L",I.x,I.y].join(" ")),a.clone().attr("d",["M",v,y,"L",A.x,A.y].join(" "))]}p[t]=b}e=v,i=y}var _=[];p.forEach(function(t){t&&_.push(t)}),d.forEach(function(t){t&&Array.prototype.push.apply(_,t)}),c.forEach(function(t){t&&_.push(t)}),u.forEach(function(t){t&&Array.prototype.push.apply(_,t)}),n.append(_),this.svgRoot.append(n)},startMoving:function(t){var e=bt(t),i=this.$point=P(e.target);this.prevClientX=e.clientX,this.prevClientY=e.clientY;var n=parseInt(this.$point.attr("index"),10);if(i.hasClass("anchor-point"))this.trigger("path:interact"),this.trigger("path:anchor-point:select",n);else if(i.hasClass("control-point")){var s=this.$point.attr("attribute-index");this.trigger("path:interact"),this.trigger("path:control-point:select",n,s)}else this.trigger("path:interact"),this.trigger("path:segment:select",n);e.stopPropagation(),e.preventDefault(),this.pathEditedEventType=null},move:function(t){var e=this.$point;if(e){var i=bt(t),n=i.clientX-this.prevClientX,s=i.clientY-this.prevClientY,r=parseInt(e.attr("index"),10);if(e.hasClass("anchor-point"))this.adjustAnchorPoint(r,n,s);else if(e.hasClass("control-point")){var o=e.attr("attribute-index");this.adjustControlPoint(r,o,n,s)}else this.adjustAnchorPoint(r-1,n,s),this.adjustAnchorPoint(r,n,s);this.prevClientX=i.clientX,this.prevClientY=i.clientY}},adjustControlPoint:function(t,e,i,n){var s=this._getPathCTM(),r=this.segList,o=r.getItem(t),a=this.controlPoints,l=s.inverse();l.e=0,l.f=0;var h=this._transformPoint(i,n,l),c="x"+e,u="y"+e;o[c]+=h.x,o[u]+=h.y;var d=this._transformPoint(o[c],o[u],s);if(a[t][e-1].attr({cx:d.x,cy:d.y}).hasClass("locked")){var p=this.getBoundIndex(t,e),g=1==e?2:1,f=r.getItem(p),m="x"+g,v="y"+g,y=H(1==e?f.x:o.x,1==e?f.y:o.y),b=H(o[c],o[u]),w=y.distance(j(f[m],f[v])),C=y.move(b,w);f[m]=C.x,f[v]=C.y;var I=this._transformPoint(f[m],f[v],s);a[p][g-1].attr({cx:I.x,cy:I.y}),this.updateDirectionPaths(p),this.updateSegmentPath(p)}this.updateDirectionPaths(t),this.updateSegmentPath(t),this.pathEditedEventType="path:control-point:adjust"},findSubpathIndex:function(t){for(var e=this._subPathIndices,i=0,n=e.length;i<n;i++)if(e[i]<t)return e[i]},findReversedSubpathIndex:function(t){for(var e=this._subPathIndices,i=e.length-1;0<=i;i--)if(e[i]>t)return e[i]},adjustAnchorPoint:function(t,e,i){var n=this._getPathCTM(),s=this.segList,r=s.getItem(t);r.pathSegType==SVGPathSeg.PATHSEG_CLOSEPATH&&(t=this.findSubpathIndex(t),r=s.getItem(t));var o=this.anchorPoints,a=this.controlPoints,l=o.length-1;if((0===t||t===l)&&a[1]&&a[l]){var h=a[1][0],c=a[l][1];h&&h.hasClass("locked")&&h.removeClass("locked"),c&&c.hasClass("locked")&&c.removeClass("locked")}var u=n.inverse();u.e=0,u.f=0;var d=this._transformPoint(e,i,u);r.x+=d.x,r.y+=d.y;var p=this._transformPoint(r.x,r.y,n);if(o[t].attr({cx:p.x,cy:p.y}),r.pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS){r.x2+=d.x,r.y2+=d.y;var g=this._transformPoint(r.x2,r.y2,n);a[t][1].attr({cx:g.x,cy:g.y})}var f=t+1<s.numberOfItems?s.getItem(t+1):0;if(f){if(f.pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS){f.x1+=d.x,f.y1+=d.y;var m=this._transformPoint(f.x1,f.y1,n);a[t+1][0].attr({cx:m.x,cy:m.y}),this.updateDirectionPaths(t+1)}this.updateSegmentPath(t+1)}this.updateDirectionPaths(t),this.updateSegmentPath(t),this.pathEditedEventType="path:anchor-point:adjust"},updateDirectionPaths:function(t){var n=this._getPathCTM(),e=this.segList,s=e.getItem(t),r=this._transformPoint(s.x,s.y,n),o=0<t?e.getItem(t-1):null,a=o?this._transformPoint(o.x,o.y,n):null,i=this.directionPaths[t];Array.isArray(i)&&i.forEach(function(t,e){e++;var i=this._transformPoint(s["x"+e],s["y"+e],n);t.attr("d",["M",1<e||!o?r.x:a.x,1<e||!o?r.y:a.y,i.x,i.y].join(" "))},this)},updateSegmentPath:function(t){var e=this.segList;if(this._subPathIndices.includes(t)){var i=this.findReversedSubpathIndex(t)||e.numberOfItems;if(i--,e.getItem(i).pathSegType!=SVGPathSeg.PATHSEG_CLOSEPATH)return;t=i}var n=this.segmentPaths[t];if(n){var s=this._getPathCTM(),r=e.getItem(t-1),o=this._transformPoint(r.x,r.y,s),a=n.createSVGPathSegMovetoAbs(o.x,o.y);n.pathSegList.initialize(a);var l=e.getItem(t),h=this._transformPoint(l.x,l.y,s);switch(l.pathSegType){case SVGPathSeg.PATHSEG_CLOSEPATH:var c=e.getItem(this.findSubpathIndex(t)),u=this._transformPoint(c.x,c.y,s);a=n.createSVGPathSegLinetoAbs(u.x,u.y);break;case SVGPathSeg.PATHSEG_LINETO_ABS:a=n.createSVGPathSegLinetoAbs(h.x,h.y);break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:var d=this._transformPoint(l.x1,l.y1,s),p=this._transformPoint(l.x2,l.y2,s);a=n.createSVGPathSegCurvetoCubicAbs(h.x,h.y,d.x,d.y,p.x,p.y)}n.pathSegList.appendItem(a)}},stopMoving:function(){if(this.$point=null,this.pathEditedEventType){var t=this.pathNode;this.trigger("path:edit",t),this.trigger(this.pathEditedEventType,t)}this.pathEditedEventType=null},createAnchorPoint:function(t){var e=bt(t),i=Ot(e.target).attr("index"),n=this.pathNode,s=this.segList,r=Ot(n).toLocalPoint(e.pageX,e.pageY),o=s.getItem(i);switch(o.pathSegType){case SVGPathSeg.PATHSEG_CLOSEPATH:case SVGPathSeg.PATHSEG_LINETO_ABS:s.insertItemBefore(n.createSVGPathSegLinetoAbs(r.x,r.y),i);break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:var a=s.getItem(i-1),l=H(a.x,a.y),h=H(o.x1,o.y1),c=H(o.x2,o.y2),u=H(o.x,o.y),d=x.getInversionSolver(l,h,c,u)(r);if(d<0)return;var p=x.getCurveDivider(l,h,c,u)(d);s.insertItemBefore(n.createSVGPathSegCurvetoCubicAbs(p[0].p3.x,p[0].p3.y,p[0].p1.x,p[0].p1.y,p[0].p2.x,p[0].p2.y),i),o.x1=p[1].p1.x,o.y1=p[1].p1.y,o.x2=p[1].p2.x,o.y2=p[1].p2.y}this.render(),this.trigger("path:edit",n),this.trigger("path:anchor-point:create",n)},removeAnchorPoint:function(t){var e,i,n=bt(t),s=parseInt(P(n.target).attr("index"),10),r=this.pathNode,o=this.segList,a=o.getItem(s);switch(a.pathSegType){case SVGPathSeg.PATHSEG_MOVETO_ABS:e=o.getItem(s+1),i=r.createSVGPathSegMovetoAbs(e.x,e.y),o.replaceItem(i,s+1),o.removeItem(s);break;case SVGPathSeg.PATHSEG_LINETO_ABS:o.removeItem(s);break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:s+1<=o.numberOfItems-1&&(e=o.getItem(s+1)).pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS&&(e.x1=a.x1,e.y1=a.y1),o.removeItem(s)}this.render(),this.trigger("path:edit",r),this.trigger("path:anchor-point:remove",r);var l=o.numberOfItems;o.getItem(o.numberOfItems-1).pathSegType==SVGPathSeg.PATHSEG_CLOSEPATH&&--l,l<2&&this.trigger("path:invalid",r)},lockControlPoint:function(t){var e=bt(t),i=P(e.target),n=this.pathNode,s=parseInt(i.attr("index")),r=i.attr("attribute-index"),o=this.getBoundIndex(s,r),a=1==r?2:1,l=this.controlPoints[o];if(l){var h=i.hasClass("locked");i.toggleClass("locked"),l[a-1].toggleClass("locked"),this.trigger("path:interact"),h?this.trigger("path:control-point:unlock",s,r):this.trigger("path:control-point:lock",s,r),this.adjustControlPoint(s,r,0,0),this.trigger("path:edit",n),this.trigger(this.pathEditedEventType,n),this.pathEditedEventType=null}},getBoundIndex:function(t,e){var i,n,s,r,o,a=this.segList,l=this.anchorPoints,h=l.length-1;return 1==e?0===(i=t-1)&&(n=a.numberOfItems-1,s=a.getItem(n).pathSegType==SVGPathSeg.PATHSEG_CLOSEPATH,r=l[0].attr("cx")===l[h].attr("cx"),o=l[0].attr("cy")===l[h].attr("cy"),s&&r&&o&&(i=h)):(i=t+1)===1+h&&(n=a.numberOfItems-1,s=a.getItem(n).pathSegType==SVGPathSeg.PATHSEG_CLOSEPATH,r=l[0].attr("cx")===l[h].attr("cx"),o=l[0].attr("cy")===l[h].attr("cy"),s&&r&&o&&(i=1)),i},getControlPointLockedStates:function(){for(var t=this.controlPoints,e=[],i=0;i<t.length;i++)if(t[i]){e[i]=[];for(var n=0;n<=1;n++)if(t[i][n]){var s=n+1;t[i][n].hasClass("locked")?e[i][s]=!0:e[i][s]=!1}}return e},setControlPointLockedStates:function(t){for(var e=this.controlPoints,i=0;i<e.length;i++)if(t[i]&&e[i])for(var n=1;n<=2;n++)t[i][n]&&e[i][n-1]&&(!0===t[i][n]?e[i][n-1].addClass("locked"):e[i][n-1].removeClass("locked"))},convertSegmentPath:function(t){var e,i,n=bt(t),s=Ot(n.target).attr("index"),r=this.pathNode,o=this.segList,a=o.getItem(s);switch(a.pathSegType){case SVGPathSeg.PATHSEG_CLOSEPATH:e=o.getItem(s-1),i=o.getItem(0),o.insertItemBefore(r.createSVGPathSegCurvetoCubicAbs(i.x,i.y,e.x,e.y,i.x,i.y),s);break;case SVGPathSeg.PATHSEG_LINETO_ABS:e=o.getItem(s-1),o.replaceItem(r.createSVGPathSegCurvetoCubicAbs(a.x,a.y,e.x,e.y,a.x,a.y),s);break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:o.replaceItem(r.createSVGPathSegLinetoAbs(a.x,a.y),s)}this.render(),this.trigger("path:edit",r),this.trigger("path:segment:convert",r)},addClosePathSegment:function(t){var e=bt(t),i=parseInt(P(e.target).attr("index"),10),n=this.segList;if((0===i||i===n.numberOfItems-1)&&n.getItem(n.numberOfItems-1).pathSegType!=SVGPathSeg.PATHSEG_CLOSEPATH){var s=this.pathNode;n.appendItem(s.createSVGPathSegClosePath()),this.render(),this.trigger("path:edit",s),this.trigger("path:closepath-segment:add",s)}},removeClosePathSegment:function(t){var e=bt(t),i=Ot(e.target).attr("index"),n=this.segList;if(n.getItem(i).pathSegType==SVGPathSeg.PATHSEG_CLOSEPATH){var s=this.pathNode;n.removeItem(i),this.render(),this.trigger("path:edit",s),this.trigger("path:closepath-segment:remove",s)}},onAnchorPointPointerDown:function(t){var e=bt(t);e.stopPropagation(),1===e.which&&(1<e.originalEvent.detail||(this.startMoving(e),this.delegateDocumentEvents()))},onControlPointPointerDown:function(t){var e=bt(t);e.stopPropagation(),1===e.which&&(1<e.originalEvent.detail||(this.startMoving(e),this.delegateDocumentEvents()))},onSegmentPathPointerDown:function(t){var e=bt(t);e.stopPropagation(),1===e.which&&(1<e.originalEvent.detail||(this.startMoving(e),this.delegateDocumentEvents()))},onPointerMove:function(t){var e=bt(t);e.stopPropagation(),this.move(e)},onPointerUp:function(t){this.undelegateDocumentEvents(),bt(t).stopPropagation(),this.stopMoving()},onAnchorPointDoubleClick:function(t){var e=bt(t);e.stopPropagation(),e.preventDefault(),1===e.which&&this.removeAnchorPoint(e)},onControlPointDoubleClick:function(t){var e=bt(t);e.stopPropagation(),e.preventDefault(),1===e.which&&this.lockControlPoint(e)},onSegmentPathDoubleClick:function(t){var e=bt(t);e.stopPropagation(),e.preventDefault(),1===e.which&&this.createAnchorPoint(e)}}),oa=Bo.extend({className:"popup",eventNamespace:"popup",events:{},renderContent:function(){var t=ue(this.options.content)?this.options.content(this.el):this.options.content;t&&this.$el.html(t)}}),aa=gi.extend({options:{paper:void 0,graph:void 0,boxContent:function(t){return $t("<%= length %> elements selected.")({length:this.model.length})},handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElements"}},{name:"rotate",position:"sw",events:{pointerdown:"startRotating",pointermove:"doRotate",pointerup:"stopBatch"}},{name:"resize",position:"se",events:{pointerdown:"startResizing",pointermove:"doResize",pointerup:"stopBatch"}}],useModelGeometry:!1,strictSelection:!1,rotateAngleGrid:15,allowTranslate:!0},className:"selection",events:{"mousedown .selection-box":"onSelectionBoxPointerDown","touchstart .selection-box":"onSelectionBoxPointerDown","mousedown .handle":"onHandlePointerDown","touchstart .handle":"onHandlePointerDown"},documentEvents:{mousemove:"adjustSelection",touchmove:"adjustSelection",mouseup:"pointerup",touchend:"pointerup",touchcancel:"pointerup"},_action:null,init:function(){this.options.model&&(this.options.collection=this.options.model);var t=this.collection=this.options.collection||this.collection||new o.Collection;if(t.comparator||(t.comparator=this.constructor.depthComparator,t.sort()),this.model=t,!this.options.paper)throw new Error("Selection: paper required");ie(this.options,{graph:this.options.paper.model}),_e(this,"startSelecting","stopSelecting","adjustSelection","pointerup"),this.options.paper.$el.append(this.$el),this._boxCount=0,this.$selectionWrapper=this.createSelectionWrapper(),this.handles=[],pe(this.options.handles).forEach(this.addHandle,this),this.startListening()},startListening:function(){var t=this.options.paper;this.listenTo(t,"scale translate",this.onPaperTransformation);var e=this.options.graph;this.listenTo(e,"reset",this.cancelSelection),this.listenTo(e,"change remove",this.onGraphChange);var i=this.collection;this.listenTo(i,"remove",this.onRemoveElement),this.listenTo(i,"reset",this.onResetElements),this.listenTo(i,"add",this.onAddElement)},onPaperTransformation:function(){this.updateSelectionBoxes({async:!1})},onGraphChange:function(t,e){e.selection!==this.cid&&this.updateSelectionBoxes()},cancelSelection:function(){this.model.reset([],{ui:!0})},addHandle:function(i){this.handles.push(i);var t=P("<div/>",{class:"handle "+(i.position||"")+" "+(i.name||""),"data-action":i.name});return i.icon&&t.css("background-image","url("+i.icon+")"),t.html(i.content||""),Mt(t,i.attrs),this.$selectionWrapper.append(t),Pe(i.events,function(t,e){Ne(t)?this.on("action:"+i.name+":"+e,this[t],this):this.on("action:"+i.name+":"+e,t)}.bind(this)),this},stopSelecting:function(t){var e,i=this.options.paper,n=this.eventData(t).action;switch(n){case"selecting":var s=this.$el.offset(),r=this.$el.width(),o=this.$el.height();e=i.pageToLocalPoint(s.left,s.top);var a=i.scale();r/=a.sx,o/=a.sy;var l=F(e.x,e.y,r,o),h=this.getElementsInSelectedArea(l),c=this.options.filter;Array.isArray(c)?h=h.filter(function(t){return!c.includes(t.model)&&!c.includes(t.model.get("type"))}):ue(c)&&(h=h.filter(function(t){return!c(t.model)}));var u=h.map(function(t){return t.model});this.model.reset(u,{ui:!0});break;case"translating":this.options.graph.stopBatch("selection-translate"),e=i.snapToGrid(t.clientX,t.clientY),this.notify("selection-box:pointerup",t,e.x,e.y);break;default:n||this.cancelSelection()}this._action=null},removeHandle:function(i){var t=pe(this.handles).findIndex(function(t){return t.name===i}),e=this.handles[t];return e&&(Pe(e.events,function(t,e){this.off("action:"+i+":"+e)}.bind(this)),this.$(".handle."+i).remove(),this.handles.splice(t,1)),this},startSelecting:function(t){t=bt(t),this.cancelSelection();var e,i,n=this.options.paper.el;if(null!=t.offsetX&&null!=t.offsetY&&P.contains(n,t.target))e=t.offsetX,i=t.offsetY;else{var s=P(n).offset(),r=n.scrollLeft,o=n.scrollTop;e=t.clientX-s.left+window.pageXOffset+r,i=t.clientY-s.top+window.pageYOffset+o}this.$el.css({width:1,height:1,left:e,top:i}),this.showLasso(),this.eventData(t,{action:"selecting",clientX:t.clientX,clientY:t.clientY,offsetX:e,offsetY:i}),this.delegateDocumentEvents(null,t.data),this._action="selecting"},changeHandle:function(e,t){var i=pe(this.handles).find(function(t){return t&&t.name===e});return i&&(this.removeHandle(e),this.addHandle(Tt({name:e},i,t))),this},onSelectionBoxPointerDown:function(t){t.stopPropagation(),t=bt(t),this.options.allowTranslate&&this.startTranslatingSelection(t),this.eventData(t,{activeElementView:this.getCellView(t.target)});var e=this.options.paper.snapToGrid(t.clientX,t.clientY);this.notify("selection-box:pointerdown",t,e.x,e.y),this.delegateDocumentEvents(null,t.data)},startTranslatingSelection:function(t){this.options.graph.startBatch("selection-translate");var e=this.options.paper.snapToGrid(t.clientX,t.clientY);this.eventData(t,{action:"translating",snappedClientX:e.x,snappedClientY:e.y}),this._action="translating"},adjustSelection:function(t){var e,i;t=bt(t);var n=this.eventData(t),s=n.action;switch(s){case"selecting":e=t.clientX-n.clientX,i=t.clientY-n.clientY;var r=parseInt(this.$el.css("left"),10),o=parseInt(this.$el.css("top"),10);this.$el.css({left:e<0?n.offsetX+e:r,top:i<0?n.offsetY+i:o,width:Math.abs(e),height:Math.abs(i)});break;case"translating":var a=this.options.paper.snapToGrid(t.clientX,t.clientY),l=a.x,h=a.y;e=l-n.snappedClientX,i=h-n.snappedClientY;var c=this.options.paper.getRestrictedArea();if(c){var u=this.model.toArray(),d=this.options.graph.getCellsBBox(u),p=c.x-d.x,g=c.y-d.y,f=c.x+c.width-(d.x+d.width),m=c.y+c.height-(d.y+d.height);e<p&&(e=p),i<g&&(i=g),f<e&&(e=f),m<i&&(i=m)}if(e||i){if(this.translateSelectedElements(e,i),this.boxesUpdated)1<this.model.length&&this.updateSelectionBoxes();else{var v=this.options.paper.scale();this.$el.children(".selection-box").add(this.$selectionWrapper).css({left:"+="+e*v.sx,top:"+="+i*v.sy})}n.snappedClientX=l,n.snappedClientY=h}this.notify("selection-box:pointermove",t,l,h);break;default:s&&this.pointermove(t)}this.boxesUpdated=!1},translateSelectedElements:function(i,n){var s={};this.model.each(function(t){if(!s[t.id]){var e={selection:this.cid};t.translate(i,n,e),t.getEmbeddedCells({deep:!0}).forEach(function(t){s[t.id]=!0}),this.options.graph.getConnectedLinks(t).forEach(function(t){s[t.id]||(t.translate(i,n,e),s[t.id]=!0)})}}.bind(this))},notify:function(t,e){var i=this.eventData(e),n=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t,i.activeElementView].concat(n))},getElementsInSelectedArea:function(t){var e=this.options.paper,i={strict:this.options.strictSelection};return this.options.useModelGeometry?e.model.findModelsInArea(t,i).map(e.findViewByModel,e).filter(function(t){return!!t}):e.findViewsInArea(t,i)},pointerup:function(t){var e=this.eventData(t).action;e&&(this.triggerAction(e,"pointerup",t),this.stopSelecting(t),this.undelegateDocumentEvents(),this._action=null)},destroySelectionBox:function(t){this.$('[data-model="'+t.get("id")+'"]').remove(),0===this.$el.children(".selection-box").length&&this.hide(),this._boxCount=Math.max(0,this._boxCount-1)},hide:function(){this.$el.removeClass("lasso selected")},showSelected:function(){this.$el.addClass("selected")},showLasso:function(){this.$el.addClass("lasso")},destroyAllSelectionBoxes:function(){this.hide(),this.$el.children(".selection-box").remove(),this._boxCount=0},createSelectionBox:function(t){var e=t.findView(this.options.paper);if(e){var i=e.getBBox({useModelGeometry:this.options.useModelGeometry});P("<div/>").addClass("selection-box").attr("data-model",t.get("id")).css({left:i.x,top:i.y,width:i.width,height:i.height}).appendTo(this.el),this.showSelected(),this._boxCount++}},createSelectionWrapper:function(){var t=P("<div/>",{class:"selection-wrapper"}),e=P("<div/>",{class:"box"});return t.append(e),t.attr("data-selection-length",this.model.length),this.$el.prepend(t),t},updateSelectionWrapper:function(){var n={x:1/0,y:1/0},s={x:0,y:0};if(this.model.each(function(t){var e=this.options.paper.findViewByModel(t);if(e){var i=e.getBBox({useModelGeometry:this.options.useModelGeometry});n.x=Math.min(n.x,i.x),n.y=Math.min(n.y,i.y),s.x=Math.max(s.x,i.x+i.width),s.y=Math.max(s.y,i.y+i.height)}}.bind(this)),this.$selectionWrapper.css({left:n.x,top:n.y,width:s.x-n.x,height:s.y-n.y}).attr("data-selection-length",this.model.length),ue(this.options.boxContent)){var t=this.$(".box"),e=this.options.boxContent.call(this,t[0]);e&&t.html(e)}},updateSelectionBoxes:function(t){0!==this.collection.length&&(this.boxesUpdated=!0,this.options.paper.requestViewUpdate(this,1,this.UPDATE_PRIORITY,t))},confirmUpdate:function(){this._updateSelectionBoxes()},_updateSelectionBoxes:function(){if(this._boxCount){this.hide();for(var t=this.$el.children(".selection-box"),e=0,i=t.length;e<i;e++){var n=t[e],s=P(n).remove().attr("data-model"),r=this.model.get(s);r&&this.createSelectionBox(r)}this.updateSelectionWrapper()}},onHandlePointerDown:function(t){var e=P(t.currentTarget).attr("data-action");e&&(t.preventDefault(),t.stopPropagation(),t=bt(t),this.triggerAction(e,"pointerdown",t),this.eventData(t,{action:e,clientX:t.clientX,clientY:t.clientY,startClientX:t.clientX,startClientY:t.clientY}),this.delegateDocumentEvents(null,t.data),this._action=e)},getCellView:function(t){var e=this.model.get(t.getAttribute("data-model"));return e&&e.findView(this.options.paper)},pointermove:function(t){var e=this.eventData(t),i=e.action;if(i){var n=this.options.paper.snapToGrid(t.clientX,t.clientY),s=this.options.paper.snapToGrid(e.clientX,e.clientY),r=n.x-s.x,o=n.y-s.y;this.triggerAction(i,"pointermove",t,r,o,t.clientX-e.startClientX,t.clientY-e.startClientY),e.clientX=t.clientX,e.clientY=t.clientY}},triggerAction:function(t,e,i){var n=Array.prototype.slice.call(arguments,2);n.unshift("action:"+t+":"+e),this.trigger.apply(this,n)},onRemoveElement:function(t){this.destroySelectionBox(t),this.updateSelectionWrapper()},onResetElements:function(t){this.destroyAllSelectionBoxes(),t.each(this.createSelectionBox.bind(this)),this.updateSelectionWrapper()},onAddElement:function(t){this.createSelectionBox(t),this.updateSelectionWrapper()},removeElements:function(t){var e=this.collection.toArray();this.cancelSelection(),this.options.graph.removeCells(e,{selection:this.cid})},startRotating:function(t){this.options.graph.trigger("batch:start");var e=this.options.graph.getCellsBBox(this.model.models).center(),i=this.options.paper.snapToGrid(t.clientX,t.clientY),n=this.model.toArray().reduce(function(t,e){return t[e.id]=q(e.get("angle")||0),t},{});this.eventData(t,{center:e,clientAngle:H(i).theta(e),initialAngles:n})},startResizing:function(t){var e=this.options.paper,i=this.options.graph,n=e.options.gridSize,s=this.model.toArray(),r=i.getCellsBBox(s),o=se(s,"getBBox"),a=o.reduce(function(t,e){return e.width<t?e.width:t},1/0),l=o.reduce(function(t,e){return e.height<t?e.height:t},1/0);this.eventData(t,{cells:i.getSubgraph(s),bbox:r,minWidth:n*r.width/a,minHeight:n*r.height/l}),i.trigger("batch:start")},doResize:function(t,e,i){var n=this.eventData(t),s=n.bbox,r=s.width,o=s.height,a=Math.max(r+e,n.minWidth),l=Math.max(o+i,n.minHeight);(.001<Math.abs(r-a)||.001<Math.abs(o-l))&&(this.options.graph.resizeCells(a,l,n.cells,{selection:this.cid}),s.width=a,s.height=l,this.updateSelectionBoxes())},doRotate:function(t){var i=this.eventData(t),n=this.options.rotateAngleGrid,e=this.options.paper.snapToGrid(t.clientX,t.clientY),s=i.clientAngle-H(e).theta(i.center);.001<Math.abs(s)&&(this.collection.each(function(t){var e=k(i.initialAngles[t.id]+s,n);t.rotate(e,!0,i.center,{selection:this.cid})}.bind(this)),this.updateSelectionBoxes())},stopBatch:function(){this.options.graph.trigger("batch:stop")},getAction:function(){return this._action}},{depthComparator:function(t){return t.getAncestors().length}}),la=aa,ha=gi.extend({options:{paper:void 0,distance:10},className:"snaplines",documentEvents:{mouseup:"hide",touchend:"hide"},init:function(){_e(this,"hide"),this.render(),this.startListening(),this.prepareFilters()},render:function(){var t=this.$horizontal=P("<div>").addClass("snapline horizontal"),e=this.$vertical=P("<div>").addClass("snapline vertical");this.$el.hide().append([t,e]).appendTo(this.options.paper.el)},startListening:function(){this.stopListening(),this.listenTo(this.options.paper,"element:pointerdown",this.captureCursorOffset),this.listenTo(this.options.paper,"element:pointermove",this.snapWhileMoving),this.listenTo(this.options.paper.model,"batch:stop",this.onBatchStop),this.delegateDocumentEvents()},prepareFilters:function(){this.filterTypes={},this.filterCells={},this.filterFunction=void 0,Array.isArray(this.options.filter)?this.options.filter.forEach(function(t){Ne(t)?this.filterTypes[t]=!0:this.filterCells[t.id]=!0},this):ue(this.options.filter)&&(this.filterFunction=this.options.filter)},onBatchStop:function(t){"resize"===(t=t||{}).batchName&&this.snapWhileResizing(t.cell,t)},captureCursorOffset:function(t,e,i,n){var s=t.getDelegatedView();if(s&&this.canElementMove(s)){var r=s.model.get("position");this._cursorOffset={x:i-r.x,y:n-r.y}}},snapWhileResizing:function(r,t){if(t.ui&&!t.snapped&&t.direction&&t.trueDirection){var e=this.options.paper.findViewByModel(r);if(e&&e.model.isElement()){var i=r.getBBox(),n=i.bbox(r.get("angle")),s=n.origin(),o=n.corner(),a=q(r.get("angle")),l=this.options.distance,h=null,c=null,u={vertical:0,horizontal:0},d=t.direction,p=t.trueDirection,g=t.relativeDirection;if(-1!==p.indexOf("right")?u.vertical=o.x:u.vertical=s.x,-1!==p.indexOf("bottom")?u.horizontal=o.y:u.horizontal=s.y,this.options.paper.model.getElements().find(function(t){if(t.id===r.id||t.isEmbeddedIn(r)||this.filterTypes[t.get("type")]||this.filterCells[t.id]||this.filterFunction&&this.filterFunction(t))return!1;var e=t.getBBox().bbox(t.get("angle")),i=e.origin(),n=e.corner(),s={vertical:[i.x,n.x],horizontal:[i.y,n.y]};return Pe(s,function(t,e){t=(t=t.map(function(t){return{position:t,distance:Math.abs(t-u[e])}})).filter(function(t){return t.distance<l}),t=me(t,function(t){return t.distance}),s[e]=t}),null===h&&0<s.vertical.length&&(h=s.vertical[0].position),null===c&&0<s.horizontal.length&&(c=s.horizontal[0].position),Dt(h)&&Dt(c)},this),this.hide(),Dt(h)||Dt(c)){var f=0;Dt(h)&&(f=-1!==p.indexOf("right")?h-n.corner().x:n.origin().x-h);var m=0;Dt(c)&&(m=-1!==p.indexOf("bottom")?c-n.corner().y:n.origin().y-c);var v=0,y=0;if(!(a%90))y=90===a||270===a?(v=m,f):(v=f,m);else{var b;b=0<=a&&a<90?1:90<=a&&a<180?4:180<=a&&a<270?3:2,c&&h&&(f<m?(m=0,c=null):(f=0,h=null));var w=T(a%90);f&&(v=3===b?f/Math.cos(w):f/Math.sin(w)),m&&(y=3===b?m/Math.cos(w):m/Math.sin(w));var C=1===b||3===b;switch(g){case"top":case"bottom":y=m?m/(C?Math.cos(w):Math.sin(w)):f/(C?Math.sin(w):Math.cos(w));break;case"left":case"right":v=f?f/(C?Math.cos(w):Math.sin(w)):m/(C?Math.sin(w):Math.cos(w))}}switch(g){case"top":case"bottom":v=0;break;case"left":case"right":y=0}var I=this.options.paper.options.gridSize,x=Math.max(i.width+v,I),A=Math.max(i.height+y,I);t.minWidth&&t.minWidth>I&&(x=Math.max(x,t.minWidth)),t.minHeight&&t.minHeight>I&&(A=Math.max(A,t.minHeight)),t.maxWidth&&(x=Math.min(x,t.maxWidth)),t.maxHeight&&(A=Math.min(A,t.maxHeight)),t.preserveAspectRatio&&(y<v?A=x*(i.height/i.width):x=A*(i.width/i.height)),x===i.width&&A===i.height||r.resize(x,A,{snaplines:this.cid,restrictedArea:this.options.paper.getRestrictedArea(e),direction:d,relativeDirection:g,trueDirection:p,snapped:!0});var S=r.getBBox().bbox(a);h&&1<Math.abs(S.x-h)&&1<Math.abs(S.width+S.x-h)&&(h=null),c&&1<Math.abs(S.y-c)&&1<Math.abs(S.height+S.y-c)&&(c=null),this.show({vertical:h,horizontal:c})}}}},canElementMove:function(t){return t&&t.model.isElement()&&t.can("elementMove")},snapWhileMoving:function(t,e,i,n){var s=t.eventData(e).delegatedView||t;if(this.canElementMove(s)){var r=s.model,o=r.get("position"),a=r.get("size"),l=F(ee({x:i-this._cursorOffset.x,y:n-this._cursorOffset.y},a)),h=l.center(),c=l.bbox(r.get("angle")),u=c.origin(),d=c.corner(),p=this.options.distance,g=null,f=null,m=0,v=0;if(this.options.paper.model.getElements().find(function(t){if(t===r||t.isEmbeddedIn(r)||this.filterTypes[t.get("type")]||this.filterCells[t.id]||this.filterFunction&&this.filterFunction(t))return!1;var e=t.getBBox().bbox(t.get("angle")),i=e.center(),n=e.origin(),s=e.corner();return null===g&&(Math.abs(i.x-h.x)<p?(g=i.x,m=.5):Math.abs(n.x-u.x)<p?g=n.x:Math.abs(n.x-d.x)<p?(g=n.x,m=1):Math.abs(s.x-d.x)<p?(g=s.x,m=1):Math.abs(s.x-u.x)<p&&(g=s.x)),null===f&&(Math.abs(i.y-h.y)<p?(f=i.y,v=.5):Math.abs(n.y-u.y)<p?f=n.y:Math.abs(n.y-d.y)<p?(f=n.y,v=1):Math.abs(s.y-d.y)<p?(f=s.y,v=1):Math.abs(s.y-u.y)<p&&(f=s.y)),Dt(g)&&Dt(f)},this),this.hide(),Dt(g)||Dt(f)){Dt(g)&&(c.x=g-m*c.width),Dt(f)&&(c.y=f-v*c.height);var y=c.center(),b=y.x-l.width/2,w=y.y-l.height/2;r.translate(b-o.x,w-o.y,{restrictedArea:this.options.paper.getRestrictedArea(s),snapped:!0}),this.show({vertical:g,horizontal:f})}}},show:function(t){t=t||{};var e=this.options.paper.matrix();t.horizontal?this.$horizontal.css("top",t.horizontal*e.d+e.f).show():this.$horizontal.hide(),t.vertical?this.$vertical.css("left",t.vertical*e.a+e.e).show():this.$vertical.hide(),this.$el.show()},hide:function(){this.$el.hide()}}),ca={options:function(){return{columnWidth:this.options.width/2-10,columns:2,rowHeight:80,resizeToFit:!0,dy:10,dx:10}},layoutGroup:function(t,e){var i=this.options.layout;if(e=e||{},!oo)throw new Error("joint.ui.Stencil: joint.layout.GridLayout is not available.");oo.layout(t,ee({},i,e.layout))}},ua=gi.extend({className:"stencil",events:{"click .btn-expand":"openGroups","click .btn-collapse":"closeGroups","click .groups-toggle > .group-label":"openGroups","click .group > .group-label":"onGroupLabelClick","touchstart .group > .group-label":"onGroupLabelClick","input .search":"onSearch","focusin .search":"pointerFocusIn","focusout .search":"pointerFocusOut"},documentEvents:{mousemove:"onDrag",touchmove:"onDrag",mouseup:"onDragEnd",touchend:"onDragEnd",touchcancel:"onDragEnd"},options:{width:200,height:800,label:"Stencil",groups:null,groupsToggleButtons:!1,dropAnimation:!1,search:null,layout:null,snaplines:null,scaleClones:!1,dragStartClone:function(t){return t.clone()},dragEndClone:function(t){return t.clone()},layoutGroup:null,paperOptions:null,paperDragOptions:null},DEFAULT_GROUP:"__default__",init:function(){this.setPaper(this.options.paperScroller||this.options.paper),this.graphs={},this.papers={},this.$groups={},this.onSearch=ge(this.onSearch,200),this.delegateEvents(),this.initializeLayout()},initializeLayout:function(){var t=this.options.layout;t&&(ue(t)?this.layoutGroup=t:(this.layoutGroup=ca.layoutGroup.bind(this),this.options.layout=Te(t)?t:{},ie(this.options.layout,ca.options.call(this))))},setPaper:function(t){var e=this.options;if(t instanceof Qs)e.paperScroller=null,e.paper=t,e.graph=t.model;else{if(!("function"==typeof na&&t instanceof na))throw new Error("Stencil: paper required");e.paperScroller=t,e.paper=t.options.paper,e.graph=t.options.paper.model}},renderContent:function(){return P("<div/>").addClass("content")},renderPaperDrag:function(){return P("<div/>").addClass("stencil-paper-drag")},renderSearch:function(){return P("<div/>").addClass("search-wrap").append(P("<input/>",{type:"search",placeholder:"search"}).addClass("search"))},renderToggleAll:function(){return[P("<div/>").addClass("groups-toggle").append(P("<label/>").addClass("group-label").html(this.options.label)).append(P("<button/>",{text:"+"}).addClass("btn btn-expand")).append(P("<button/>",{text:"-"}).addClass("btn btn-collapse"))]},renderElementsContainer:function(){return P("<div/>").addClass("elements")},renderGroup:function(t){t=t||{};var e=P("<div/>").addClass("group").attr("data-name",t.name).toggleClass("closed",!!t.closed),i=P("<h3/>").addClass("group-label").html(t.label||t.name),n=this.renderElementsContainer();return e.append(i,n)},render:function(){var r=this.options;this.$content=this.renderContent(),this.$paperDrag=this.renderPaperDrag(),this.$el.empty().append(this.$paperDrag,this.$content),r.search&&this.$el.addClass("searchable").prepend(this.renderSearch()),r.groupsToggleButtons&&this.$el.addClass("collapsible").prepend(this.renderToggleAll());var o,t=Object.keys(r.groups||{}),e=0<t.length;if(r.paperOptions&&!ue(r.paperOptions)&&r.paperOptions.model)throw new Error("ui.Stencil: the `paperOptions` has to be a function if there is the property `model` defined.");if(e){me(t,function(t){return this[t].index}.bind(r.groups)).forEach(function(t){var e=this.options.groups[t],i=this.$groups[t]=this.renderGroup({name:t,label:e.label,closed:e.closed}).appendTo(this.$content);if(e.paperOptions&&e.paperOptions.model)throw new Error("ui.Stencil: the `model` property is not allowed in the `paperOptions` for the groups.");o=xe(r,"paperOptions")||{};var n=ee({},o,e.paperOptions,{el:i.find(".elements"),model:o.model||new Xs,width:e.width||r.width,height:e.height||r.height,interactive:!1,preventDefaultBlankAction:!1}),s=new Qs(n);this.graphs[t]=n.model,this.papers[t]=s},this)}else{var i=this.renderElementsContainer().appendTo(this.$content);o=xe(r,"paperOptions")||{};var n=new Qs(ee({},o,{el:i,model:o.model||new Xs,width:r.width,height:r.height,interactive:!1,preventDefaultBlankAction:!1}));this.graphs[this.DEFAULT_GROUP]=n.model,this.papers[this.DEFAULT_GROUP]=n}o=xe(r,"paperOptions")||{};var s=xe(r,"paperDragOptions")||{},a=this._graphDrag=s.model||o.model||new Xs;return this._paperDrag=new Qs(ee({},r.paperDragOptions,{el:this.$paperDrag,width:1,height:1,model:a})),this.startListening(),this},startListening:function(){this.stopListening(),Pe(this.papers,function(t){this.listenTo(t,"cell:pointerdown",this.onDragStart)}.bind(this))},load:function(i,t){Array.isArray(i)?this.loadGroup(i,t):Te(i)&&Pe(this.options.groups,function(t,e){i[e]&&this.loadGroup(i[e],e)}.bind(this))},loadGroup:function(t,e){var i=this.getGraph(e);i.resetCells(t);var n=this.options.height;if(e&&(n=this.getGroup(e).height),this.isLayoutEnabled()&&this.layoutGroup(i,this.getGroup(e)),!n){var s=this.getPaper(e);s.fitToContent({minWidth:s.options.width,gridHeight:1,padding:this.options.paperPadding||10})}},isLayoutEnabled:function(){return!!this.options.layout},getGraph:function(t){var e=this.graphs[t||this.DEFAULT_GROUP];if(!e)throw new Error("Stencil: group "+t+" does not exist.");return e},getPaper:function(t){return this.papers[t||this.DEFAULT_GROUP]},preparePaperForDragging:function(t,e,i){var n=this._paperDrag,s=this._graphDrag;n.$el.addClass("dragging").appendTo(document.body);var r=this.options.dragStartClone(t.model).position(0,0),o=5,a=this.options.snaplines;if(a&&(o+=a.options.distance),a||this.options.scaleClones){var l=this.options.paper.scale();n.scale(l.sx,l.sy),o*=Math.max(l.sx,l.sy)}else n.scale(1,1);this.clearClone(),this.options.dropAnimation&&this._paperDrag.$el.stop(!0,!0),s.resetCells([r.position(0,0)]);var h=r.findView(n);h.stopListening(),n.fitToContent({padding:o,allowNewOrigin:"any"});var c=h.getBBox(),u=this._cloneGeometryBBox=h.getBBox({useModelGeometry:!0});this._cloneViewDeltaOrigin=u.origin().difference(c.origin()),this._cloneBBox=r.getBBox(),this._clone=r,this._cloneView=h,this._paperDragPadding=o,this._paperDragInitialOffset=this.setPaperDragOffset(e,i)},setPaperDragOffset:function(t,e){var i=document.body.scrollTop||document.documentElement.scrollTop,n=this._cloneViewDeltaOrigin,s=this._cloneGeometryBBox,r=this._paperDragPadding||5,o={left:t-n.x-s.width/2-r,top:e-n.y-s.height/2-r+i};return this._paperDrag.$el.offset(o),o},setCloneLocalPosition:function(t,e){var i=this.options.paper.clientToLocalPoint({x:t,y:e}),n=this._cloneBBox;return i.x-=n.width/2,i.y-=n.height/2,this._clone.set("position",i),i},onDragStart:function(t,e){e.preventDefault(),this.options.graph.startBatch("stencil-drag"),this.$el.addClass("dragging"),this.preparePaperForDragging(t,e.clientX,e.clientY);var i=this.setCloneLocalPosition(e.clientX,e.clientY),n=this._cloneView,s=this.options.snaplines;s&&(s.captureCursorOffset(this._cloneView,e,i.x,i.y),n.listenTo(this._clone,"change:position",this.onCloneSnapped.bind(this))),this.delegateDocumentEvents(null,e.data)},onCloneSnapped:function(t,e,i){if(i.snapped){var n=this._cloneBBox;t.position(n.x+i.tx,n.y+i.ty,{silent:!0}),this._cloneView.translate(),t.set("position",e,{silent:!0}),this._cloneSnapOffset={x:i.tx,y:i.ty}}else this._cloneSnapOffset=null},onDrag:function(t){var e=this._cloneView;if(e){t.preventDefault();var i=(t=bt(t)).clientX,n=t.clientY;this.setPaperDragOffset(i,n);var s=this.setCloneLocalPosition(i,n),r=this.options.paper.options.embeddingMode,o=this.options.snaplines,a=(r||o)&&this.insideValidArea({x:i,y:n});if(r){e.eventData(t,{paper:this.options.paper});var l=e.eventData(t);a?e.processEmbedding(l):e.clearEmbedding(l)}o&&(a?o.snapWhileMoving(e,t,s.x,s.y):o.hide())}},onDragEnd:function(t){var e=this._clone;if(e){t=bt(t);var i=this._cloneView,n=this._cloneBBox,s=this._cloneSnapOffset,r=n.x,o=n.y;s&&(r+=s.x,o+=s.y),e.position(r,o,{silent:!0});var a=this.options.dragEndClone(e);this.drop(a,{x:t.clientX,y:t.clientY})?this.onDropEnd(e):this.onDropInvalid(t,a),this.options.paper.options.embeddingMode&&i&&(i.eventData(t,{model:a,paper:this.options.paper}),i.finalizeEmbedding(i.eventData(t))),this.options.graph.stopBatch("stencil-drag")}},onDropEnd:function(t){this._clone===t&&(this.clearClone(),this.$el.append(this._paperDrag.$el),this.$el.removeClass("dragging"),this._paperDrag.$el.removeClass("dragging"))},clearClone:function(){this._clone&&(this._clone.remove(),this._clone=null,this._cloneView=null,this._cloneSnapOffset=null,this._paperDragInitialOffset=null,this._paperDragPadding=null)},onDropInvalid:function(t,e){var i=this._clone;if(i){t=bt(t),e=e||this.options.dragEndClone(i),this.trigger("drop:invalid",t,e);var n=this.options.dropAnimation;if(n){var s=Te(n)?n.duration:150,r=Te(n)?n.easing:"swing";this._cloneView=null,this._paperDrag.$el.animate(this._paperDragInitialOffset,s,r,this.onDropEnd.bind(this,i))}else this.onDropEnd(i)}},insideValidArea:function(t){var e,i=this.options.paper,n=this.options.paperScroller,s=this.getDropArea(this.$el);if(n)if(n.options.autoResizePaper)e=this.getDropArea(n.$el);else{var r=this.getDropArea(n.$el);e=this.getDropArea(i.$el).intersect(r)}else e=this.getDropArea(i.$el);return!(!e||!e.containsPoint(t)||s.containsPoint(t))},getDropArea:function(t){var e=t.offset(),i=document.body.scrollTop||document.documentElement.scrollTop,n=document.body.scrollLeft||document.documentElement.scrollLeft;return F({x:e.left+parseInt(t.css("border-left-width"),10)-n,y:e.top+parseInt(t.css("border-top-width"),10)-i,width:t.innerWidth(),height:t.innerHeight()})},drop:function(t,e){var i=this.options.paper,n=this.options.graph;if(this.insideValidArea(e)){var s=i.clientToLocalPoint(e),r=t.getBBox();s.x+=r.x-r.width/2,s.y+=r.y-r.height/2;var o=this._cloneSnapOffset?1:i.options.gridSize;return t.set("position",{x:k(s.x,o),y:k(s.y,o)}),t.unset("z"),n.addCell(t,{stencil:this.cid}),!0}return!1},filter:function(l,h){var t=Object.keys(this.papers).reduce(function(t,e){var n=this.papers[e],s=e===this.DEFAULT_GROUP?null:e,i=n.model.getCells().filter(function(t){var e=!1;e=ue(h)?h.call(this,t,l,s,this):this.isCellMatched(t,l,h,l.toLowerCase()!==l);var i=n.findViewByModel(t);return i&&i.vel.toggleClass("unmatched",!e),e}.bind(this)),r=!he(i),o=this.options,a=((xe(o,"paperOptions")||{}).model||new Xs).resetCells(i);return this.trigger("filter",a,e,l),this.isLayoutEnabled()&&this.layoutGroup(a,this.getGroup(e)),this.$groups[e]&&this.$groups[e].toggleClass("unmatched",!r),n.fitToContent({gridWidth:1,gridHeight:1,padding:o.paperPadding||10}),t||r}.bind(this),!1);this.$el.toggleClass("not-found",!t)},isCellMatched:function(i,n,s,r){return!n||Object.keys(s).some(function(t){var e=s[t];return("*"==t||i.get("type")==t)&&e.some(function(t){var e=gt(i.attributes,t,"/");return null!=e&&(e=e.toString(),r||(e=e.toLowerCase()),0<=e.indexOf(n))})})},getGroup:function(t){return this.options.groups&&this.options.groups[t]||{}},onSearch:function(t){this.filter(t.target.value,this.options.search)},pointerFocusIn:function(){this.$el.addClass("is-focused")},pointerFocusOut:function(){this.$el.removeClass("is-focused")},onGroupLabelClick:function(t){if("touchstart"===t.type)this._groupLabelClicked=!0;else if(this._groupLabelClicked&&"click"===t.type)return void(this._groupLabelClicked=!1);var e=P(t.target).closest(".group");this.toggleGroup(e.data("name"))},toggleGroup:function(t){this.isGroupOpen(t)?this.closeGroup(t):this.openGroup(t)},closeGroup:function(t){var e=this.$groups[t];e&&this.isGroupOpen(t)&&(this.trigger("group:close",t),e.addClass("closed"))},openGroup:function(t){var e=this.$groups[t];e&&!this.isGroupOpen(t)&&(this.trigger("group:open",t),e.removeClass("closed"))},isGroupOpen:function(t){var e=this.$groups[t];return!!e&&!e.hasClass("closed")},closeGroups:function(){Object.keys(this.$groups).forEach(function(t){this.closeGroup(t)},this)},openGroups:function(){Object.keys(this.$groups).forEach(function(t){this.openGroup(t)},this)},onRemove:function(){se(this.papers,"remove"),this.papers={},this._paperDrag&&(this._paperDrag.remove(),this._paperDrag=null),this.undelegateDocumentEvents()}}),da=gi.extend({options:{text:void 0,newlineCharacterBBoxWidth:10,placeholder:void 0,focus:!0,debug:!1,useNativeSelection:!0,annotateUrls:!1,urlAnnotation:{attrs:{class:"url-annotation",fill:"lightblue","text-decoration":"underline"}},textareaAttributes:{autocorrect:"off",autocomplete:"off",autocapitalize:"off",spellcheck:"false",tabindex:"0"}},className:"text-editor",events:{"keyup textarea":"onKeyup","input textarea":"onInput","copy textarea":"onCopy","cut textarea":"onCut","paste textarea":"onPaste","mousedown .char-selection-box":"onMousedown","dblclick .char-selection-box":"onDoubleClick","click .char-selection-box":"onTripleClick"},selection:{start:null,end:null},selecting:!1,init:function(){_e(this,"onMousedown","onMousemove","onMouseup","onDoubleClick","onTripleClick","onKeydown","onAfterPaste","onAfterKeydown"),this.setTextElement(this.options.text),P(document.body).on("mousemove",this.onMousemove),P(document.body).on("mouseup",this.onMouseup),P(document.body).on("keydown",this.onKeydown),this.options.cellView?this.$viewport=P(this.options.cellView.paper.cells):this.$viewport=P(this.options.text),this.options.annotations&&this.setAnnotations(this.options.annotations)},setTextElement:function(t){this.$elText&&this.unbindTextElement(),this.options.text=t,this.$elText=P(t),this.$elText.on("mousedown",this.onMousedown),this.$elText.on("dblclick",this.onDoubleClick),this.$elText.on("click",this.onTripleClick)},render:function(t){this.$caret=P("<div>",{class:"caret"}),this.$selection=P("<div>"),this.$selectionBox=P("<div>",{class:"char-selection-box"}),this.$el.append(this.$caret,this.$selection),this.$textareaContainer=P("<div>",{class:"textarea-container"}),this.$textarea=P("<textarea>",this.options.textareaAttributes),this.textarea=this.$textarea[0],this._textContent=this.textarea.value=this.getTextContent(),this._textareaValueBeforeInput=this.textarea.value,this.$textareaContainer.append(this.textarea),this.options.focus&&this.$el.append(this.$textareaContainer),P(t||document.body).append(this.$el);var e=Ot(this.options.text).bbox();return this.$textareaContainer.css({left:e.x,top:e.y}),this.focus(),Ot(this.options.text).attr("cursor","text"),this.selectAll(),this},annotateURLBeforeCaret:function(t){var e=this.getURLBoundary(Math.max(t-1,0));return!!e&&(this.annotateURL(this.getAnnotations()||[],e[0],e[1]),!0)},hasSelection:function(){return Dt(this.selection.start)&&Dt(this.selection.end)&&this.selection.start!==this.selection.end},textContentHasChanged:function(){return this._textContent!==this.textarea.value},restoreTextAreaSelectionDirection:function(){this._selectionDirection&&(this.textarea.selectionDirection=this._selectionDirection)},storeSelectionDirection:function(){this._selectionDirection=this.textarea.selectionDirection},onKeydown:function(t){this.options.debug&&console.log("onKeydown(): ",t.keyCode),this.hasSelection()&&(this.deselect(),this.restoreTextAreaSelectionDirection()),setTimeout(this.onAfterKeydown,0),this._copied=!1,this._selectionStartBeforeInput=this.textarea.selectionStart,this._selectionEndBeforeInput=this.textarea.selectionEnd},onAfterKeydown:function(){this.$textarea.is(":focus")&&(this.storeSelectionDirection(),this.textarea.selectionStart===this.textarea.selectionEnd?this.setCaret(this.textarea.selectionStart):this.select(this.textarea.selectionStart,this.textarea.selectionEnd))},onKeyup:function(t){this.textContentHasChanged()&&this.onInput(t)},onCopy:function(t){this._copied||this.copyToClipboard()},onCut:function(t){this._copied||this.copyToClipboard()},copyToClipboard:function(){document.queryCommandSupported&&document.queryCommandSupported("copy")&&(this._copied=!0,document.execCommand("copy"))},onInput:function(t){if(this.textContentHasChanged()){var e=this.textarea.value.length-this._textareaValueBeforeInput.length,i={start:this._selectionStartBeforeInput,end:this._selectionEndBeforeInput},n={start:this.textarea.selectionStart,end:this.textarea.selectionEnd};this.options.debug&&console.log("onInput()",t,"selectionBeforeInput",i,"selectionAfterInput",n,"diffLength",e);var s=this.inferTextOperationType(i,n,e),r=!1,o=this.getAnnotations();if(this.options.annotateUrls&&"insert"===s){var a=this.textarea.value.substr(i.start,e);this.options.debug&&console.log("onInput()","inserted text",a),/\s/.test(a)&&(r=this.annotateURLBeforeCaret(i.start))&&(o=this.shiftAnnotations(o,n.end,e))}if(o&&(r||(o=this.annotate(o,i,n,e)),this.options.debug&&console.log("onInput()","modified annotations",o),this._currentAnnotationAttributes&&"insert"===s)){var l={start:i.start,end:n.end,attrs:this._currentAnnotationAttributes};o.push(l),this._currentAnnotationAttributes=void 0,this.options.debug&&console.log("onInput()","insert annotation",l,"final annotations",o)}this._annotations=o,this.trigger("text:change",this.textarea.value,this._textareaValueBeforeInput,o,i,n),this._selectionBeforeInput=n,this._textareaValueBeforeInput=this.textarea.value,this._textContent=this.textarea.value}},onPaste:function(t){this.options.debug&&console.log("onPaste()"),this._textareaValueBeforeInput=this.textarea.value,setTimeout(this.onAfterPaste,0)},onAfterPaste:function(){this.setCaret(this.textarea.selectionStart)},onMousedown:function(t){if(3!==t.originalEvent.detail){this.options.debug&&console.log("onMousedown()");var e=this.getCharNumFromEvent(t);this.startSelecting(),this.select(e),t.preventDefault(),t.stopPropagation()}},onMousemove:function(t){if(this.selectionInProgress()){this.options.debug&&console.log("onMousemove()");var e=this.getCharNumFromEvent(t);this.storeSelectionDirection(),this.select(null,e),t.preventDefault(),t.stopPropagation()}},onMouseup:function(t){this.selectionInProgress()&&(this.options.debug&&console.log("onMouseup()"),this.stopSelecting(),this.trigger("select:changed",this.selection.start,this.selection.end))},onDoubleClick:function(t){this.options.debug&&console.log("onDoubleClick()");var e=this.getCharNumFromEvent(t),i=this.getWordBoundary(e);this.select(i[0],i[1]),t.preventDefault(),t.stopPropagation()},onTripleClick:function(t){3===t.originalEvent.detail&&(this.options.debug&&console.log("onTripleClick()"),this.hideCaret(),this.selectAll(),t.preventDefault(),t.stopPropagation())},findAnnotationsUnderCursor:function(t,e){return Ot.findAnnotationsAtIndex(t,e)},findAnnotationsInSelection:function(t,e,i){return Ot.findAnnotationsBetweenIndexes(t,e,i)},inferTextOperationType:function(t,e,i){return t.start===t.end&&e.start===e.end&&0<i?"insert":t.start===t.end&&e.start===e.end&&i<=0?"delete-single":t.start!==t.end&&e.start===e.end&&e.start===t.start?"delete":t.start!==t.end&&e.start!==t.start?"delete-insert":void 0},annotate:function(t,s,r,o){var a=[],l=this.inferTextOperationType(s,r,o);return pe(t).forEach(function(t){var e,i;switch(l){case"insert":t.start<s.start&&s.start<=t.end?t.end+=o:t.start>=s.start&&(t.start+=o,t.end+=o);break;case"delete-single":t.start<s.start&&s.start<=t.end&&s.start!==r.start?t.end+=o:t.start<=s.start&&s.start<t.end&&s.start===r.start?t.end+=o:t.start>=s.start&&(t.start+=o,t.end+=o);break;case"delete":t.start<=s.start&&s.start<=t.end?s.end<=t.end?t.end+=o:t.end+=r.start-t.end:t.start>=s.start&&t.start<s.end?(e=t.end-t.start,i=s.end-t.start,t.start=s.start,t.end=t.start+e-i):t.start>=s.end&&(t.start+=o,t.end+=o);break;case"delete-insert":if(t.start<=s.start&&s.start<=t.end)s.start<t.end&&(s.end>t.end?t.end=r.end:t.end=r.end+(t.end-s.end));else if(t.start>=s.start&&t.start<=s.end){var n=r.start-s.start;i=s.end-t.start,e=t.end-t.start,t.start=s.start+n,t.end=t.start+e-i}else t.start>=s.start&&t.end<=s.end?t.start=t.end=0:t.start>=s.end&&(t.start+=o,t.end+=o);break;default:this.options.debug&&console.log("ui.TextEditor: Unknown text operation.")}t.end>t.start&&a.push(t)},this),a},shiftAnnotations:function(t,e,i){return Ot.shiftAnnotations(t,e,i)},setCurrentAnnotation:function(t){this._currentAnnotationAttributes=t},setAnnotations:function(t){this._annotations=t},getAnnotations:function(){return this._annotations},getCombinedAnnotationAttrsAtIndex:function(e,t){var i={};return pe(t).forEach(function(t){void 0===t.start&&void 0===t.end?Ot.mergeAttrs(i,t.attrs):e>=t.start&&e<t.end&&Ot.mergeAttrs(i,t.attrs)}),i},getSelectionAttrs:function(t,e){var i=t.start,n=t.end;if(i===n&&0===i)return this.getCombinedAnnotationAttrsAtIndex(i,e);if(i===n)return this.getCombinedAnnotationAttrsAtIndex(i-1,e);for(var s,r=i;r<n;r++){var o=this.getCombinedAnnotationAttrsAtIndex(r,e);if(s&&!ce(s,o)){s=jt(Ot.mergeAttrs({},s)),o=jt(Ot.mergeAttrs({},o));var a={};Pe(o,function(t,e){s[e]===o[e]&&ft(a,e,t)}),s=a}else s=o}return s},getTextContent:function(){var t=this.options.text,e=Ot(t).find(".v-line");return 0===e.length?t.textContent:e.reduce(function(t,e,i,n){var s=e.node.textContent;return e.hasClass("v-empty-line")&&(s=""),i===n.length-1?t+s:t+s+"\n"},"")},startSelecting:function(){this.selecting=!0},stopSelecting:function(){this.selecting=!1},selectionInProgress:function(){return!0===this.selecting},selectAll:function(){return this.select(0,this.getNumberOfChars())},select:function(t,e){return this.options.debug&&console.log("select(",t,e,")"),void 0===e&&(e=t),Dt(t)&&(this.selection.start=t),Dt(e)&&(this.selection.end=e),Dt(this.selection.end)||(this.selection.end=this.selection.start),Dt(this.selection.start)&&Dt(this.selection.end)&&(this.selection.start===this.selection.end?(this.clearSelection(),this.focus(),this.setCaret(this.selection.start)):(this.hideCaret(),this.renderSelection(this.selection.start,this.selection.end)),this.trigger("select:change",this.selection.start,this.selection.end)),this},setTextAreaSelection:function(t,e){var i={start:t,end:e};i=this.normalizeSelectionRange(i),this.textarea.focus(),this.textarea.selectionStart=i.start,this.textarea.selectionEnd=i.end},renderSelection:function(t,e){this.options.debug&&console.log("renderSelection()");var i={start:t,end:e};if(i=this.normalizeSelectionRange(i),this.clearSelection(),this.options.useNativeSelection){this.$viewport&&(this._viewportUserSelectBefore=this.$viewport.css("user-select"),this.$viewport.css({"-webkit-user-select":"all","-moz-user-select":"all","user-select":"all"}));var n=i.end-i.start;this.selectTextInElement(this.options.text,i.start,n)}else this.renderSelectionBoxes(i.start,i.end)},normalizeSelectionStartAndLength:function(t,e,i){var n=t.substr(0,e),s=t.substr(e,i);e-=this.countLineBreaks(n),i-=this.countLineBreaks(s);var r=this.countEmptyLines(n);return i+=r,i-=r,{start:e+=r,length:i+=this.countEmptyLines(s)}},selectTextInElement:function(e,i,n){if(ue(e.selectSubString)&&this.selectTextInElementUsingSelectSubString(e,i,n),!this.actualSelectionMatchesExpectedSelection(i,n))try{this.selectTextInElementUsingRanges(e,i,n)}catch(t){this.options.debug&&console.log(t),ue(e.selectSubString)&&this.selectTextInElementUsingSelectSubString(e,i,n)}},selectTextInElementUsingSelectSubString:function(t,e,i){var n=this.normalizeSelectionStartAndLength(this.getTextContent(),e,i);try{t.selectSubString(n.start,n.length)}catch(t){this.options.debug&&console.log(t)}},selectTextInElementUsingRanges:function(t,e,i){var n=window.getSelection();n.removeAllRanges();var s=this.normalizeSelectionStartAndLength(this.getTextContent(),e,i);e=0+s.start,i=0+s.length;for(var r,o,a,l,h,c=this.getTextNodesFromDomElement(t),u=0,d=e+i;0<i&&0<c.length;)a=u+(r=c.shift()).length,(e<=u&&u<d||e<a&&a<=d||u<=e&&e<a||u<d&&d<=a)&&(l=Math.max(e-u,0),h=Math.min(l+Math.min(i,r.length),a),(o=document.createRange()).setStart(r,l),o.setEnd(r,h),n.addRange(o),i-=h-l),u+=r.length},actualSelectionMatchesExpectedSelection:function(t,e){var i=window.getSelection().toString();return this.getExpectedSelectedContent(t,e)===(i=i.replace(/\s/g," "))},getExpectedSelectedContent:function(t,e){var i=this.getTextContent().substr(t,e);return i=(i=(i=i.replace(/(\n\r|\r|\n){2,}/g,"-")).replace(/\n\r|\r|\n/g,"")).replace(/\s/g," ")},getTextNodesFromDomElement:function(t){for(var e=[],i=0,n=t.childNodes.length;i<n;i++){var s=t.childNodes[i];void 0!==s.tagName?e=e.concat(this.getTextNodesFromDomElement(s)):e.push(s)}return e},renderSelectionBoxes:function(e,i){this.options.debug&&console.log("renderSelectionBoxes()"),this.$selection.empty();for(var t,n,s,r=this.getFontSize(),o=this.getTextTransforms(),a=o.rotation,l=e;l<i;l++){var h=this.$selectionBox.clone();try{s=this.getCharBBox(l)}catch(t){this.trigger("select:out-of-range",e,i);break}n&&0===a&&Math.round(s.y)===Math.round(n.y)&&Math.round(s.height)===Math.round(n.height)&&Math.round(s.x)===Math.round(n.x+n.width)?t.css({width:"+="+s.width}):(h.css({left:s.x,top:s.y-s.height,width:s.width,height:s.height,"-webkit-transform":"rotate("+a+"deg)","-webkit-transform-origin":"0% 100%","-moz-transform":"rotate("+a+"deg)","-moz-transform-origin":"0% 100%"}),this.$selection.append(h),t=h),n=s}s&&this.$textareaContainer.css({left:s.x,top:s.y-r*o.scaleY})},clearSelection:function(){return this.options.debug&&console.log("clearSelection()"),this.$selection.empty(),this.options.text.selectSubString&&(this.$viewport&&this._viewportUserSelectBefore&&this.$viewport.css({"-webkit-user-select":this._viewportUserSelectBefore,"-moz-user-select":this._viewportUserSelectBefore,"user-select":this._viewportUserSelectBefore}),window.getSelection().removeAllRanges()),this},deselect:function(){return this.options.debug&&console.log("deselect()"),this.stopSelecting(),this.clearSelection(),this.setTextAreaSelection(this.selection.start,this.selection.end),this},getSelectionStart:function(){return this.selection.start},getSelectionEnd:function(){return this.selection.end},getSelectionRange:function(){return this.normalizeSelectionRange(this.selection)},normalizeSelectionRange:function(t){return(t=ae(t)).start>t.end&&(t.end=[t.start,t.start=t.end][0]),t},getSelectionLength:function(){var t=this.getSelectionRange();return t.end-t.start},getSelection:function(){var t=this.getSelectionRange();return this.getTextContent().slice(t.start,t.end)},getWordBoundary:function(t){for(var e=this.textarea.value,i=/\W/,n=t;n;){if(i.test(e[n])){n+=1;break}--n}for(var s=this.getNumberOfChars(),r=t;r<=s&&!i.test(e[r]);)r+=1;return n<r?[n,r]:[r,n]},getURLBoundary:function(t){for(var e=this.textarea.value,i=/\s/,n=t;n;){if(i.test(e[n])){n+=1;break}--n}for(var s=this.getNumberOfChars(),r=t;r<=s&&!i.test(e[r]);)r+=1;if(/[-a-zA-Z0-9@:%_+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_+.~#?&//=]*)?/.test(e.substring(n,r)))return[n,r]},annotateURL:function(t,e,i){var n=this.textarea.value.substring(e,i),s=ee({url:n},this.options.urlAnnotation);return s.start=e,s.end=i,ce(s,t[t.length-1])||t.push(s),t},getCharBBox:function(t){if(this.isLineEnding(t)){var e=this.getCharBBox(t-1);return e.x=e.x2,e.y=e.y2,e.width=this.options.newlineCharacterBBoxWidth||10,e}var i=this.realToSvgCharNum(t),n=this.options.text,s=n.getStartPositionOfChar(i),r=n.getEndPositionOfChar(i),o=n.getExtentOfChar(i);s=this.localToScreenCoordinates(s),r=this.localToScreenCoordinates(r);var a=this.getTextTransforms();return{x:s.x,y:s.y,width:o.width*a.scaleX,height:o.height*a.scaleY,x2:r.x,y2:r.y}},realToSvgCharNum:function(t){for(var e=0,i=0;i<=t;i++)this.isLineEnding(i)&&(e+=1);return t-e},selectionStartToSvgCharNum:function(t){return t-this.nonEmptyLinesBefore(t)},isLineEnding:function(t){var e=this.textarea.value;return"\n"===e[t]&&0<t&&"\n"!==e[t-1]},svgToRealCharNum:function(t){for(var e=0,i=0;i<=t+e;i++)this.isLineEnding(i)&&(e+=1);return t+e},localToScreenCoordinates:function(t){return P(this.options.text).show(),Ot.transformPoint(t,this.options.text.getCTM())},getNumberOfChars:function(){return this.getTextContent().length},getCharNumFromEvent:function(t){var e=this.options.text,i=t.clientX,n=t.clientY,s=Ot(e).toLocalPoint(i,n),r=e.getCharNumAtPosition(s);if(r<0)return this.getNumberOfChars();var o=this.localToScreenCoordinates(s),a=this.getCharBBox(this.svgToRealCharNum(r));return Math.abs(a.x-o.x)<Math.abs(a.x+a.width-o.x)?this.svgToRealCharNum(r):this.svgToRealCharNum(r)+1},lineNumber:function(t){var e=this.textarea.value.substr(0,t);return this.countLineBreaks(e)},emptyLinesBefore:function(t){for(var e=this.textarea.value.split(/\n\r|\r|\n/g),i=0,n=this.lineNumber(t)-1;0<=n;n--)e[n]||(i+=1);return i},countLineBreaks:function(t){return(t.match(/\n\r|\r|\n/g)||[]).length},countEmptyLines:function(t){return(t.match(/(\n\r|\r|\n){2,}/g)||[]).length},nonEmptyLinesBefore:function(t){return this.lineNumber(t)-this.emptyLinesBefore(t)},isEmptyLine:function(t){return!this.textarea.value.split(/\n\r|\r|\n/g)[t]},isEmptyLineUnderSelection:function(t){var e=this.lineNumber(t);return this.isEmptyLine(e)},getTextTransforms:function(){var t=this.options.text.getCTM();return Ot.decomposeMatrix(t)},getFontSize:function(){return parseInt(Ot(this.options.text).attr("font-size"),10)},getTextAnchor:function(){return Ot(this.options.text).attr("text-anchor")||""},setCaret:function(t,e){Te(t)&&(e=t,t=void 0),e=e||{};var i,n=this.options.text,s=this.getNumberOfChars(),r=this.selection.start,o=this.textarea.value;void 0!==t&&(t=Math.min(Math.max(t,0),s),r=this.selection.start=this.selection.end=t),e.silent||this.trigger("caret:change",r),this.setTextAreaSelection(r,r),this.options.debug&&console.log("setCaret(",t,e,")","selectionStart",r,"isLineEnding",this.isLineEnding(r),"isEmptyLineUnderSelection",this.isEmptyLineUnderSelection(r),"svgCharNum",this.selectionStartToSvgCharNum(r),"nonEmptyLinesBefore",this.nonEmptyLinesBefore(r));try{var a;i=this.isEmptyLineUnderSelection(r)||!this.isLineEnding(r)&&o.length!==r?(a=this.selectionStartToSvgCharNum(r),n.getStartPositionOfChar(a)):(a=this.selectionStartToSvgCharNum(r)-1,n.getEndPositionOfChar(a))}catch(t){this.trigger("caret:out-of-range",r),i={x:0,y:0}}var l=this.localToScreenCoordinates(i),h=this.getTextTransforms(),c=h.rotation,u=this.getFontSize()*h.scaleY;return this.options.placeholder&&this.$caret.toggleClass("placeholder",0===s),this.$caret.css({left:l.x,top:l.y+(s?-u:0),height:u,"line-height":u+"px","font-size":u+"px","-webkit-transform":"rotate("+c+"deg)","-webkit-transform-origin":"0% 100%","-moz-transform":"rotate("+c+"deg)","-moz-transform-origin":"0% 100%"}).attr({"text-anchor":this.getTextAnchor()}).show(),this.$textareaContainer.css({left:l.x,top:l.y+(s?-u:0)}),this.focus(),this},focus:function(){return this.options.debug&&console.log("focus()"),this.showCaret(),this},blur:function(){return this.options.debug&&console.log("blur()"),this.hideCaret(),this},showCaret:function(){return this.options.debug&&console.log("showCaret()"),this.$caret.show(),this},hideCaret:function(){return this.options.debug&&console.log("hideCaret()"),this.$caret.hide(),this},unbindTextElement:function(){this.$elText.off("mousedown",this.onMousedown),this.$elText.off("dblclick",this.onDoubleClick),this.$elText.off("click",this.onTripleClick)},onRemove:function(){this.deselect(),this.unbindTextElement(),P(document.body).off("mousemove",this.onMousemove),P(document.body).off("mouseup",this.onMouseup),P(document.body).off("keydown",this.onKeydown),Ot(this.options.text).attr("cursor","")}},ee({getTextElement:function(t){var e=t.tagName.toUpperCase();if("TEXT"===e||"TSPAN"===e||"TEXTPATH"===e)return"TEXT"===e?t:this.getTextElement(t.parentNode)},edit:function(t,r){var e=!1!==(r=r||{}).update;this.options=ee({},r,{update:e});var o=this.getTextElement(t);if(o){var i;if(this.close(),this.ed=new da(ee({text:o},r)),this.ed.on("all",this.trigger,this),r.cellView){if(i=r.cellView.paper.el,this.cellViewUnderEdit=r.cellView,this.cellViewUnderEditInteractiveOption=this.cellViewUnderEdit.options.interactive,this.cellViewUnderEdit.options.interactive=!1,r.annotationsProperty&&!this.ed.getAnnotations()){var n=this.cellViewUnderEdit.model.prop(r.annotationsProperty);n&&this.ed.setAnnotations(this.deepCloneAnnotations(n))}}else i=Ot(o).svg().parentNode;return e&&this.ed.on("text:change",function(t,e,i){if(r.cellView){var n=null;if(r.textProperty&&(r.cellView.model.isLink()&&"labels"===r.textProperty.substr(0,"labels".length)&&(n=Ot(P(Ot(o).node).closest(".label")[0]).index()),r.cellView.model.prop(r.textProperty,t,{textEditor:this.ed.cid})),r.annotationsProperty&&r.cellView.model.prop(r.annotationsProperty,this.deepCloneAnnotations(i),{rewrite:!0,textEditor:this.ed.cid}),null!==n){var s=Ot(r.cellView.el).find(".label");o=s[n].findOne("text"),this.ed.setTextElement(o.node)}}else Ot(o).text(t,i)},this),this.ed.render(i),this}this.options.debug&&console.log("ui.TextEditor: cannot find a text element.")},close:function(){if(this.ed){if(this.ed.options.annotateUrls){var t=this.ed.getSelectionStart();if(!this.findAnnotationsUnderCursor().find(function(t){return!!t.url&&t}))this.ed.annotateURLBeforeCaret(t)&&this.applyAnnotations(this.getAnnotations())}this.ed.remove(),this.cellViewUnderEdit&&(this.cellViewUnderEdit.options.interactive=this.cellViewUnderEditInteractiveOption),this.ed=this.cellViewUnderEdit=this.cellViewUnderEditInteractiveOption=void 0}},applyAnnotations:function(t){var e=this.options;if(this.ed&&e.update){e.cellView&&e.annotationsProperty?(e.cellView.model.prop(e.annotationsProperty,this.deepCloneAnnotations(t),{rewrite:!0}),this.ed.setAnnotations(t)):Ot(this.ed.options.text).text(this.ed.getTextContent(),t);var i=this.getSelectionRange();0<this.getSelectionLength()?this.ed.select(i.start,i.end):this.ed.setCaret()}},deepCloneAnnotations:function(t){try{return JSON.parse(JSON.stringify(t))}catch(t){return}},proxy:function(t,e){if(this.ed)return this.ed[t].apply(this.ed,e)},setCurrentAnnotation:function(t){return this.proxy("setCurrentAnnotation",arguments)},getAnnotations:function(){return this.proxy("getAnnotations",arguments)},setCaret:function(){return this.proxy("setCaret",arguments)},deselect:function(){return this.proxy("deselect",arguments)},selectAll:function(){return this.proxy("selectAll",arguments)},select:function(){return this.proxy("select",arguments)},getNumberOfChars:function(){return this.proxy("getNumberOfChars",arguments)},getCharNumFromEvent:function(){return this.proxy("getCharNumFromEvent",arguments)},getWordBoundary:function(){return this.proxy("getWordBoundary",arguments)},findAnnotationsUnderCursor:function(){return this.proxy("findAnnotationsUnderCursor",[this.ed.getAnnotations(),this.ed.getSelectionStart()])},findAnnotationsInSelection:function(){if(this.ed){var t=this.ed.getSelectionRange();return this.proxy("findAnnotationsInSelection",[this.ed.getAnnotations(),t.start,t.end])}},getSelectionAttrs:function(t){if(this.ed){var e=this.ed.getSelectionRange();return this.proxy("getSelectionAttrs",[e,t])}},getSelectionLength:function(){return this.proxy("getSelectionLength",arguments)},getSelectionRange:function(){return this.proxy("getSelectionRange",arguments)}},o.Events)),pa=gi.extend({className:"widget",references:[],constructor:function(t,e){this.availableReferences=e||{},gi.prototype.constructor.call(this,t)},updateAttrs:function(t){Mt(this.$el,t)},bindEvents:function(){},validateReferences:function(){var t=this.references||[],e=[];return t.forEach(function(t){void 0===this.availableReferences[t]&&e.push(t)},this),e},getReference:function(t){return this.availableReferences[t]},getReferences:function(){return this.availableReferences}}),ga=pa.extend({tagName:"label",events:{"change .input":"onChange",mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick"},documentEvents:{mouseup:"pointerup",touchend:"pointerup"},init:function(){_e(this,"pointerup")},render:function(){var t=this.options,e=P("<span/>").text(t.label||"");return this.$input=P("<input/>",{type:"checkbox",class:"input"}).prop("checked",!!t.value),this.$span=P("<span/>"),this.$el.append([e,this.$input,this.$span]),this},onChange:function(t){this.trigger("change",!!t.target.checked,t)},pointerdown:function(t){t=bt(t),this.$el.addClass("is-in-action"),this.trigger("pointerdown",t),this.delegateDocumentEvents()},pointerclick:function(t){t=bt(t),this.trigger("pointerclick",t)},pointerup:function(t){t=bt(t),this.undelegateDocumentEvents(),this.trigger("pointerup",t),this.$el.removeClass("is-in-action"),"touchend"===t.type&&(this.$input.trigger("click"),t.preventDefault())}}),fa=pa.extend({tagName:"label",events:{"change input.toggle":"onChange","click input.toggle":"pointerclick",mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup"},documentEvents:{mouseup:"pointerup",touchend:"pointerup"},init:function(){_e(this,"pointerup")},render:function(){var t=this.options,e=P("<span/>").text(t.label||""),i=P("<span><i/></span>");this.$input=P("<input/>",{type:"checkbox",class:"toggle"}).prop("checked",!!t.value);var n=P("<div/>").addClass(t.type);return this.$el.append([e,n.append(this.$input,i)]),this},onChange:function(t){this.trigger("change",!!t.target.checked,t)},pointerclick:function(t){t=bt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=bt(t),this.$el.addClass("is-in-action"),this.trigger("pointerdown",t),this.delegateDocumentEvents()},pointerup:function(t){t=bt(t),this.undelegateDocumentEvents(),this.$el.removeClass("is-in-action"),this.trigger("pointerup",t),"touchend"===t.type&&(this.$input.trigger("click"),t.preventDefault())}}),ma=pa.extend({render:function(){return this.options.width&&this.$el.css({width:this.options.width}),this}}),va=pa.extend({tagName:"label",render:function(){return this.$el.text(this.options.text),this}}),ya=pa.extend({events:{"change .input":"onChange","input .input":"onChange"},render:function(){var t,e=this.options;return this.$output=P("<output/>").text(e.value),t=P("<span/>").addClass("units").text(e.unit),this.$input=P("<input/>",{type:"range",name:e.type,min:e.min,max:e.max,step:e.step,class:"input"}).val(e.value),this.$el.append([this.$input,this.$output,t]),this},onChange:function(t){var e=parseInt(this.$input.val(),10);e!==this.currentValue&&(this.currentValue=e,this.$output.text(e),this.trigger("change",e,t))},setValue:function(t){this.$input.val(t),this.$input.trigger("change")}}),ba=pa.extend({render:function(){var t=Ae(this.options,"type","group","index");return this.selectBox=new Oo(t),this.selectBox.render().$el.appendTo(this.el),this},bindEvents:function(){this.selectBox.on("all",this.trigger,this)}}),wa=pa.extend({events:{mousedown:"pointerdown",mouseup:"pointerup",touchend:"pointerup",touchstart:"pointerdown",click:"pointerclick"},tagName:"button",render:function(){var t=this.options;return this.$el.text(t.text),this},pointerclick:function(t){t=bt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=bt(t),this.trigger("pointerdown",t)},pointerup:function(t){t=bt(t),this.trigger("pointerup",t),"touchend"===t.type&&(this.$el.trigger("click"),t.preventDefault())}}),Ca=pa.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout"},tagName:"div",render:function(){var t=this.options;return this.$label=P("<label/>").text(t.label),this.$text=P("<input/>",{type:"text",class:"input"}).val(t.value),this.$input=P("<div/>").addClass("input-wrapper").append(this.$text),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t=bt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=bt(t),this.trigger("pointerdown",t),"touchstart"===t.type&&this.$text.trigger("focus")},pointerup:function(t){t=bt(t),this.trigger("pointerup",t),"touchend"===t.type&&(this.$text.trigger("click"),t.preventDefault())},pointerfocusin:function(t){t=bt(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=bt(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)}}),Ia=pa.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout"},tagName:"div",render:function(){var t=this.options;return this.$label=P("<label/>").text(t.label),this.$number=P("<input/>",{type:"number",class:"number",max:t.max,min:t.min}).val(t.value),this.$input=P("<div/>").addClass("input-wrapper").append(this.$number),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t=bt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=bt(t),this.trigger("pointerdown",t),"touchstart"===t.type&&this.$number.trigger("focus")},pointerup:function(t){t=bt(t),this.trigger("pointerup",t),"touchend"===t.type&&(this.$number.trigger("click"),t.preventDefault())},pointerfocusin:function(t){t=bt(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=bt(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)}}),xa=pa.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout"},tagName:"div",render:function(){var t=this.options;return this.$label=P("<label/>").text(t.label),this.$textarea=P("<textarea/>",{class:"textarea"}).text(t.value),this.$input=P("<div/>").addClass("input-wrapper").append(this.$textarea),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t.preventDefault(),t=bt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=bt(t),this.trigger("pointerdown",t),"touchstart"===t.type&&this.$textarea.focus()},pointerup:function(t){t=bt(t),this.trigger("pointerup",t),"touchend"===t.type&&(this.$textarea.trigger("click"),t.preventDefault())},pointerfocusin:function(t){t=bt(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=bt(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)}}),Aa=pa.extend({render:function(){var t=Ae(this.options,"type","group","index");return this.selectButtonGroup=new Ho(t),this.selectButtonGroup.render().$el.appendTo(this.el),this},bindEvents:function(){this.selectButtonGroup.on("all",this.trigger,this)}}),Sa=wa.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoom(e.step,{max:e.max,grid:e.step}),wa.prototype.pointerdown.call(this,t)}}),_a=wa.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoom(-e.step,{min:e.min,grid:e.step}),wa.prototype.pointerdown.call(this,t)}}),Pa=wa.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoomToFit({padding:20,scaleGrid:e.step,minScale:e.min,maxScale:e.max}),wa.prototype.pointerdown.call(this,t)}}),Ma=ya.extend({references:["paperScroller"],options:{min:20,max:500,step:20,value:100,unit:" %"},bindEvents:function(){this.on("change",function(t){this.getReferences().paperScroller.zoom(t/100,{absolute:!0,grid:this.options.step/100})},this),this.getReferences().paperScroller.options.paper.on("scale",function(t){this.setValue(Math.floor(100*t))},this)}}),ka=wa.extend({references:["commandManager"],pointerclick:function(){this.getReferences().commandManager.undo()}}),Ta=wa.extend({references:["commandManager"],pointerclick:function(){this.getReferences().commandManager.redo()}}),Na=wa.extend({onRender:function(){var t=this.target=P(this.options.target)[0];t&&!P.contains(window.top.document,t)&&this.$el.hide()},pointerclick:function(){kt(this.target)}}),Da={checkbox:ga,toggle:fa,separator:ma,label:va,range:ya,selectBox:ba,button:wa,inputText:Ca,inputNumber:Ia,textarea:xa,selectButtonGroup:Aa,zoomIn:Sa,zoomOut:_a,zoomToFit:Pa,zoomSlider:Ma,undo:ka,redo:Ta,fullscreen:Na};pa.create=function(t,e){var i=Me(Ne(t)?t:t.type);if(!ue(Da[i]))throw new Error('Widget: unable to find widget: "'+i+'"');var n=new Da[i](t,e),s=n.validateReferences(e);if(0<s.length)throw new Error('Widget: "'+i+'" missing dependency: '+s.join(", "));return n.render(),n.updateAttrs(t.attrs),n.bindEvents(),n.$el.attr("data-type",i),t.name&&n.$el.attr("data-name",t.name),n};function Ea(t){t=t||{},this.comparator=t.comparator||function(t,e){return t-e},this.index={},this.data=t.data||[],this.heapify()}var La=gi.extend({options:{},align:["left","right"],className:"toolbar",defaultGroup:"default",widgets:[],groupViews:[],init:function(){this.tools=pe(this.options.tools),this.groups=this.options.groups||{}},getWidgetByName:function(e){return this.widgets.find(function(t){return t.options.name===e})},getWidgets:function(){return this.widgets},groupsWithItemsPairs:function(){var i={};this.tools.forEach(function(t){var e=t.group||this.defaultGroup;i[e]=i[e]||{items:[],group:{}},i[e].items.push(t),i[e].group=this.groups[e]||{}},this);for(var t=Object.keys(i),e=[],n=0,s=t.length;n<s;n++){var r=t[n];e.push([r,i[r]])}var o=me(e,function(t){return t[1].group.index});return me(o,function(t){return t[1].group.align||"left"})},render:function(){var t=this.groupsWithItemsPairs(),s=!1;return t.forEach(function(t){var e=t[0],i=t[1],n=this.renderGroup(e,i);!s&&i.group.align&&"right"===i.group.align&&(s=!0,n.addClass("group-first")),n.appendTo(this.el)},this),this},renderGroup:function(t,e){var i=new za({name:t,align:e.group.align,items:e.items,references:this.options.references});return this.groupViews.push(i),i.on("all",function(){this.trigger.apply(this,arguments)}.bind(this)),i.render(),this.widgets=this.widgets.concat(i.widgets),i.$el},onRemove:function(){se(this.groupViews,"off"),se(this.groupViews,"remove")}}),za=gi.extend({className:"toolbar-group",init:function(){this.widgets=[]},onRender:function(){this.$el.attr("data-group",this.options.name),this.$el.addClass(this.options.align),this.renderItems()},renderItems:function(){pe(this.options.items).forEach(function(t){var e=this.createWidget(t);this.$el.append(e.$el)},this)},createWidget:function(i){var t=pa.create(i,this.options.references);return t.on("all",function(t){var e=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[i.name+":"+t].concat(e))}.bind(this)),this.widgets.push(t),t},onRemove:function(){se(this.widgets,"off"),se(this.widgets,"remove")}}),Oa=gi.extend({className:"tooltip",options:{left:void 0,right:void 0,top:void 0,bottom:void 0,position:void 0,positionSelector:void 0,direction:"auto",minResizedWidth:100,padding:0,rootTarget:null,target:null,trigger:"hover",viewport:{selector:null,padding:0},dataAttributePrefix:"tooltip",template:'<div class="tooltip-arrow"/><div class="tooltip-arrow-mask"/><div class="tooltip-content"/>'},init:function(){this.eventNamespace=("."+this.className+this.cid).replace(/ /g,"_"),this.settings={},this.container=document.body;var t=this.options.trigger.split(" ");_e(this,"render","hide","show","toggle","isVisible","position"),this.options.rootTarget?(this.$rootTarget=P(this.options.rootTarget),t.forEach(function(t){switch(t){case"click":this.$rootTarget.on("click"+this.eventNamespace,this.options.target,this.toggle);break;case"hover":this.$rootTarget.on("mouseover"+this.eventNamespace,this.options.target,this.render);break;case"focus":this.$rootTarget.on("focusin"+this.eventNamespace,this.options.target,this.render)}},this)):(this.$target=P(this.options.target),t.forEach(function(t){switch(t){case"click":this.$target.on("click"+this.eventNamespace,this.toggle);break;case"hover":this.$target.on("mouseover"+this.eventNamespace,this.render);break;case"focus":this.$target.on("focusin"+this.eventNamespace,this.render)}},this)),this.$el.append(this.options.template)},onRemove:function(){this.options.rootTarget?this.$rootTarget.off(this.eventNamespace):this.$target.off(this.eventNamespace)},hide:function(){var t=this.settings;t&&(this.unbindHideActions(t.currentTarget),this.$el.removeClass(t.className),this.$el.remove())},show:function(t){this.render(t||{target:this.options.target})},toggle:function(t){this.isVisible()?this.hide():this.show(t)},isVisible:function(){return document.body.contains(this.el)},render:function(t){var e,i=void 0!==t.x&&void 0!==t.y?t:null,n=P(t.target).closest(this.options.target)[0],s=this.settings=this.getTooltipSettings(n);s.currentTarget=n,this.bindHideActions(n),e=i?{x:i.x,y:i.y,width:1,height:1}:_t(n),this.$(".tooltip-content").html(s.content),this.$el.hide(),this.$el.removeClass("left right top bottom"),this.$el.addClass(s.className),P(this.container).append(this.$el);var r=this.$("img");r.length?r.on("load",function(){this.position(e),this.$el.addClass("rendered")}.bind(this)):(this.position(e),this.$el.addClass("rendered"))},getTooltipSettings:function(t){var e=this.loadDefinitionFromElementData(t);return this.evaluateOptions(t,e)},unbindHideActions:function(t){var e=this.eventNamespace+".remove";P(t).off(e),clearInterval(this.interval)},bindHideOnRemoveTarget:function(t){clearInterval(this.interval),this.interval=setInterval(function(){P.contains(document,t)||(clearInterval(this.interval),this.hide())}.bind(this),500)},bindHideActions:function(t){var i=this.settings,n=P(t),s=this.eventNamespace+".remove";this.bindHideOnRemoveTarget(t),this.options.trigger.split(" ").forEach(function(t){var e={hover:["mouseout","mousedown"],focus:["focusout"]}[t]||[];i.hideTrigger&&(e=i.hideTrigger.split(" ")||[]),e.forEach(function(t){n.on(t+s,this.hide)},this)},this)},evaluateOptions:function(n,s){var r=ee({},s=s||{},this.options);return Pe(r,function(t,e){var i=ue(t)?t(n):t;r[e]=null==i?s[e]:i}),this.normalizePosition(r),r},loadDefinitionFromElementData:function(t){if(!t)return{};var e=this.getAllAttrs(t,"data-"+this.options.dataAttributePrefix),n={};return Pe(e,function(t,e){var i;""===e&&(e="content"),"left"!==(i=e)&&"bottom"!==i&&"top"!==i&&"right"!==i&&(n[e]=t)}),n},getAllAttrs:function(t,e){for(var i=e||"",n=t.attributes,s={},r=0,o=n.length;r<o;r++){var a=n[r];if(a&&a.name.startsWith(i))s[Me(a.name.slice(i.length))]=a.value}return s},normalizePosition:function(t){var e=t.left||t.right||t.top||t.bottom;!t.position&&e&&(t.left&&(t.position="left"),t.right&&(t.position="right"),t.top&&(t.position="top"),t.bottom&&(t.position="bottom")),!t.positionSelector&&e&&(t.positionSelector=e)},position:function(t){var e=this.settings;this.$el.show(),this.$el.css("width","auto");var i=_t(this.container),n=this.getTooltipBBox(t,i);this.$el.css({left:n.x,top:n.y,width:n.width||"auto"});var s={};"left"===e.position||"right"===e.position?s.top=t.y+t.height/2-n.y:"top"===e.position||"bottom"===e.position?s.left=t.x+t.width/2-n.x:s.top=t.y+t.height/2-n.y,s.top-=i.y,s.left-=i.x,this.$(".tooltip-arrow, .tooltip-arrow-mask").removeAttr("style").css(s),e.direction&&"off"!==e.direction&&this.$el.addClass("auto"===e.direction?e.position||"left":e.direction)},getViewportViewBBox:function(){var t=this.settings,e=t.viewport.selector?P(t.currentTarget).closest(t.viewport.selector):"html",i=_t(e);if(!t.viewport.selector){var n=P(window);i.width=n.width()+n.scrollLeft(),i.height=n.height()+n.scrollTop()}var s=t.viewport.padding||0;return i.x+=s,i.y+=s,i.width-=2*s,i.height-=2*s,i},basePositions:{left:function(t,e){var i={x:e.positionedBBox.x+e.positionedBBox.width+e.padding,y:e.targetBBox.y+e.targetBBox.height/2-e.tooltipBBox.height/2};if(t){var n=e.viewport.x+e.viewport.width-i.x;if(n>e.minWidth&&n<e.tooltipBBox.width+e.padding&&(i.width=n),n<e.minWidth)return this.settings.position="right",this.basePositions.right(!1,e)}return i},right:function(t,e){var i={x:e.positionedBBox.x-e.tooltipBBox.width-e.padding,y:e.targetBBox.y+e.targetBBox.height/2-e.tooltipBBox.height/2};if(t){var n=e.positionedBBox.x-e.padding-e.viewport.x;if(n>e.minWidth&&n<e.tooltipBBox.width+e.padding&&(i.width=n,i.x=e.viewport.x),n<e.minWidth)return this.settings.position="left",this.basePositions.left(!1,e)}return i},top:function(t,e){var i={x:e.targetBBox.x+e.targetBBox.width/2-e.tooltipBBox.width/2,y:e.positionedBBox.y+e.positionedBBox.height+e.padding};if(t&&e.viewport.y+e.viewport.height-(e.positionedBBox.y+e.positionedBBox.height+e.padding)<e.tooltipBBox.height)return this.settings.position="bottom",this.basePositions.bottom(!1,e);return i},bottom:function(t,e){var i={x:e.targetBBox.x+e.targetBBox.width/2-e.tooltipBBox.width/2,y:e.positionedBBox.y-e.tooltipBBox.height-e.padding};if(t&&e.positionedBBox.y-e.padding-e.viewport.y<e.tooltipBBox.height)return this.settings.position="top",this.basePositions.top(!1,e);return i}},getTooltipBBox:function(t,e){var i=this.settings,n=P(i.positionSelector),s=n[0]?_t(n[0]):t,r=this.measureTooltipElement(),o=this.getViewportViewBBox(),a=i.position||"left",l=i.padding,h=Math.min(i.minResizedWidth,r.width+l),c={padding:l,targetBBox:t,positionedBBox:s,tooltipBBox:r,viewport:o},u=this.basePositions[a].call(this,0<h,c);return u.x-=e.x,u.y-=e.y,u.y<o.y?u.y=o.y:u.y+r.height>o.y+o.height&&(u.y=o.y+o.height-r.height),u.x<o.x?u.x=o.x:u.x+r.width>o.x+o.width&&(u.x=o.x+o.width-r.width),u},measureTooltipElement:function(){var t=this.$el.clone().appendTo(P("body")).css({left:-1e3,top:-500}),e={width:t.outerWidth(),height:t.outerHeight()};return t.remove(),e}}),Ga=gi.extend({MINIMAL_PREVIEW_SIZE:10,className:"tree-layout",documentEvents:{mousemove:"onPointermove",touchmove:"onPointermove",mouseup:"onPointerup",touchend:"onPointerup"},options:{previewAttrs:{parent:{rx:2,ry:2}},useModelGeometry:!1,clone:function(t){return t.clone()},canInteract:function(){return!0},validateConnection:null,paperConstructor:Qs,paperOptions:null,reconnectElements:null,translateElements:null},init:function(){this.toggleDefaultInteraction(!1),this.startListening(),this.render(),this.onSetTheme(null,this.theme)},startListening:function(){var t=this.options.paper;this.listenTo(t,"element:pointerdown",this.canInteract(this.onPointerdown))},toggleDefaultInteraction:function(t){this.options.paper.setInteractivity(t)},render:function(){var t=this.options.paper;this.$activeBox=P("<div>").addClass("tree-layout-box active hidden").appendTo(this.el);var e=ee({},this.options.paperOptions,{interactive:!1,width:"100%",height:"100%"});return this.draggingPaper=new this.options.paperConstructor(e),this.draggingPaper.undelegateEvents(),this.$translateBox=P("<div>").addClass("tree-layout-box translate hidden").append(this.draggingPaper.render().el).appendTo(this.el),this.$mask=P("<div>").addClass("tree-layout-mask"),this.svgViewport=Ot(t.cells),this.svgPreviewChild=Ot(this.renderChildPreview()).attr(this.options.previewAttrs.child||{}).addClass("tree-layout-preview child"),this.svgPreviewConnection=Ot(this.renderConnectionPreview()).attr(this.options.previewAttrs.link||{}).addClass("tree-layout-preview link"),this.svgPreviewParent=Ot(this.renderParentPreview()).attr(this.options.previewAttrs.parent||{}).addClass("tree-layout-preview parent"),this.svgPreview=Ot("g").addClass("tree-layout-preview-group").append([this.svgPreviewConnection,this.svgPreviewParent,this.svgPreviewChild]),this.$el.appendTo(t.el),this},renderChildPreview:function(){return Ot("circle")},renderParentPreview:function(){return Ot("rect")},renderConnectionPreview:function(){return Ot("path")},onSetTheme:function(e,i){[this.svgPreview,this.$mask].forEach(function(t){t&&(e&&t.removeClass(this.themeClassNamePrefix+e),t.addClass(this.themeClassNamePrefix+i))},this)},onRemove:function(){this.svgPreview.remove()},toggleDropping:function(t){this.$mask.toggleClass("dropping-not-allowed",!t),this.$translateBox.toggleClass("no-drop",!t)},canDrop:function(){return this.isActive()&&!this.$translateBox.hasClass("no-drop")},isActive:function(){return!this.$translateBox.hasClass("hidden")},_startDrag:function(t,e,i){var n=this.options.paper;this.$mask.appendTo(n.el),this.toggleDropping(!1),this.ctm=n.matrix();var s=t[0],r=s.findView(n).getBBox({useModelGeometry:this.options.useModelGeometry});this.updateBox(this.$translateBox,ie({x:e,y:i},r)),this.updateBox(this.$activeBox,r),this.$activeBox.removeClass("hidden"),this.$translateBox.removeClass("hidden"),this.prepareDraggingPaper(s)},updateBox:function(t,e){t.css({width:e.width,height:e.height,left:e.x,top:e.y})},positionTranslateBox:function(t){var e=Ot.transformPoint(t,this.ctm);this.$translateBox.css({left:e.x,top:e.y})},prepareDraggingPaper:function(t){var e=this.options.clone(t).position(0,0);this.draggingPaper.scale(this.ctm.a,this.ctm.d),this.draggingPaper.model.resetCells([e])},_doDrag:function(t,e,i){var n,s,r=this.model,o={x:e,y:i};if(this.candidate&&(this.candidate=null,this.hidePreview()),this.positionTranslateBox(o),(n=r.getMinimalRootAreaByPoint(o))&&(s=n.findMinimalAreaByPoint(o,{expandBy:Math.min(r.get("siblingGap"),r.get("gap"))/2})),s){var a=this.findDirection(s,o),l=s.getLayoutSiblings(a),h=l.getSiblingRankByPoint(o);pe(t).every(function(t){return this.isConnectionValid(t,l,h)},this)?(this.candidate={id:s.root.id,direction:a,siblingRank:h},this.updatePreview(l,h),this.showPreview(),this.toggleDropping(!0)):this.toggleDropping(!1)}else this.toggleDropping(!0)},_finishDrag:function(t,e,i){this.$mask.remove().removeClass("dropping-not-allowed");var n=this.candidate,s=this.options;if(n){var r=s.reconnectElements;"function"==typeof r?r.apply(this,[t,s.paper.getModelById(n.id),n.siblingRank,n.direction,this]):this.reconnectElements(t,n),this.candidate=null}else if(this.canDrop()){var o=s.translateElements;"function"==typeof o?o.call(this,t,e,i,this):this.translateElements(t,e,i)}this.$activeBox.addClass("hidden"),this.$translateBox.addClass("hidden"),this.hidePreview()},reconnectElement:function(t,e){var i=e.siblingRank+.5,n={direction:e.direction,siblingRank:i,ui:!0};if(!this.model.reconnectElement(t,e.id,n)){var s=this.options.paper,r=s.getDefaultLink(t.findView(s));r.set({source:{id:e.id},target:{id:t.id}}),r.addTo(s.model,n),this.model.changeSiblingRank(t,i,n),this.model.changeDirection(t,e.direction,n);var o=this.model.getAttribute(t,"direction");this.model.updateDirections(t,[o,e.direction],n)}},reconnectElements:function(t,e){t.forEach(function(t){this.reconnectElement(t,e)},this),this.layout()},translateElement:function(t,e,i){var n=this.model.graph.getConnectedLinks(t,{inbound:!0});se(n,"remove");var s=t.get("size");t.set("position",{x:e-s.width/2,y:i-s.height/2},{ui:!0})},translateElements:function(t,e,i){t.forEach(function(t){this.translateElement(t,e,i)},this),this.layout()},layout:function(){this.model.layout({ui:!0,treeLayoutView:this.cid})},updatePreview:function(t,e){var i=t.parentArea.root,n=Math.max(this.model.get("siblingGap")/2,this.MINIMAL_PREVIEW_SIZE),s={width:n,height:n},r=t.getNeighborPointFromRank(e),o=t.getConnectionPoints(r,{ignoreSiblings:!0}),a=t.getParentConnectionPoint(),l=t.getChildConnectionPoint(r,s);this.updateParentPreview(i.position(),i.size(),i),this.updateChildPreview(r,s),this.updateConnectionPreview(a,l,o)},showPreview:function(){this.svgViewport.append(this.svgPreview)},hidePreview:function(){this.svgPreview.remove()},updateParentPreview:function(t,e){this.svgPreviewParent.attr({x:t.x,y:t.y,width:e.width,height:e.height})},updateChildPreview:function(t,e){this.svgPreviewChild.attr({cx:t.x,cy:t.y,r:e.width/2})},updateConnectionPreview:function(t,e,i){this.svgPreviewConnection.attr({d:Vn(t,e,i,{})})},findDirection:function(t,e){var i,n=t.root.get("layout")||t.getType();switch(n){case"BL-BR":case"TL-TR":case"L-R":return i=n.split("-"),e.x>t.rootCX?i[1]:i[0];case"BL-TL":case"BR-TR":case"B-T":return i=n.split("-"),e.y>t.rootCY?i[0]:i[1];case"L":case"R":case"T":case"B":case"TR":case"TL":case"BR":case"BL":return n;default:return t.direction}},isConnectionValid:function(t,e,i){var n=e.parentArea.root;if(t.id==n.id)return!1;if(this.model.graph.isSuccessor(t,e.parentArea.root))return!1;var s=this.model.getLayoutArea(t);if(s.parentArea&&s.parentArea==e.parentArea&&s.direction==e.direction){var r=s.siblingRank-i;if(0==r||1==r)return!1}var o=this.options.validateConnection;return"function"!=typeof o||o.call(this,t,n,this)},canInteract:function(e){return function(t){this.options.canInteract(t)&&e.apply(this,arguments)}.bind(this)},startDragging:function(t){var e=Array.isArray(t)?t:[t];he(e)||this.delegateDocumentEvents(null,{moveCounter:0,draggedElements:e})},onPointerdown:function(t){this.startDragging(t.model)},onPointermove:function(t){var e=t.data,i=this.options.paper,n=i.clientToLocalPoint({x:t.clientX,y:t.clientY});e.moveCounter===i.options.clickThreshold?this._startDrag(e.draggedElements,n.x,n.y):e.moveCounter>i.options.clickThreshold&&this._doDrag(e.draggedElements,n.x,n.y),e.moveCounter++},onPointerup:function(t){var e=t.data,i=this.options.paper;if(e.moveCounter>=i.options.clickThreshold){var n=i.clientToLocalPoint({x:t.clientX,y:t.clientY});this._finishDrag(e.draggedElements,n.x,n.y)}this.undelegateDocumentEvents()}}),Ba={PathDrawer:sa,Clipboard:zo,ContextToolbar:Bo,Dialog:jo,FlashMessage:Ro,FreeTransform:Vo,Halo:Yo,Inspector:Fo,Keyboard:Wo,Lightbox:ea,Navigator:ia,PaperScroller:na,ColorPalette:Go,PathEditor:ra,Popup:oa,SelectBox:Oo,SelectButtonGroup:Ho,Selection:aa,SelectionView:la,Snaplines:ha,Stencil:ua,TextEditor:da,Toolbar:La,Tooltip:Oa,TreeLayoutView:Ga,widgets:Da,Widget:pa},ja={Local:{prefix:"joint.storage",insert:function(t,e,i){var n=e.id||vt(),s=this.loadIndex(t);-1===s.keys.indexOf(n)&&s.keys.push(n),this.setItem(this.docKey(t,n),e),this.setItem(this.indexKey(t),s),this.callback(i,null,ee({},e,{id:n}))},find:function(i,t,n){var e=this.loadIndex(i),s=[];if(he(t))e.keys.forEach(function(t){var e=this.getItem(this.docKey(i,t));e||this.callback(n,new Error("Storage incosistency. No document found for an ID "+t+" from index.")),s.push(e)},this),this.callback(n,null,s);else if(t.id){var r=this.getItem(this.docKey(i,t.id));this.callback(n,null,r?[r]:[])}else this.callback(n,null,[])},remove:function(e,i,t){var n=this.loadIndex(e);he(i)?(n.keys.forEach(function(t){localStorage.removeItem(this.docKey(e,t))},this),localStorage.removeItem(this.indexKey(e)),this.callback(t,null)):i.id&&(n.keys=n.keys.filter(function(t){return t!==i.id}),localStorage.removeItem(this.docKey(e,i.id)),this.setItem(this.indexKey(e),n),this.callback(t,null))},callback:function(t,e,i){t&&setTimeout(function(){t(e,i)},1)},setItem:function(t,e){localStorage.setItem(t,JSON.stringify(e))},getItem:function(t){var e=localStorage.getItem(t);return e?JSON.parse(e):e},loadIndex:function(t){var e=this.getItem(this.indexKey(t))||{};return e.keys=e.keys||[],e},docKey:function(t,e){return this.prefix+"."+t+".docs."+e},indexKey:function(t){return this.prefix+"."+t+".index"}}};Ea.prototype.isEmpty=function(){return 0===this.data.length},Ea.prototype.insert=function(t,e,i){var n={priority:t,value:e};this.data.push(n);var s=this.data.length-1;i&&(n.id=i,this.index[i]=s),this.bubbleUp(s)},Ea.prototype.peek=function(){return this.data[0]&&this.data[0].value},Ea.prototype.peekPriority=function(){return this.data[0]&&this.data[0].priority},Ea.prototype.updatePriority=function(t,e){var i=this.index[t];if(null==i)throw new Error("Node with id "+t+" was not found in the heap.");var n=this.data,s=n[i].priority,r=this.comparator(e,s);r<0?(n[i].priority=e,this.bubbleUp(i)):0<r&&(n[i].priority=e,this.bubbleDown(i))},Ea.prototype.remove=function(){var t=this.data,e=t[0],i=t.pop();return this.index[t.length]=null,0<t.length&&((t[0]=i).id&&(this.index[i.id]=0),this.bubbleDown(0)),e&&e.value},Ea.prototype.heapify=function(){for(var t=0;t<this.data.length;t++)this.bubbleUp(t)},Ea.prototype.bubbleUp=function(t){for(var e,i,n=this.data;0<t&&(e=t-1>>>1,this.comparator(n[t].priority,n[e].priority)<0);)i=n[e],n[e]=n[t],n[t].id&&(this.index[n[t].id]=e),n[t]=i,n[t].id&&(this.index[n[t].id]=t),t=e},Ea.prototype.bubbleDown=function(t){for(var e=this.data,i=e.length-1;;){var n=1+(t<<1),s=1+n,r=t;if(n<=i&&this.comparator(e[n].priority,e[r].priority)<0&&(r=n),s<=i&&this.comparator(e[s].priority,e[r].priority)<0&&(r=s),r===t)break;var o=e[r];e[r]=e[t],e[t].id&&(this.index[e[t].id]=r),e[t]=o,e[t].id&&(this.index[e[t].id]=t),t=r}};function Ra(t,e,i){i=i||function(t,e){return 1};var n={};n[e]=0;var s,r,o,a,l={},h=new Ea;for(var c in t)c!==e&&(n[c]=1/0),h.insert(n[c],c,c);for(var u={};!h.isEmpty();)for(u[s=h.remove()]=!0,r=t[s]||[],o=0;o<r.length;o++)u[c=r[o]]||(a=n[s]+i(s,c))<n[c]&&(n[c]=a,l[c]=s,h.updatePriority(c,a));return l}var Va={PriorityQueue:Ea,Dijkstra:Ra};Qs.prototype.print=function(e){var t=Ua(e),i=Ya.call(this,t),n={sheetSizePx:Ha(t)};t.ready(i,function(t){Wa.call(this,t,e)}.bind(this),n)},Qs.prototype.preparePrintArea=function(t,e){this.trigger("beforeprint",e);var i=P("<div/>").addClass("printarea"),n=P("<div/>").addClass(ct("print-paper")).css("position","relative");e.size&&i.addClass("printarea-size-"+e.size);var s=Ot(this.svg).clone(),r=s.findOne("."+ct("layers"));n.append(s.node);var o=Ha(e),a=this.getArea(),l=this.scale(),h=l.sx,c=l.sy,u=this.translate(),d=u.tx,p=u.ty,g=Ot.createSVGMatrix().translate(d/h,p/c),f=Fa(a,t,o),m=f.scaleToFit,v=f.bBox;return n.css({left:0,top:0}),s.attr({width:v.width*m,height:v.height*m,style:"position:relative",viewBox:[v.x,v.y,v.width,v.height].join(" ")}),r.attr("transform",Ot.matrixToTransformString(g)),i.append([n.append([s.node])]),i.addClass("preview"),{$el:i,sheetSizePx:o}};function Za(t,e,i){if(i=i||{},void 0===t)throw new Error("The the dia.Paper is a mandatory option.");t.trigger("beforeexport",i);var n=Ot(t.svg).clone(),s=n.findOne("."+ct("layers")),r=i.area||t.paperToLocalRect(t.getContentBBox()),o=i.preserveDimensions;o&&n.attr({width:o.width||r.width,height:o.height||r.height}),n.removeAttr("style").attr("viewBox",[r.x,r.y,r.width,r.height].join(" ")),s.removeAttr("transform"),!1!==i.useComputedStyles&&function(t,e){for(var i=Array.from(t.querySelectorAll("*")),n=Array.from(e.querySelectorAll("*")),s=t.ownerDocument,r=s.styleSheets.length,o=[],a=r-1;0<=a;a--)o[a]=s.styleSheets[a],s.styleSheets[a].disabled=!0;var l={};i.forEach(function(t,e){var i=window.getComputedStyle(t,null),n={};Pe(i,function(t){n[t]=i.getPropertyValue(t)}),l[e]=n}),r!=s.styleSheets.length&&o.forEach(function(t,e){s.styleSheets[e]=t});for(var h=0;h<r;h++)s.styleSheets[h].disabled=!1;var c={};i.forEach(function(t,e){var i=window.getComputedStyle(t,null),n=l[e],s={};Pe(i,function(t){isNaN(t)&&i.getPropertyValue(t)!==n[t]&&(s[t]=i.getPropertyValue(t))}),c[e]=s}),n.forEach(function(t,e){P(t).css(c[e])})}(t.svg,n.node);var a,l,h,c=i.stylesheet;if(Ne(c)&&(a=n.node,l=c,h=a.ownerDocument.implementation.createDocument(null,"xml",null),Ot(a).prepend(Ot("style",{type:"text/css"},[h.createCDATASection(l)]))),t.trigger("afterexport",i),i.convertImagesToDataUris){var u=n.find("image").map(qa);P.when.apply(P,u).then(function(){e(tl(n.node))})}else e(tl(n.node))}var Wa=function(t,e){if(t){var i=P(document.body);i.addClass("joint-print");var n=this.$el.children().detach();t.forEach(function(t){t.removeClass("preview").addClass("print-ready").appendTo(i)});var s=!1,r=function(){s||(s=!0,i.removeClass("joint-print"),t.forEach(function(t){t.remove()}),this.$el.append(n),P("#print-styles").remove(),this.trigger("afterprint",e),P(window).off("afterprint",r))}.bind(this);P(window).one("afterprint",r),setTimeout(r,200),window.print()}},Ya=function(t){var e,i=Ja.call(this,t),n=[];if(t.poster)for(var s=Ka(i,t.poster),r=$a(i,s),o=0;o<r.length;o++)e=this.preparePrintArea(r[o],t),n.push(e.$el);else e=this.preparePrintArea(i,t),n.push(e.$el);if(e){var a={width:e.sheetSizePx.cssWidth,height:e.sheetSizePx.cssHeight};Xa(a,t)}return n},Ha=function(t){var e=Ht(t.margin),i=t.sheet;e.unit=t.marginUnit,i.unit=t.sheetUnit;var n="calc("+i.width+i.unit+" - "+(e.left+e.right)+e.unit+")",s="calc("+i.height+i.unit+" - "+(e.top+e.bottom)+e.unit+")",r=Qa.measure(n,s,"");return{cssWidth:n,cssHeight:s,width:r.width,height:r.height}},Fa=function(t,e,i){var n=new Q({x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}),s=n.width/n.height,r=i.width/i.height;return{bBox:n,scaleToFit:r<s?i.width/n.width:i.height/n.height,fitHorizontal:r<s}},Ua=function(t){var e=ne({},t,{area:null,poster:!1,sheet:{width:210,height:297},sheetUnit:"mm",ready:function(t,e,i){e(t)},margin:.4,marginUnit:"in",padding:5});return e.area||(e.printingAll=!0),e},Xa=function(t,e){var i,n,s,r,o=(i=t,Object.keys(i).map(function(t){return t+":"+i[t]}).join(";")+";"),a=Ht(e.margin),l=e.marginUnit,h=[a.top+l,a.right+l,a.bottom+l,a.left+l].join(" "),c="size:"+(e.sheet.width+e.sheet.unit)+" "+(e.sheet.height+e.sheet.unit);n=["@media print {",".printarea.print-ready {",o,"}","@page {","margin:"+h+";",c,"}",".printarea.preview {",o,"}","}"].join(""),s=P("#print-styles"),r='<style type="text/css" id="print-styles">'+n+"</style>",s.length?s.html(n):P("head").append(r)},Ja=function(t){var e=t.area;if(!e){var i=Ht(t.padding);e=this.getContentArea().moveAndExpand({x:-i.left,y:-i.top,width:i.left+i.right,height:i.top+i.bottom})}return e},$a=function(t,e){for(var i,n=e.width,s=e.height,r=[],o=0,a=0,l=0,h=0;o<t.height;){for(;a<t.width&&(i=Q(t.x+a,t.y+o,n,s),r.push(i),a+=n,!(200<h));)h++;if(h=a=0,o+=s,200<l)break;l++}return r},Ka=function(t,e){var i={width:e.width,height:e.height};return i.width||(i.width=Math.ceil(t.width/(e.columns||1))),i.height||(i.height=Math.ceil(t.height/(e.rows||1))),i},Qa={supportedUnits:{px:function(t){return t},mm:function(t){return this.millimeterSize*t},cm:function(t){return this.millimeterSize*t*10},in:function(t){return this.millimeterSize*t*25.4},pt:function(t){return this.millimeterSize*(25.4*t/72)},pc:function(t){return this.millimeterSize*(25.4*t/6)}},measure:function(t,e,i){i=i||"";var n=P("<div/>").css({display:"inline-block",position:"absolute",left:-15e3,top:-15e3,width:t+i,height:e+i}).appendTo(document.body),s={width:n.width(),height:n.height()};return n.remove(),s},toPx:function(t,e){if(this.millimeterSize||(this.millimeterSize=this.measure(1,1,"mm").width),e=(e||"").toLowerCase(),!this.supportedUnits[e])throw new Error("Unsupportted unit "+e);return this.supportedUnits[e].call(this,t)}};function qa(i){var n=P.Deferred(),t=i.attr("xlink:href")||i.attr("href");return St(t,function(t,e){!t&&e&&i.attr("xlink:href",e),n.resolve()}),n.promise()}function tl(t){return(new XMLSerializer).serializeToString(t).replace(/&nbsp;/g,"\xa0")}function el(t,e){var n=ke("svg_output");Za(t,function(t){var e=window.open("",n,"menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes"),i="data:image/svg+xml,"+encodeURIComponent(t);e.document.write('<img src="'+i+'" style="max-height:100%" />')},ee({convertImagesToDataUris:!0},e))}Qs.prototype.toSVG=function(){for(var t=arguments.length,e=Array(t);t--;)e[t]=arguments[t];return Za.apply(this,[this].concat(e))},Qs.prototype.openAsSVG=function(){for(var t=arguments.length,e=Array(t);t--;)e[t]=arguments[t];return el.apply(this,[this].concat(e))};function il(t,a,l){if(void 0===l&&(l={}),void 0===t)throw new Error("The the dia.Paper is a mandatory argument.");var e,i,h=l.canvg||("undefined"!=typeof canvg?canvg:void 0),n=function(t,e){var i=function(t){var e=Ht(t.padding);t.width&&t.height&&(e.left+e.right>=t.width&&(e.left=e.right=0),e.top+e.bottom>=t.height&&(e.top=e.bottom=0));return e}(e),n=F({x:-i.left,y:-i.top,width:i.left+i.right,height:i.top+i.bottom});if(e.width&&e.height){var s=t.width+i.left+i.right,r=t.height+i.top+i.bottom;n.scale(s/e.width,r/e.height)}return Q(t).moveAndExpand(n)}(l.area||t.paperToLocalRect(t.getContentBBox()),l),s=Dt(l.width)&&Dt(l.height)?l:n,c=(e=s,i=function(t){var e=1;if(void 0!==t&&(e=parseFloat(t),!Number.isFinite(e)||0===e))throw new Error("dia.Paper: invalid raster size ("+t+")");return e}(l.size),{width:Math.max(Math.round(e.width*i),1),height:Math.max(Math.round(e.height*i),1)});if(!function(t,e){var i=document.createElement("canvas");i.width=t,i.height=e;var n=t-1,s=e-1,r=i.getContext("2d");try{r.fillStyle="rgb(1,1,1)",r.fillRect(n,s,1,1);var o=r.getImageData(n,s,1,1).data;if(1!==o[0]||1!==o[1]||1!==o[2])return!1}catch(t){return!1}return!0}(c.width,c.height))throw new Error("dia.Paper: raster size exceeded.");var u,d=new Image;d.onload=function(){var t,e,i;function n(){(i=document.createElement("canvas")).width=c.width,i.height=c.height,(e=i.getContext("2d")).fillStyle=l.backgroundColor||"white",e.fillRect(0,0,c.width,c.height)}function s(){t=i.toDataURL(l.type,l.quality),a(t),r()}function r(){i.svg&&ue(i.svg.stop)&&setTimeout(i.svg.stop,1)}n();try{e.drawImage(d,0,0,c.width,c.height),s()}catch(t){if(void 0===h)return void console.error("Canvas tainted. Canvg library required.");n();var o={ignoreDimensions:!0,ignoreClear:!0,ignoreMouse:!0,ignoreAnimation:!0,offsetX:0,offsetY:0,useCORS:!0};h(i,u,ee(o,{forceRedraw:function(){return!this.called&&(this.called=!0)}.bind({called:!1}),renderCallback:function(){try{s()}catch(t){r(),u=function(t){return t.replace(/<image[^>]*>/g,function(t){var e=t.match(/href="([^"]*)"/),i=e&&e[1],n="data:image/svg+xml";if(i&&i.substr(0,n.length)===n){var s=atob(i.substr(i.indexOf(",")+1));return s.substr(s.indexOf("<svg"))}return t})}(u),n(),h(i,u,ee(o,{renderCallback:s}))}}}))}},Za(t,function(t){u=t,d.src="data:image/svg+xml,"+encodeURIComponent(t)},{paper:t,convertImagesToDataUris:!0,area:n,useComputedStyles:l.useComputedStyles,stylesheet:l.stylesheet,preserveDimensions:{width:c.width,height:c.height}})}function nl(t,e,i){(i=i||{}).type="image/png",il(t,e,i)}function sl(t,e,i){(i=i||{}).type="image/jpeg",il(t,e,i)}function rl(t,e){var i=ke("png_output");nl(t,function(t){window.open("",i,"menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes").document.write('<img src="'+t+'"/>')},ee({padding:10},e))}Qs.prototype.openAsPNG=function(t){for(var e=arguments.length,i=Array(e);e--;)i[e]=arguments[e];return rl.apply(this,[this].concat(i))},Qs.prototype.toJPEG=function(t,e){for(var i=arguments.length,n=Array(i);i--;)n[i]=arguments[i];return sl.apply(this,[this].concat(n))},Qs.prototype.toPNG=function(t,e){for(var i=arguments.length,n=Array(i);i--;)n[i]=arguments[i];return nl.apply(this,[this].concat(n))},Qs.prototype.toDataURL=function(t,e){for(var i=arguments.length,n=Array(i);i--;)n[i]=arguments[i];return il.apply(this,[this].concat(n))};var ol={toCellsArray:function(t,n,i){var e=(new DOMParser).parseFromString(t,"text/xml");if("parsererror"==e.documentElement.nodeName)throw new Error("Error while parsing GEXF file.");var s=Array.from(e.documentElement.querySelectorAll("node")),r=Array.from(e.documentElement.querySelectorAll("edge")),o=[];return s.forEach(function(t){var e=parseFloat(t.querySelector("size").getAttribute("value")),i=n({id:t.getAttribute("id"),width:e,height:e,label:t.getAttribute("label")});o.push(i)}),r.forEach(function(t){var e=i({source:t.getAttribute("source"),target:t.getAttribute("target")});o.unshift(e)}),o},toSVG:Za,openAsSVG:el,toDataURL:il,toPNG:nl,toJPEG:sl,openAsPNG:rl};if("undefined"!=typeof module&&module.exports)var al=require("ws").Server,ll=require("ws"),hl=require("url");ll=ll||"undefined"!=typeof window&&window.WebSocket;function cl(t){if(this.options=t,!this.options||!this.options.graph)throw new Error("Channel: missing a graph.");this.options.ttl=this.options.ttl||60,this.options.healthCheckInterval=this.options.healthCheckInterval||36e5,this.options.reconnectInterval=this.options.reconnectInterval||1e4,this.options.serverShouldSendGraph=void 0===this.options.serverShouldSendGraph||this.options.serverShouldSendGraph,this._isClient=!!this.options.url,this._clients=[],this.messageQueue=[],this.id=this.options.id||(this._isClient?"c_":"s_")+vt(),this.state={},this.state[this.id]=0,this.sites={},this.sites[this.id]={socket:void 0,outgoing:[],ttl:this.options.ttl},this.initialize()}ee(cl.prototype,o.Events),cl.prototype.initialize=function(){this.options.graph.on("all",this.onGraphChange.bind(this)),this._isClient?this.connectClient():this.options.port&&(this.server=new al({port:this.options.port}),this.server.on("connection",this.onConnection.bind(this))),this._isClient||(this._healthCheckInterval=setInterval(this.healthCheck.bind(this),this.options.healthCheckInterval))},cl.prototype.connectClient=function(){var t=this.options.url+"/?channelId="+this.id+"&state="+JSON.stringify(this.state)+(this.options.query?"&query="+JSON.stringify(this.options.query):"");0<this.options.debugLevel&&this.log("connectClient",t);var e=new ll(t);e.onopen=this.onConnection.bind(this,e),e.onclose=this.onClose.bind(this,e)},cl.prototype.close=function(){this._reconnectTimeout&&clearTimeout(this._reconnectTimeout),this._healthCheckInterval&&clearInterval(this._healthCheckInterval),this._closed=!0,Pe(this.sites,function(t){t.socket&&t.socket.close()}),this.server&&this.server.close()},cl.prototype.healthCheck=function(){if(0<this.options.debugLevel){var t=Object.keys(this.sites).reduce(function(t,e){return t[e]=this[e].ttl,t}.bind(this.sites),{});this.log("healthCheck",t)}Pe(this.sites,function(t,e){e!==this.id&&(t.socket&&1===t.socket.readyState?t.ttl=this.options.ttl:--t.ttl,t.ttl<=0&&(this.sites=Ae(this.sites,e),this.state=Ae(this.state,e)))}.bind(this))},cl.prototype.onConnection=function(e,t){if(this._clients.push(e),this.trigger("open",e),this._isClient)(this.sites[this.id].socket=e).onmessage=function(t){this.onMessage(e,t.data)}.bind(this);else{var i=e.upgradeReq||t,n=hl.parse(i.url,!0).query.channelId;if(this.sites[n])this.sites[n].socket=e;else if(1<this.debugLevel&&this.log("new_site",n),this.sites[n]={socket:e,outgoing:[],ttl:this.options.ttl},this.state[n]=0,this.options.serverShouldSendGraph){var s={channelId:this.id,state:JSON.parse(JSON.stringify(this.state)),action:"graph",graph:this.options.graph.toJSON()};this.messageQueue.push({type:"op",data:s,source:this.id,target:[n]}),this.send()}e.on("message",this.onMessage.bind(this,e)),e.on("close",this.onClose.bind(this,e))}},cl.prototype.onClose=function(t){var e=this._clients.indexOf(t);-1!==e&&this._clients.splice(e,1),this._isClient&&!this._closed&&(this._reconnectTimeout&&clearTimeout(this._reconnectTimeout),this._reconnectTimeout=setTimeout(this.connectClient.bind(this),this.options.reconnectInterval)),this.trigger("close",t)},cl.prototype.onMessage=function(t,e){this.trigger("message:received",e),1<this.options.debugLevel&&this.log("message",e);try{e=JSON.parse(e)}catch(t){return console.error("Channel: message parsing failed.",t)}if("notification"==e.type)return this.trigger(e.data.event,e.data.data),this.sendNotification(e);var i,n,s=e.data;"graph"===(s=(i=(this._isClient||(n=this.sites[s.channelId],s=this.receive(n,s.channelId,s)),this.sites[this.id]),this.receive(i,this.id,s))).action?this.state[s.channelId]=s.state[s.channelId]:this.state[s.channelId]=(this.state[s.channelId]||0)+1,1<this.options.debugLevel&&this.log("new state",this.state),this.execute(s),Pe(this.sites,function(t,e){e!==this.id&&e!==s.channelId&&this.receive(t,e,s)}.bind(this)),this._isClient||(e.op=s,this.messageQueue.push(e),this.broadcast(e)),this.trigger("message:processed",e)},cl.prototype.receive=function(t,e,i){if(!t)return i;1<this.options.debugLevel&&this.log("receive",e,i),1<this.options.debugLevel&&this.log("outgoing",t.outgoing),t.outgoing=t.outgoing.filter(function(t){return t.state[t.channelId]>=(i.state[t.channelId]||0)}),1<this.options.debugLevel&&this.log("outgoing.length",t.outgoing.length);for(var n=0;n<t.outgoing.length;n++){var s=t.outgoing[n],r=this.transform(i,s);i=r[0],t.outgoing[n]=r[1]}return i},cl.prototype.transform=function(t,e){return 1<this.options.debugLevel&&this.log("transform",t,e),"change:target"===t.action&&"remove"===e.action&&t.cell.target.id===e.cell.id&&(t.cell.target={x:0,y:0}),"change:source"===t.action&&"remove"===e.action&&t.cell.source.id===e.cell.id&&(t.cell.source={x:0,y:0}),[t,e]},cl.prototype.execute=function(t){var e;switch(t.action){case"add":this.options.graph.addCell(t.cell,{remote:!0});break;case"remove":(e=this.options.graph.getCell(t.cell.id))&&e.remove({remote:!0,disconnectLinks:!0});break;case"graph":this.options.graph.fromJSON(t.graph);break;default:var i=t.action.substr("change:".length);(e=this.options.graph.getCell(t.cell.id))&&e.set(i,t.cell[i],{remote:!0})}},cl.prototype.broadcast=function(t){this._isClient?t.target=Object.keys(this.sites):t.target=Object.keys(Ae(this.sites,this.id,t.source)),this.send()},cl.prototype.send=function(){if(!this._paused){for(var t=[],e=0;e<this.messageQueue.length;e++){var i=this.messageQueue[e];this.sendMessage(i)&&t.push(e)}t.forEach(function(t){this.messageQueue.splice(t,1)},this)}},cl.prototype.sendMessage=function(n){1<this.debugLevel&&this.log("sendMessage",n);var s=[];return n.target.forEach(function(t,e){var i=this.sites[t];if(!i)return s.push(e);i.socket&&1===i.socket.readyState&&(1<this.debugLevel&&this.log("sendMessage",t,n),i.socket.send(JSON.stringify(n)),s.push(e))},this),s.forEach(function(t){n.target.splice(t,1)}),!n.target.length},cl.prototype.log=function(t,e){var i="Channel ["+this.id+"] "+t.toUpperCase()+": ";console.log.apply(console,[i].concat(Array.prototype.slice.call(arguments,1)))},cl.prototype.pause=function(){this._paused=!0},cl.prototype.unpause=function(){this._paused=!1,this.send()},cl.prototype.notify=function(t,e){var i={type:"notification",source:this.id,data:{event:t,data:e}};this.sendNotification(i)},cl.prototype.sendNotification=function(t){this._isClient?t.target=Object.keys(this.sites):t.target=Object.keys(Ae(this.sites,this.id,t.source)),this.sendMessage(t)},cl.prototype.onGraphChange=function(t,e,i,n){if((!n||!n.remote)&&("add"===t||"remove"===t||"change:"===t.substr(0,"change:".length))){var s={channelId:this.id,state:JSON.parse(JSON.stringify(this.state)),action:t,cell:e.toJSON()},r={type:"op",data:s,source:this.id};1<this.options.debugLevel&&this.log("generate",r),this.messageQueue.push(r),this.broadcast(r),this.sites[this.id].outgoing.push(s),this.state[this.id]++}};function ul(t){if(this.options=t,!this.options.port)throw new Error("ChannelHub: missing a port.");this.initialize()}ee(ul.prototype,o.Events),ul.prototype.initialize=function(){this.server=new al({port:this.options.port}),this.server.on("connection",this.onConnection.bind(this))},ul.prototype.onConnection=function(i,n){var t=i.upgradeReq||n,e={query:hl.parse(t.url,!0).query};if(!this.router)throw new Error("ChannelHub: missing a router.");var s=!1,r=this.router(e,function(t,e){if(t)throw new Error(t);e&&!s&&(e.onConnection(i,n),s=!0)});r instanceof cl&&(r.onConnection(i,n),s=!0)},ul.prototype.route=function(t){this.router=t},ul.prototype.close=function(){this.server.close()};var dl={Channel:cl,ChannelHub:ul},pl=o.Model.extend({initialize:function(t){this._map={},this._commandManager=t.commandManager,this.listenTo(this._commandManager,"add",this._onCommand)},defaults:{cancelInvalid:!0},_onCommand:function(t){return Array.isArray(t)?t.find(function(t){return!this._validateCommand(t)},this):this._validateCommand(t)},_validateCommand:function(r){return!(!r.options||!1!==r.options.validation)||(pe(this._map[r.action]).forEach(function(n){var s=0;!function t(e){var i=n[s++];try{if(!i)return void(o=e);i(e,r,t)}catch(e){t(e)}}(o)}),!o||(this.get("cancelInvalid")&&this._commandManager.cancel(),this.trigger("invalid",o),!1));var o},validate:function(e){var i=Array.prototype.slice.call(arguments,1);return i.forEach(function(t){if(!ue(t))throw new Error(e+" requires callback functions.")}),e.split(" ").forEach(function(t){(this._map[t]=this._map[t]||[]).push(i)},this),this}}),gl=o.Model.extend({defaults:{cmdBeforeAdd:null,cmdNameRegex:/^(?:add|remove|change:\w+)$/,applyOptionsList:["propertyPath"],revertOptionsList:["propertyPath"]},PREFIX_LENGTH:7,initialize:function(t){_e(this,"initBatchCommand","storeBatchCommand"),this.graph=t.graph,this.reset(),this.listen()},listen:function(){this.listenTo(this.graph,"all",this.addCommand,this),this.listenTo(this.graph,"batch:start",this.initBatchCommand,this),this.listenTo(this.graph,"batch:stop",this.storeBatchCommand,this)},createCommand:function(t){return{action:void 0,data:{id:void 0,type:void 0,previous:{},next:{}},batch:t&&t.batch}},push:function(t){this.redoStack=[],t.batch?(this.lastCmdIndex=Math.max(this.lastCmdIndex,0),this.trigger("batch",t)):(this.undoStack.push(t),this.trigger("add",t))},addCommand:function(i,n,t,e){if((!e||!e.dry)&&this.get("cmdNameRegex").test(i)&&("function"!=typeof this.get("cmdBeforeAdd")||this.get("cmdBeforeAdd").apply(this,arguments))){var s=void 0,r=n instanceof Xs;if(this.batchCommand){s=this.batchCommand[Math.max(this.lastCmdIndex,0)];var o=r&&!s.graphChange||s.data.id!==n.id,a=s.action!==i;if(0<=this.lastCmdIndex&&(o||a)){var l=this.batchCommand.findIndex(function(t,e){return(r&&t.graphChange||t.data.id===n.id)&&t.action===i});l<0||"add"===i||"remove"===i?s=this.createCommand({batch:!0}):(s=this.batchCommand[l],this.batchCommand.splice(l,1)),this.lastCmdIndex=this.batchCommand.push(s)-1}}else s=this.createCommand({batch:!1});if("add"===i||"remove"===i)return s.action=i,s.data.id=n.id,s.data.type=n.attributes.type,s.data.attributes=Tt({},n.toJSON()),s.options=e||{},void this.push(s);var h=i.substr(this.PREFIX_LENGTH);s.batch&&s.action||(s.action=i,s.data.previous[h]=ae(n.previous(h)),s.options=e||{},r?s.graphChange=!0:(s.data.id=n.id,s.data.type=n.attributes.type)),s.data.next[h]=ae(n.get(h)),this.push(s)}},initBatchCommand:function(){this.batchCommand?this.batchLevel++:(this.batchCommand=[this.createCommand({batch:!0})],this.lastCmdIndex=-1,this.batchLevel=0)},storeBatchCommand:function(){if(this.batchCommand&&this.batchLevel<=0){var t=this.filterBatchCommand(this.batchCommand);0<t.length&&(this.redoStack=[],this.undoStack.push(t),this.trigger("add",t)),this.batchCommand=null,this.lastCmdIndex=null,this.batchLevel=null}else this.batchCommand&&0<this.batchLevel&&this.batchLevel--},filterBatchCommand:function(t){for(var e=t.slice(),i=[];0<e.length;){var n=e.shift(),s=n.data.id;if(null!=n.action&&(null!=s||n.graphChange)){if("add"===n.action){var r=e.findIndex(function(t){return"remove"===t.action&&t.data&&t.data.id===s});if(0<=r){e=e.filter(function(t,e){return r<e||t.data.id!==s});continue}}else if("remove"===n.action){var o=e.findIndex(function(t){return"add"===t.action&&t.data&&t.data.id==s});if(0<=o){e.splice(o,1);continue}}else if(0===n.action.indexOf("change")&&ce(n.data.previous,n.data.next))continue;i.push(n)}}return i},revertCommand:function(t,e){var i;this.stopListening(),i=Array.isArray(t)?this.constructor.sortBatchCommands(t):[t];for(var n=this.graph,s=i.length-1;0<=s;s--){var r=i[s],o=r.graphChange?n:n.getCell(r.data.id),a=ee({commandManager:this.id||this.cid},e,Se(r.options,this.get("revertOptionsList")));switch(r.action){case"add":o.remove(a);break;case"remove":n.addCell(r.data.attributes,a);break;default:var l=r.action.substr(this.PREFIX_LENGTH);o.set(l,r.data.previous[l],a)}}this.listen()},applyCommand:function(t,e){var i;this.stopListening(),i=Array.isArray(t)?this.constructor.sortBatchCommands(t):[t];for(var n=this.graph,s=0;s<i.length;s++){var r=i[s],o=r.graphChange?n:n.getCell(r.data.id),a=ee({commandManager:this.id||this.cid},e,Se(r.options,this.get("applyOptionsList")));switch(r.action){case"add":n.addCell(r.data.attributes,a);break;case"remove":o.remove(a);break;default:var l=r.action.substr(this.PREFIX_LENGTH);o.set(l,r.data.next[l],a)}}this.listen()},undo:function(t){var e=this.undoStack.pop();e&&(this.revertCommand(e,t),this.redoStack.push(e))},redo:function(t){var e=this.redoStack.pop();e&&(this.applyCommand(e,t),this.undoStack.push(e))},cancel:function(t){this.hasUndo()&&(this.revertCommand(this.undoStack.pop(),t),this.redoStack=[])},reset:function(){this.undoStack=[],this.redoStack=[]},hasUndo:function(){return 0<this.undoStack.length},hasRedo:function(){return 0<this.redoStack.length}},{sortBatchCommands:function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],s=null;if("add"===n.action)for(var r=n.data.id,o=0;o<i;o++)if(t[o].data.id===r){s=o;break}null!==s?e.splice(s,0,n):e.push(n)}return e}});Xs.prototype.constructTree=function(t,n,s,r){r=r||[];var e=ue(n.children)?n.children(t):t[n.children||"children"];return s||(s=n.makeElement(t),r.push(s)),pe(e).forEach(function(t){var e=n.makeElement(t),i=n.makeLink(s,e);r.push(e,i),this.constructTree(t,n,e,r)},this),r},Xs.prototype.shortestPath=function(t,e,n){n=n||{};var s={};this.getLinks().forEach(function(t){var e=t.get("source").id,i=t.get("target").id;s[e]||(s[e]=[]),s[i]||(s[i]=[]),s[e].push(i),n.directed||s[i].push(e)});var i=Ra(s,t.id||t,n.weight),r=[],o=e.id||e;for(i[o]&&r.push(o);o=i[o];)r.unshift(o);return r};var fl={Validator:pl,CommandManager:gl},ml=ee({},so,Lo),vl={standard:ee({},Xi,Ar),uml:Ln,pn:Mn,fsa:_n,erd:Sn,logic:gn,chess:fn,org:Pn,devs:Qi,basic:Ei,bpmn:io,chart:Gr},yl=ee({},er,fl);e.V=Ot,e.Vectorizer=fr,e.alg=Va,e.anchors=Fs,e.com=dl,e.config=Bt,e.connectionPoints=Jn,e.connectionStrategies=ns,e.connectors=Zn,e.dia=yl,e.env=yi,e.format=ol,e.g=zt,e.highlighters=Wn,e.layout=ml,e.linkAnchors=Ys,e.linkTools=gr,e.mvc=fi,e.routers=js,e.setTheme=function(t,e){se(pi,"setTheme",t,e=e||{}),gi.prototype.defaultTheme=t},e.shapes=vl,e.storage=ja,e.ui=Ba,e.util=Ke,e.version="3.0.2",e.versionRappid="3.0.0",Object.defineProperty(e,"__esModule",{value:!0})}),"undefined"!=typeof joint)var g=joint.g,V=joint.V;