define("controlareasettings/building/config/space-common",[],function(){"use strict";function n(n,e){var o,t;for(t=0;t<e.length;t++)$.each(e[t],function(e,t){(o=n[e]).set("disabled",t[0]),o.set("visible",t[1])})}var t=window.I18N,e={DELETE_FLOOR_TEXT:t.prop("SPACE_MESSAGE_CONFIRM_DELETE_SELECTED_FLOOR"),DELETE_MULTI_FLOOR_TEXT:function(e){return t.prop("SPACE_MESSAGE_CONFIRM_DELETE_SELECTED_MULTI_FLOOR",e)},DELETE_ZONE_TEXT:t.prop("SPACE_MESSAGE_CONFIRM_DELETE_SELECTED_ZONE"),DELETE_MULTI_ZONE_TEXT:function(e){return t.prop("SPACE_MESSAGE_CONFIRM_DELETE_SELECTED_MULTI_ZONE",e)},DELETE_BUILDING_TEXT:t.prop("SPACE_MESSAGE_CONFIRM_DELETE_BUILDING"),DELETE_BUILDING_TEXT_RESULT:t.prop("SPACE_MESSAGE_NOTI_DELETE_BUILDING"),DELETE_FLOOR_TEXT_RESULT:t.prop("SPACE_MESSAGE_NOTI_DELETE_SELECTED_FLOOR"),DELETE_MULTI_FLOOR_TEXT_RESULT:t.prop("SPACE_MESSAGE_NOTI_DELETE_SELECTED_MULTI_FLOOR"),DELETE_ZONE_TEXT_RESULT:t.prop("SPACE_MESSAGE_NOTI_DELETE_SELECTED_ZONE"),DELETE_MULTI_ZONE_TEXT_RESULT:t.prop("SPACE_MESSAGE_NOTI_DELETE_SELECTED_MULTI_ZONE"),SPACE_CANCEL_TEXT:t.prop("SPACE_MESSAGE_CANCEL_THE_WORK"),SPACE_CANCEL_TEXT_RESULT:t.prop("SPACE_MESSAGE_NOTI_CANCELED_THIS_WORK"),SPACE_SAVE_TEXT_RESULT:t.prop("COMMON_MESSAGE_NOTI_CHANGES_SAVED"),UPLOAD_IMAGE_NOT:t.prop("SPACE_UPLOAD_IMAGE_NOT"),UPLOAD_IMAGE_FILE_SIZE_NOT:t.prop("SPACE_UPLOAD_IMAGE_FILE_SIZE_NOT"),UPLOAD_IMAGE_FILE_TYPE_NOT:t.prop("SPACE_UPLOAD_IMAGE_FILE_TYPE_NOT"),UPLOAD_TEXT_BTN:t.prop("SPACE_UPLOAD_TEXT_BTN"),TEXT_LENGTH_LONG:t.prop("SPACE_FLOOR_NAME_LONG"),SPACE_MESSAGE_NOTI_EXIST_SAME_BUILDING_NAME:t.prop("SPACE_MESSAGE_NOTI_EXIST_SAME_BUILDING_NAME"),SPACE_MESSAGE_NOTI_EXIST_SAME_FLOOR_NAME:t.prop("SPACE_MESSAGE_NOTI_EXIST_SAME_FLOOR_NAME"),SPACE_MESSAGE_NOTI_NOT_SAME_ZNOE_NAME:t.prop("SPACE_MESSAGE_NOTI_NOT_SAME_ZNOE_NAME"),SPACE_SAVE_ZONE_NAME_OVERLAP_ERROR:t.prop("SPACE_MESSAGE_NOTI_EXIST_SAME_ZNOE_NAME"),SPACE_SAVE_FLOOR_NAME_NOT:t.prop("SPACE_MESSAGE_NOTI_NOT_SAME_FLOOR_NAME"),SPACE_SAVE_BUILDING_NAME_NOT:t.prop("SPACE_MESSAGE_NOTI_NOT_BUILDING_NAME"),SPACE_SAVE_ZONE_OVERLAP:t.prop("SPACE_MESSAGE_NOTI_NOT_OVERLAP_ZNOE"),COMMON_MESSAGE_NOTI_SAVED:t.prop("COMMON_MESSAGE_NOTI_CHANGES_SAVED"),SPACE_DUPLICATE_BUILDING_NAME:function(e){return t.prop("SPACE_DUPLICATE_BUILDING_NAME",e)}},o={NAME:t.prop("SPACE_TEXT_NAME"),FLOOR:t.prop("SPACE_FLOOR"),DESCRIPTION:t.prop("SPACE_TEXT_DESCRIPTION"),DENSITY:t.prop("SPACE_TEXT_DENSITY"),COMFORT:t.prop("SPACE_TEXT_COMFORT"),ZONE_NUM:t.prop("SPACE_ZONE_COUNT"),MAP_IMAGE:t.prop("SPACE_MAP_IMAGE"),SPACE_TEXT_LOCATION:t.prop("SPACE_TEXT_LOCATION"),SPACE_TEXT_DATE:t.prop("SPACE_TEXT_DATE"),SPACE_TEXT_MANAGER:t.prop("SPACE_TEXT_MANAGER"),SPACE_TEXT_TOTAL:t.prop("SPACE_TEXT_TOTAL"),SPACE_TEXT_GENERAL:t.prop("SPACE_TEXT_GENERAL"),SPACE_BUTTON_TEXT_CREATE:t.prop("SPACE_BUTTON_TEXT_CREATE"),SPACE_TEXT_LATEST_UPDATE:t.prop("SPACE_TEXT_LATEST_UPDATE"),SPACE_TEXT_COLOR:t.prop("SPACE_ZONE_BACKGROUND_COLOR"),SPACE_FLOOR_WIDTH:t.prop("SPACE_FLOOR_WIDTH"),SPACE_FLOOR_HEIGHT:t.prop("SPACE_FLOOR_HEIGHT"),SPACE_COMFORT_INDEX:t.prop("SPACE_TEXT_COMFORT"),SPACE_COMFORT_INDEX_COMFORTABLE:t.prop("SPACE_COMFORT_INDEX_COMFORTABLE"),SPACE_COMFORT_INDEX_UNCOMFORTABLE:t.prop("SPACE_COMFORT_INDEX_UNCOMFORTABLE"),SPACE_COMFORT_INDEX_VERY_UNCOMFORTABLE:t.prop("SPACE_COMFORT_INDEX_VERY_UNCOMFORTABLE"),SPACE_BUTTON_TEXT_SAVE:t.prop("SPACE_BUTTON_TEXT_SAVE"),SPACE_BUTTON_TEXT_ADD:t.prop("SPACE_BUTTON_TEXT_ADD"),SPACE_BUTTON_TEXT_DELETE:t.prop("SPACE_BUTTON_TEXT_DELETE"),SPACE_BUTTON_TEXT_CANCEL:t.prop("SPACE_BUTTON_TEXT_CANCEL"),SPACE_BUTTON_TEXT_EXIT:t.prop("SPACE_BUTTON_TEXT_EXIT"),SPACE_BUTTON_TEXT_EDIT:t.prop("SPACE_BUTTON_TEXT_EDIT"),COMMON_BTN_DETAIL:t.prop("COMMON_BTN_DETAIL"),SPACE_ALL_DEVICE_TYPE:t.prop("SPACE_ALL_DEVICE_TYPE"),SPACE_BUTTON_TEXT_DELETEFLOOR:t.prop("SPACE_BUTTON_TEXT_DELETEFLOOR"),SPACE_NO_DEVICE_TYPE:t.prop("FACILITY_DEVICE_FILTER_SELECT_EMPTY")};return{MESSAGE:e,TEXT:o,buttonStateChange:n,editButtonsState:function(e){n(e,[{btnSave:[!1,!0]},{btnExit:[!1,!1]},{btnCancel:[!1,!0]}])},changeEditMode:function(e,t){n(e,[{btnEdit:[!1,!t]},{btnAdd:[!1,t]},{btnSave:[!0,t]},{btnDelete:[!0,t]},{btnExit:[!1,t]},{btnCancel:[!1,!1]},{btnMoveTop:[!0,t]},{btnMoveUp:[!0,t]},{btnMoveDown:[!0,t]},{btnMoveBottom:[!0,t]}])},checkDuplicatedByKey:function(e,t){var n,o,i=e.length;for(n=0;n<i;n++)for(o=n+1;o<i;o++)if(e[n][t]===e[o][t])return!0;return!1},checkNoElementByKey:function(e,t){var n,o=e.length;for(n=0;n<o;n++)if(null===e[n][t]||void 0===e[n][t]||""===e[n][t])return!0;return!1},deepCopyArray:function(e){return JSON.parse(JSON.stringify(e))},getFloorName:function(e,t){var n="";return n+="F"===e?t+e:"B"===e?e+t:t}}}),define("controlareasettings/building/config/space-vm",[],function(){"use strict";var e=window.kendo,t=window.I18N;return{AllMainViewModel:e.observable({btnEdit:{type:"edit",text:t.prop("SPACE_BUTTON_TEXT_EDIT"),disabled:!1,visible:!0,click:function(){}},btnAdd:{type:"add",text:t.prop("SPACE_BUTTON_TEXT_ADD"),disabled:!1,visible:!1,click:function(){}},btnDelete:{type:"delete",text:t.prop("SPACE_BUTTON_TEXT_DELETE"),disabled:!0,visible:!1,click:function(){}},btnSave:{type:"save",text:t.prop("SPACE_BUTTON_TEXT_SAVE"),disabled:!0,visible:!1,click:function(){}},btnExit:{type:"exit",text:t.prop("SPACE_BUTTON_TEXT_EXIT"),disabled:!1,visible:!1,click:function(){}},btnCancel:{type:"cancel",text:t.prop("SPACE_BUTTON_TEXT_CANCEL"),disabled:!1,visible:!1,click:function(){}},btnMoveTop:{type:"top",disabled:!0,visible:!1,click:function(){}},btnMoveUp:{type:"up",disabled:!0,visible:!1,click:function(){}},btnMoveDown:{type:"down",disabled:!0,visible:!1,click:function(){}},btnMoveBottom:{type:"bottom",disabled:!0,visible:!1,click:function(){}}}),SpecificFloorMainViewModel:e.observable({btnFloorDelete:{type:"floor-delete",text:t.prop("SPACE_BUTTON_TEXT_DELETEFLOOR"),disabled:!1,visible:!0,click:function(){}},btnEdit:{type:"edit",text:t.prop("SPACE_BUTTON_TEXT_EDIT"),disabled:!1,visible:!0,click:function(){}},btnSave:{type:"save",text:t.prop("SPACE_BUTTON_TEXT_SAVE"),disabled:!0,visible:!1,click:function(){}},btnExit:{type:"exit",text:t.prop("SPACE_BUTTON_TEXT_EXIT"),disabled:!1,visible:!1,click:function(){}},btnCancel:{type:"cancel",text:t.prop("SPACE_BUTTON_TEXT_CANCEL"),disabled:!1,visible:!1,click:function(){}},btnZoneCreate:{type:"zone-create",text:t.prop("SPACE_BUTTON_TEXT_CREATE"),disabled:!1,visible:!0,click:function(){}},btnZoneDelete:{type:"zone-delete",text:t.prop("SPACE_BUTTON_TEXT_DELETE"),disabled:!0,visible:!0,click:function(){}},btnMoveTop:{type:"top",disabled:!0,visible:!0,click:function(){}},btnMoveUp:{type:"up",disabled:!0,visible:!0,click:function(){}},btnMoveDown:{type:"down",disabled:!0,visible:!0,click:function(){}},btnMoveBottom:{type:"bottom",disabled:!0,visible:!0,click:function(){}},spanEditInfo:{text:t.prop("SPACE_MESSAGE_INFO_CLICK_ZONE_NAME"),visible:!0}})}}),define("controlareasettings/building/config/space-api",[],function(){"use strict";function r(e,t,n,o){return null!=n&&0===n.length?[]:$.ajax(function(e,t,n,o){var i,a={url:e,method:t};for(i in null!=n&&(a.data=n),o)a[i]=o[i];return a}(e,t,n,o))}function t(e,t){var n,o,i;for(o in t){for(e+=o+"="+(i=t[o])[0],n=1;n<i.length;n++)e+=","+i[n];e+="&"}return e.lastIndexOf("&")===e.length-1&&(e=e.slice(0,-1)),e}function n(e,t){var n,o=[];for(n=0;n<t.length;n++)o.push(r(e+t[n].id,"DELETE"));return o}function o(e,t,n){var o,i,a,u,r;for(o in n)n[o].isContains&&(i=e,a=t,r=n[u=o].defaultValue,null===i[u]||void 0===i[u]?null!=r&&(a[u]=r):a[u]=i[u])}function i(e,t){var n={};return o(e,n,{id:{isContains:t},name:{isContains:!0},nameDisplayCoordinate:{isContains:!0},description:{isContains:!0,defaultValue:""},foundation_space_floors_id:{isContains:!0},foundation_space_zoneTypes_id:{isContains:!0},maxOccupancy:{isContains:!0,defaultValue:0},sortOrder:{isContains:!0},geometry:{isContains:!0},backgroundColor:{isContains:!0}}),n}function a(e,t){var n={};return o(e,n,{id:{isContains:t},name:{isContains:!0},description:{isContains:!0,defaultValue:""},maxOccupancy:{isContains:!0,defaultValue:0},sortOrder:{isContains:!0}}),n}function d(e,t){var n={};return o(e,n,{id:{isContains:t},type:{isContains:!0},name:{isContains:!0},description:{isContains:!0,defaultValue:""},foundation_space_buildings_id:{isContains:!0},length:{isContains:!0,defaultValue:0},width:{isContains:!0,defaultValue:0},maxOccupancy:{isContains:!0,defaultValue:0},sortOrder:{isContains:!0}}),n}return{spaceZonesGET:function(e){return r(t("/foundation/space/zones?",e),"GET",null,!1)},spaceZonesPOST:function(e){var t,n,o=[];for(t=0;t<e.length;t++)n=i(e[t]),o.push(r("/foundation/space/zones","POST",n));return o},spaceZonesPATCH:function(e){var t,n,o=[];for(t=0;t<e.length;t++)n=i(e[t],!0),o.push(n);return r("/foundation/space/zones","PATCH",o)},spaceZonesDELETE:function(e){return n("/foundation/space/zones/",e)},spaceFloorsGET:function(e){return r(t("/foundation/space/floors?",e),"GET")},spaceFloorsPOST:function(e){var t,n,o=[],i=!1,a=new FormData,u={};for(t=0;t<e.length;t++)o.push(d(e[t])),e[t].image&&(i=!0,u["images["+t+"]"]=e[t].image);if(i){for(n in a.append("data",JSON.stringify(o)),u)a.append(n,u[n]);return r("/foundation/space/floors","POST",a,{isFileUpload:!0})}return r("/foundation/space/floors","POST",o)},spaceFloorsPATCH:function(e){var t,n=[];for(t=0;t<e.length;t++)n.push(d(e[t],!0));return r("/foundation/space/floors","PATCH",n)},spaceFloorsDELETE:function(e){return n("/foundation/space/floors/",e)},spaceFloorsImagePOST:function(e){var t,n,o=[];for(t=0;t<e.length;t++)(n=new FormData).append("image",e[t].image),o.push(r("/foundation/space/floors/"+e[t].id+"/image","POST",n,{isFileUpload:!0}));return o},spaceFloorsImageDELETE:function(e){var t,n=[];for(t=0;t<e.length;t++)n.push(r("/foundation/space/floors/"+e[t].id+"/image","DELETE"));return n},spaceBuildingsGET:function(){return r("/foundation/space/buildings","GET")},spaceBuildingsPOST:function(e){var t,n=[];for(t=0;t<e.length;t++)n.push(a(e[t]));return r("/foundation/space/buildings","POST",n)},spaceBuildingsPATCH:function(e){var t,n=[];for(t=0;t<e.length;t++)n.push(a(e[t],!0));return r("/foundation/space/buildings","PATCH",n)},spaceBuildingsDELETE:function(e){return n("/foundation/space/buildings/",e)},dmsDevicesGET:function(e){return r(t("/dms/devices?",e),"GET")},dmsDevicesPATCH:function(e){return r("/dms/devices","PATCH",e)}}}),define("controlareasettings/building/config/space-widget",["controlareasettings/core","controlareasettings/building/config/space-common"],function(){"use strict";var e;return e=$("<div/>").kendoCommonDialog({type:"confirm"}).data("kendoCommonDialog"),{messagDialog:$("<div/>").kendoCommonDialog().data("kendoCommonDialog"),confirmDialog:e,Loading:new window.CommonLoadingPanel}}),define("controlareasettings/building/model/space-model",["controlareasettings/core","controlareasettings/building/config/space-common"],function(e,t){"use strict";var n=window.kendo,o={description:t.TEXT.DESCRIPTION,density:t.TEXT.DENSITY,comfort:t.TEXT.COMFORT,location:t.TEXT.SPACE_TEXT_LOCATION,date:t.TEXT.SPACE_TEXT_DATE,manager:t.TEXT.SPACE_TEXT_MANAGER},i=[{text:"F",value:0},{text:"B",value:1},{text:"None",value:-1}],a={ORIGINAL_DATA:0,UPDATE_DATA:1,NEW_DATA:2,DELETED_DATA:3,VIEW_DATA:4};return{floorType:i,dataType:a,Zone:n.data.Model.define({id:"id",fields:{id:{name:"id",type:"string",editType:null},name:{name:"name",type:"string",editType:"input"},nameDisplayCoordinate:{name:"nameDisplayCoordinate",type:"object"},foundation_space_buildings_id:{name:"foundation_space_buildings_id",type:"number"},foundation_space_buildings_name:{name:"foundation_space_buildings_name",type:"string"},foundation_space_floors_id:{name:"foundation_space_floors_id",type:"number"},foundation_space_floors_name:{name:"foundation_space_floors_name",type:"string"},foundation_space_floors_type:{name:"foundation_space_floors_type",type:"string"},sortOrder:{name:"sortOrder",type:"number"},maxOccupancy:{name:"maxOccupancy",type:"number"},indexes:{name:"indexes",type:"object"},geometry:{name:"geometry",type:"object"},description:{name:o.description,type:"string",editType:"input"},created:{name:"created",type:"object"},updated:{name:"updated",type:"object"},devices:{name:"devices",type:"object"},thumbnailImage:{name:"thumbnailImage",type:"string"}}}),Building:n.data.Model.define({id:"id",fields:{id:{name:"id",type:"number"},description:{name:"description",type:"string"},name:{name:"name",type:"string"},highestFloor:{name:"highestFloor",type:"object"},lowestFloor:{name:"lowestFloor",type:"object"},indexes:{name:"indexes",type:"object"},sortOrder:{name:"sortOrder",type:"number"},maxOccupancy:{name:"maxOccupancy",type:"number"},imageFileName:{name:"imageFileName",type:"string"},dataType:{name:"dataType",type:"number",options:[{text:"ORIGINAL_DATA",value:a.ORIGINAL_DATA},{text:"UPDATE_DATA",value:a.UPDATE_DATA},{text:"NEW_DATA",value:a.NEW_DATA},{text:"DELETED_DATA",value:a.DELETED_DATA},{text:"VIEW_DATA",value:a.VIEW_DATA}],defaultValue:0}}}),Floor:n.data.Model.define({id:"id",fields:{id:{name:"id",type:"number"},description:{name:"description",type:"string"},name:{name:"name",type:"string"},indexes:{name:"indexes",type:"object"},sortOrder:{name:"sortOrder",type:"number"},type:{name:"type",type:"string",options:i},length:{name:"length",type:"number"},width:{name:"width",type:"number"},maxOccupancy:{name:"maxOccupancy",type:"number"},imageFileName:{name:"imageFileName",type:"string"},alarms:{name:"alarms",type:"object"},space_buildings_id:{name:"space_buildings_id",type:"number"},dataType:{name:"dataType",type:"number",options:[{text:"ORIGINAL_DATA",value:a.ORIGINAL_DATA},{text:"UPDATE_DATA",value:a.UPDATE_DATA},{text:"NEW_DATA",value:a.NEW_DATA},{text:"DELETED_DATA",value:a.DELETED_DATA},{text:"VIEW_DATA",value:a.VIEW_DATA}],defaultValue:0}}}),Indexes:n.data.Model.define({fields:{densityLevel:{name:"densityLevel",type:"number"},comfortLevel:{name:"comfortLevel",type:"number"},numberOfPeople:{name:"numberOfPeople",type:"number"},numberOfZones:{name:"numberOfZones",type:"number"}}})}}),define("controlareasettings/building/total-building",["controlareasettings/core","controlareasettings/building/config/space-common","controlareasettings/building/config/space-widget","controlareasettings/building/config/space-vm","controlareasettings/building/config/space-api"],function(e,t,n,o,i){"use strict";function l(){var e=c.find(".k-grid-content tr"),t=c.find(".k-grid-content .k-state-selected"),n=e.length,o=t.length,i=t.eq(o-1);L(M,[{btnAdd:[!(n<100),!0]},{btnDelete:[!(0<o),!0]},{btnMoveTop:[!1,!0]},{btnMoveUp:[!1,!0]},{btnMoveDown:[!1,!0]},{btnMoveBottom:[!1,!0]}]),o-1===i.index()&&L(M,[{btnMoveTop:[!0,!0]},{btnMoveUp:[!0,!0]}]),-1!==t.eq(0).index()&&t.eq(0).index()!==n-o||L(M,[{btnMoveDown:[!0,!0]},{btnMoveBottom:[!0,!0]}])}var a,u,r,d,s,c,E=window.kendo,p=window.MAIN_WINDOW,A=window.Util,_=t.MESSAGE,f=t.TEXT,T=n.Loading,g=n.confirmDialog,m=n.messagDialog,C=t.checkDuplicatedByKey,b=t.getFloorName,D=t.checkNoElementByKey,v=$("#spaceAllTopButtons").html(),O=$("#spaceAllMoveButtons").html(),S=$("<div/>").addClass("left").append(O),h=[],F={name:{validator:null,element:null},description:{validator:null,element:null},validate:function(){return null!==this.name.validator&&null!==this.description.validator&&(this.name.validator&&this.description.validator)}},N=0,k=2,B=o.AllMainViewModel,M={btnEdit:B.get("btnEdit"),btnAdd:B.get("btnAdd"),btnDelete:B.get("btnDelete"),btnSave:B.get("btnSave"),btnExit:B.get("btnExit"),btnCancel:B.get("btnCancel"),btnMoveTop:B.get("btnMoveTop"),btnMoveUp:B.get("btnMoveUp"),btnMoveDown:B.get("btnMoveDown"),btnMoveBottom:B.get("btnMoveBottom")},L=t.buttonStateChange,y=t.editButtonsState,P=function(){a=$("#component-example-tab"),$(".common-tab-top-content").append(S).append(v),u=$("#space-content"),d=$("#space-grid"),c=$("#space-grid-edit").off()},I=function(){r=d.kendoGrid({columns:x(),scrollable:!0,height:"100%"}).data("kendoGrid"),s=c.kendoGrid({columns:U(),scrollable:!0,height:"100%",hasCheckedModel:!0,setCheckedAttribute:!0}).data("kendoGrid"),E.bind(a,B)},w=function(n){T.open(),i.spaceBuildingsGET().done(function(e){var t;if(n)for(p.setBuildingList(e),t=0;t<e.length;t++)if(0===e[t].id){e.splice(t,1);break}r.setDataSource(new E.data.DataSource({data:e,sort:{field:"sortOrder",dir:"asc"},aggregate:[{field:"indexes.numberOfZones",aggregate:"sum"}]}))}).fail(function(e){m.message(A.parseFailResponse(e)),m.open()}).always(function(){T.close()})},x=function(){var e=[];return e.push({field:"name",title:f.NAME,width:60,footerTemplate:f.SPACE_TEXT_TOTAL},{field:"floors",title:f.FLOOR,width:90,template:function(e){var t="-";return e.highestFloor&&e.lowestFloor&&(t=b(e.lowestFloor.foundation_space_floors_type,e.lowestFloor.foundation_space_floors_name)+" ~ "+b(e.highestFloor.foundation_space_floors_type,e.highestFloor.foundation_space_floors_name)),t},footerTemplate:"-"},{field:"description",title:f.DESCRIPTION,width:180,footerTemplate:"-"},{field:"indexes",title:f.ZONE_NUM,width:70,template:function(e){var t="-";return e.indexes&&0<e.indexes.numberOfZones&&(t=e.indexes.numberOfZones),t},footerTemplate:function(e){return e["indexes.numberOfZones"]?e["indexes.numberOfZones"].sum:"-"}}),e},U=function(){var e=x();return e[N].template=function(e){return'<input class="k-input" data-id="'+e.id+'" data-key="name" value="'+e.name+'">'},e[k].template=function(e){return'<input class="k-input" data-id="'+e.id+'" data-key="description" value="'+e.description+'">'},e},R=function(){c.on("change",".k-input",function(e){var t,n=$(e.target),o=n.data("id"),i=n.data("key");(t=W(o))[i]=n.val(),t.created||(t.changed=!0),y(M)}),M.btnEdit.set("click",function(){var e=r.dataSource.data().length;Z(!0),99<e&&L(M,[{btnAdd:[!0,!0]}])}),M.btnAdd.set("click",function(){var e=E.guid();h.push({id:e,name:V(),description:"",indexes:{numberOfZones:0},created:!0,sortOrder:0}),z(),H(),y(M),G(),l()}),M.btnSave.set("click",function(){var a=!1,u=!1;if(G(),F.validate()){if(C(s.dataSource.view(),"name"))return m.message(_.SPACE_MESSAGE_NOTI_EXIST_SAME_BUILDING_NAME),void m.open();if(D(s.dataSource.view(),"name"))return m.message(_.SPACE_SAVE_BUILDING_NAME_NOT),void m.open();0<Y("created").length&&(a=!0),0<Y("changed").length&&(u=!0);var e=[].concat(i.spaceBuildingsPOST(Y("created")),i.spaceBuildingsPATCH(Y("changed")),i.spaceBuildingsDELETE(Y("deleted")));T.open(),$.when.apply(this,e).done(function(){var e,t,n,o=0,i=[];for(a&&(e=arguments&&arguments[o]&&arguments[o++][0]||[]),u&&(t=arguments&&arguments[o]&&arguments[o][0]||[]),e=e||[],t=t||[],o=0;o<e.length;o++)490!==e[o].code||!e[o].body||61501!=e[o].body.code&&61502!=e[o].body.code||i.push(e[o].body.message.slice(e[o].body.message.indexOf("[")+1,e[o].body.message.indexOf("]")));for(o=0;o<t.length;o++)490!==t[o].code||!t[o].body||61501!=t[o].body.code&&61502!=t[o].body.code||i.push(t[o].body.message.slice(t[o].body.message.indexOf("[")+1,t[o].body.message.indexOf("]")));T.close(),n=0===i.length?_.COMMON_MESSAGE_NOTI_SAVED:_.SPACE_DUPLICATE_BUILDING_NAME(i.join(", ")),m.message(n),m.open(),Z(!1),w(!0)}).fail(function(e){m.message(A.parseFailResponse(e)),m.open(),T.close()})}}),M.btnDelete.set("click",function(){g.setConfirmActions({yes:function(){var e,t,n,o,i=s.getCheckedData();for(e=0;e<i.length;e++)if(n=i[e].id,i[e].created){for(o=-1,t=0;t<h.length;t++)if(h[t].id===n){o=t;break}h.splice(o,1)}else W(n).changed=!1,W(n).deleted=!0;y(M),z(),H(),G(),l()}}),g.message(_.DELETE_BUILDING_TEXT),g.open()}),M.btnCancel.set("click",function(){g.setConfirmActions({yes:function(){Z(!1)}}),g.message(_.SPACE_CANCEL_TEXT),g.open()}),M.btnExit.set("click",function(){Z(!1)}),M.btnMoveTop.set("click",function(){n("up",0)}),M.btnMoveUp.set("click",function(){var e=c.find(".k-checkbox:checked").eq(0).closest("tr").index();n("up",e=0<e?e-1:e)}),M.btnMoveDown.set("click",function(){var e=c.find(".k-checkbox:checked"),t=e.eq(e.length-1).closest("tr").index();t=t<s.dataSource.view().length-1?t+1:t,n("down",t)}),M.btnMoveBottom.set("click",function(){n("down",s.dataSource.view().length-1)});var n=function(e,t){var n,o,i,a,u=s.dataSource.view(),r=c.find(".k-grid-content"),d=r.scrollTop();if(o=u.length,"up"===e){for(a=1,n=0;n<t;n++)(i=W(u[n].id)).created||i.sortOrder===a||(i.changed=!0),i.sortOrder=a++;for(n=t;n<o;n++)u[n].checked&&((i=W(u[n].id)).created||i.sortOrder===a||(i.changed=!0),i.sortOrder=a++);for(n=t;n<o;n++)u[n].checked||((i=W(u[n].id)).created||i.sortOrder===a||(i.changed=!0),i.sortOrder=a++);d=70*t<d?70*t:d,r.scrollTop(d)}else if("down"===e){for(n=(a=o)-1;t<n;n--)(i=W(u[n].id)).created||i.sortOrder===a||(i.changed=!0),i.sortOrder=a--;for(n=t;0<=n;n--)u[n].checked&&((i=W(u[n].id)).created||i.sortOrder===a||(i.changed=!0),i.sortOrder=a--);for(n=t;0<=n;n--)u[n].checked||((i=W(u[n].id)).created||i.sortOrder===a||(i.changed=!0),i.sortOrder=a--);d=d<70*(t+1)-r.height()?70*(t+1)-r.height():d,r.scrollTop(d)}z(),G(),y(M),l()};s.bind("checked",function(e){var t,n=e.checkbox,o=e.isHeader,i=s.dataSource.view();for(o?n[0].checked&&c.find(".k-grid-content tr").toggleClass("k-state-selected"):n.closest("tr").toggleClass("k-state-selected"),t=0;t<i.length;t++)W(i[t].id).checked=i[t].checked;l()}),s.bind("dataBound",function(e){F.name.element=c.find('.k-input[data-key="name"]').kendoCommonValidator({type:"name"}),F.name.validator=X("name"),F.description.element=c.find('.k-input[data-key="description"]').kendoCommonValidator({type:"description"}),F.description.validator=X("description")})},X=function(e){var t,n=F[e].element,o=n.length;for(t=0;t<o;t++)if(!n.eq(t).data("kendoCommonValidator").validate())return!1;return!0},G=function(){var e,t,n,o,i=s.getCheckedData();for(s.setDataSource(new E.data.DataSource({data:JSON.parse(JSON.stringify(h)),sort:{field:"sortOrder",dir:"asc"},filter:[{field:"deleted",operator:"neq",value:!0}],aggregate:[{field:"indexes.numberOfZones",aggregate:"sum"}]})),o=s.dataSource.view(),e=0;e<i.length;e++){for(n=-1,t=0;t<o.length;t++)if(o[t].id===i[e].id){n=t;break}-1<n&&c.find(".k-grid-content .k-checkbox-label").eq(n).closest("tr").toggleClass("k-state-selected")}},V=function(){var e,t,n,o,i,a=h.length,u=0;for(i=0;i<a;i++)(e=h[i]).deleted||(o=e.name)&&-1!==o.indexOf("Building")&&(n=(t=o.split(" "))[t.length-1],n=Number(n),!isNaN(n)&&u<n&&(u=n));return"Building "+(u+1)},Z=function(e){t.changeEditMode(M,e),e?(u.addClass("editable"),0<(h=JSON.parse(JSON.stringify(r.dataSource.data()))).length&&z(),G()):(u.removeClass("editable"),s.uncheckAll(),h=[])},z=function(){h.sort(function(e,t){return e.sortOrder-t.sortOrder})},H=function(){var e,t=1;for(e=0;e<h.length;e++)h[e].deleted||(h[e].sortOrder=t++,h[e].created||(h[e].changed=!0))},W=function(t){var e;return(e=$.grep(h,function(e){return e.id===t}))[0]?e[0]:null},Y=function(e){var t,n=[];for(t=0;t<h.length;t++)h[t][e]&&n.push(h[t]);return n};return{init:function(){P(),I(),Z(!1),w(),R()}}}),define("controlareasettings/building/all-floor",["controlareasettings/core","controlareasettings/building/config/space-common","controlareasettings/building/config/space-widget","controlareasettings/building/config/space-vm","controlareasettings/building/config/space-api"],function(e,t,n,o,i){"use strict";function l(){var e=_.find(".k-grid-content tr"),t=_.find(".k-grid-content .k-state-selected"),n=e.length,o=t.length,i=t.eq(o-1);R(U,[{btnAdd:[!(n<150),!0]},{btnDelete:[!(0<o),!0]},{btnMoveTop:[!1,!0]},{btnMoveUp:[!1,!0]},{btnMoveDown:[!1,!0]},{btnMoveBottom:[!1,!0]}]),o-1===i.index()&&R(U,[{btnMoveTop:[!0,!0]},{btnMoveUp:[!0,!0]}]),-1!==t.eq(0).index()&&t.eq(0).index()!==n-o||R(U,[{btnMoveDown:[!0,!0]},{btnMoveBottom:[!0,!0]}])}var a,u,r,d,s,c,E,p,A,_,f=window.kendo,T=window.I18N,g=window.Util,m=window.MAIN_WINDOW,C=t.MESSAGE,b=t.TEXT,D=n.Loading,v=n.confirmDialog,O=n.messagDialog,S=t.deepCopyArray,h=t.getFloorName,F=$("#spaceAllTopButtons").html(),N=$("#spaceAllMoveButtons").html(),k=$("<div/>").addClass("left").append(N),B=[],M={name:{validator:null,element:null},description:{validator:null,element:null},width:{validator:null,element:null},length:{validator:null,element:null},validate:function(){var e=this;return null!==e.name.validator&&null!==e.description.validator&&null!==e.width.validator&&null!==e.length.validator&&(e.name.validator&&e.description.validator&&e.width.validator&&e.length.validator)}},L=1,y=2,P=4,I=5,w=6,x=o.AllMainViewModel,U={btnEdit:x.get("btnEdit"),btnAdd:x.get("btnAdd"),btnDelete:x.get("btnDelete"),btnSave:x.get("btnSave"),btnExit:x.get("btnExit"),btnCancel:x.get("btnCancel"),btnMoveTop:x.get("btnMoveTop"),btnMoveUp:x.get("btnMoveUp"),btnMoveDown:x.get("btnMoveDown"),btnMoveBottom:x.get("btnMoveBottom")},R=t.buttonStateChange,X=t.editButtonsState,G=function(){s=$("#component-example-tab"),$(".common-tab-top-content").append(k).append(F),c=$("#space-content"),p=$("#space-grid"),_=$("#space-grid-edit").off()},V=function(){E=p.kendoGrid({columns:z(),scrollable:!0,height:"100%"}).data("kendoGrid"),A=_.kendoGrid({columns:H(),scrollable:!0,height:"100%",hasCheckedModel:!0,setCheckedAttribute:!0}).data("kendoGrid"),f.bind(s,x)},Z=function(t){D.open(),i.spaceFloorsGET({foundation_space_buildings_id:[u]}).done(function(e){t&&m.refreshFloorList(),E.setDataSource(new f.data.DataSource({data:e,sort:{field:"sortOrder",dir:"asc"},aggregate:[{field:"indexes.numberOfZones",aggregate:"sum"}]}))}).fail(function(e){O.message(g.parseFailResponse(e)),O.open()}).always(function(){D.close()})},z=function(){var e=[];return e.push({field:"id",title:b.NAME,width:200,template:"",footerTemplate:a.name||a.value},{field:"name",title:b.FLOOR,width:250,template:function(e){return h(e.type,e.name)},footerTemplate:function(){return r&&d?r+" ~ "+d:"-"}},{field:"description",title:b.DESCRIPTION,footerTemplate:a.description},{field:"indexes",title:b.ZONE_NUM,width:100,template:function(e){var t="-";return e.indexes&&0<e.indexes.numberOfZones&&(t=e.indexes.numberOfZones),t},footerTemplate:function(e){return e["indexes.numberOfZones"]?e["indexes.numberOfZones"].sum:"-"}},{field:"width",title:b.SPACE_FLOOR_WIDTH,width:100,footerTemplate:"-"},{field:"length",title:b.SPACE_FLOOR_HEIGHT,width:100,footerTemplate:"-"},{field:"imageFileName",title:b.MAP_IMAGE,width:240,footerTemplate:"-"}),e},H=function(){var e=z();return e[L].template=function(e){var t='<input class="floor-type-select" data-id="'+e.id+'" data-key="type" value="'+e.type+'">';return t+='<input class="k-input floor-name-input" data-id="'+e.id+'" data-key="name" value="'+e.name+'">'},e[y].template=function(e){return'<input class="k-input" data-id="'+e.id+'" data-key="description" value="'+e.description+'">'},e[P].template=function(e){return'<input class="k-input floor-width-input" data-id="'+e.id+'" data-key="width" value="'+e.width+'">'},e[I].template=function(e){return'<input class="k-input floor-length-input" data-id="'+e.id+'" data-key="length" value="'+e.length+'">'},e[w].template=function(e){var t=$("<td/>"),n=$("<span/>").addClass("floor-image").attr("data-id",e.id).attr("data-key","imageFileName");e.imageFileName&&n.addClass("has-image-file");var o='<span class="floor-image-filename image-file">'+e.imageFileName+"</span>";return o+='<input class="floor-image-input" type="file" accept=".gif, .jpg, .png, .dwg, .jpeg">',o+='<button class="floor-image-delete-btn image-file"></button>',o+='<button class="floor-image-upload-btn k-button no-image-file">'+C.UPLOAD_TEXT_BTN+"</button>",t.append(n.html(o)),t.html()},e},W=function(){_.on("change",".k-input",function(e){var t,n=$(e.target),o=n.data("id"),i=n.data("key");(t=ne(o))[i]=n.val(),t.created||(t.changed=!0),X(U)}),_.on("click",".floor-image-upload-btn",function(){$(this).siblings(".floor-image-input").trigger("click")}),_.on("change",".floor-image .floor-image-input",function(){var e,t=$(this),n=t.get(0),o=t.closest(".floor-image"),i=o.data("id"),a=o.data("key"),u=ne(i),r=!1,d=n&&n.files[0]&&n.files[0].name||"",l=(e=d.split("."))[e.length-1].toLowerCase();"gif"!==l&&"dwg"!==l&&"png"!==l&&"jpg"!==l&&"jpeg"!==l||(r=!0),n.files[0].size<2097152&&r&&/^(?=.{1,255}$)([A-Za-z\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC_\-\s0-9\.]+)$/.test(d)?n.files&&n.files[0]&&(u[a]=d,u.image=n.files[0],u.created||(u.imageChanged=!0,u.imageDeleted=!1),K(),X(U)):(2097152<n.files[0].size?O.message(C.UPLOAD_IMAGE_FILE_SIZE_NOT):r?O.message(T.prop("COMMON_INVALID_VALUE")):O.message(C.UPLOAD_IMAGE_FILE_TYPE_NOT),O.open())}),_.on("click",".floor-image-delete-btn",function(){var e=$(this).closest(".floor-image"),t=e.data("id"),n=e.data("key"),o=ne(t);o[n]=void 0,o.created||(o.imageChanged=!1,o.imageDeleted=!0),K(),X(U)}),U.btnEdit.set("click",function(){var e=E.dataSource.data().length;Q(!0),149<e&&R(U,[{btnAdd:[!0,!0]}])}),U.btnAdd.set("click",function(){var e=f.guid();B.push({id:e,name:J(),type:"F",foundation_space_buildings_id:u,description:"",indexes:{numberOfZones:0},created:!0,width:0,length:0,sortOrder:0}),ee(),te(),X(U),K(),l()}),U.btnSave.set("click",function(){var e=0,t=B.length,n="";for(e=0;e<t;e++)n=B[e].name,B[e].name=$.trim(n);if(K(),M.validate()){if(j())return O.message(C.SPACE_MESSAGE_NOTI_EXIST_SAME_FLOOR_NAME),void O.open();var o=[].concat(i.spaceFloorsPOST(oe("created")),i.spaceFloorsPATCH(oe("changed")),i.spaceFloorsDELETE(oe("deleted")),i.spaceFloorsImagePOST(oe("imageChanged")),i.spaceFloorsImageDELETE(oe("imageDeleted")));D.open(),$.when.apply(this,o).done(function(){D.close(),O.message(C.COMMON_MESSAGE_NOTI_SAVED),O.open(),Q(!1),Z(!0)}).fail(function(e){O.message(g.parseFailResponse(e)),O.open(),D.close()})}}),U.btnDelete.set("click",function(){var e,a=A.getCheckedData(),t=a.length;e=1<t?C.DELETE_MULTI_FLOOR_TEXT(t):C.DELETE_FLOOR_TEXT,v.setConfirmActions({yes:function(){var e,t,n,o,i;for(e=0;e<a.length;e++)if(n=a[e].id,a[e].created){for(o=-1,t=0;t<B.length;t++)if(B[t].id===n){o=t;break}B.splice(o,1)}else(i=ne(n)).changed=!1,i.imageChanged=!1,i.imageDeleted=!1,i.deleted=!0;X(U),ee(),te(),K(),l()}}),v.message(e),v.open()}),U.btnCancel.set("click",function(){v.setConfirmActions({yes:function(){Q(!1)}}),v.message(C.SPACE_CANCEL_TEXT),v.open()}),U.btnExit.set("click",function(){Q(!1)}),U.btnMoveTop.set("click",function(){n("up",0)}),U.btnMoveUp.set("click",function(){var e=_.find(".k-checkbox:checked").eq(0).closest("tr").index();n("up",e=0<e?e-1:e)}),U.btnMoveDown.set("click",function(){var e=_.find(".k-checkbox:checked"),t=e.eq(e.length-1).closest("tr").index();t=t<A.dataSource.view().length-1?t+1:t,n("down",t)}),U.btnMoveBottom.set("click",function(){n("down",A.dataSource.view().length-1)});var n=function(e,t){var n,o,i,a,u=A.dataSource.view(),r=_.find(".k-grid-content"),d=r.scrollTop();if(o=u.length,"up"===e){for(a=1,n=0;n<t;n++)(i=ne(u[n].id)).created||i.sortOrder===a||(i.changed=!0),i.sortOrder=a++;for(n=t;n<o;n++)u[n].checked&&((i=ne(u[n].id)).created||i.sortOrder===a||(i.changed=!0),i.sortOrder=a++);for(n=t;n<o;n++)u[n].checked||((i=ne(u[n].id)).created||i.sortOrder===a||(i.changed=!0),i.sortOrder=a++);d=71*t<d?71*t:d,r.scrollTop(d)}else if("down"===e){for(n=(a=o)-1;t<n;n--)(i=ne(u[n].id)).created||i.sortOrder===a||(i.changed=!0),i.sortOrder=a--;for(n=t;0<=n;n--)u[n].checked&&((i=ne(u[n].id)).created||i.sortOrder===a||(i.changed=!0),i.sortOrder=a--);for(n=t;0<=n;n--)u[n].checked||((i=ne(u[n].id)).created||i.sortOrder===a||(i.changed=!0),i.sortOrder=a--);d=d<71*(t+1)-r.height()?71*(t+1)-r.height():d,r.scrollTop(d)}ee(),K(),X(U),l()};A.bind("checked",function(e){var t,n=e.checkbox,o=e.isHeader,i=A.dataSource.view();for(o?n[0].checked&&_.find(".k-grid-content tr").toggleClass("k-state-selected"):n.closest("tr").toggleClass("k-state-selected"),t=0;t<i.length;t++)ne(i[t].id).checked=i[t].checked;l()}),A.bind("dataBound",function(e){var t={messages:{invalidValue:T.prop("COMMON_INVALID_VALUE"),invalidMin:T.prop("COMMON_INVALID_MIN",0)},rules:{invalidValue:function(e){var t=e.val();return!isNaN(Number(t))},invalidMin:function(e){var t=e.val();return!(!isNaN(Number(t))&&t<0)}}};_.find(".floor-type-select").each(function(){var e=$(this),t=e.val();"undefined"!==t&&""!==t||(t=null),e.kendoDropDownList({value:t,dataValueField:"value",dataTextField:"text",width:80,dataSource:[{value:"F",text:"F"},{value:"B",text:"B"},{value:"None",text:"None"}],change:function(e){var t=e.sender.element,n=e.sender.value(),o=t.data("id"),i=t.data("key"),a=ne(o);a[i]=n,a.created||(a.changed=!0),X(U)}})}),M.name.element=_.find('.k-input[data-key="name"]').kendoCommonValidator({messages:{cannotInputMore:C.TEXT_LENGTH_LONG,noEmptyName:C.SPACE_SAVE_FLOOR_NAME_NOT},rules:{cannotInputMore:function(e){return!(3<e.val().length)},noEmptyName:function(e){return 0!==e.val().length}}}),M.name.validator=q("name"),M.description.element=_.find('.k-input[data-key="description"]').kendoCommonValidator({type:"description"}),M.description.validator=q("description"),M.width.element=_.find('.k-input[data-key="width"]').kendoCommonValidator(t),M.width.validator=q("width"),M.length.element=_.find('.k-input[data-key="length"]').kendoCommonValidator(t),M.length.validator=q("length")}),E.bind("dataBinding",Y),A.bind("dataBinding",Y)},Y=function(e){var t=e.sender.dataSource.view(),n=0<t.length-1?t.length-1:0;d=0<t.length?(r=h(t[n].type,t[n].name),h(t[0].type,t[0].name)):r=""},q=function(e){var t,n=M[e].element,o=n.length;for(t=0;t<o;t++)if(!n.eq(t).data("kendoCommonValidator").validate())return!1;return!0},j=function(){var e,t,n=A.dataSource.view();for(e=0;e<n.length;e++)for(t=e+1;t<n.length;t++)if(h(n[e].type,n[e].name)===h(n[t].type,n[t].name))return!0;return!1},K=function(){var e,t,n,o,i=A.getCheckedData();for(A.setDataSource(new f.data.DataSource({data:S(B),sort:{field:"sortOrder",dir:"asc"},filter:[{field:"deleted",operator:"neq",value:!0}],aggregate:[{field:"indexes.numberOfZones",aggregate:"sum"}]})),o=A.dataSource.view(),e=0;e<i.length;e++){for(n=-1,t=0;t<o.length;t++)if(o[t].id===i[e].id){n=t;break}-1<n&&_.find(".k-grid-content .k-checkbox-label").eq(n).closest("tr").toggleClass("k-state-selected")}},J=function(){var e,t,n,o,i,a=B.length,u=0;for(i=0;i<a;i++)(e=B[i]).deleted||(n=e.name,o=e.type,n&&"F"===o&&(t=Number(n),!isNaN(t)&&u<t&&(u=t)));return u+1},Q=function(e){t.changeEditMode(U,e),e?(c.addClass("editable"),0<(B=S(E.dataSource.data())).length&&ee(),K()):(c.removeClass("editable"),Y({sender:E}),A.uncheckAll(),B=[])},ee=function(){B.sort(function(e,t){return e.sortOrder-t.sortOrder})},te=function(){var e,t=1;for(e=0;e<B.length;e++)B[e].deleted||(B[e].sortOrder=t++,B[e].created||(B[e].changed=!0))},ne=function(t){var e;return(e=$.grep(B,function(e){return e.id===t}))[0]?e[0]:null},oe=function(e){var t,n=[];for(t=0;t<B.length;t++)B[t][e]&&n.push(B[t]);return n};return{init:function(e){a=e.building,u=a.id,r=h(a.lowestFloor&&a.lowestFloor.foundation_space_floors_type||"",a.lowestFloor&&a.lowestFloor.foundation_space_floors_name||""),d=h(a.highestFloor&&a.highestFloor.foundation_space_floors_type||"",a.highestFloor&&a.highestFloor.foundation_space_floors_name||""),G(),V(),Q(!1),Z(),W()}}}),define("controlareasettings/building/specific-floor",["controlareasettings/core","controlareasettings/building/config/space-common","controlareasettings/building/config/space-widget","controlareasettings/building/model/space-model","controlareasettings/building/config/space-api","controlareasettings/building/config/space-vm"],function(e,t,n,o,d,i){"use strict";function a(){var e=$("#zone-list-grid-edit .k-grid-content .k-checkbox"),t=$("#zone-list-grid-edit .k-grid-content .k-checkbox:checked"),n=t.length,o=$("#zone-list-grid-edit .k-grid-content .k-checkbox:checked:last").closest("tr").index();V(G,[{btnZoneCreate:[!(e.length<100),!0]},{btnZoneDelete:[!(0<n),!0]},{btnMoveTop:[!1,!0]},{btnMoveUp:[!1,!0]},{btnMoveDown:[!1,!0]},{btnMoveBottom:[!1,!0]}]),n-1===o&&V(G,[{btnMoveTop:[!0,!0]},{btnMoveUp:[!0,!0]}]),-1!==t.eq(0).closest("tr").index()&&t.eq(0).closest("tr").index()!==e.length-n||V(G,[{btnMoveDown:[!0,!0]},{btnMoveBottom:[!0,!0]}])}var p,u,r,l,s,c,E,A,_,f,T,g,m,C,b,D,v,O,S,h,F=window.kendo,N=window.moment,k=window.Util,B=window.MAIN_WINDOW,M=t.MESSAGE,L=t.TEXT,y=n.Loading,P=n.confirmDialog,I=n.messagDialog,w=t.checkDuplicatedByKey,x=t.deepCopyArray,U=t.getFloorName,R=$("#spaceFloorTopButtons").html(),X=i.SpecificFloorMainViewModel,G={btnFloorDelete:X.get("btnFloorDelete"),btnEdit:X.get("btnEdit"),btnSave:X.get("btnSave"),btnExit:X.get("btnExit"),btnCancel:X.get("btnCancel"),btnZoneCreate:X.get("btnZoneCreate"),btnZoneDelete:X.get("btnZoneDelete"),btnMoveTop:X.get("btnMoveTop"),btnMoveUp:X.get("btnMoveUp"),btnMoveDown:X.get("btnMoveDown"),btnMoveBottom:X.get("btnMoveBottom")},V=t.buttonStateChange,Z=function(){h=$("#component-example-tab"),$(".common-tab-top-content").append(R),c=$("#space-detail-dialog"),D=$("#spaceFloorGrid"),O=D.find(".fake-grid-body"),v=D.find(".space-map-view").off("click"),A=v.find("#zone-list-grid"),f=v.find("#zone-list-grid-edit"),u=v.find("#map-view-block"),g=v.find(".device-filter")},z=function(){c.data("kendoDetailDialog")&&c.data("kendoDetailDialog").destroy(),s=c.kendoDetailDialog({title:L.COMMON_BTN_DETAIL,dataSource:[],height:850,width:700,scheme:{id:"id",fields:{name:{name:L.SPACE_TEXT_GENERAL,type:"text",editable:!0,editCss:{display:"none"},template:function(){return""}},location:{name:L.SPACE_TEXT_LOCATION,type:"text",template:function(e){return e.foundation_space_buildings_name+" - "+U(e.foundation_space_floors_type,e.foundation_space_floors_name)}},description:{name:L.DESCRIPTION,type:"text",editable:!0,validator:!0,editCss:{width:"100%"}},created:{name:"[ "+L.SPACE_BUTTON_TEXT_CREATE+" ]",template:function(){return""}},created_date:{name:L.SPACE_TEXT_DATE,template:function(e){var t="-";return t=void 0!==e.created?N(e.created.date).format("YYYY/MM/DD hh:mm:ss"):t}},created_ums_users_name:{name:L.SPACE_TEXT_MANAGER,template:function(e){var t="-";return t=void 0!==e.created?e.created.ums_users_name:t}},updated:{name:"[ "+L.SPACE_TEXT_LATEST_UPDATE+" ]",type:"text",template:function(){return""}},updated_date:{name:L.SPACE_TEXT_DATE,template:function(e){var t="-";return t=void 0!==e.updated?N(e.updated.date).format("YYYY/MM/DD hh:mm:ss"):t}},updated_ums_users_name:{name:L.SPACE_TEXT_MANAGER,template:function(e){var t="-";return t=void 0!==e.updated?e.updated.ums_users_name:t}},backgroundColor:{name:L.SPACE_TEXT_COLOR,type:"text",template:function(e){return e.backgroundColor||(e.backgroundColor="#0081c6"),'<div><div class="space-detail-dialog-color-picker" style="background-color: '+e.backgroundColor+';"></div><div class="space-detail-dialog-color">'+e.backgroundColor+"</div></div>"},editable:!0,editFieldName:"backgroundColor",editTemplate:function(){return'<div><div class="space-detail-dialog-color-picker" data-bind="style:  {backgroundColor: fields.backgroundColor}"></div><input class="k-input space-detail-dialog-color-picker-active-area" data-bind="value: fields.backgroundColor, events: {click: click}, disabled: disabled"><div id="space-color-picker"></div></div>'},editViewModel:{fields:{backgroundColor:null},click:function(e){$("#space-color-picker").data("kendoCommonColorPicker").open(),e.stopPropagation()},disabled:!1,init:function(){this.fields.backgroundColor=s.getSelectedData().backgroundColor,$("#space-color-picker").kendoCommonColorPicker({}).data("kendoCommonColorPicker").bind("change",function(e){s.options.scheme.fields.backgroundColor.editViewModel.fields.set("backgroundColor",e.value),s.enableSaveBtn()})}}}}},headerTemplate:function(e){var t='<div class="space-popup-header"><div class="detail-dialog-content-field-item" data-editable="true" data-key="name"><div class="detail-dialog-content-field-value">';return t+='<span class="display">'+e.name+"</span>",t+='<span class="editable" style="width: 100%;"><input type="text" class="k-input" style="width: 100%;"></span></div></div></div>'},isCustomActions:!0,actions:[{text:L.SPACE_BUTTON_TEXT_SAVE,visible:!1,disabled:!0,action:J},{text:L.SPACE_BUTTON_TEXT_EDIT,visible:!0,action:q},{text:L.SPACE_BUTTON_TEXT_CANCEL,visible:!1,action:Q},{text:L.SPACE_BUTTON_TEXT_DELETE,visible:!0,action:j},{text:L.SPACE_BUTTON_TEXT_EXIT,visible:!0,action:K}]}).data("kendoDetailDialog"),F.bind(h,X),E=A.kendoGrid({columns:ee(),scrollable:!0,height:"100%"}).data("kendoGrid"),_=f.kendoGrid({columns:ee(),hasCheckedModel:!0,setCheckedAttribute:!0,scrollable:!0,height:"calc(100% - 48px)"}).data("kendoGrid"),p=u.kendoCommonMapView({floor:C,showDeviceInfoCheckbox:!1,height:"100%",isRegisterView:!0,canDragDeviceIcon:!1,isMonitoringFloorImage:!1}).data("kendoCommonMapView"),l=u.find(".leaflet-control-container .common-map-view-color-picker-element"),r=l.data("kendoCommonColorPicker"),S=k.getTotalDeviceTypeDataSource(),T=g.kendoDropDownCheckBox({invisible:!1,disabled:!1,dataTextField:"text",dataValueField:"value",emptyText:L.SPACE_NO_DEVICE_TYPE,selectAllText:L.SPACE_ALL_DEVICE_TYPE,animation:!1,autoBind:!0,showSelectAll:!0,dataSource:S}).data("kendoDropDownCheckBox")},H=function(){$.when.apply(this,[d.dmsDevicesGET({foundation_space_floors_id:[b],registrationStatuses:["Registered"]}),d.spaceZonesGET({foundation_space_floors_id:[b]}),d.spaceFloorsGET({ids:[b]})]).done(function(e,t,n){var o,i=[],a=[];if(e[0])for(o=0;o<e[0].length;o++)i.push(e[0][o]);if(t[0])for(o=0;o<t[0].length;o++)a.push(t[0][o]);p.setZoneDataSource(a),p.setDataSource(i),p.zoneDataSource.sort({field:"sortOrder",dir:"asc"}),E.setDataSource(new F.data.DataSource({data:x(a),sort:{field:"sortOrder",dir:"asc"}})),n[0]&&!n[0][0]&&(n[0][0]={}),W(n[0][0])}).fail(function(e){var t=k.parseFailResponse(e);I.message(t),I.open()}).always(function(){y.close(),T.selectAll()})},W=function(e){var t,n,o,i,a,u,r,d;t=e.type?e.type:"-",n=e.name?e.name:"-",o=e.description?e.description:"",r=e.width?e.width:"-",d=e.length?e.length:"-",a=e.imageFileName?e.imageFileName.replace("/",""):"-";var l=e.indexes;i="-",l&&(i=l.numberOfZones?l.numberOfZones:"-"),u=U(t,n),O.find(".Floor").html(u),O.find(".Description").html(o),O.find(".width").html(r),O.find(".length").html(d),O.find(".ZoneNum").html(i),O.find(".MapImage").html(a)},Y=function(){g.on("change",function(){var e,t,n={logic:"or",filters:[]},o=$(this).val();if(o=o?o.split(","):o,p.dataSource.filter([]),o&&"All"!==o&&0<o.length){e=o.length;for(var i=0;i<e;i++)(t=o[i])&&("ControlPoint"!==t&&n.filters.push({field:"type",operator:"contains",value:t}),n.filters.push({field:"mappedType",operator:"contains",value:t}));p.dataSource.filter(n)}p.dataSource.view()}),p.bind("dragend",function(e){0<e.zones.length&&ie(!1)}),p.bind("change",function(e){var t,n=e.zones?e.zones[0]:void 0,o=_.dataSource;e.sender._isEditableZone&&void 0!==n&&((t=o.get(n.id)).set("checked",n.selected),t.set("name",n.name),0<p.getUpdatedZones().updated.length&&ie(!1),a())}),r.bind("change",function(e){ie(!1)}),G.btnEdit.set("click",function(){var e=E.dataSource.data().length;te(!1),100<=e&&V(G,[{btnZoneCreate:[!0,!0]}])}),G.btnFloorDelete.set("click",function(){P.setConfirmActions({yes:function(){y.open(),$.when.apply(this,d.spaceFloorsDELETE([{id:b}])).done(function(){I.message(M.DELETE_FLOOR_TEXT_RESULT),I.open(),B.refreshFloorList(),B.clickAllFloor()}).fail(function(e){var t=k.parseFailResponse(e);I.message(t),I.open()}).always(function(){y.close()})},no:null}),P.message(M.DELETE_FLOOR_TEXT),P.open()}),G.btnSave.set("click",function(){if(p.isIntersectZonePolygons())return I.message(M.SPACE_SAVE_ZONE_OVERLAP),void I.open();if(w(_.dataSource.view(),"name"))return I.message(M.SPACE_SAVE_ZONE_NAME_OVERLAP_ERROR),void I.open();var e,t;y.open();var a,n=p.zoneDataSource,o=p.getUpdatedZones(),i=o.created,u=o.updated,r=o.deleted;for(e=0;e<u.length;e++)t=n.get(u[e].id),u[e]=t;$.when.apply(this,d.spaceZonesPOST(i),d.spaceZonesPATCH(u)).always(function(e){void 0===e||201==e.status||204==e.status?d.spaceZonesGET({foundation_space_floors_id:[b]}).done(function(t){var n,o,i=p.zoneDataSource;for(n=0;n<t.length;n++)o=void 0,$.grep(i.data(),function(e){t[n].name===e.name&&(o=i.get(e.id))}),void 0!==o&&o.id!==t[n].id&&o.set("id",t[n].id);a=p.getUpdatedDevices().updated,$.when.apply(this,d.dmsDevicesPATCH(a)).done(function(){$.when.apply(this,d.spaceZonesDELETE(r)).done(function(){I.message(M.SPACE_SAVE_TEXT_RESULT),I.open(),ne(),H()}).fail(function(e){y.close(),I.message(k.parseFailResponse(e)),I.open()})}).fail(function(e){y.close(),I.message(k.parseFailResponse(e)),I.open()})}).fail(function(e){y.close(),I.message(k.parseFailResponse(e)),I.open()}):(y.close(),I.message(k.parseFailResponse(e)),I.open())})}),G.btnCancel.set("click",function(){P.setConfirmActions({yes:function(){ne(),p.setZoneDataSource(x(E.dataSource.data())),p.zoneDataSource.sort({field:"sortOrder",dir:"asc"}),I.message(M.SPACE_CANCEL_TEXT_RESULT),I.open()}}),P.message(M.SPACE_CANCEL_TEXT),P.open()}),G.btnExit.set("click",function(){ne()}),G.btnZoneDelete.set("click",function(){var e,t=_.getCheckedData().length;P.setConfirmActions({yes:function(){var e,t,n,o=_.getCheckedData(),i=p.zoneDataSource;for(n=0;n<o.length;n++)i.remove(i.get(o[n].id));for(t=(e=i.view()).length,n=0;n<t;n++)i.get(e[n].id).set("sortOrder",n+1);p.unselectAll(),ie(!0)},no:null}),e=1==t?M.DELETE_ZONE_TEXT:M.DELETE_MULTI_ZONE_TEXT(t),P.message(e),P.open()}),G.btnZoneCreate.set("click",function(){var e,t=F.guid(),n=p.zoneDataSource,o=n.data();for(p.unselectAll(),n.add({id:t,sortOrder:0,foundation_space_buildings_name:m.name,foundation_space_floors_type:C.type,foundation_space_floors_name:C.name,selected:!0}),e=0;e<o.length;e++)o[e].set("sortOrder",o[e].sortOrder+1);ie(!0),p.editableZone(t,!0)}),_.bind("checked",function(e){var t,n=e.sender.dataSource.data(),o=e.isHeader,i=e.item;if(o)for(t=0;t<n.length;t++)p.selectZone(n[t].id,n[t].checked);else i.checked?p.editableZone(i.id,i.checked):p.selectZone(i.id,i.checked);a()}),G.btnMoveTop.set("click",function(){n("up",0)}),G.btnMoveUp.set("click",function(){var e=$("#zone-list-grid-edit .k-checkbox:checked").eq(0).closest("tr").index();n("up",e=0<e?e-1:e)}),G.btnMoveDown.set("click",function(){var e=$("#zone-list-grid-edit .k-checkbox:checked"),t=e.eq(e.length-1).closest("tr").index();t=t<p.zoneDataSource.data().length-1?t+1:t,n("down",t)}),G.btnMoveBottom.set("click",function(){n("down",p.zoneDataSource.data().length-1)});var n=function(e,t){var n,o,i=[],a=p.zoneDataSource,u=a.view();if(o=u.length,"up"===e){for(n=0;n<t;n++)i.push(u[n]);for(n=t;n<o;n++)u[n].selected&&i.push(u[n]);for(n=t;n<o;n++)u[n].selected||i.push(u[n])}else if("down"===e){for(n=o-1;t<n;n--)i.unshift(u[n]);for(n=t;0<=n;n--)u[n].selected&&i.unshift(u[n]);for(n=t;0<=n;n--)u[n].selected||i.unshift(u[n])}for(n=0;n<o;n++)a.get(i[n].id).set("sortOrder",n+1);a.sort({field:"sortOrder",dir:"asc"}),ie(!0)};v.on("click",".ic.ic-info",function(e){var t=$(e.target).closest("span").data("id");s.setDataSource(p.zoneDataSource.get(t)),v.hasClass("editable")&&s.buttons[s.BTN.EDIT].click(),s.open(),$(".space-popup-header input").kendoCommonValidator({type:"name",rules:{required:function(e){return!!e.val()}},messages:{required:M.SPACE_MESSAGE_NOTI_NOT_SAME_ZNOE_NAME}})}),c.off("keyup").on("keyup",".space-popup-header .editable input",function(e){c.find('li[data-key="name"] input').trigger($.Event("keyup",{keyCode:e.keyCode})),$(this).data("kendoCommonValidator").validate()||s.disableSaveBtn()}),c.off("change").on("change",".space-popup-header .editable input",function(e){c.find('li[data-key="name"] input').val($(e.target).val())}),$(window).on("resize",function(e){E.setOptions({height:"100%"}),_.setOptions({height:"calc(100% - 48px)"})})},q=function(e){var t=$(e.sender.element),n=e.sender.dataSource.data()[0].name;return t.find(".space-popup-header .editable input").val(n),e.sender.setEditable(!0),!1},j=function(t){var e=M.DELETE_ZONE_TEXT;return P.message(e),P.setConfirmActions({yes:function(){var e=t.sender.dataSource.data()[0].id;te(!0),p.zoneDataSource.remove(p.zoneDataSource.get(e)),oe(),t.sender.close()},no:null}),P.open(),!1},K=function(e){e.sender.isEditable&&e.sender.setEditable(!1)},J=function(e){var t,n,o,i,a=e.sender,u=$(a.element),r=p.zoneDataSource,d=a.dataSource.data()[0],l=r.data(),s=u.find(".space-popup-header").find(".editable input"),c=s.val(),E=a.save();for(t=0;t<l.length;t++)if(d.id!==l[t].id&&c===l[t].name)return I.message(M.SPACE_SAVE_ZONE_NAME_OVERLAP_ERROR),I.open(),!1;if(s.data("kendoCommonValidator").validate()&&E){for(n in te(!0),a.setEditable(!1),o=r.get(d.id),i=_.dataSource.get(d.id),E)d.set(n,E[n]),o.set(n,E[n]),i.set(n,E[n]);a.updateDisplayValue(),s.closest("div").find(".display").html(c)}return!1},Q=function(e){return e.sender._cancelEvent(e,!1)},ee=function(){var e=[],t=U(C.type,C.name);return e.push({field:"name",title:t},{title:"",template:function(e){return'<span class="ic ic-info" data-id="'+e.id+'"></span>'},width:40}),e},te=function(e){V(G,[{btnFloorDelete:[!1,!1]},{btnEdit:[!1,!1]},{btnSave:[!e,!0]},{btnCancel:[!1,e]},{btnExit:[!1,!e]},{btnZoneCreate:[!1,!0]},{btnZoneDelete:[!0,!0]},{btnMoveTop:[!0,!0]},{btnMoveUp:[!0,!0]},{btnMoveDown:[!0,!0]},{btnMoveBottom:[!0,!0]}]),v.hasClass("editable")||v.addClass("editable"),p.setEditableZone(!0),oe()},ne=function(){V(G,[{btnFloorDelete:[!1,!0]},{btnEdit:[!1,!0]},{btnSave:[!0,!1]},{btnExit:[!1,!1]},{btnCancel:[!1,!1]},{btnZoneCreate:[!1,!1]},{btnZoneDelete:[!0,!1]}]),v.removeClass("editable"),p.dataSource.filter([]),p.cancel(),g.trigger("change")},oe=function(){var e,t=x(p.zoneDataSource.data());for(e=0;e<t.length;e++)t[e].checked=t[e].selected;_.setDataSource(new F.data.DataSource({data:t,sort:{field:"sortOrder",dir:"asc"}})),a()},ie=function(e){e&&oe(),V(G,[{btnSave:[!1,!0]},{btnCancel:[!1,!0]},{btnExit:[!1,!1]}])};return{init:function(e){m=e.building?e.building:B.getCurrentFloor().building,b=e.floor.id,C=e.floor?e.floor:B.getCurrentFloor().floor,Z(),z(),Y(),ne(),y.open(),H()}}}),define("controlareasettings/building/building",["controlareasettings/core","controlareasettings/building/total-building","controlareasettings/building/all-floor","controlareasettings/building/specific-floor"],function(e,o,i,a){"use strict";var u=window.kendo,r=window.MAIN_WINDOW,d=$(".common-tab-top-content"),l=$("#space-content"),s=$("#spaceViewTemplate").html(),c=$("#spaceFloorViewTemplate").html(),t=$("#component-example-tab"),n=function(e){var t=e.building,n=e.floor;d.empty(),l.empty().removeClass("editable"),t.id==r.FLOOR_NAV_BUILDING_TOTAL_ID?(l.html(u.template(s)),o.init(e)):n.id==r.FLOOR_NAV_FLOOR_ALL_ID?(l.html(u.template(s)),i.init(e)):(l.html(u.template(c)),a.init(e))};t.kendoCommonTabStrip(),e.on("onfloorchange",n)});